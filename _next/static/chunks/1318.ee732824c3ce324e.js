"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1318],{23750:(t,e,s)=>{s.d(e,{O:()=>d,a:()=>_,c:()=>o});var i=s(8288),n=s(16404),r=s(31632),h=s(73750),m=s(32045),a=s(92656);function o(t,e,s,i,n){return l(t,e,null,s,i,n)}function l(t,e,s,i,m,a){let l=t.getGeometryType();if(l===n.G.enumPoint){let s=t.getXY();return e.contains(s)?t:t.createInstance()}if(l===n.G.enumEnvelope){let s=h.J.constructEmpty();if(t.queryEnvelope(s),s.intersect(e)){let e=t.clone();return e.setEnvelope(s),e}return t.createInstance()}if(t.isEmpty())return t;if(e.isEmpty())return t.createInstance();let _=e.clone();{let e=new h.J;if(t.queryLooseEnvelope(e),_.containsEnvelope(e))return t;if(!_.isIntersecting(e))return t.createInstance();0===m&&(e.intersect(_),e.inflate(Math.max(.1*e.maxDimension(),1)),e.intersect(_),_.assign(e))}let d=i;if((null!==s||Number.isNaN(d))&&(d=(0,r.a)(s,_,!1).total()),l===n.G.enumGeometryCollection){let e=t.createInstance();for(let s=0,i=t.getGeometryCount();s<i;s++){let i=t.getGeometry(s);if(i.isEmpty())continue;let n=o(i,_,d,m,a);n.isEmpty()||(n===i?e.addGeometry(n.clone()):e.addGeometry(n))}return e}(0,n.i)(l)||(0,n.t)("Clip: geometry not supported");let c=t.getImpl().getAccelerators();if(null!==c){let t=c.getRasterizedGeometry();(0,n.g)(null===t)}switch(l){case n.G.enumMultiPoint:{let e,s=t.getPointCount(),i=t.getImpl().getAttributeStreamRef(0),r=0;for(let n=0;n<s;n++){let s=i.readPoint2D(2*n);_.contains(s)||(0===r&&(e=t.createInstance()),r<n&&e.addPoints(t,r,n),r=n+1)}return r>0&&e.addPoints(t,r,s),0===r?t:((0,n.g)(null!==e),e)}case n.G.enumPolygon:case n.G.enumPolyline:var x,p,g,y;return x=t,p=_,g=d,y=m,new u(p,a).clipMultiPath2(x,g,y);default:(0,n.c)("")}}function _(t,e,s,i,n,r){let m=new u(e,r),a=new h.J;return t.queryLooseEnvelope(a),e.containsEnvelope(a)?t:e.isIntersecting(a)?m.clipPolesOut(t,n):t.createInstance()}class u{constructor(t,e){this.m_shape=new m.E,this.m_geometry=m.n,this.m_verticesOnExtentIndex=-1,this.m_verticesOnExtent=[],this.m_progressCounter=0,this.m_extent=new h.J(t),this.m_progressTracker=e}progress_(){}clipMultiPath2(t,e,s){return t.getGeometryType()===n.G.enumPolygon?this.clipPolygonOrProjectedPolyline2(t,s):this.clipPolyline(t,e)}clipPolygonOrProjectedPolyline2(t,e){let s=t.getGeometryType()===n.G.enumPolyline;if(0===this.m_extent.width()||0===this.m_extent.height())return t.createInstance();let i=h.J.constructEmpty();t.queryLooseEnvelope(i),this.m_geometry=s?this.m_shape.addGeometry(t):this.m_shape.addGeometry(t,this.m_extent);let r=h.J.constructEmpty(),o=h.J.constructEmpty(),l=new a.P,_=new a.P,d=(0,a.d)(9,Number.NaN),c=(0,a.d)(9,Number.NaN),x=(0,a.m)(a.P,9),p=null,g=new m.L,y=[],f=!1;for(let t=0;!f&&t<4;t++){let e=!1,h=!!(1&t),a=0;switch(t){case 0:a=this.m_extent.xmin,e=i.xmin<=a&&i.xmax>=a;break;case 1:a=this.m_extent.ymin,e=i.ymin<=a&&i.ymax>=a;break;case 2:a=this.m_extent.xmax,e=i.xmin<=a&&i.xmax>=a;break;case 3:a=this.m_extent.ymax,e=i.ymin<=a&&i.ymax>=a}if(e){f=!0;for(let e=this.m_shape.getFirstPath(this.m_geometry);e!==m.n;){let i=!0,p=-1,v=-1,b=this.m_shape.getFirstVertex(e),E=b;do{this.progress_();let e=this.m_shape.getSegment(E);if(null===e){let t=this.m_shape.getNextVertex(E);if(t===m.n){(0,n.g)(s),0===p&&y.push(E);break}this.m_shape.queryXY(E,l),g.setStartXY(l),this.m_shape.queryXY(t,_),g.setEndXY(_),e=g}e.queryLooseEnvelope(r);let b=u.checkSegmentIntersection(r,t,a);e.isCurve()&&0===b&&e.isCurve()&&(g.setStartXY(e.getStartXY()),g.setEndXY(e.getEndXY()),this.m_shape.replaceCurveWithLine(E),e=g,g.queryEnvelope(r),b=u.checkSegmentIntersection(r,t,a));let N=0,C=m.n;if(-1===b){let s=e.intersectionWithAxis2D(h,a,d,c);if(s>0){let t=null;if(e.isCurve()){t=x,(0,n.g)(s<=9);for(let t=0;t<s;t++)h?x[t].setCoords(d[t],a):x[t].setCoords(a,d[t]);N=this.m_shape.splitSegmentAxisAware(E,c,s,t,+!!h)}else N=this.m_shape.splitSegmentAxisAware(E,c,s,null,-1)}else N=0;N+=1;let r=E,m=this.m_shape.getNextVertex(r);e=null;for(let e=0;e<N;e++){this.m_shape.queryXY(r,l),this.m_shape.queryXY(m,_);let e=this.m_shape.getSegment(r);null===e&&(g.setStartXY(l),g.setEndXY(_),e=g),e.queryEnvelope(o);let s=u.checkSegmentIntersection(o,t,a);e.isCurve()&&0===s&&(this.m_shape.replaceCurveWithLine(r),g.setStartXY(l),g.setEndXY(_),(e=g).queryEnvelope(o),s=u.checkSegmentIntersection(o,t,a)),-1===s&&(h?Math.abs(l.y-a)<Math.abs(_.y-a)?(l.y=a,this.m_shape.setXY(r,l)):(_.y=a,this.m_shape.setXY(m,_)):Math.abs(l.x-a)<Math.abs(_.x-a)?(l.x=a,this.m_shape.setXY(r,l)):(_.x=a,this.m_shape.setXY(m,_)),null===(e=this.m_shape.getSegment(r))&&(g.setStartXY(l),g.setEndXY(_),e=g),e.queryEnvelope(o),-1===(s=u.checkSegmentIntersection(o,t,a))&&(s=u.checkSegmentIntersectionLoose(o,t,a)));let n=p;p=s,-1===v&&(v=p),0===n&&1===p||1===n&&0===p||0===n&&0===p&&y.push(r),1===p&&(f=!1,i=!1),C=r=m,m=this.m_shape.getNextVertex(m)}}if(0===N){let t=p;p=b,-1===v&&(v=p),0===t&&p>=1||t>=1&&0===p||0===t&&0===p&&y.push(E),1===p&&(f=!1,i=!1),C=this.m_shape.getNextVertex(E)}if(E=C,y.length>=256){for(let t=1,e=y.length-1;t<e;t++){let e=y[t];s?this.m_shape.snapVertexForPoleClipping(e,a):this.m_shape.removeVertex(e,!1)}y[1]=y.at(-1),y.length=2}}while(E!==b);if(!i){0===v&&(s||0===p||2===p)&&y.push(b);for(let t=0,e=y.length;t<e;t++){let e=y[t];s?this.m_shape.snapVertexForPoleClipping(e,a):this.m_shape.removeVertex(e,!1)}}y.length=0,e=i||0===this.m_shape.getPathSize(e)?this.m_shape.removePath(e):this.m_shape.getNextPath(e)}}}if(f)return t.createInstance();s?this.removeSpikesAlongPoles():this.resolveBoundaryOverlaps(),e>0&&this.densifyAlongClipExtent(e);let v=this.m_shape.getGeometry(this.m_geometry);return v.getGeometryType()===n.G.enumPolygon&&v.setFillRule(t.getFillRule()),v}clipPolyline(t,e){let s=h.J.constructEmpty(),i=h.J.constructEmpty(),n=(0,a.d)(9,Number.NaN),r=(0,a.d)(9,Number.NaN),o=new m.S,l=t,_=h.J.constructEmpty();t.queryLooseEnvelope(_);for(let e=0;e<4;e++){let h=!1,m=!!(1&e),d=0;switch(e){case 0:d=this.m_extent.xmin,h=_.xmin<=d&&_.xmax>=d;break;case 1:d=this.m_extent.ymin,h=_.ymin<=d&&_.ymax>=d;break;case 2:d=this.m_extent.xmax,h=_.xmin<=d&&_.xmax>=d;break;case 3:d=this.m_extent.ymax,h=_.ymin<=d&&_.ymax>=d}if(!h)continue;let c=l;l=t.createInstance();let x=c.getImpl().querySegmentIterator();x.resetToFirstPath();let p=new a.P,g=new a.P;for(;x.nextPath();){let t=-1,h=!0;for(;x.hasNextSegment();){this.progress_();let t=x.nextSegment(),a=t.isDegenerate(0);t.queryLooseEnvelope(s);let _=u.checkSegmentIntersection(s,e,d);if(-1===_){let s=t.intersectionWithAxis2D(m,d,n,r),_=0;p.assign(t.getStartXY());for(let c=0;c<=s;c++){let x=c<s?r[c]:1;if(_===x)continue;t.queryCut(_,x,o,!1);let y=o.get(),f=!1;if(y.getStartXY().equals(p)||(y.setStartXY(p),f=!0),c<s&&(m?(g.x=n[c],g.y=d):(g.x=d,g.y=n[c]),y.getEndXY().equals(g)||(y.setEndXY(g),f=!0)),f&&y.normalizeAfterEndpointChange(),!a&&y.isDegenerate(0))continue;y.queryEnvelope(i);let v=u.checkSegmentIntersection(i,e,d);if(-1===v){let t=y.getStartXY(),s=y.getEndXY();(f=!1,m)?Math.abs(t.y-d)<Math.abs(s.y-d)?(t.y=d,y.setStartXY(t),t.equals(y.getStartXY())||(y.setStartXY(t),f=!0)):(s.y=d,s.equals(y.getEndXY())||(y.setEndXY(s),f=!0)):Math.abs(t.x-d)<Math.abs(s.x-d)?(t.x=d,t.equals(y.getStartXY())||(y.setStartXY(t),f=!0)):(s.x=d,s.equals(y.getEndXY())||(y.setEndXY(s),f=!0)),f&&y.normalizeAfterEndpointChange(),y.queryEnvelope(i),-1===(v=u.checkSegmentIntersection(i,e,d))&&(v=u.checkSegmentIntersectionLoose(i,e,d))}p.assign(y.getEndXY()),_=x,v>=1?(l.addSegment(y,h),h=!1):h=!0}}else _>=1?(l.addSegment(t,h),h=!1):h=!0}}}return l}static checkSegmentIntersection(t,e,s){switch(e){case 0:return t.xmin<s&&t.xmax<=s?0:t.xmin>=s?t.xmax===s?2:1:-1;case 1:return t.ymin<s&&t.ymax<=s?0:t.ymin>=s?t.ymax===s?2:1:-1;case 2:return t.xmin>=s&&t.xmax>s?0:t.xmax<=s?t.xmin===s?2:1:-1;case 3:return t.ymin>=s&&t.ymax>s?0:t.ymax<=s?t.ymin===s?2:1:-1}return(0,n.c)(""),0}static checkSegmentIntersectionLoose(t,e,s){switch(e){case 0:{let e=Math.abs(t.xmin-s),i=Math.abs(t.xmax-s);return t.xmin<s?e>i?0:1:((0,n.c)(""),1)}case 1:{let e=Math.abs(t.ymin-s),i=Math.abs(t.ymax-s);return t.ymin<s?e>i?0:1:((0,n.c)(""),1)}case 2:{let e=Math.abs(t.xmin-s),i=Math.abs(t.xmax-s);return t.xmax>s?e<i?0:1:((0,n.c)(""),1)}case 3:{let e=Math.abs(t.ymin-s),i=Math.abs(t.ymax-s);return t.ymax>s?e<i?0:1:((0,n.c)(""),1)}}return(0,n.c)(""),0}resolveBoundaryOverlaps(){this.m_verticesOnExtentIndex=-1,this.splitSegments(!1,this.m_extent.xmin),this.splitSegments(!1,this.m_extent.xmax),this.splitSegments(!0,this.m_extent.ymin),this.splitSegments(!0,this.m_extent.ymax),this.m_verticesOnExtent.length=0,this.m_verticesOnExtentIndex=this.m_shape.createUserIndex();let t=new a.P;for(let e=this.m_shape.getFirstPath(this.m_geometry);e!==m.n;e=this.m_shape.getNextPath(e)){let s=this.m_shape.getFirstVertex(e);for(let i=0,n=this.m_shape.getPathSize(e);i<n;i++,s=this.m_shape.getNextVertex(s))this.progress_(),this.m_shape.queryXY(s,t),this.m_extent.xmin!==t.x&&this.m_extent.xmax!==t.x&&this.m_extent.ymin!==t.y&&this.m_extent.ymax!==t.y||(this.m_shape.setUserIndex(s,this.m_verticesOnExtentIndex,this.m_verticesOnExtent.length),this.m_verticesOnExtent.push(s))}this.dbgCheckPathFirst(),this.resolveOverlaps(!1,this.m_extent.xmin),this.dbgCheckPathFirst(),this.resolveOverlaps(!1,this.m_extent.xmax),this.dbgCheckPathFirst(),this.resolveOverlaps(!0,this.m_extent.ymin),this.dbgCheckPathFirst(),this.resolveOverlaps(!0,this.m_extent.ymax),this.fixPaths()}densifyAlongClipExtent(t){let e=new a.P(0,0),s=new a.P(0,0),i=(0,a.d)(2048,Number.NaN);for(let r=this.m_shape.getFirstPath(this.m_geometry);r!==m.n;r=this.m_shape.getNextPath(r)){let h=this.m_shape.getFirstVertex(r),m=h;do{let r=this.m_shape.getNextVertex(m);this.m_shape.queryXY(m,e);let h=-1;if(e.x===this.m_extent.xmin?(this.m_shape.queryXY(r,s),s.x===this.m_extent.xmin&&(h=1)):e.x===this.m_extent.xmax&&(this.m_shape.queryXY(r,s),s.x===this.m_extent.xmax&&(h=1)),e.y===this.m_extent.ymin?(this.m_shape.queryXY(r,s),s.y===this.m_extent.ymin&&(h=0)):e.y===this.m_extent.ymax&&(this.m_shape.queryXY(r,s),s.y===this.m_extent.ymax&&(h=0)),-1===h||this.isCurve(m)){m=r;continue}let o=e.clone(),l=new a.P(0,0);if(h){let i=e.y-this.m_extent.ymin;l.y=(0,a.e)(s.y-e.y),o.y=t*(0,a.f)(Math.floor(Math.abs(i)/t),i)+this.m_extent.ymin,l.y<0&&(o.y+=t)}else{let i=e.x-this.m_extent.xmin;l.x=(0,a.e)(s.x-e.x),o.x=t*(0,a.f)(Math.floor(Math.abs(i)/t),i)+this.m_extent.xmin,l.x<0&&(o.x+=t)}let _=h?s.y-e.y:s.x-e.x,u=Math.abs(_);if(u/t>65536&&(0,n.c)(""),u>0){let s=Math.trunc(u/t)+2;i.length<s&&(i.length=s);let r=0;for(let s=0;;s++){let m=o.add(l.mul(s*t)),a=(h?m.y-e.y:m.x-e.x)/_;if(a>=1)break;a<=0||((0,n.g)(r<=i.length),i[r]=a,r++)}0!==r&&this.m_shape.splitSegment(m,i,r)}m=r}while(m!==h)}}splitSegments(t,e){let s=-1,i=new a.P,n=[];for(let r=this.m_shape.getFirstPath(this.m_geometry);r!==m.n;r=this.m_shape.getNextPath(r)){let h=this.m_shape.getFirstVertex(r),a=m.n;for(let m=0,o=this.m_shape.getPathSize(r);m<o;m++,h=a)if(this.progress_(),a=this.m_shape.getNextVertex(h),this.m_shape.queryXY(h,i),(t?i.y===e:i.x===e)&&(this.m_shape.queryXY(a,i),t?i.y===e:i.x===e)){if(this.isCurve(h))continue;-1===s&&(s=this.m_shape.createUserIndex()),1!==this.m_shape.getUserIndex(h,s)&&(n.push(h),this.m_shape.setUserIndex(h,s,1)),1!==this.m_shape.getUserIndex(a,s)&&(n.push(a),this.m_shape.setUserIndex(a,s,1))}}if(-1!==s&&this.m_shape.removeUserIndex(s),n.length<3)return;n.sort((t,e)=>this.compareVertices(t,e));let r=new a.P,h=new a.P,o=new a.P;h.setNAN();let l=-1,_=[],u=[],d=this.m_shape.createUserIndex(),c=this.m_shape.createUserIndex();for(let s=0,m=n.length;s<m;s++){let m=n[s];if(this.m_shape.queryXY(m,i),!i.isEqualPoint2D(h)){if(-1===l){l=s,h.setCoordsPoint2D(i);continue}for(let i=l;i<s;i++){let s=n[i],m=this.m_shape.getNextVertex(s),a=this.m_shape.getPrevVertex(s),o=!1;this.m_shape.queryXY(m,r),0>h.compare(r)&&(t?r.y===e:r.x===e)&&(this.isCurve(s)||(_.push(s),o=!0,this.m_shape.setUserIndex(s,c,1))),this.m_shape.queryXY(a,r),0>h.compare(r)&&(t?r.y===e:r.x===e)&&(this.isCurve(a)||(o||_.push(s),this.m_shape.setUserIndex(s,d,1)))}for(let t=0,e=_.length;t<e;t++){let e=_[t],s=this.m_shape.getUserIndex(e,d),n=this.m_shape.getUserIndex(e,c);if(1===s){let t=this.m_shape.getPrevVertex(e);this.m_shape.queryXY(t,o);let s=0;if(!o.isEqualPoint2D(i)){let n=a.P.distance(h,o);0==(s=a.P.distance(o,i)/n)?s=Number.EPSILON:1===s&&(s=1-Number.EPSILON),this.m_shape.splitSegment(t,[s],1);let r=this.m_shape.getPrevVertex(e);this.m_shape.setXY(r,i),u.push(r),this.m_shape.setUserIndex(r,d,1),this.m_shape.setUserIndex(r,c,-1)}}if(1===n){let t=this.m_shape.getNextVertex(e);this.m_shape.queryXY(t,o);let s=0;if(!o.isEqualPoint2D(i)){let t=a.P.distance(h,o);0==(s=a.P.distance(h,i)/t)?s=Number.EPSILON:1===s&&(s=1-Number.EPSILON),this.m_shape.splitSegment(e,[s],1);let n=this.m_shape.getNextVertex(e);this.m_shape.setXY(n,i),u.push(n),this.m_shape.setUserIndex(n,d,-1),this.m_shape.setUserIndex(n,c,1)}}}let m=_;_=u,(u=m).length=0,l=s,h.setCoordsPoint2D(i)}}this.m_shape.removeUserIndex(d),this.m_shape.removeUserIndex(c)}resolveOverlaps(t,e){let s=new a.P,i=[],r=-1;for(let n=0,h=this.m_verticesOnExtent.length;n<h;n++){this.progress_();let h=this.m_verticesOnExtent[n];if(h===m.n)continue;let a=this.m_shape.getNextVertex(h);if(this.m_shape.queryXY(h,s),(t?s.y===e:s.x===e)&&(this.m_shape.queryXY(a,s),t?s.y===e:s.x===e)){if(this.isCurve(h))continue;-1===r&&(r=this.m_shape.createUserIndex()),-2!==this.m_shape.getUserIndex(h,r)&&(i.push(h),this.m_shape.setUserIndex(h,r,-2)),-2!==this.m_shape.getUserIndex(a,r)&&(i.push(a),this.m_shape.setUserIndex(a,r,-2))}}if(0===i.length)return void(-1!==r&&this.m_shape.removeUserIndex(r));(0,n.g)(-1!==r),i.sort((t,e)=>this.compareVertices(t,e));for(let t=0,e=i.length;t<e;t++){let e=i[t];this.m_shape.setUserIndex(e,r,t)}let h=new a.P,o=new a.P;o.setNAN();let l=-1;for(let n=0,a=i.length;n<a;n++){this.progress_();let a=i[n];if(a!==m.n&&(this.m_shape.queryXY(a,s),!s.isEqualPoint2D(o))){if(-1!==l)for(;;){let s=!1,a=n;for(let _=l;_<a;_++){let a=i[_];if(a===m.n)continue;let l=m.n,u=this.m_shape.getNextVertex(a);this.m_shape.queryXY(u,h),0>o.compare(h)&&(t?h.y===e:h.x===e)&&(this.isCurve(a)||(l=u));let d=m.n,c=this.m_shape.getPrevVertex(a);if(this.m_shape.queryXY(c,h),0>o.compare(h)&&(t?h.y===e:h.x===e)&&(this.isCurve(c)||(d=c)),l===m.n||d===m.n){if(l!==m.n||d!==m.n){for(let u=_+1;u<n;u++){let n=i[u];if(n===m.n)continue;let _=this.m_shape.getNextVertex(n),c=m.n;this.m_shape.queryXY(_,h),0>o.compare(h)&&(t?h.y===e:h.x===e)&&(this.isCurve(n)||(c=_));let x=this.m_shape.getPrevVertex(n),p=m.n;if(this.m_shape.queryXY(x,h),0>o.compare(h)&&(t?h.y===e:h.x===e)&&(this.isCurve(x)||(p=x)),c!==m.n&&p!==m.n){this.beforeRemoveVertex(n,i,r),this.m_shape.removeVertex(n,!1),this.beforeRemoveVertex(c,i,r),this.m_shape.removeVertex(c,!1),s=!0;break}if(l!==m.n&&p!==m.n){this.removeOverlap(i,a,l,n,p,r),s=!0;break}if(d!==m.n&&c!==m.n){this.removeOverlap(i,n,c,a,d,r),s=!0;break}}if(s)break}}else this.beforeRemoveVertex(a,i,r),this.m_shape.removeVertex(a,!1),this.beforeRemoveVertex(l,i,r),this.m_shape.removeVertex(l,!1),s=!0}if(!s)break}l=n,o.setCoordsPoint2D(s)}}this.m_shape.removeUserIndex(r)}beforeRemoveVertex(t,e,s){let i=this.m_shape.getUserIndex(t,s);(0,n.g)(i>=0),e[i]=m.n,i=this.m_shape.getUserIndex(t,this.m_verticesOnExtentIndex),(0,n.g)(i>=0),this.m_verticesOnExtent[i]=m.n;let r=this.m_shape.getPathFromVertex(t);r!==m.n&&this.m_shape.getFirstVertex(r)===t&&(this.m_shape.setFirstVertex(r,m.n),this.m_shape.setLastVertex(r,m.n))}removeOverlap(t,e,s,i,n,r){this.m_shape.setNextVertex(e,i),this.m_shape.setPrevVertex(i,e),this.m_shape.setPrevVertex(s,n),this.m_shape.setNextVertex(n,s),this.beforeRemoveVertex(i,t,r),this.m_shape.removeVertexInternal(i,!1),this.beforeRemoveVertex(n,t,r),this.m_shape.removeVertexInternal(n,!0)}removeSpikesAlongPoles(){this.removeSpikesOnPole(this.m_extent.ymin),this.removeSpikesOnPole(this.m_extent.ymax)}removeSpikesOnPole(t){for(let e=this.m_shape.getFirstPath(this.m_geometry);e!==m.n;e=this.m_shape.getNextPath(e)){let s=this.m_shape.getPathSize(e);if(s<3)continue;let i=this.m_shape.getFirstVertex(e),n=new a.P;this.m_shape.queryXY(i,n);let r=n.y===t&&!this.isCurve(i);i=this.m_shape.getNextVertex(i);let h=new a.P;this.m_shape.queryXY(i,h);let m=h.y===t&&!this.isCurve(i);i=this.m_shape.getNextVertex(i);let o=new a.P;for(let e=0,a=s-2;e<a;e++,i=this.m_shape.getNextVertex(i)){this.progress_(),this.m_shape.queryXY(i,o);let e=o.y===t;if(m&&r&&e&&(h.x-n.x)*(o.x-h.x)<=0){this.m_shape.removeVertex(this.m_shape.getPrevVertex(i),!1),h.setCoordsPoint2D(o),m=e&&!this.isCurve(i);continue}n.setCoordsPoint2D(h),r=m,h.setCoordsPoint2D(o),m=e&&!this.isCurve(i)}}}fixPaths(){for(let t=0,e=this.m_verticesOnExtent.length;t<e;t++){let e=this.m_verticesOnExtent[t];e!==m.n&&this.m_shape.setPathToVertex(e,m.n)}let t=this.m_shape.hasCurves(),e=0,s=0;for(let t=this.m_shape.getFirstPath(this.m_geometry);t!==m.n;){let i=this.m_shape.getFirstVertex(t);if(i===m.n||t!==this.m_shape.getPathFromVertex(i)){let e=t;t=this.m_shape.getNextPath(t),this.m_shape.setFirstVertex(e,m.n),this.m_shape.removePathOnly(e);continue}let n=i,r=0;do this.m_shape.setPathToVertex(n,t),r++,n=this.m_shape.getNextVertex(n);while(n!==i);this.m_shape.setRingAreaValid(t,!1),this.m_shape.setLastVertex(t,this.m_shape.getPrevVertex(i)),this.m_shape.setPathSize(t,r),s+=r,e++,t=this.m_shape.getNextPath(t)}for(let i=0,r=this.m_verticesOnExtent.length;i<r;i++){let r=this.m_verticesOnExtent[i];if(r===m.n)continue;let h=this.m_shape.getPathFromVertex(r);if(h!==m.n)continue;h=this.m_shape.insertPath(this.m_geometry,m.n);let a=!1,o=0,l=r;do this.m_shape.setPathToVertex(r,h),o++,t&&o<=2&&(a||=this.isCurve(r)),r=this.m_shape.getNextVertex(r);while(r!==l);if(a?0===o:o<=2){let t=this.m_shape.getUserIndex(l,this.m_verticesOnExtentIndex);(0,n.g)(t>=0),this.m_verticesOnExtent[t]=m.n;let e=this.m_shape.removeVertex(l,!1);2===o&&((t=this.m_shape.getUserIndex(e,this.m_verticesOnExtentIndex))>=0&&(this.m_verticesOnExtent[t]=m.n),this.m_shape.removeVertex(e,!1));let s=h;h=this.m_shape.getNextPath(h),this.m_shape.setFirstVertex(s,m.n),this.m_shape.removePathOnly(s)}else this.m_shape.setClosedPath(h,!0),this.m_shape.setPathSize(h,o),this.m_shape.setFirstVertex(h,l),this.m_shape.setLastVertex(h,this.m_shape.getPrevVertex(l)),this.m_shape.setRingAreaValid(h,!1),s+=o,e++}this.m_shape.setGeometryPathCount(this.m_geometry,e),this.m_shape.setGeometryVertexCount(this.m_geometry,s);let i=0;for(let t=this.m_shape.getFirstGeometry();t!==m.n;t=this.m_shape.getNextGeometry(t))i+=this.m_shape.getPointCount(t);this.m_shape.setTotalPointCount(i)}dbgCheckPathFirst(){}isCurve(t){return null!==this.m_shape.getSegment(t)}compareVertices(t,e){let s=new a.P;this.m_shape.queryXY(t,s);let i=new a.P;return this.m_shape.queryXY(e,i),s.compare(i)}clipPolesOut(t,e){return this.clipPolygonOrProjectedPolyline2(t,e)}}class d{getOperatorType(){return 10004}supportsCurves(){return!0}accelerateGeometry(t,e,s){return!1}canAccelerateGeometry(t){return!1}executeMany(t,e,s,i){return new c(t,e,s,i)}execute(t,e,s,i){return l(t,e,s,Number.NaN,0,i)}}class c extends i.G{constructor(t,e,s,i){super(),this.m_progressTracker=i,this.m_index=-1,t||(0,n.t)(""),this.m_envelope=e,this.m_inputGeometryCursor=t,this.m_spatialRefImpl=s,this.m_tolerance=(0,r.a)(s,e,!1).total()}next(){let t;return(t=this.m_inputGeometryCursor.next())?((0,n.d)(t),this.m_index=this.m_inputGeometryCursor.getGeometryID(),o(t,this.m_envelope,this.m_tolerance,0,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}},31632:(t,e,s)=>{s.d(e,{$:()=>tb,A:()=>z,B:()=>F,C:()=>Q,D:()=>R,E:()=>tq,F:()=>w,G:()=>tN,H:()=>tE,I:()=>tt,J:()=>te,K:()=>I,L:()=>j,M:()=>tu,N:()=>tn,O:()=>_,P:()=>tD,Q:()=>Z,R:()=>tg,S:()=>k,T:()=>X,U:()=>function t(e,s,i,n){if(!e.hasAttribute(i))return!1;let h=e.getGeometryType();if(h===r.G.enumGeometryCollection){let r=e.getGeometryCount(),h=0;for(let m=0;m<r;++m)h|=!!t(e.getGeometry(m),s,i,n);return!!h}if((0,r.i)(h)){let t=d.getPersistence(i),h=d.getComponentCount(i),m=e.getPointCount();if(1===t||2===t){let t=function(t,e,s,i,n){let r=!1,h=n.vmin,m=n.vmax;for(let n=s;n<e;n+=i){let e=t.read(n);e<h?(r=!0,t.write(n,h)):e>m&&(r=!0,t.write(n,m))}return r}(e.getAttributeStreamRef(i),m*h,n,h,s);return t&&e.notifyModified(),t}(0,r.c)("snap_coordinate not implemented")}if(h===r.G.enumEnvelope){let t=e.queryInterval(i,n),r=!1;return t.vmin<s.vmin&&(r=!0,t.vmin=s.vmin),t.vmax>s.vmax&&(r=!0,t.vmax=s.vmax),r&&e.setIntervalEnvelope(i,n,t),r}if(h===r.G.enumPoint){let t=e.getAttributeAsDbl(i,n),r=!1;return t<s.vmin&&(r=!0,t=s.vmin),t>s.vmax&&(r=!0,t=s.vmax),r&&e.setAttributeBasic(i,n,t),r}if((0,r.f)(h)){let t=e.getStartAttributeAsDbl(i,n),r=!1;return t<s.vmin&&(r=!0,t=s.vmin),t>s.vmax&&(r=!0,t=s.vmax),r&&e.setStartAttribute(i,n,t),(t=e.getEndAttributeAsDbl(i,n))<s.vmin&&(r=!0,t=s.vmin),t>s.vmax&&(r=!0,t=s.vmax),r&&e.setEndAttribute(i,n,t),r}(0,r.c)("snap_coordinate not implemented")},V:()=>d,W:()=>ta,X:()=>D,Y:()=>tC,Z:()=>ty,_:()=>tv,a:()=>ti,a0:()=>tf,a1:()=>t_,a2:()=>O,a3:()=>tr,a4:()=>A,a5:()=>tx,a6:()=>Y,b:()=>th,c:()=>tm,d:()=>tl,e:()=>K,f:()=>td,g:()=>$,h:()=>N,i:()=>tp,j:()=>v,k:()=>tP,l:()=>g,m:()=>y,n:()=>C,o:()=>u,p:()=>c,q:()=>E,r:()=>f,s:()=>tc,t:()=>P,u:()=>q,v:()=>W,w:()=>b,x:()=>ts,y:()=>B,z:()=>T});var i=s(92656),n=s(73750),r=s(16404);let h=[0,0,Number.NaN,0,0,0,0,0,-1,-1,0,0,0,0],m=[2,1,1,1,3,1,2,3,2,4,1,1,2,1],a=[1,1,1,0,2,1,1,1,0,0,0,0,0,1],o=[1,1,1,2,0,0,0,0,2,2,4,2,2,1],l=[4,8,4,8,1],_=25;function u(){return(0,i.d)(_,Number.NaN)}let d=class t{getAttributeCount(){return this.m_attributeCount}getSemantics(t){return this.m_indexToSemantics[t]}getSemanticsBitArray(){return this.m_semanticsBitArray}getAttributeIndex(t){return this.m_semanticsToIndexMap[t]}static getInterpolation(t){return a[t]}static getPersistence(t){return o[t]}static getPersistenceSize(t){return l[t]}static getPersistenceSizeFromSemantics(e){return t.getPersistenceSize(t.getPersistence(e))*t.getComponentCount(e)}static getComponentCount(t){return m[t]}static maxComponentCount(){return 4}static isInteger(t){return 2===t||3===t||4===t}static isIntegerSemantics(e){return t.isInteger(t.getPersistence(e))}static isTexture(t){return 5===t||6===t||7===t}hasAttribute(t){return!!(this.m_semanticsBitArray&1<<t)}hasAttributesFrom(t){return(this.m_semanticsBitArray&t.m_semanticsBitArray)===t.m_semanticsBitArray}hasZ(){return this.hasAttribute(1)}hasM(){return this.hasAttribute(2)}hasID(){return this.hasAttribute(3)}getTotalComponentCount(){return this.m_totalComponentCount}static getDefaultValue(t){return h[t]}static isDefaultValue(t,e){return(0,i.a3)(h[t],e)}equals(t){return this===t}getDefaultPointAttributes(){return this.m_defaultPointAttributes}getPointAttributeOffset(t){return this.m_pointAttributeOffsets[t]}constructor(e){this.m_semanticsBitArray=e,this.m_attributeCount=0,this.m_totalComponentCount=0,this.m_semanticsToIndexMap=new Int32Array(14),this.m_indexToSemantics=new Int32Array(14),this.m_pointAttributeOffsets=new Int32Array(14),this.m_defaultPointAttributes=(0,i.d)(_,Number.NaN),this.m_semanticsToIndexMap.fill(-1),this.m_indexToSemantics.fill(-1);let s=0,n=1,r=14;for(;s<r;s++)e&n&&(this.m_semanticsToIndexMap[s]=this.m_attributeCount,this.m_indexToSemantics[this.m_attributeCount]=s,this.m_attributeCount++,this.m_totalComponentCount+=t.getComponentCount(s)),n<<=1;let h=0;for(s=0,r=this.getAttributeCount();s<r;s++){let e=this.getSemantics(s),i=t.getComponentCount(e),n=t.getDefaultValue(e);this.m_pointAttributeOffsets[s]=h;for(let t=0;t<i;t++)this.m_defaultPointAttributes[h]=n,h++}}};function c(){return(0,i.d)(14,0)}class x{static getInstance(){return x.s_thisInstance}constructor(){this.m_map=new Map,this.m_vd2D=new d(1),this.m_map.set(1,this.m_vd2D),this.m_vd3D=new d(3),this.m_map.set(3,this.m_vd2D)}GetVD2D(){return this.m_vd2D}GetVD3D(){return this.m_vd3D}FindOrAdd(t){if(1===t)return this.GetVD2D();if(3===t)return this.GetVD3D();let e=this.m_map.get(t);if(e)return e;let s=new d(t);return this.m_map.set(t,s),s}}function p(t){return x.getInstance().FindOrAdd(t)}function g(t,e){if(!t||!e)return e||t;let s=t.getSemanticsBitArray()|e.getSemanticsBitArray();return(s&t.getSemanticsBitArray())===s?t:(s&e.getSemanticsBitArray())===s?e:p(s)}function y(t,e){let s=t.getSemanticsBitArray()|1<<e;return(s&t.getSemanticsBitArray())===s?t:p(s)}function f(t,e){let s=(t.getSemanticsBitArray()|1<<e)-(1<<e);return s===t.getSemanticsBitArray()?t:p(s)}function v(){return x.getInstance().GetVD2D()}function b(){return x.getInstance().GetVD3D()}function E(t,e,s){if(s.fill(-1),null!==t&&null!==e)for(let i=0,n=t.getAttributeCount();i<n;i++)s[i]=e.getAttributeIndex(t.getSemantics(i))}x.s_thisInstance=new x;class N{static construct(t,e,s){return new N(t,e,s)}constructor(t,e,s){void 0!==t?(this.x=t,this.y=e,this.z=s):this.x=this.y=this.z=Number.NaN}get 0(){return this.x}get 1(){return this.y}get 2(){return this.z}set 0(t){this.x=t}set 1(t){this.y=t}set 2(t){this.z=t}clone(){return new N(this.x,this.y,this.z)}assign(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}setCoords(t,e,s){return this.x=t,this.y=e,this.z=s,this}setCoordsPoint2DZ(t,e){return this.setCoords(t.x,t.y,e)}setCoordsPoint3D(t){this.x=t.x,this.y=t.y,this.z=t.z}setZero(){this.x=0,this.y=0,this.z=0}setNormalized(t){this.assign(t),this.normalizeThis()}normalizeThis(){let t=this.length();return t?(this.x/=t,this.y/=t,this.z/=t):(this.x=1,this.y=0,this.z=0),this}getUnitVector(){let t=new N;return t.setNormalized(this),t}sqrLength(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthXY(){return(0,r.g)(0),0}static sqrDistance(t,e){return(0,i.s)(t.x-e.x)+(0,i.s)(t.y-e.y)+(0,i.s)(t.z-e.z)}static sqrDistanceCoords(t,e,s,n,r,h){return(0,i.s)(t-n)+(0,i.s)(e-r)+(0,i.s)(s-h)}static distance(t,e){return Math.sqrt(N.sqrDistance(t,e))}isEqual(t,e){return void 0===e&&(e=0),Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e&&(0,i.I)(this.z,t.z,e)}static compareByLength(t,e,s,i){return(0,r.g)(0),0}isEqualCoords(t,e,s,i){return(0,r.g)(0),this.x===t&&this.y===e&&this.z===s}isEqualsTols(t,e,s){return(0,r.g)(0),!1}isEqualCoordsTols(t,e,s,i,n){return(0,r.g)(0),!1}static st_isEqual(t,e,s,i){return(0,r.g)(0),!1}equals(t,e){return this.isEqual(t,e)}equalsTols(t,e,s){return(0,r.g)(0),!1}divThis(t){return this.x/=t,this.y/=t,this.z/=t,this}subThis(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}setSub(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}sub(t){return N.construct(this.x-t.x,this.y-t.y,this.z-t.z)}addThis(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}add(t){return this.clone().addThis(t)}setAdd(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}mul(t){return N.construct(this.x*t,this.y*t,this.z*t)}dotProduct(t){return this.x*t.x+this.y*t.y+this.z*t.z}crossProductVector(t){let e=this.y*t.z-t.y*this.z;return new N(e,t.x*this.z-this.x*t.z,this.x*t.y-t.x*this.y)}setCrossProductVector(t,e){let s=t.y*e.z-e.y*t.z,i=e.x*t.z-t.x*e.z,n=t.x*e.y-e.x*t.y;return this.x=s,this.y=i,this.z=n,this}setScaled(t,e){return this.x=t*e.x,this.y=t*e.y,this.z=t*e.z,this}scaleThis(t){return this.x*=t,this.y*=t,this.z*=t,this}scaleZThis(t){return this.z*=t,this}setNAN(){return(0,r.g)(0),this}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)||Number.isNaN(this.z)}static getNAN(){return N.construct(Number.NaN,Number.NaN,Number.NaN)}isFinite(){return(0,r.g)(0),!1}isZero(){return 0===this.x&&0===this.y&&0===this.z}norm(t){return(0,r.g)(0),0}sqrDistanceFromCenterToSpheroidSurface(t,e){return(0,r.g)(0),0}distanceFromCenterToSpheroidSurface(t,e){return Math.sqrt(this.sqrDistanceFromCenterToSpheroidSurface(t,e))}static getClosestCoordinate(t,e,s,i=!1){return(0,r.g)(0),0}compare(t){return this.y<t.y?-1:this.y>t.y?1:this.x<t.x?-1:this.x>t.x?1:this.z<t.z?-1:+(this.z>t.z)}compareXYZ(t){return(0,r.g)(0),0}negateThis(){this.x=-this.x,this.y=-this.y,this.z=-this.z}static averageFast(t,e){return(0,r.g)(0),{}}static average(t,e){return(0,r.g)(0),{}}static size(){return N.dimensions}static lerp(t,e,s){let n=new N;return(0,i.x)(t,e,s,n),n}static slerp(t,e,s){return(0,r.g)(0),{}}static compareVectors(t,e){return(0,r.g)(0),0}static selectRightHandedBasisFromNormal(t,e,s){let i=t.getUnitVector(),n=i.createAPerpendicular(),r=new N;r.setCrossProductVector(i,n),r.normalizeThis(),e.setCoordsPoint3D(n),s.setCoordsPoint3D(r)}createAPerpendicular(){let t=[this.crossProductVector(new N(0,0,1)),this.crossProductVector(new N(1,0,0)),this.crossProductVector(new N(0,1,0))],e=[t[0].sqrLength(),t[1].sqrLength(),t[2].sqrLength()],s=t[e.reduce((t,s,i)=>e[t]>e[i]?t:i,0)];return s.normalizeThis(),s}calculateAngle(t){return(0,r.g)(0),0}static crossDotSign(t,e,s){return(0,r.g)(0),0}static isBisectorRobust(t,e,s){return(0,r.g)(0),0}static compareZOrder(t,e){return(0,r.g)(0),!1}}N.dimensions=3;class C{static constructEmpty(){return new C(Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN)}constructor(t,e,s,i,n,r){this.m_EnvelopeType=3,this.xmin=t,this.ymin=e,this.zmin=s,this.xmax=i,this.ymax=n,this.zmax=r,this.normalize()}inflate(t){this.inflateCoords(t,t,t)}inflateCoords(t,e,s){(0,r.g)(0)}getEnvelope2D(){return new n.J(this.xmin,this.ymin,this.xmax,this.ymax)}getEnvelopeZs(){return new i.E(this.zmin,this.zmax)}setEmptyZ(){this.zmin=Number.NaN,this.zmax=Number.NaN}normalize(){let t=!1;this.xmin<=this.xmax||(this.xmax=(0,i.b)(this.xmin,this.xmin=this.xmax),t=!0),this.ymin<=this.ymax||(this.ymax=(0,i.b)(this.ymin,this.ymin=this.ymax),t=!0),!t||this.xmin<=this.xmax&&this.ymin<=this.ymax?this.zmin<=this.zmax||(this.zmax=(0,i.b)(this.zmin,this.zmin=this.zmax),this.zmin<=this.zmax||this.setEmptyZ()):this.setEmpty()}isEmpty(){return Number.isNaN(this.xmin)||Number.isNaN(this.ymin)||Number.isNaN(this.xmax)||Number.isNaN(this.ymax)}isEmptyZ(){return Number.isNaN(this.zmin)||Number.isNaN(this.zmax)}setEmpty(){this.xmin=Number.NaN,this.ymin=Number.NaN,this.zmin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN,this.zmax=Number.NaN}mergeEnv3D(t){t.isEmpty()||(this.mergeCoords(t.xmin,t.ymin,t.zmin),this.mergeCoords(t.xmax,t.ymax,t.zmax))}mergeNe(t){this.mergeNeCoords(t.x,t.y,t.z)}mergeNeCoords(t,e,s){this.xmin>t?this.xmin=t:this.xmax<t&&(this.xmax=t),this.ymin>e?this.ymin=e:this.ymax<e&&(this.ymax=e),this.zmin>s?this.zmin=s:this.zmax<s&&(this.zmax=s)}mergeCoords(t,e,s){this.isEmpty()?(this.xmin=t,this.xmax=t,this.ymin=e,this.ymax=e,this.zmin=s,this.zmax=s):(this.isEmptyZ()&&(this.zmin=s,this.zmax=s),this.mergeNeCoords(t,e,s))}setCoords(t,e,s,i,n,r){this.xmin=t,this.ymin=e,this.zmin=s,this.xmax=i,this.ymax=n,this.zmax=r,this.normalize()}sqrDistanceEnvelope3DAndPoints(t,e,s,i=1){return(0,r.g)(0),0}sqrMaxDistance(t,e=1){return(0,r.g)(0),0}}let D=-0x21524111;function I(t,e,s){switch(t){case 0:return new L(e,s);case 1:return new B(e,s);case 2:return new z(e,s);case 3:throw Error("64 bit int attribute stream not implemented");case 4:return new A(e,s);default:(0,r.t)("")}}function P(t,e){let s=d.getComponentCount(t);return I(d.getPersistence(t),e*s,d.getDefaultValue(t))}function q(t,e){let s=d.getComponentCount(t);return I(d.getPersistence(t),e*s)}function T(t,e){return new z(t,e)}function R(t,e){return new A(t,e)}function w(t,e){return new B(t,e)}class S{size(){return this.m_size}checkResize(t,e){t>this.m_size&&this.resize(t,e)}resize(t,e){if((t=Math.trunc(t))===this.m_size)return;let s=!!e||Number.isNaN(e);if(t<this.m_a.length)this.m_a.length>S.s_resizeMin&&1.25*t<this.m_a.length&&(this.m_a=this.m_a.slice(0,t)),s&&t>this.m_size&&this.m_a.fill(e,this.m_size,t);else if(t>=this.m_a.length){let i=1.25*t,n=new this.m_a.constructor(i);n.set(this.m_a),this.m_a=n,s&&this.m_a.fill(e,this.m_size,t)}this.m_size=t}resizeRounded(t,e){return this.resize(t,e)}reserve(t){}read(t){return this.m_a[t]}readAsDbl(t){return this.read(t)}write(t,e){this.m_a[t]=e}writeAsDbl(t,e){this.write(t,e)}setRange(t,e,s){(e<0||s<0||s+e>this.size())&&(0,r.t)(),this.m_a.fill(t,e,e+s)}add(t){this.resize(this.m_size+1),this.m_a[this.m_size-1]=t}addArray(t,e){let s=this.m_size;void 0===e?(this.resize(this.m_size+t.length),this.m_a.set(t,s)):(this.resize(this.m_size+e),this.m_a.set(t.slice(0,e),s))}equals(t,e,s,n){return this.getPersistence()===t.getPersistence()&&function(t,e,s,n,r){if(t.getPersistence()!==e.getPersistence())return!1;let h=1>=t.getPersistence(),m=t.size(),a=e.size();if(n>m||n>a)return!1;if(r)if(h){for(let h=s;h<n;h++)if(!(0,i.I)(t.read(h),e.read(h),r))return!1}else for(let i=s;i<n;i++){let s=t.read(i)-e.read(i);if(s<0&&(s=-s),s>r)return!1}else for(let i=s;i<n;i++){let s=t.read(i),n=e.read(i);if(s!==n){if(h&&Number.isNaN(s)&&Number.isNaN(n))continue;return!1}}return!0}(this,t,e,s,n)}insertRange(t,e,s,i){let n=this.m_size;this.checkResize(Math.max(0,i)+s),this.m_a.copyWithin(t+s,t,i>=0?i:n),this.m_a.fill(e,t,t+s)}readRange(t,e){return this.m_a.slice(t,t+e)}insertRangeFromStream(t,e,s,i,n,h,m){(0,r.g)(this.getPersistence()===e.getPersistence());let a=this.m_size;i&&this.checkResize(Math.max(0,m)+i),this.m_a.copyWithin(t+i,t,m>=0?m:a),this.m_a.set(e.readRange(s,i),t),n||this.reverseRange(t,i,h)}writeRange(t,e,s,i,n,h){if((0,r.g)(this.getPersistence()===s.getPersistence()),(t<0||e<0||i<0)&&(0,r.t)(),s.size()<i+e&&(0,r.t)(),0===e)return;this.size()<e+t&&this.resize(e+t);let m=s.m_a.subarray(i,i+e);!function(t,e,s,i,n,h){if((e<0||s<0)&&(0,r.t)(),0===s)return;if(1===s)return t[e]=i[0];let m=i;s<i.length&&(m=i.subarray(0,s)),t.set(m,e)}(this.m_a,t,e,m)}insertAttributes(t,e,s,i){let n=d.getComponentCount(s);this.m_a.copyWithin(t+n,t,i>=0?i:this.m_size);for(let i=0;i<n;i++)this.m_a[t+i]=e.getAttributeAsDbl(s,i)}insertAttributesFromPoints(t,e,s,n,h){(0,r.g)(d.getPersistence(n)===this.getPersistence());let m=d.getComponentCount(n),a=this.m_size;if(this.checkResize(Math.max(0,h)+m*s),this.m_a.copyWithin(t+m*s,t,h>=0?h:a),0===n){let n=new i.P;for(let i=t,r=0;r<s;r++,i+=2)e[r].queryXY(n),this.m_a[i]=n.x,this.m_a[i+1]=n.y}else if(1===m)for(let i=t,r=0;r<s;r++,i++)this.m_a[i]=e[r].getAttributeAsDbl(n,0);else for(let i=t,r=0;r<s;r++,i+=m)for(let t=0;t<m;t++)this.m_a[i+t]=e[r].getAttributeAsDbl(n,t)}eraseRange(t,e,s){this.m_size<t+e&&(0,r.t)(),this.m_a.copyWithin(t,t+e),this.m_size-=e}reverseRange(t,e,s){if((s<1||e%s!=0)&&(0,r.t)(),this.m_a.subarray(t,t+e).reverse(),s>1)for(let i=t,n=t+e;i<n;i+=s){let t=i,e=i+s-1;for(;t<e;){let s=this.m_a[t];this.m_a[t]=this.m_a[e],this.m_a[e]=s,t++,e--}}}rotate(t,e,s){(e<t||e>s||t>s)&&(0,r.n)("rotate"),e!==t&&e!==s&&(this.reverseRange(t,e-t,1),this.reverseRange(e,s-e,1),this.reverseRange(t,s-t,1))}sort(t,e,s){this.m_a.subarray(t,e).sort(s)}constructor(t){if(t.move)this.m_a=t.move.m_a,this.m_size=t.move.m_size,t.move.m_a=t.move.m_a.slice(0,0),t.move.m_size=0;else if(t.copy)this.m_size=t.copy.m_size,t.maxSize&&(this.m_size=Math.min(t.maxSize,this.m_size)),this.m_a=t.copy.m_a.slice(0,this.m_size);else{let e=Math.max(t.size,S.s_constructMin);this.m_a=new t.ctor(e),(t.defaultValue||Number.isNaN(t.defaultValue))&&this.m_a.fill(t.defaultValue),this.m_size=t.size}}}S.s_constructMin=2,S.s_resizeMin=30;class A extends S{setBits(t,e){this.m_a[t]|=e}clearBits(t,e){this.m_a[t]&=~e}getPersistence(){return 4}clone(){return new A({ctor:Int8Array,copy:this})}restrictedClone(t){return new A({ctor:Int8Array,copy:this,maxSize:t})}constructor(t,e){super("number"==typeof t?{ctor:Int8Array,size:t,defaultValue:e}:t)}}class z extends S{getPersistence(){return 2}clone(){return new z({ctor:Int32Array,copy:this})}restrictedClone(t){return new z({ctor:Int32Array,copy:this,maxSize:t})}write(t,e){(0,r.g)(e<=(0,i.i)()),super.write(t,e)}constructor(t,e){super("number"==typeof t?{ctor:Int32Array,size:t,defaultValue:e}:t)}}class L extends S{getPersistence(){return 0}clone(){return new L({ctor:Float32Array,copy:this})}restrictedClone(t){return new L({ctor:Float32Array,copy:this,maxSize:t})}constructor(t,e){super("number"==typeof t?{ctor:Float32Array,size:t,defaultValue:e}:t)}}class B extends S{getPersistence(){return 1}getArray(){return this.m_a}applyTransformation(t,e,s){(1&e||e+2*s>this.size())&&(0,r.t)();let i=0===e?this.m_a:this.m_a.subarray(e);t.transformInterleavedPoints(i,s,i)}readPoint2D(t){let e=this.m_a[t],s=this.m_a[t+1];return new i.P(e,s)}queryPoint2D(t,e){return e.x=this.m_a[t],e.y=this.m_a[t+1],e}writePoint2D(t,e){this.write(t,e.x),this.write(t+1,e.y)}insert(t,e,s){this.checkResize(s+2),this.m_a.copyWithin(t+2,t,s),this.m_a[t]=e.x,this.m_a[t+1]=e.y}insertRangeFromPoints(t,e,s,i,n,r){let h=this.m_size;if(this.checkResize(Math.max(r,0)+2*i),this.m_a.copyWithin(t+2*i,t,r>=0?r:h),n)for(let n=s,r=t,h=0;h<i;++h,++n){let t=e[n];this.m_a[r++]=t.x,this.m_a[r++]=t.y}else for(let n=s+i-1,r=t,h=0;h<i;++h,--n){let t=e[n];this.m_a[r++]=t.x,this.m_a[r++]=t.y}}queryRange(t,e,s,i,n){if((t<0||e<0)&&(0,r.t)(),!i&&(n<=0||e%n!=0)&&(0,r.t)(),0===e)return;if(1===e)return void(s[0]=this.m_a[t]);let h=this.m_a.subarray(t,t+e);s.set(h)}writeRangeFromArray(t,e,s,i,n){if((t<0||e<0)&&(0,r.t)(),0===e)return;if(1===e)return void(this.m_a[t]=s[0]);let h=s;e<s.length&&(h=s.subarray(0,e)),this.m_a.set(h,t)}clone(){return new B({ctor:Float64Array,copy:this})}restrictedClone(t){return new B({ctor:Float64Array,copy:this,maxSize:t})}constructor(t,e){super("number"==typeof t?{ctor:Float64Array,size:t,defaultValue:e}:t)}}class F{constructor(){this.m_minValue=-1,this.m_maxValue=-1,this.m_dy=Number.NaN,this.m_buckets=new z(0),this.m_bucketedIndices=new z(0)}static sortEx(t,e,s,i,n=32){if(s-e<=n)return void i.userSort(e,s,t);(new F).sort(t,e,s,i,n)}sort(t,e,s,i,n=32){if(s-e<=n)return void i.userSort(e,s,t);let r=!0,h=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;for(let n=e;n<s;n++){let e=i.getValue(t.read(n));e<h&&(h=e),e>m&&(m=e)}if(this.reset(s-e,h,m,s-e)){for(let n=e;n<s;n++){let s=t.read(n),r=i.getValue(s),h=this.getBucket(r);this.m_buckets.write(h,this.m_buckets.read(h)+1),this.m_bucketedIndices.write(n-e,s)}let n=this.m_buckets.read(0);this.m_buckets.write(0,0);for(let t=1,e=this.m_buckets.size();t<e;t++){let e=this.m_buckets.read(t);this.m_buckets.write(t,n),n+=e}for(let n=e;n<s;n++){let s=this.m_bucketedIndices.read(n-e),r=i.getValue(s),h=this.getBucket(r),m=this.m_buckets.read(h);t.write(m+e,s),this.m_buckets.write(h,m+1)}r=!1}if(r)return void i.userSort(e,s,t);let a=0;for(let s=0,n=this.m_buckets.size();s<n;s++){let n=a;(a=this.m_buckets.read(s))>n&&i.userSort(e+n,e+a,t)}this.m_buckets.size()>100&&(this.m_buckets.resize(0),this.m_bucketedIndices.resize(0))}reset(t,e,s,i){if(t<2||s===e)return!1;let n=Math.min(F.c_maxBuckets,t);return this.m_buckets.resize(n),this.m_buckets.setRange(0,0,this.m_buckets.size()),this.m_minValue=e,this.m_maxValue=s,this.m_bucketedIndices.resize(i),this.m_dy=(s-e)/(n-1),!0}getBucket(t){return Math.trunc((t-this.m_minValue)/this.m_dy)}getBucketCount(){return this.m_buckets.size()}}F.c_maxBuckets=65536;class k{constructor(t){this.m_buffer=null,this.m_firstFree=-1,this.m_last=0,this.m_size=0,this.m_capacity=0,this.m_bufferSize=0,this.m_stride=0,this.m_stride=t,this.m_realStride=t,this.m_blockSize=Math.trunc(k.st_realBlockSize/this.m_realStride)}dbgdelete_(t){return this.m_buffer[t>>k.st_blockPower][1+(t&k.st_blockMask)]=k.st_deadVertex,!0}deleteElement(t){(t>>k.st_blockPower)*this.m_blockSize*this.m_realStride+(t&k.st_blockMask)<this.m_last*this.m_realStride?(this.m_buffer[t>>k.st_blockPower][t&k.st_blockMask]=this.m_firstFree,this.m_firstFree=t):this.m_last--,this.m_size--}getField(t,e){return this.m_buffer[t>>k.st_blockPower][(t&k.st_blockMask)+e]}setField(t,e,s){this.m_buffer[t>>k.st_blockPower][(t&k.st_blockMask)+e]=s}getStride(){return this.m_stride}newElement(){let t=this.m_firstFree;if(-1===t){if(this.m_last===this.m_capacity){let t=0!==this.m_capacity?Math.trunc(2*(this.m_capacity+1)):1;this.grow(t)}t=(this.m_last/this.m_blockSize<<k.st_blockPower)+this.m_last%this.m_blockSize*this.m_realStride,this.m_last++}else this.m_firstFree=this.m_buffer[t>>k.st_blockPower][t&k.st_blockMask];this.m_size++;let e=this.m_buffer[t>>k.st_blockPower],s=t&k.st_blockMask;for(let t=0;t<this.m_stride;t++)e[s+t]=-1;return t}elementToIndex(t){return(t>>k.st_blockPower)*this.m_blockSize+(t&k.st_blockMask)/this.m_realStride}deleteAll(t){this.m_firstFree=-1,this.m_last=0,this.m_size=0,t&&(this.m_buffer=null,this.m_capacity=0)}size(){return this.m_size}setCapacity(t){t>this.m_capacity&&this.grow(t)}capacity(){return this.m_capacity}swap(t,e){let s=this.m_buffer[t>>k.st_blockPower],i=this.m_buffer[e>>k.st_blockPower],n=t&k.st_blockMask,r=e&k.st_blockMask;for(let t=0;t<this.m_stride;t++){let e=s[n+t];s[n+t]=i[r+t],i[r+t]=e}}swapField(t,e,s){let i=this.m_buffer[t>>k.st_blockPower],n=this.m_buffer[e>>k.st_blockPower],r=(t&k.st_blockMask)+s,h=(e&k.st_blockMask)+s,m=i[r];i[r]=n[h],n[h]=m}static impossibleIndex2(){return -2}static impossibleIndex3(){return -3}static isValidElement(t){return t>=0}ensureBufferBlocksCapacity(t){if(this.m_buffer.length<t){let e=Array(t);for(let t=0;t<this.m_buffer.length;t++)e[t]=this.m_buffer[t];this.m_buffer=e}}grow(t){null===this.m_buffer&&(this.m_bufferSize=0,this.m_buffer=Array(8));let e=Math.trunc((t+this.m_blockSize-1)/this.m_blockSize);if(this.ensureBufferBlocksCapacity(e),1===e){let e=0,s=t*this.m_realStride;for(;s>k.st_sizes[e];)e++;let i=new Int32Array(k.st_sizes[e]);1===this.m_bufferSize?(i.set(this.m_buffer[0]),this.m_buffer[0]=i):(this.m_buffer[this.m_bufferSize]=i,this.m_bufferSize++),this.m_capacity=Math.trunc(i.length/this.m_realStride)}else{if(1===this.m_bufferSize&&this.m_buffer[0].length<k.st_realBlockSize){let t=new Int32Array(k.st_realBlockSize);t.set(this.m_buffer[0]),this.m_buffer[0]=t,this.m_capacity=this.m_blockSize}for(;this.m_bufferSize<e;)this.m_buffer[this.m_bufferSize++]=new Int32Array(k.st_realBlockSize),this.m_capacity+=this.m_blockSize}}}k.st_realBlockSize=16384,k.st_blockMask=16383,k.st_blockPower=14,k.st_sizes=[16,32,64,128,256,512,1024,2048,4096,8192,16384],k.st_deadVertex=-0x7eadbeed;class V{constructor(t,e,s){this.m_extent=new n.J,this.m_dataExtent=new n.J,this.m_childExtents=[new n.J,new n.J,new n.J,new n.J],this.m_elementNodes=new k(4),this.m_data=[],this.m_freeData=[],this.m_root=-1,this.m_height=8,void 0===s&&(s=!1),this.m_quadTreeNodes=new k(s?11:10),this.m_bStoreDuplicates=s,this.reset_(t,e)}reset(t,e){this.m_quadTreeNodes.deleteAll(!1),this.m_elementNodes.deleteAll(!1),this.m_data.length=0,this.m_freeData.length=0,this.reset_(t,e)}insert(t,e){if(-1===this.m_root&&this.createRoot_(),this.m_bStoreDuplicates){let s=this.insertDuplicates_(t,e,0,this.m_extent,this.m_root,!1,-1);return -1!==s&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:e}):this.m_dataExtent.mergeEnvelope2D(e)),s}let s=this.insert_(t,e,0,this.m_extent,this.m_root,!1,-1);return -1!==s&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:e}):this.m_dataExtent.mergeEnvelope2D(e)),s}insertEx(t,e,s){let i;if(-1===this.m_root&&this.createRoot_(),this.m_bStoreDuplicates){let s=this.insertDuplicates_(t,e,0,this.m_extent,this.m_root,!1,-1);return -1!==s&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:e}):this.m_dataExtent.mergeEnvelope2D(e)),s}i=-1===s?this.m_root:this.getQuad_(s);let n=this.getHeight(i),r=this.getExtent(i),h=this.insert_(t,e,n,r,i,!1,-1);return -1!==h&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:e}):this.m_dataExtent.mergeEnvelope2D(e)),h}removeElement(t){(0,r.g)(0)}getElement(t){return this.getElementValue_(this.getData_(t))}getElementAtIndex(t){return(0,r.g)(0),0}getElementExtent(t){let e=this.getData_(t);return this.getBoundingBoxValue_(e).clone()}getElementExtentAtIndex(t){return(0,r.g)(0),{}}getDataExtent(){return this.m_dataExtent.clone()}getQuadTreeExtent(){return(0,r.g)(0),{}}getHeight(t){return this.m_quadTreeNodes.getField(t,6)>>V.m_heightBitShift}getMaxHeight(){return this.m_height}getExtent(t){let e=new n.J;if(e.setCoords({env2D:this.m_extent}),t===this.m_root)return e;let s=[],i=t;do s.push(this.getQuadrant_(i)),i=this.getParent_(i);while(i!==this.m_root);let r=s.length;for(let t=0;t<r;t++){let t=s.at(-1);s.pop(),0===t?(e.xmin=.5*(e.xmin+e.xmax),e.ymin=.5*(e.ymin+e.ymax)):1===t?(e.xmax=.5*(e.xmin+e.xmax),e.ymin=.5*(e.ymin+e.ymax)):(2===t?e.xmax=.5*(e.xmin+e.xmax):e.xmin=.5*(e.xmin+e.xmax),e.ymax=.5*(e.ymin+e.ymax))}return e}getQuad(t){return this.getQuad_(t)}getElementCount(){return -1===this.m_root?0:this.getSubTreeElementCount_(this.m_root)}getSubTreeElementCount(t){return this.getSubTreeElementCount_(t)}getContainedSubTreeElementCount(t){return this.m_bStoreDuplicates?this.getContainedSubTreeElementCount_(t):this.getSubTreeElementCount_(t)}getIntersectionCount(t,e,s){if(-1===this.m_root)return 0;let r=new n.J;r.setCoords({env2D:t}),r.inflateCoords(e,e);let h=[],m=[];h.push(this.m_root),m.push(this.m_extent.clone());let a=(0,i.m)(n.J,4),o=0;for(;h.length>0;){let t=!1,e=h.at(-1),i=m.at(-1);if(h.pop(),m.pop(),r.containsEnvelope(i)){if(o+=this.getSubTreeElementCount(e),s>0&&o>=s)return s}else if(r.isIntersecting(i)){for(let t=this.getFirstElement_(e);-1!==t;t=this.getNextElement_(t)){let e=this.getData_(t);if(this.getBoundingBoxValue_(e).isIntersecting(r)&&(o++,s>0&&o>=s))return s}t=this.getHeight(e)+1<=this.m_height}if(t){V.setChildExtents_(i,a);for(let t=0;t<4;t++){let s=this.getChild_(e,t);-1!==s&&this.getSubTreeElementCount_(s)>0&&r.isIntersecting(a[t])&&(h.push(s),m.push(a[t].clone()))}}}return o}hasData(t,e){return this.getIntersectionCount(t,e,1)>=1}getIterator(t,e){return new M(this,t,e)}getIteratorForQT(){return new M(this)}getSortedIterator(t,e){return new H(this.getIterator(t,e))}getSortedIteratorForQT(){return new H(this.getIteratorForQT())}visitLeavesNearest(t,e,s,i){(0,r.g)(0)}reset_(t,e){(e<0||e>127)&&(0,r.t)("invalid height"),this.m_height=e,this.m_extent.setCoords({env2D:t}),this.m_dataExtent.setEmpty(),this.m_root=-1}insert_(t,e,s,i,r,h,m){if(!i.containsEnvelope(e))return 0===s?-1:this.insert_(t,e,0,this.m_extent,this.m_root,h,m);if(!h)for(let t=r;-1!==t;t=this.getParent_(t))this.setSubTreeElementCount_(t,this.getSubTreeElementCount_(t)+1);let a=new n.J;a.setCoords({env2D:i});let o,l=r;for(o=s;o<this.m_height&&this.canPushDown_(l);o++){V.setChildExtents_(a,this.m_childExtents);let t=!1;for(let s=0;s<4;s++)if(this.m_childExtents[s].containsEnvelope(e)){t=!0;let e=this.getChild_(l,s);-1===e&&(e=this.createChild_(l,s)),this.setSubTreeElementCount_(e,this.getSubTreeElementCount_(e)+1),l=e,a.setCoords({env2D:this.m_childExtents[s]});break}if(!t)break}return this.insertAtQuad_(t,e,o,a,l,h,r,m,-1)}insertDuplicates_(t,e,s,r,h,m,a){if(!m){if(!r.containsEnvelope(e))return -1;this.setSubTreeElementCount_(h,this.getSubTreeElementCount_(h)+1),this.setContainedSubTreeElementCount_(h,this.getContainedSubTreeElementCount_(h)+1)}let o=Math.max(e.width(),e.height()),l=-1,_=[],u=[],d=[];_.push(h),u.push(r.clone()),d.push(s);let c=(0,i.m)(n.J,4);for(;_.length>0;){let s=!1,i=_.at(-1),n=u.at(-1),r=d.at(-1);if(_.pop(),u.pop(),d.pop(),r+1<this.m_height&&this.canPushDown_(i)&&o<=Math.max(n.width(),n.height())/2&&(s=!0),s){V.setChildExtents_(n,c);let t=!1;for(let s=0;s<4;s++)if(t=c[s].containsEnvelope(e)){let t=this.getChild_(i,s);-1===t&&(t=this.createChild_(i,s)),_.push(t),u.push(c[s].clone()),d.push(r+1),this.setSubTreeElementCount_(t,this.getSubTreeElementCount_(t)+1),this.setContainedSubTreeElementCount_(t,this.getContainedSubTreeElementCount_(t)+1);break}if(!t){for(let t=0;t<4;t++)if(c[t].isIntersecting(e)){let e=this.getChild_(i,t);-1===e&&(e=this.createChild_(i,t)),_.push(e),u.push(c[t].clone()),d.push(r+1),this.setSubTreeElementCount_(e,this.getSubTreeElementCount_(e)+1)}}}else l=this.insertAtQuad_(t,e,r,n,i,m,h,a,l),m=!1}return 0}insertAtQuad_(t,e,s,i,n,r,h,m,a){this.getFirstElement_(n);let o=this.getLastElement_(n),l=-1;if(r){if(n===h)return m;this.disconnectElementHandle_(m),l=m}else -1===a?(l=this.createElement_(),this.setDataValues_(this.getData_(l),t,e)):l=this.createElementFromDuplicate_(a);return this.setQuad_(l,n),-1!==o?(this.setPrevElement_(l,o),this.setNextElement_(o,l)):this.setFirstElement_(n,l),this.setLastElement_(n,l),this.setLocalElementCount_(n,this.getLocalElementCount_(n)+1),this.canFlush_(n)&&this.flush_(s,i,n),l}static setChildExtents_(t,e){let s=.5*(t.xmin+t.xmax),i=.5*(t.ymin+t.ymax);e[0].setCoords({xmin:s,ymin:i,xmax:t.xmax,ymax:t.ymax}),e[1].setCoords({xmin:t.xmin,ymin:i,xmax:s,ymax:t.ymax}),e[2].setCoords({xmin:t.xmin,ymin:t.ymin,xmax:s,ymax:i}),e[3].setCoords({xmin:s,ymin:t.ymin,xmax:t.xmax,ymax:i})}disconnectElementHandle_(t){let e=this.getQuad_(t),s=this.getFirstElement_(e),i=this.getLastElement_(e),n=this.getPrevElement_(t),r=this.getNextElement_(t);s===t?(-1!==r?this.setPrevElement_(r,-1):this.setLastElement_(e,-1),this.setFirstElement_(e,r)):i===t?(this.setNextElement_(n,-1),this.setLastElement_(e,n)):(this.setPrevElement_(r,n),this.setNextElement_(n,r)),this.setPrevElement_(t,-1),this.setNextElement_(t,-1),this.setLocalElementCount_(e,this.getLocalElementCount_(e)-1)}canFlush_(t){return this.getLocalElementCount_(t)===V.m_flushingCount&&!this.hasChildren_(t)}flush_(t,e,s){let i,r=new n.J,h=this.getFirstElement_(s),m=-1,a=-1;do a=this.getData_(h),i=this.getElementValue_(a),r.setCoords({env2D:this.getBoundingBoxValue_(a)}),m=this.getNextElement_(h),this.m_bStoreDuplicates?this.insertDuplicates_(i,r,t,e,s,!0,h):this.insert_(i,r,t,e,s,!0,h),h=m;while(-1!==h)}canPushDown_(t){return this.getLocalElementCount_(t)>=V.m_flushingCount||this.hasChildren_(t)}hasChildren_(t){return -1!==this.getChild_(t,0)||-1!==this.getChild_(t,1)||-1!==this.getChild_(t,2)||-1!==this.getChild_(t,3)}createChild_(t,e){let s=this.m_quadTreeNodes.newElement();return this.setChild_(t,e,s),this.setSubTreeElementCount_(s,0),this.setLocalElementCount_(s,0),this.setParent_(s,t),this.setHeightAndQuadrant_(s,this.getHeight_(t)+1,e),this.m_bStoreDuplicates&&this.setContainedSubTreeElementCount_(s,0),s}createRoot_(){this.m_root=this.m_quadTreeNodes.newElement(),this.setSubTreeElementCount_(this.m_root,0),this.setLocalElementCount_(this.m_root,0),this.setHeightAndQuadrant_(this.m_root,0,0),this.m_bStoreDuplicates&&this.setContainedSubTreeElementCount_(this.m_root,0)}createElement_(){let t,e=this.m_elementNodes.newElement();return this.m_freeData.length>0?(t=this.m_freeData.at(-1),this.m_freeData.pop()):(t=this.m_data.length,this.m_data.length=t+1),this.setData_(e,t),e}createElementFromDuplicate_(t){let e=this.m_elementNodes.newElement(),s=this.getData_(t);return this.setData_(e,s),e}freeElementAndBoxNode_(t){(0,r.g)(0)}getChild_(t,e){return this.m_quadTreeNodes.getField(t,e)}setChild_(t,e,s){this.m_quadTreeNodes.setField(t,e,s)}getFirstElement_(t){return this.m_quadTreeNodes.getField(t,4)}setFirstElement_(t,e){this.m_quadTreeNodes.setField(t,4,e)}getLastElement_(t){return this.m_quadTreeNodes.getField(t,5)}setLastElement_(t,e){this.m_quadTreeNodes.setField(t,5,e)}getQuadrant_(t){return this.m_quadTreeNodes.getField(t,6)&V.m_quadrantMask}getHeight_(t){return this.m_quadTreeNodes.getField(t,6)>>V.m_heightBitShift}setHeightAndQuadrant_(t,e,s){let i=e<<V.m_heightBitShift|s;this.m_quadTreeNodes.setField(t,6,i)}getLocalElementCount_(t){return this.m_quadTreeNodes.getField(t,7)}setLocalElementCount_(t,e){this.m_quadTreeNodes.setField(t,7,e)}getSubTreeElementCount_(t){return this.m_quadTreeNodes.getField(t,8)}setSubTreeElementCount_(t,e){this.m_quadTreeNodes.setField(t,8,e)}getParent_(t){return this.m_quadTreeNodes.getField(t,9)}setParent_(t,e){this.m_quadTreeNodes.setField(t,9,e)}getContainedSubTreeElementCount_(t){return this.m_quadTreeNodes.getField(t,10)}setContainedSubTreeElementCount_(t,e){this.m_quadTreeNodes.setField(t,10,e)}getData_(t){return this.m_elementNodes.getField(t,0)}setData_(t,e){this.m_elementNodes.setField(t,0,e)}getPrevElement_(t){return this.m_elementNodes.getField(t,1)}getNextElement_(t){return this.m_elementNodes.getField(t,2)}setPrevElement_(t,e){this.m_elementNodes.setField(t,1,e)}setNextElement_(t,e){this.m_elementNodes.setField(t,2,e)}getQuad_(t){return this.m_elementNodes.getField(t,3)}setQuad_(t,e){this.m_elementNodes.setField(t,3,e)}getElementValue_(t){return this.m_data[t].element}getBoundingBoxValue_(t){return this.m_data[t].box}setDataValues_(t,e,s){this.m_data[t]={element:e,box:s.clone()}}}V.m_quadrantMask=3,V.m_heightBitShift=2,V.m_flushingCount=5;class M{constructor(t,e,s){this.m_bLinear=!1,this.m_queryStart=new i.P,this.m_queryEnd=new i.P,this.m_queryBox=new n.J,this.m_tolerance=0,this.m_currentElementHandle=-1,this.m_nextElementHandle=-1,this.m_quadsStack=[],this.m_extentsStack=[],this.m_childExtents=[new n.J,new n.J,new n.J,new n.J],this.m_quadTree=t,e&&this.resetIterator(e,s)}resetIterator(t,e){if(void 0===e&&(e=0),t instanceof n.J)return this.m_quadsStack.length=0,this.m_extentsStack.length=0,this.m_currentElementHandle=-1,this.m_queryBox.setCoords({env2D:t}),this.m_queryBox.inflateCoords(e,e),this.m_tolerance=Number.NaN,void(-1!==this.m_quadTree.m_root&&this.m_queryBox.isIntersecting(this.m_quadTree.m_extent)?(this.m_quadsStack.push(this.m_quadTree.m_root),this.m_extentsStack.push(this.m_quadTree.m_extent.clone()),this.m_nextElementHandle=this.m_quadTree.getFirstElement_(this.m_quadTree.m_root),this.m_bLinear=!1):this.m_nextElementHandle=-1);if(this.m_quadsStack.length=0,this.m_extentsStack.length=0,this.m_currentElementHandle=-1,t.queryLooseEnvelope(this.m_queryBox),this.m_queryBox.inflateCoords(e,e),-1!==this.m_quadTree.m_root&&this.m_queryBox.isIntersecting(this.m_quadTree.m_extent)){let s=t.getGeometryType();(this.m_bLinear=s===r.G.enumLine,this.m_bLinear)?(this.m_queryStart.assign(t.getStartXY()),this.m_queryEnd.assign(t.getEndXY()),this.m_tolerance=e):this.m_tolerance=Number.NaN,this.m_quadsStack.push(this.m_quadTree.m_root),this.m_extentsStack.push(this.m_quadTree.m_extent.clone()),this.m_nextElementHandle=this.m_quadTree.getFirstElement_(this.m_quadTree.m_root)}else this.m_nextElementHandle=-1}next(){if(0===this.m_quadsStack.length)return -1;this.m_currentElementHandle=this.m_nextElementHandle;let t=new i.P,e=new i.P,s=new n.J,r=!1;for(;!r;){for(;-1!==this.m_currentElementHandle;){let i=this.m_quadTree.getData_(this.m_currentElementHandle);if(s.setCoords({env2D:this.m_quadTree.getBoundingBoxValue_(i)}),s.isIntersecting(this.m_queryBox)&&(!this.m_bLinear||(t.setCoordsPoint2D(this.m_queryStart),e.setCoordsPoint2D(this.m_queryEnd),s.inflateCoords(this.m_tolerance,this.m_tolerance),s.clipLine(t,e)>0))){r=!0;break}this.m_currentElementHandle=this.m_quadTree.getNextElement_(this.m_currentElementHandle)}if(-1===this.m_currentElementHandle){let s=this.m_quadsStack.at(-1),i=this.m_extentsStack.at(-1);V.setChildExtents_(i,this.m_childExtents),this.m_quadsStack.pop(),this.m_extentsStack.pop();for(let i=0;i<4;i++){let r=this.m_quadTree.getChild_(s,i);if(-1!==r&&this.m_quadTree.getSubTreeElementCount(r)>0&&this.m_childExtents[i].isIntersecting(this.m_queryBox))if(this.m_bLinear){t.setCoordsPoint2D(this.m_queryStart),e.setCoordsPoint2D(this.m_queryEnd);let s=new n.J;s.setCoords({env2D:this.m_childExtents[i]}),s.inflateCoords(this.m_tolerance,this.m_tolerance),s.clipLine(t,e)>0&&(this.m_quadsStack.push(r),this.m_extentsStack.push(this.m_childExtents[i].clone()))}else this.m_quadsStack.push(r),this.m_extentsStack.push(this.m_childExtents[i].clone())}if(0===this.m_quadsStack.length)return -1;this.m_currentElementHandle=this.m_quadTree.getFirstElement_(this.m_quadsStack.at(-1))}}return this.m_nextElementHandle=this.m_quadTree.getNextElement_(this.m_currentElementHandle),this.m_currentElementHandle}clone(){return(0,r.g)(0),{}}}class H{constructor(t){this.m_bucketSort=new F,this.m_sortedHandles=new z(0),this.m_index=-1,this.m_quadTreeIteratorImpl=t}resetIterator(t,e){this.m_quadTreeIteratorImpl.resetIterator(t,e),this.m_sortedHandles.resize(0),this.m_index=-1}next(){if(-1===this.m_index){let t=-1;for(;-1!==(t=this.m_quadTreeIteratorImpl.next());)this.m_sortedHandles.add(t);let e=this;this.m_bucketSort.sort(this.m_sortedHandles,0,this.m_sortedHandles.size(),{userSort(t,s,i){i.sort(t,s,(t,s)=>e.m_quadTreeIteratorImpl.m_quadTree.getElement(t)-e.m_quadTreeIteratorImpl.m_quadTree.getElement(s))},getValue:t=>e.m_quadTreeIteratorImpl.m_quadTree.getElement(t)})}return this.m_index===this.m_sortedHandles.size()-1?-1:(this.m_index++,this.m_sortedHandles.read(this.m_index))}clone(){return(0,r.g)(0),{}}}class Y{constructor(t=!1){this.m_bNotifyOnActions=t}onDelete(t){}onSet(t){}onEndSearch(t){}onAddUniqueElementFailed(t){}onDeleteImpl(t,e){this.m_bNotifyOnActions&&this.onDelete(t.getElement(e))}onSetImpl(t,e){this.m_bNotifyOnActions&&this.onSet(t.getElement(e))}onAddUniqueElementFailedImpl(t){this.m_bNotifyOnActions&&this.onAddUniqueElementFailed(t)}onEndSearchImpl(t){this.m_bNotifyOnActions&&this.onEndSearch(t)}}class X{static st_nullNode(){return -1}constructor(){this.m_defaultTreap=-1,this.m_random=0x767aa0b,this.m_comparator=null,this.m_treapData=new k(7),this.m_treapCount=0,this.m_maxDepthEver=0,this.m_bBalancing=!0}setComparator(t){this.m_comparator=t}getComparator(){return this.m_comparator}disableBalancing(){this.m_bBalancing=!1}enableBalancing(){this.m_bBalancing||((0,r.g)(this.m_treapCount<=1),this.rebalance(-1),this.m_bBalancing=!0)}isAutoBalancing(){return this.m_bBalancing}rebalance(t){if(this.m_bBalancing||(-1===t&&(t=this.m_defaultTreap),0===this.size(t)))return;let e=[];for(let s=this.getFirst(t);-1!==s;s=this.getNext(s))e.push(s),this.setParent_(s,-1),this.setRight_(s,-1),this.setLeft_(s,-1);for(let s of(this.setRoot_(-1,t),this.setFirst_(-1,t),this.setLast_(-1,t),this.setSize_(0,t),this.m_bBalancing=!0,e))this.addBiggestElement_(s,t);this.m_bBalancing=!1}setCapacity(t){this.m_treapData.setCapacity(t)}createTreap(t){let e=this.m_treapData.newElement();return this.setSize_(0,e),this.setTreapData_(t,e),this.m_treapCount++,e}deleteTreap(t){this.m_treapData.deleteElement(t),this.m_treapCount--}addElement(t,e=-1){return -1===e&&(this.m_defaultTreap===X.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),e=this.m_defaultTreap),this.addElement_(t,0,e)}addUniqueElement(t,e=-1){return -1===e&&(this.m_defaultTreap===X.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),e=this.m_defaultTreap),this.addElement_(t,1,e)}addBiggestElement(t,e=-1){-1===e&&(this.m_defaultTreap===X.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),e=this.m_defaultTreap);let s=this.newNode_(t);return this.addBiggestElement_(s,e),s}addElementAtPosition(t,e,s,n,r,h=-1){let m,a,o,l;if(-1===h&&(this.m_defaultTreap===X.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),h=this.m_defaultTreap),this.getRoot_(h)===X.st_nullNode()){let t=this.newNode_(s);return this.setRoot_(t,h),this.addToList_(-1,t,h),t}if(r?(m=e!==X.st_nullNode()?this.m_comparator.compare(this,s,e):-1,a=t!==X.st_nullNode()?this.m_comparator.compare(this,s,t):1):(m=-1,a=1),n&&(0===m||0===a)){this.m_comparator.onAddUniqueElementFailedImpl(s);let i=0===m?e:t;return this.setDuplicateElement_(i,h),-1}(e!==X.st_nullNode()&&t!==X.st_nullNode()?this.m_random>(0,i.A)(this.m_random)>>1:e!==X.st_nullNode())?(l=m,o=e):(l=a,o=t);let _=-1,u=-1,d=!0;for(;;){if(l<0){let t=this.getLeft(o);if(t===X.st_nullNode()){u=o,_=this.newNode_(s),this.setLeft_(o,_),this.setParent_(_,o);break}o=t}else{let t=this.getRight(o);if(t===X.st_nullNode()){u=this.getNext(o),_=this.newNode_(s),this.setRight_(o,_),this.setParent_(_,o);break}o=t}d&&(l*=-1,d=!1)}return this.bubbleUp_(_),this.getParent(_)===X.st_nullNode()&&this.setRoot_(_,h),this.addToList_(u,_,h),_}replaceElementAtPosition(t,e,s,i,n=-1){if(i){let i=this.getNext(t),r=-1;i!==X.st_nullNode()&&(r=this.m_comparator.compare(this,e,i));let h=this.getPrev(t),m=-1;if(h!==X.st_nullNode()&&(m=this.m_comparator.compare(this,e,h)),s&&(0===r||0===m)){this.m_comparator.onAddUniqueElementFailedImpl(e);let t=0===r?i:h;return n===X.st_nullNode()&&(this.m_defaultTreap===X.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),n=this.m_defaultTreap),this.setDuplicateElement_(t,n),-1}}return this.setElement_(t,e),t}getDuplicateElement(t=-1){return -1===t?this.getDuplicateElement_(this.m_defaultTreap):this.getDuplicateElement_(t)}deleteNode(t,e=-1){this.m_comparator&&this.m_comparator.onDeleteImpl(this,t),-1===e&&(e=this.m_defaultTreap),this.m_bBalancing?this.deleteNode_(t,e):this.unbalancedDelete_(t,e)}search(t,e=-1){let s=this.getRoot(e);for(;s!==X.st_nullNode();){let e=this.m_comparator.compare(this,t,s);if(!e)return s;s=e<0?this.getLeft(s):this.getRight(s)}return this.m_comparator.onEndSearchImpl(t),X.st_nullNode()}searchLowerBound(t,e=-1){let s=this.getRoot(e),i=-1;for(;s!==X.st_nullNode();){let e=t.compare(this,s);if(!e)return s;e<0?s=this.getLeft(s):(i=s,s=this.getRight(s))}return i}searchUpperBound(t,e=-1){let s=this.getRoot(e),i=-1;for(;s!==X.st_nullNode();){let e=t.compare(this,s);if(!e)return s;e<0?(i=s,s=this.getLeft(s)):s=this.getRight(s)}return i}getElement(t){return this.m_treapData.getField(t,3)}getLeft(t){return this.m_treapData.getField(t,0)}getRight(t){return this.m_treapData.getField(t,1)}getParent(t){return this.m_treapData.getField(t,2)}getNext(t){return this.m_treapData.getField(t,6)}getPrev(t){return this.m_treapData.getField(t,5)}getFirst(t=-1){return -1===t?this.getFirst_(this.m_defaultTreap):this.getFirst_(t)}getLast(t=-1){return -1===t?this.getLast_(this.m_defaultTreap):this.getLast_(t)}getTreapData(t=-1){return -1===t?this.getTreapData_(this.m_defaultTreap):this.getTreapData_(t)}setElement(t,e){null!==this.m_comparator&&this.m_comparator.onSetImpl(this,t),this.setElement_(t,e)}getRoot(t=-1){return -1===t?this.getRoot_(this.m_defaultTreap):this.getRoot_(t)}clear(){this.m_treapData.deleteAll(!1),this.m_defaultTreap=X.st_nullNode(),this.m_treapCount=0,this.m_maxDepthEver=0}addToList_(t,e,s){let i;-1!==t?(i=this.getPrev(t),this.setPrev_(t,e)):i=this.getLast_(s),this.setPrev_(e,i),-1!==i&&this.setNext_(i,e),this.setNext_(e,t),t===this.getFirst_(s)&&this.setFirst_(e,s),-1===t&&this.setLast_(e,s),this.setSize_(this.getSize_(s)+1,s)}size(t=-1){return -1===t?this.getSize_(this.m_defaultTreap):this.getSize_(t)}getMaxDepth(t=-1){return this.getMaxDepthHelper_(this.getRoot(t))}getMaxDepthEver(){return this.m_maxDepthEver}static st_isValidNode(t){return k.isValidElement(t)}dbgCheck_(t){}getPriority_(t){return this.m_treapData.getField(t,4)}bubbleDown_(t){let e=this.getLeft(t),s=this.getRight(t),n=this.getPriority_(t);for(;e!==X.st_nullNode()||s!==X.st_nullNode();){let r=e!==X.st_nullNode()?this.getPriority_(e):(0,i.j)(),h=s!==X.st_nullNode()?this.getPriority_(s):(0,i.j)();if(n<=Math.min(r,h))return;r<=h?this.rotateRight_(e):this.rotateLeft_(t),e=this.getLeft(t),s=this.getRight(t)}}bubbleUp_(t){if(!this.m_bBalancing)return;let e=this.getPriority_(t),s=this.getParent(t);for(;s!==X.st_nullNode()&&this.getPriority_(s)>e;)this.getLeft(s)===t?this.rotateRight_(t):this.rotateLeft_(s),s=this.getParent(t)}rotateLeft_(t){let e,s=this.getRight(t);this.setParent_(s,this.getParent(t)),this.setParent_(t,s),e=this.getLeft(s),this.setRight_(t,e),e!==X.st_nullNode()&&this.setParent_(e,t),this.setLeft_(s,t),(e=this.getParent(s))!==X.st_nullNode()&&(this.getLeft(e)===t?this.setLeft_(e,s):this.setRight_(e,s))}rotateRight_(t){let e,s=this.getParent(t);this.setParent_(t,this.getParent(s)),this.setParent_(s,t),e=this.getRight(t),this.setLeft_(s,e),e!==X.st_nullNode()&&this.setParent_(e,s),this.setRight_(t,s),(e=this.getParent(t))!==X.st_nullNode()&&(this.getLeft(e)===s?this.setLeft_(e,t):this.setRight_(e,t))}setParent_(t,e){this.m_treapData.setField(t,2,e)}setLeft_(t,e){this.m_treapData.setField(t,0,e)}setRight_(t,e){this.m_treapData.setField(t,1,e)}setPriority_(t,e){this.m_treapData.setField(t,4,e)}setPrev_(t,e){this.m_treapData.setField(t,5,e)}setNext_(t,e){this.m_treapData.setField(t,6,e)}setRoot_(t,e){this.m_treapData.setField(e,0,t)}setFirst_(t,e){this.m_treapData.setField(e,1,t)}setLast_(t,e){this.m_treapData.setField(e,2,t)}setDuplicateElement_(t,e){this.m_treapData.setField(e,3,t)}setSize_(t,e){this.m_treapData.setField(e,4,t)}setTreapData_(t,e){this.m_treapData.setField(e,5,t)}getRoot_(t){return -1===t?X.st_nullNode():this.m_treapData.getField(t,0)}getFirst_(t){return -1===t?X.st_nullNode():this.m_treapData.getField(t,1)}getLast_(t){return -1===t?X.st_nullNode():this.m_treapData.getField(t,2)}getDuplicateElement_(t){return -1===t?X.st_nullNode():this.m_treapData.getField(t,3)}getSize_(t){return -1===t?0:this.m_treapData.getField(t,4)}getTreapData_(t){return this.m_treapData.getField(t,5)}newNode_(t){let e=this.m_treapData.newElement();return this.setPriority_(e,this.generatePriority_()),this.setElement_(e,t),e}freeNode_(t,e){t!==X.st_nullNode()&&this.m_treapData.deleteElement(t)}generatePriority_(){return this.m_random=(0,i.A)(this.m_random),this.m_random&(0,i.j)()>>1}maxPriority(){return(0,r.g)(0),0}getMaxDepthHelper_(t){return t===X.st_nullNode()?0:1+Math.max(this.getMaxDepthHelper_(this.getLeft(t)),this.getMaxDepthHelper_(this.getRight(t)))}addElement_(t,e,s){if(this.getRoot(s)===X.st_nullNode()){let e=this.newNode_(t);return this.setRoot_(e,s),this.addToList_(-1,e,s),this.m_maxDepthEver=Math.max(this.m_maxDepthEver,1),e}let i=this.getRoot_(s),n=-1,r=-1,h=1;for(;;){let m=-1===e?1:this.m_comparator.compare(this,t,i);if(m<0){let e=this.getLeft(i);if(e===X.st_nullNode()){r=i,n=this.newNode_(t),this.setLeft_(i,n),this.setParent_(n,i);break}i=e}else{if(1===e&&0===m)return this.m_comparator.onAddUniqueElementFailedImpl(t),this.setDuplicateElement_(i,s),-1;let h=this.getRight(i);if(h===X.st_nullNode()){r=this.getNext(i),n=this.newNode_(t),this.setRight_(i,n),this.setParent_(n,i);break}i=h}h++}return this.bubbleUp_(n),this.getParent(n)===X.st_nullNode()&&this.setRoot_(n,s),this.addToList_(r,n,s),this.m_maxDepthEver=Math.max(h,this.m_maxDepthEver),n}removeFromList_(t,e){let s=this.getPrev(t),i=this.getNext(t);-1!==s?this.setNext_(s,i):this.setFirst_(i,e),-1!==i?this.setPrev_(i,s):this.setLast_(s,e),this.setSize_(this.getSize_(e)-1,e)}unbalancedDelete_(t,e){this.removeFromList_(t,e);let s=this.getLeft(t),n=this.getRight(t),r=this.getParent(t),h=t;if(-1!==s&&-1!==n){let m;this.m_random=(0,i.A)(this.m_random),m=this.m_random>(0,i.j)()>>1?this.getNext(t):this.getPrev(t);let a=this.getParent(m)===t;this.m_treapData.swapField(t,m,0),this.m_treapData.swapField(t,m,1),this.m_treapData.swapField(t,m,2),-1!==r?this.getLeft(r)===t?this.setLeft_(r,m):this.setRight_(r,m):this.setRoot_(m,e),a?(s===m?(this.setLeft_(m,t),this.setParent_(n,m)):n===m&&(this.setRight_(m,t),this.setParent_(s,m)),this.setParent_(t,m),r=m):(this.setParent_(s,m),this.setParent_(n,m),r=this.getParent(t),h=m),s=this.getLeft(t),n=this.getRight(t),-1!==s&&this.setParent_(s,t),-1!==n&&this.setParent_(n,t)}let m=-1!==s?s:n;-1===r?this.setRoot_(m,e):this.getLeft(r)===h?this.setLeft_(r,m):this.setRight_(r,m),-1!==m&&this.setParent_(m,r),this.freeNode_(t,e)}deleteNode_(t,e){this.setPriority_(t,(0,i.j)());let s=X.st_nullNode(),n=X.st_nullNode(),r=this.getRoot_(e),h=r===t;if(h&&(s=this.getLeft(r),n=this.getRight(r),s===X.st_nullNode()&&n===X.st_nullNode()))return this.removeFromList_(r,e),this.freeNode_(r,e),void this.setRoot_(X.st_nullNode(),e);this.bubbleDown_(t);let m=this.getParent(t);m!==X.st_nullNode()&&(this.getLeft(m)===t?this.setLeft_(m,X.st_nullNode()):this.setRight_(m,X.st_nullNode())),this.removeFromList_(t,e),this.freeNode_(t,e),h&&this.setRoot_(s===X.st_nullNode()||this.getParent(s)!==X.st_nullNode()?n:s,e)}setElement_(t,e){this.m_treapData.setField(t,3,e)}addBiggestElement_(t,e){if(this.getRoot_(e)===X.st_nullNode())return this.setRoot_(t,e),void this.addToList_(-1,t,e);let s=this.getLast_(e);this.setRight_(s,t),this.setParent_(t,s),this.bubbleUp_(t),this.getParent(t)===X.st_nullNode()&&this.setRoot_(t,e),this.addToList_(-1,t,e)}}class O{constructor(t){this.m_lists=new k(6),this.m_listOfLists=O.st_nullNode(),void 0===t?(this.m_listNodes=new k(3),this.m_bStoreListIndexWithNode=!1):(this.m_listNodes=new k(t?4:3),this.m_bStoreListIndexWithNode=t)}freeNode_(t){this.m_listNodes.deleteElement(t)}newNode_(){return this.m_listNodes.newElement()}freeList_(t){(0,r.g)(0)}newList_(){return this.m_lists.newElement()}setPrev_(t,e){this.m_listNodes.setField(t,1,e)}setNext_(t,e){this.m_listNodes.setField(t,2,e)}setData_(t,e){(0,r.g)(0)}setList_(t,e){return this.m_listNodes.setField(t,3,e)}setListSize_(t,e){this.m_lists.setField(t,4,e)}setNextList_(t,e){(0,r.g)(0)}setPrevList_(t,e){this.m_lists.setField(t,2,e)}createList(t){let e=this.newList_();return this.m_lists.setField(e,3,this.m_listOfLists),this.m_lists.setField(e,4,0),this.m_lists.setField(e,5,t),this.m_listOfLists!==O.st_nullNode()&&this.setPrevList_(this.m_listOfLists,e),this.m_listOfLists=e,e}deleteList(t){this.clear(t);let e=this.m_lists.getField(t,2),s=this.m_lists.getField(t,3);return e!==O.st_nullNode()?this.setNextList_(e,s):this.m_listOfLists=s,s!==O.st_nullNode()&&this.setPrevList_(s,e),this.freeList_(t),s}reserveLists(t){(0,r.g)(0)}getListData(t){return this.m_lists.getField(t,5)}getList(t){return(0,r.g)(0),0}setListData(t,e){this.m_lists.setField(t,5,e)}addElement(t,e){return this.insertElement(t,-1,e)}insertElement(t,e,s){let i=this.newNode_(),n=-1;if(e!==O.st_nullNode()&&(n=this.getPrev(e),this.setPrev_(e,i)),this.setNext_(i,e),n!==O.st_nullNode()&&this.setNext_(n,i),e===this.m_lists.getField(t,0)&&this.m_lists.setField(t,0,i),e===O.st_nullNode()){let e=this.m_lists.getField(t,1);this.setPrev_(i,e),-1!==e&&this.setNext_(e,i),this.m_lists.setField(t,1,i)}return this.setData(i,s),this.setListSize_(t,this.getListSize(t)+1),this.m_bStoreListIndexWithNode&&this.setList_(i,t),i}deleteElement(t,e){let s=this.getPrev(e),i=this.getNext(e);return s!==O.st_nullNode()?this.setNext_(s,i):this.m_lists.setField(t,0,i),i!==O.st_nullNode()?this.setPrev_(i,s):this.m_lists.setField(t,1,s),this.freeNode_(e),this.setListSize_(t,this.getListSize(t)-1),i}reserveNodes(t){this.m_listNodes.setCapacity(t)}getData(t){return this.m_listNodes.getField(t,0)}getElement(t){return this.getData(t)}setData(t,e){this.m_listNodes.setField(t,0,e)}getNext(t){return this.m_listNodes.getField(t,2)}getPrev(t){return this.m_listNodes.getField(t,1)}getFirst(t){return this.m_lists.getField(t,0)}getLast(t){return this.m_lists.getField(t,1)}static st_nullNode(){return -1}clear(t){if(void 0!==t){let e=this.getLast(t);for(;e!==O.st_nullNode();){let t=e;e=this.getPrev(t),this.freeNode_(t)}return this.m_lists.setField(t,0,-1),this.m_lists.setField(t,1,-1),void this.setListSize_(t,0)}for(let t=this.getFirstList();-1!==t;)t=this.deleteList(t)}isEmpty(t){return(0,r.g)(0),!1}getNodeCount(){return this.m_listNodes.size()}getListCount(){return this.m_lists.size()}getListSize(t){return this.m_lists.getField(t,4)}getFirstList(){return this.m_listOfLists}getNextList(t){return this.m_lists.getField(t,3)}}class G extends Y{constructor(t){super(),this.m_intervalTree=t}compare(t,e,s){let i=t.getElement(s),n=this.m_intervalTree.getValue_(e),r=this.m_intervalTree.getValue_(i);return n<r?-1:n===r?J.isLeft_(e)&&J.isRight_(i)?-1:J.isLeft_(i)&&J.isRight_(e)?1:0:1}}class J{constructor(t){this.m_bEnvelopesRef=!1,this.m_intervals=[],this.m_envelopesRef=null,this.m_intervalNodes=new k(3),this.m_intervalHandles=[],this.m_endIndicesUnique=[],this.m_cCount=-1,this.m_root=-1,this.m_bSortIntervals=!1,this.m_bConstructing=!1,this.m_bConstructionEnded=!1,this.m_bOfflineDynamic=t,this.m_tertiaryNodes=new k(this.m_bOfflineDynamic?5:4),this.m_secondaryTreaps=new X,this.m_secondaryTreaps.setComparator(new G(this)),this.m_secondaryLists=new O}addEnvelopesRef(t){this.reset_(!0,!0),this.m_bEnvelopesRef=!0,this.m_envelopesRef=t,this.m_bConstructing=!1,this.m_bConstructionEnded=!0,this.m_bOfflineDynamic||(this.insertIntervalsStatic_(),this.m_cCount=this.m_envelopesRef.length)}startConstruction(){this.reset_(!0,!1)}addInterval(t){this.m_bConstructing||(0,r.m)(""),this.m_intervals.push(t.clone())}addIntervalCoords(t,e){(0,r.g)(0)}endConstruction(){this.m_bConstructing||(0,r.m)(""),this.m_bConstructing=!1,this.m_bConstructionEnded=!0,this.m_bOfflineDynamic||(this.insertIntervalsStatic_(),this.m_cCount=this.m_intervals.length)}insert(t){if(this.m_bOfflineDynamic&&this.m_bConstructionEnded||(0,r.m)(""),-1===this.m_root){let t=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length;if(this.m_bSortIntervals){let e=new z(0);this.querySortedEndPointIndices_(e),this.m_endIndicesUnique.length=0,this.querySortedDuplicatesRemoved_(e),this.m_intervalHandles.length=t,this.m_intervalHandles.fill(-1),this.m_bSortIntervals=!1}else this.m_intervalHandles.fill(-1,0,t);this.m_root=this.createRoot_()}let e=this.insertIntervalEnd_(t<<1,this.m_root),s=this.getSecondaryFromInterval_(e),i=this.m_secondaryTreaps.addElement(1+(t<<1),s);this.setRightEnd_(e,i),this.m_intervalHandles[t]=e,this.m_cCount++}remove(t){let e;this.m_bOfflineDynamic&&this.m_bConstructionEnded||(0,r.m)("");let s=this.m_intervalHandles[t];-1===s&&(0,r.t)("the interval does not exist in the interval tree"),this.m_intervalHandles[t]=-1,this.m_cCount--;let i=this.getSecondaryFromInterval_(s),n=-1;n=this.m_secondaryTreaps.getTreapData(i),this.m_secondaryTreaps.deleteNode(this.getLeftEnd_(s),i),this.m_secondaryTreaps.deleteNode(this.getRightEnd_(s),i),0===(e=this.m_secondaryTreaps.size(i))&&(this.m_secondaryTreaps.deleteTreap(i),this.setSecondaryToTertiary_(n,-1)),this.m_intervalNodes.deleteElement(s);let h=this.getPptr_(n),m=this.getLptr_(n),a=this.getRptr_(n);for(;!(e>0||n===this.m_root||-1!==m&&-1!==a);)n===this.getLptr_(h)?-1!==m?(this.setLptr_(h,m),this.setPptr_(m,h),this.setLptr_(n,-1)):-1!==a?(this.setLptr_(h,a),this.setPptr_(a,h),this.setRptr_(n,-1)):this.setLptr_(h,-1):-1!==m?(this.setRptr_(h,m),this.setPptr_(m,h),this.setLptr_(n,-1)):-1!==a?(this.setRptr_(h,a),this.setPptr_(a,h),this.setRptr_(n,-1)):this.setRptr_(h,-1),this.setPptr_(n,-1),this.m_tertiaryNodes.deleteElement(n),n=h,e=-1!==(i=this.getSecondaryFromTertiary_(n))?this.m_secondaryTreaps.size(i):0,m=this.getLptr_(n),a=this.getRptr_(n),h=this.getPptr_(n)}size(){return this.m_cCount}getIteratorQuery(t,e){return t instanceof i.E?new U(this,t,e):((0,r.g)(0),{})}getIterator(){return new U(this)}querySortedEndPointIndices_(t){let e=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length;for(let s=0;s<2*e;s++)t.add(s);this.sortEndIndices_(t,0,2*e)}querySortedDuplicatesRemoved_(t){let e=Number.NaN;for(let s=0;s<t.size();s++){let i=t.read(s),n=this.getValue_(i);n!==e&&(this.m_endIndicesUnique.push(i),e=n)}}insertIntervalsStatic_(){let t=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length,e=new z(0);this.querySortedEndPointIndices_(e),this.m_endIndicesUnique.length=0,this.querySortedDuplicatesRemoved_(e),this.m_intervalNodes.setCapacity(t),this.m_secondaryLists.reserveNodes(2*t);let s=(0,i.d)(t,-1);this.m_root=this.createRoot_();for(let t=0;t<e.size();t++){let i=e.read(t),n=s[i>>1];if(-1!==n){let t=this.getSecondaryFromInterval_(n);this.setRightEnd_(n,this.m_secondaryLists.addElement(t,i))}else n=this.insertIntervalEnd_(i,this.m_root),s[i>>1]=n}}createRoot_(){let t=this.calculateDiscriminantIndex1_(0,this.m_endIndicesUnique.length-1);return this.createTertiaryNode_(t)}insertIntervalEnd_(t,e){let s=-1,i=e,n=-1,r=-1,h=0,m=this.m_endIndicesUnique.length-1,a=0,o=t>>1,l=Number.NaN,_=Number.NaN,u=!0,d=this.getMin_(o),c=this.getMax_(o),x=-1;for(;u;){a=h+(m-h>>1),x=this.calculateDiscriminantIndex1_(h,m);let e=this.getDiscriminantFromIndex1_(x);if(c<e){if(-1!==i){if(x===this.getDiscriminantIndex1_(i))s=i,l=e,_=-1!==(i=this.getLptr_(i))?this.getDiscriminant_(i):Number.NaN;else if(_>e){let t=this.createTertiaryNode_(x);e<l?this.setLptr_(s,t):this.setRptr_(s,t),this.setRptr_(t,i),this.m_bOfflineDynamic&&(this.setPptr_(t,s),this.setPptr_(i,t)),s=t,l=e,i=-1,_=Number.NaN}}m=a;continue}if(d>e){if(-1!==i){if(x===this.getDiscriminantIndex1_(i))s=i,l=e,_=-1!==(i=this.getRptr_(i))?this.getDiscriminant_(i):Number.NaN;else if(_<e){let t=this.createTertiaryNode_(x);e<l?this.setLptr_(s,t):this.setRptr_(s,t),this.setLptr_(t,i),this.m_bOfflineDynamic&&(this.setPptr_(t,s),this.setPptr_(i,t)),s=t,l=e,i=-1,_=Number.NaN}}h=a+1;continue}let o=-1;o=-1===i||x!==this.getDiscriminantIndex1_(i)?this.createTertiaryNode_(x):i,-1===(n=this.getSecondaryFromTertiary_(o))&&(n=this.createSecondary_(o),this.setSecondaryToTertiary_(o,n));let p=this.addEndIndex_(n,t);r=this.createIntervalNode_(),this.setSecondaryToInterval_(r,n),this.setLeftEnd_(r,p),-1!==i&&x===this.getDiscriminantIndex1_(i)||(e<l?this.setLptr_(s,o):this.setRptr_(s,o),this.m_bOfflineDynamic&&this.setPptr_(o,s),-1!==i&&(_<e?this.setLptr_(o,i):this.setRptr_(o,i),this.m_bOfflineDynamic&&this.setPptr_(i,o))),u=!1;break}return r}createTertiaryNode_(t){let e=this.m_tertiaryNodes.newElement();return this.setDiscriminantIndex1_(e,t),e}createSecondary_(t){return this.m_bOfflineDynamic?this.m_secondaryTreaps.createTreap(t):this.m_secondaryLists.createList(t)}createIntervalNode_(){return this.m_intervalNodes.newElement()}reset(){this.m_bOfflineDynamic&&this.m_bConstructionEnded||(0,r.m)(""),this.reset_(!1,this.m_bEnvelopesRef)}reset_(t,e){t?(this.m_bEnvelopesRef=!1,this.m_envelopesRef=null,this.m_bSortIntervals=!0,this.m_bConstructing=!0,this.m_bConstructionEnded=!1,this.m_endIndicesUnique.length=0,e?(this.m_intervals.length=0,this.m_bEnvelopesRef=!0):this.m_intervals.length=0):this.m_bSortIntervals=!1,this.m_bOfflineDynamic?this.m_secondaryTreaps.clear():this.m_secondaryLists.clear(),this.m_intervalNodes.deleteAll(!1),this.m_tertiaryNodes.deleteAll(!1),this.m_root=-1,this.m_cCount=0}getDiscriminant_(t){let e=this.getDiscriminantIndex1_(t);return this.getDiscriminantFromIndex1_(e)}getDiscriminantFromIndex1_(t){if(-1===t)return Number.NaN;if(t>0){let e=t-2,s=this.m_endIndicesUnique[e],i=this.m_endIndicesUnique[e+1];return .5*(this.getValue_(s)+this.getValue_(i))}let e=this.m_endIndicesUnique[-t-2];return this.getValue_(e)}calculateDiscriminantIndex1_(t,e){return t<e?t+(e-t>>1)+2:-(t+2)}setDiscriminantIndex1_(t,e){this.m_tertiaryNodes.setField(t,0,e)}setSecondaryToTertiary_(t,e){this.m_tertiaryNodes.setField(t,1,e)}setLptr_(t,e){this.m_tertiaryNodes.setField(t,2,e)}setRptr_(t,e){this.m_tertiaryNodes.setField(t,3,e)}setPptr_(t,e){this.m_tertiaryNodes.setField(t,4,e)}setSecondaryToInterval_(t,e){this.m_intervalNodes.setField(t,0,e)}addEndIndex_(t,e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.addElement(e,t):this.m_secondaryLists.addElement(t,e)}setLeftEnd_(t,e){this.m_intervalNodes.setField(t,1,e)}setRightEnd_(t,e){this.m_intervalNodes.setField(t,2,e)}getFirst_(t){return this.m_bOfflineDynamic?this.m_secondaryTreaps.getFirst(t):this.m_secondaryLists.getFirst(t)}getLast_(t){return this.m_bOfflineDynamic?this.m_secondaryTreaps.getLast(t):this.m_secondaryLists.getLast(t)}static isLeft_(t){return!(1&t)}static isRight_(t){return!(1&~t)}getDiscriminantIndex1_(t){return this.m_tertiaryNodes.getField(t,0)}getSecondaryFromTertiary_(t){return this.m_tertiaryNodes.getField(t,1)}getLptr_(t){return this.m_tertiaryNodes.getField(t,2)}getRptr_(t){return this.m_tertiaryNodes.getField(t,3)}getPptr_(t){return this.m_tertiaryNodes.getField(t,4)}getSecondaryFromInterval_(t){return this.m_intervalNodes.getField(t,0)}getLeftEnd_(t){return this.m_intervalNodes.getField(t,1)}getRightEnd_(t){return this.m_intervalNodes.getField(t,2)}getMin_(t){return this.m_bEnvelopesRef?this.m_envelopesRef[t].xmin:this.m_intervals[t].vmin}getMax_(t){return this.m_bEnvelopesRef?this.m_envelopesRef[t].xmax:this.m_intervals[t].vmax}sortEndIndices_(t,e,s){let i=this;(new F).sort(t,e,s,{userSort(t,e,s){i.sortEndIndicesHelper_(s,t,e)},getValue:t=>i.getValue_(t)})}sortEndIndicesHelper_(t,e,s){t.sort(e,s,(t,e)=>{let s=this.getValue_(t),i=this.getValue_(e);return s<i||s===i&&J.isLeft_(t)&&J.isRight_(e)?-1:1})}getValue_(t){if(!this.m_bEnvelopesRef){let e=this.m_intervals[t>>1];return J.isLeft_(t)?e.vmin:e.vmax}let e=this.m_envelopesRef[t>>1];return J.isLeft_(t)?e.xmin:e.xmax}}class U{constructor(t,e,s){this.m_query=i.E.constructEmpty(),this.m_tertiaryHandle=-1,this.m_nextTertiaryHandle=-1,this.m_forkedHandle=-1,this.m_currentEndHandle=-1,this.m_nextEndHandle=-1,this.m_tertiaryStack=[],this.m_functionIndex=0,this.m_intervalTree=t,this.m_functionStack=[,,],this.m_functionStack[0]=this.nullFunc_,this.m_functionStack[1]=this.nullFunc_,void 0!==e&&this.resetIterator(e,s)}nullFunc_(){return(0,r.c)("should not be called"),!1}resetIterator(t,e){if("number"==typeof t){let s=new i.E;s.setCoords(t,t),this.resetIterator(s,e)}else void 0===e&&(e=0),this.m_query.vmin=t.vmin-e,this.m_query.vmax=t.vmax+e,this.m_tertiaryStack.length=0,this.m_functionIndex=0,this.m_functionStack[0]=this.initialize_}next(){if(this.m_intervalTree.m_bConstructionEnded||(0,r.m)(""),this.m_functionIndex<0)return -1;for(;this.m_fi=this.m_functionStack[this.m_functionIndex],this.m_fi(););return -1!==this.m_currentEndHandle?this.getCurrentEndIndex_()>>1:-1}initialize_(){return this.m_tertiaryHandle=-1,this.m_nextTertiaryHandle=-1,this.m_forkedHandle=-1,this.m_currentEndHandle=-1,this.m_intervalTree.m_tertiaryNodes.size()>0?(this.m_functionStack[0]=this.pIn_,this.m_nextTertiaryHandle=this.m_intervalTree.m_root,!0):(this.m_functionIndex=-1,!1)}pIn_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,-1===this.m_tertiaryHandle)return this.m_functionIndex=-1,this.m_currentEndHandle=-1,!1;let t=this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle);if(this.m_query.vmax<t){let t=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),-1!==t&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(t),this.m_functionStack[++this.m_functionIndex]=this.left_),!0}if(t<this.m_query.vmin){let t=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),-1!==t&&(this.m_nextEndHandle=this.m_intervalTree.getLast_(t),this.m_functionStack[++this.m_functionIndex]=this.right_),!0}this.m_functionStack[this.m_functionIndex]=this.pL_,this.m_forkedHandle=this.m_tertiaryHandle;let e=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),-1!==e&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(e),this.m_functionStack[++this.m_functionIndex]=this.all_),!0}pL_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,-1===this.m_tertiaryHandle)return this.m_functionStack[this.m_functionIndex]=this.pR_,this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_forkedHandle),!0;if(this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle)<this.m_query.vmin){let t=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),-1!==t&&(this.m_nextEndHandle=this.m_intervalTree.getLast_(t),this.m_functionStack[++this.m_functionIndex]=this.right_),!0}let t=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),-1!==t&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(t),this.m_functionStack[++this.m_functionIndex]=this.all_);let e=this.m_intervalTree.getRptr_(this.m_tertiaryHandle);return -1!==e&&this.m_tertiaryStack.push(e),!0}pR_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,-1===this.m_tertiaryHandle)return this.m_functionStack[this.m_functionIndex]=this.pT_,!0;let t=this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle);if(this.m_query.vmax<t){let t=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),-1!==t&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(t),this.m_functionStack[++this.m_functionIndex]=this.left_),!0}let e=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),-1!==e&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(e),this.m_functionStack[++this.m_functionIndex]=this.all_);let s=this.m_intervalTree.getLptr_(this.m_tertiaryHandle);return -1!==s&&this.m_tertiaryStack.push(s),!0}pT_(){if(0===this.m_tertiaryStack.length)return this.m_functionIndex=-1,this.m_currentEndHandle=-1,!1;this.m_tertiaryHandle=this.m_tertiaryStack.at(-1),this.m_tertiaryStack.pop();let t=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return -1!==t&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(t),this.m_functionStack[++this.m_functionIndex]=this.all_),-1!==this.m_intervalTree.getLptr_(this.m_tertiaryHandle)&&this.m_tertiaryStack.push(this.m_intervalTree.getLptr_(this.m_tertiaryHandle)),-1!==this.m_intervalTree.getRptr_(this.m_tertiaryHandle)&&this.m_tertiaryStack.push(this.m_intervalTree.getRptr_(this.m_tertiaryHandle)),!0}left_(){return this.m_currentEndHandle=this.m_nextEndHandle,-1!==this.m_currentEndHandle&&J.isLeft_(this.getCurrentEndIndex_())&&this.m_intervalTree.getValue_(this.getCurrentEndIndex_())<=this.m_query.vmax?(this.m_nextEndHandle=this.getNext_(),!1):(this.m_functionIndex--,!0)}right_(){return this.m_currentEndHandle=this.m_nextEndHandle,-1!==this.m_currentEndHandle&&J.isRight_(this.getCurrentEndIndex_())&&this.m_intervalTree.getValue_(this.getCurrentEndIndex_())>=this.m_query.vmin?(this.m_nextEndHandle=this.getPrev_(),!1):(this.m_functionIndex--,!0)}all_(){return this.m_currentEndHandle=this.m_nextEndHandle,-1!==this.m_currentEndHandle&&J.isLeft_(this.getCurrentEndIndex_())?(this.m_nextEndHandle=this.getNext_(),!1):(this.m_functionIndex--,!0)}getNext_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getNext(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getNext(this.m_currentEndHandle)}getPrev_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getPrev(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getPrev(this.m_currentEndHandle)}getCurrentEndIndex_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getElement(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getData(this.m_currentEndHandle)}}class Z{constructor(){this.m_tolerance=0,this.m_sweepIndexRed=-1,this.m_sweepIndexBlue=-1,this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_intervalTreeRed=null,this.m_intervalTreeBlue=null,this.m_iteratorRed=null,this.m_iteratorBlue=null,this.m_envelopesRed=[],this.m_envelopesBlue=[],this.m_elementsRed=[],this.m_elementsBlue=[],this.m_sortedEndIndicesRed=new z(0),this.m_sortedEndIndicesBlue=new z(0),this.m_queuedListRed=-1,this.m_queuedListBlue=-1,this.m_queuedEnvelopes=new O,this.m_queuedIndicesRed=[],this.m_queuedIndicesBlue=[],this.m_bAddRed=!1,this.m_bAddBlue=!1,this.m_bAddRedRed=!1,this.m_bDone=!0,this.m_function=this.nullFunc_,this.reset_()}startConstruction(){this.reset_(),this.m_bAddRedRed=!0,this.m_elementsRed.length=0,this.m_envelopesRed.length=0}addEnvelope(t,e){this.m_bAddRedRed||(0,r.m)(""),this.m_elementsRed.push(t),this.m_envelopesRed.push(new n.J(e))}endConstruction(){this.m_bAddRedRed||(0,r.m)(""),this.m_bAddRedRed=!1,this.m_envelopesRed.length>0&&(this.m_function=this.initialize_,this.m_bDone=!1)}startRedConstruction(){this.reset_(),this.m_bAddRed=!0,this.m_elementsRed.length=0,this.m_envelopesRed.length=0}addRedEnvelope(t,e){this.m_bAddRed||(0,r.m)(""),this.m_elementsRed.push(t),this.m_envelopesRed.push(e.clone())}endRedConstruction(){this.m_bAddRed||(0,r.m)(""),this.m_bAddRed=!1,this.m_envelopesRed.length>0&&this.m_envelopesBlue.length>0&&(this.m_function===this.nullFunc_||this.m_function===this.initializeBlue_?this.m_function=this.initializeRedBlue_:this.m_function!==this.initializeRedBlue_&&(this.m_function=this.initializeRed_),this.m_bDone=!1)}startBlueConstruction(){this.reset_(),this.m_bAddBlue=!0,this.m_elementsBlue.length=0,this.m_envelopesBlue.length=0}addBlueEnvelope(t,e){this.m_bAddBlue||(0,r.m)(""),this.m_elementsBlue.push(t),this.m_envelopesBlue.push(e.clone())}endBlueConstruction(){this.m_bAddBlue||(0,r.m)(""),this.m_bAddBlue=!1,this.m_envelopesRed.length>0&&this.m_envelopesBlue.length>0&&(this.m_function===this.nullFunc_||this.m_function===this.initializeRed_?this.m_function=this.initializeRedBlue_:this.m_function!==this.initializeRedBlue_&&(this.m_function=this.initializeBlue_),this.m_bDone=!1)}next(){if(this.m_bDone)return!1;for(;this.m_function(););return!this.m_bDone}getHandleA(){return this.m_envelopeHandleA}getHandleB(){return this.m_envelopeHandleB}setTolerance(t){this.m_tolerance=t}getElement(t){return this.m_elementsRed[t]}getRedEnvelope(t){return this.m_envelopesRed[t]}getBlueEnvelope(t){return this.m_envelopesBlue[t]}getRedElement(t){return this.m_elementsRed[t]}getBlueElement(t){return this.m_elementsBlue[t]}isTop_(t){return!(1&~t)}isBottom_(t){return!(1&t)}reset_(){this.m_bAddRed=!1,this.m_bAddBlue=!1,this.m_bAddRedRed=!1,this.m_sweepIndexRed=-1,this.m_sweepIndexBlue=-1,this.m_queuedListRed=-1,this.m_queuedListBlue=-1,this.m_bDone=!0}initialize_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new J(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),null===this.m_iteratorRed&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_sortedEndIndicesRed.resize(0);for(let t=0;t<2*this.m_envelopesRed.length;t++)this.m_sortedEndIndicesRed.add(t);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,2*this.m_envelopesRed.length,!0),this.m_sweepIndexRed=2*this.m_envelopesRed.length,this.m_function=this.sweep_,!0}initializeRed_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new J(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),null===this.m_iteratorRed&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_sortedEndIndicesRed.resize(0);for(let t=0;t<2*this.m_envelopesRed.length;t++)this.m_sortedEndIndicesRed.add(t);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,this.m_sortedEndIndicesRed.size(),!0),this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),-1!==this.m_queuedListRed&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_function=this.sweepRedBlue_,this.resetBlue_()}initializeBlue_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeBlue||(this.m_intervalTreeBlue=new J(!0)),this.m_intervalTreeBlue.addEnvelopesRef(this.m_envelopesBlue),null==this.m_iteratorBlue&&(this.m_iteratorBlue=this.m_intervalTreeBlue.getIterator()),this.m_sortedEndIndicesBlue.resize(0);for(let t=0;t<2*this.m_envelopesBlue.length;t++)this.m_sortedEndIndicesBlue.add(t);return this.sortYEndIndices_(this.m_sortedEndIndicesBlue,0,this.m_sortedEndIndicesBlue.size(),!1),this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),-1!==this.m_queuedListBlue&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_function=this.sweepRedBlue_,this.resetRed_()}initializeRedBlue_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new J(!0)),this.m_intervalTreeBlue||(this.m_intervalTreeBlue=new J(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_intervalTreeBlue.addEnvelopesRef(this.m_envelopesBlue),null===this.m_iteratorRed&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),null===this.m_iteratorBlue&&(this.m_iteratorBlue=this.m_intervalTreeBlue.getIterator()),this.m_sortedEndIndicesRed.resize(0),this.m_sortedEndIndicesBlue.resize(0);for(let t=0;t<2*this.m_envelopesRed.length;t++)this.m_sortedEndIndicesRed.add(t);for(let t=0;t<2*this.m_envelopesBlue.length;t++)this.m_sortedEndIndicesBlue.add(t);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,this.m_sortedEndIndicesRed.size(),!0),this.sortYEndIndices_(this.m_sortedEndIndicesBlue,0,this.m_sortedEndIndicesBlue.size(),!1),this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),-1!==this.m_queuedListRed&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),-1!==this.m_queuedListBlue&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_function=this.sweepRedBlue_,!0}sweep_(){let t=this.m_sortedEndIndicesRed.read(--this.m_sweepIndexRed),e=t>>1;if(this.isBottom_(t))return this.m_intervalTreeRed.remove(e),0!==this.m_sweepIndexRed||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);let s=i.E.construct(this.m_envelopesRed[e].xmin,this.m_envelopesRed[e].xmax);return this.m_iteratorRed.resetIterator(s,this.m_tolerance),this.m_envelopeHandleA=e,this.m_function=this.iterate_,!0}sweepBruteForce_(){return -1==--this.m_sweepIndexRed?(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1):(this.m_envelopeHandleA=this.m_sweepIndexRed,this.m_sweepIndexBlue=this.m_sweepIndexRed,this.m_function=this.iterateBruteForce_,!0)}sweepRedBlueBruteForce_(){return -1==--this.m_sweepIndexRed?(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1):(this.m_envelopeHandleA=this.m_sweepIndexRed,this.m_sweepIndexBlue=this.m_envelopesBlue.length,this.m_function=this.iterateRedBlueBruteForce_,!0)}sweepRedBlue_(){let t=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed-1),e=this.m_sortedEndIndicesBlue.read(this.m_sweepIndexBlue-1),s=this.getAdjustedValue_(t,!0),i=this.getAdjustedValue_(e,!1);return s>i?this.sweepRed_():s<i?this.sweepBlue_():this.isTop_(t)?this.sweepRed_():this.isTop_(e)?this.sweepBlue_():this.sweepRed_()}sweepRed_(){let t=this.m_sortedEndIndicesRed.read(--this.m_sweepIndexRed),e=t>>1;if(this.isBottom_(t))return -1!==this.m_queuedListRed&&-1!==this.m_queuedIndicesRed[e]?(this.m_queuedEnvelopes.deleteElement(this.m_queuedListRed,this.m_queuedIndicesRed[e]),this.m_queuedIndicesRed[e]=-1):this.m_intervalTreeRed.remove(e),0!==this.m_sweepIndexRed||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);if(-1!==this.m_queuedListBlue&&this.m_queuedEnvelopes.getListSize(this.m_queuedListBlue)>0){let t=this.m_queuedEnvelopes.getFirst(this.m_queuedListBlue);for(;-1!==t;){let e=this.m_queuedEnvelopes.getData(t);this.m_intervalTreeBlue.insert(e),this.m_queuedIndicesBlue[e]=-1;let s=this.m_queuedEnvelopes.getNext(t);this.m_queuedEnvelopes.deleteElement(this.m_queuedListBlue,t),t=s}}if(this.m_intervalTreeBlue.size()>0){let t=i.E.construct(this.m_envelopesRed[e].xmin,this.m_envelopesRed[e].xmax);this.m_iteratorBlue.resetIterator(t,this.m_tolerance),this.m_envelopeHandleA=e,this.m_function=this.iterateBlue_}else -1===this.m_queuedListRed&&((0,i.w)(this.m_queuedIndicesRed,this.m_envelopesRed.length,-1),this.m_queuedListRed=this.m_queuedEnvelopes.createList(1)),this.m_queuedIndicesRed[e]=this.m_queuedEnvelopes.addElement(this.m_queuedListRed,e),this.m_function=this.sweepRedBlue_;return!0}sweepBlue_(){let t=this.m_sortedEndIndicesBlue.read(--this.m_sweepIndexBlue),e=t>>1;if(this.isBottom_(t))return -1!==this.m_queuedListBlue&&-1!==this.m_queuedIndicesBlue[e]?(this.m_queuedEnvelopes.deleteElement(this.m_queuedListBlue,this.m_queuedIndicesBlue[e]),this.m_queuedIndicesBlue[e]=-1):this.m_intervalTreeBlue.remove(e),0!==this.m_sweepIndexBlue||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);if(-1!==this.m_queuedListRed&&this.m_queuedEnvelopes.getListSize(this.m_queuedListRed)>0){let t=this.m_queuedEnvelopes.getFirst(this.m_queuedListRed);for(;-1!==t;){let e=this.m_queuedEnvelopes.getData(t);this.m_intervalTreeRed.insert(e),this.m_queuedIndicesRed[e]=-1;let s=this.m_queuedEnvelopes.getNext(t);this.m_queuedEnvelopes.deleteElement(this.m_queuedListRed,t),t=s}}if(this.m_intervalTreeRed.size()>0){let t=i.E.construct(this.m_envelopesBlue[e].xmin,this.m_envelopesBlue[e].xmax);this.m_iteratorRed.resetIterator(t,this.m_tolerance),this.m_envelopeHandleB=e,this.m_function=this.iterateRed_}else -1===this.m_queuedListBlue&&((0,i.w)(this.m_queuedIndicesBlue,this.m_envelopesBlue.length,-1),this.m_queuedListBlue=this.m_queuedEnvelopes.createList(0)),this.m_queuedIndicesBlue[e]=this.m_queuedEnvelopes.addElement(this.m_queuedListBlue,e),this.m_function=this.sweepRedBlue_;return!0}iterate_(){if(this.m_envelopeHandleB=this.m_iteratorRed.next(),-1!==this.m_envelopeHandleB)return!1;let t=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed)>>1;return this.m_intervalTreeRed.insert(t),this.m_function=this.sweep_,!0}iterateRed_(){if(this.m_envelopeHandleA=this.m_iteratorRed.next(),-1!==this.m_envelopeHandleA)return!1;this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1;let t=this.m_sortedEndIndicesBlue.read(this.m_sweepIndexBlue)>>1;return this.m_intervalTreeBlue.insert(t),this.m_function=this.sweepRedBlue_,!0}iterateBlue_(){if(this.m_envelopeHandleB=this.m_iteratorBlue.next(),-1!==this.m_envelopeHandleB)return!1;let t=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed)>>1;return this.m_intervalTreeRed.insert(t),this.m_function=this.sweepRedBlue_,!0}iterateBruteForce_(){if(-1==--this.m_sweepIndexBlue)return this.m_function=this.sweepBruteForce_,!0;let t=this.m_envelopesRed[this.m_sweepIndexRed].clone(),e=this.m_envelopesRed[this.m_sweepIndexBlue];return t.inflateCoords(this.m_tolerance,this.m_tolerance),!t.isIntersecting(e)||(this.m_envelopeHandleB=this.m_sweepIndexBlue,!1)}iterateRedBlueBruteForce_(){if(-1==--this.m_sweepIndexBlue)return this.m_function=this.sweepRedBlueBruteForce_,!0;let t=this.m_envelopesRed[this.m_sweepIndexRed].clone(),e=this.m_envelopesBlue[this.m_sweepIndexBlue];return t.inflateCoords(this.m_tolerance,this.m_tolerance),!t.isIntersecting(e)||(this.m_envelopeHandleB=this.m_sweepIndexBlue,!1)}resetRed_(){return this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_intervalTreeRed.size()>0&&this.m_intervalTreeRed.reset(),-1!==this.m_queuedListRed&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_bDone=!1,!0}resetBlue_(){return this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_intervalTreeBlue.size()>0&&this.m_intervalTreeBlue.reset(),-1!==this.m_queuedListBlue&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_bDone=!1,!0}nullFunc_(){return(0,r.c)("should not be called"),!1}sortYEndIndices_(t,e,s,i){let n=this;(new F).sort(t,e,s,{userSort(t,e,s){n.sortYEndIndicesHelper_(s,t,e,i)},getValue:t=>n.getAdjustedValue_(t,i)})}sortYEndIndicesHelper_(t,e,s,i){t.sort(e,s,(t,e)=>{let s=this.getAdjustedValue_(t,i),n=this.getAdjustedValue_(e,i);return s<n||s===n&&this.isBottom_(t)&&this.isTop_(e)?-1:1})}getAdjustedValue_(t,e){let s=.5*this.m_tolerance;if(e){let e=this.m_envelopesRed[t>>1];return this.isBottom_(t)?e.ymin-s:e.ymax+s}let i=this.m_envelopesBlue[t>>1];return this.isBottom_(t)?i.ymin-s:i.ymax+s}}class Q{constructor(t,e){this.tolerance=void 0!==t?t:Number.NaN,this.resolution=void 0!==e?e:Number.NaN}add(t){return new Q(this.tolerance+t,this.resolution)}scale(t){return new Q(this.tolerance*t,this.resolution*t)}total(){return this.tolerance+this.resolution}}function j(t,e,s,n,r){let h=n*n,m=t.sub(e),a=s.sub(e),o=m.sqrLength(),l=a.sqrLength();if(o<=h||l<=h)return!0;let _=(0,i.s)(m.crossProduct(a));return(_<=h*o||_<=h*l)&&m.dotProduct(a)>=0}function W(t,e,s){return i=>0===s?(i+t)*e:(i-t*e)/e}function K(t,e){let s=new n.J;return t.queryLooseEnvelope(s),s.mergeEnvelope2D(e),s}function $(t,e){let s=n.J.constructEmpty();t.queryLooseEnvelope(s);let i=n.J.constructEmpty();return e.queryLooseEnvelope(i),s.mergeEnvelope2D(i),s}function tt(t,e){return(Number.isFinite(t)||Number.isNaN(t))&&(Number.isFinite(e)||Number.isNaN(e))}function te(t,e){return Number.isFinite(t)&&Number.isFinite(e)}function ts(t,e,s){let i=n.J.constructEmpty();return i.setFromPoints(t,e),to(0,null,i.calculateToleranceFromEnvelope(),s,!1)}function ti(t,e,s){return to(0,t,e.calculateToleranceFromEnvelope(),s,!1)}function tn(t,e,s){return to(1,t,e.calculateToleranceFromEnvelope(),s,!1)}function tr(t,e,s){return tn(t,e.queryInterval(1,0),s)}function th(t,e,s){let i=n.J.constructEmpty();return e.queryEnvelope(i),ti(t,i,s)}function tm(t,e,s=!1){return to(0,t,e.calculateToleranceFromEnvelope(),s,!0).total()}function ta(t,e,s){let i=n.J.constructEmpty();return e.queryEnvelope(i),tm(t,i,s)}function to(t,e,s,i,n){let r=new Q(0,0);return null!==e&&(r.tolerance=e.getTolerance(t),(!n||i)&&null!==e)&&(r.resolution=e.getResolution(t),i&&(r.resolution*=2)),i&&(s*=4,r.tolerance*=1.01,r.resolution*=1.01),r.total()<s?new Q(s,0):r}function tl(t){return Math.sqrt(2)*(2*t.tolerance+t.resolution)}function t_(t){return Math.sqrt(2)*(t.tolerance+t.resolution)}function tu(t){return t>=3}function td(t,e){return t.getImpl().getIsSimple(e,[0])>=3}function tc(t,e){t.getImpl().setIsSimple(3,e)}function tx(t,e,s,n){if((0,i.s)(e.x-t.x)+(0,i.s)(e.y-t.y)<=s*s){let s=t.z,r=e.z;return(0,i.I)(s,r,n)}return!1}function tp(t){return t>=4}function tg(t,e){return t===r.G.enumPolygon?tu(e):e>=1}function ty(t,e,s){let i=n.J.constructEmpty(),r=n.J.constructEmpty();t.queryLooseEnvelope(i),e.queryLooseEnvelope(r),i.inflateCoords(s,s),r.inflateCoords(s,s);let h=n.J.constructEmpty();h.setCoords({env2D:i}),h.intersect(r);let m=t.querySegmentIterator(),a=e.querySegmentIterator(),o=n.J.constructEmpty(),l=n.J.constructEmpty(),_=new Z;_.setTolerance(s);let u=!1;for(_.startRedConstruction();m.nextPath();)for(;m.hasNextSegment();)m.nextSegment().queryLooseEnvelope(o),o.isIntersecting(h)&&(u=!0,_.addRedEnvelope(m.getStartPointIndex(),o));if(_.endRedConstruction(),!u)return null;let d=!1;for(_.startBlueConstruction();a.nextPath();)for(;a.hasNextSegment();)a.nextSegment().queryLooseEnvelope(l),l.isIntersecting(h)&&(d=!0,_.addBlueEnvelope(a.getStartPointIndex(),l));return _.endBlueConstruction(),d?_:null}function tf(t,e,s,i,r){t.getGeometryType(),e.getGeometryType();let h=n.J.constructEmpty(),m=n.J.constructEmpty();t.queryLooseEnvelope(h),e.queryLooseEnvelope(m),h.inflateCoords(s,s),m.inflateCoords(s,s);let a=n.J.constructEmpty();a.setCoords({env2D:h}),a.intersect(m);let o=new Z;o.setTolerance(s);let l=!1;o.startRedConstruction();for(let e=0,s=t.getPathCount();e<s;e++)t.queryLoosePathEnvelope(e,h),h.isIntersecting(a)&&(l=!0,o.addRedEnvelope(e,h));if(o.endRedConstruction(),!l)return null;let _=!1;o.startBlueConstruction();for(let t=0,s=e.getPathCount();t<s;t++)e.queryLoosePathEnvelope(t,m),m.isIntersecting(a)&&(_=!0,o.addBlueEnvelope(t,m));return o.endBlueConstruction(),_?o:null}function tv(t,e,s){let i=n.J.constructEmpty(),r=n.J.constructEmpty();t.queryLooseEnvelope(i),e.queryEnvelope(r),i.inflateCoords(s,s),r.inflateCoords(s,s);let h=n.J.constructEmpty();h.setCoords({env2D:i}),h.intersect(r);let m=t.querySegmentIterator(),a=new Z;a.setTolerance(s);let o=!1;for(a.startRedConstruction();m.nextPath();)for(;m.hasNextSegment();)m.nextSegment().queryLooseEnvelope(i),i.isIntersecting(h)&&(o=!0,a.addRedEnvelope(m.getStartPointIndex(),i));if(a.endRedConstruction(),!o)return null;let l=!1;a.startBlueConstruction();for(let t=0,s=e.getPointCount();t<s;t++){let s=e.getXY(t);h.contains(s)&&(l=!0,a.addBlueEnvelope(t,n.J.construct(s.x,s.y,s.x,s.y)))}return a.endBlueConstruction(),l?a:null}function tb(t,e,s){let r=n.J.constructEmpty(),h=n.J.constructEmpty();t.queryEnvelope(r),e.queryEnvelope(h),r.inflateCoords(s,s),h.inflateCoords(s,s);let m=n.J.constructEmpty();m.setCoords({env2D:r}),m.intersect(h);let a=new Z;a.setTolerance(s);let o=!1;a.startRedConstruction();let l=new i.P;for(let e=0,s=t.getPointCount();e<s;e++)t.queryXY(e,l),m.contains(l)&&(o=!0,a.addRedEnvelope(e,n.J.construct(l.x,l.y,l.x,l.y)));if(a.endRedConstruction(),!o)return null;let _=!1;a.startBlueConstruction();let u=new i.P;for(let t=0,s=e.getPointCount();t<s;t++)e.queryXY(t,u),m.contains(u)&&(_=!0,a.addBlueEnvelope(t,n.J.construct(u.x,u.y,u.x,u.y)));return a.endBlueConstruction(),_?a:null}function tE(t){let e=new n.J;return t.queryLooseEnvelope(e),e.inflateCoords(1,1),function(t,e,s){let i=new n.J;if(t.queryLooseEnvelope(i),i.isEmpty())return null;t.getGeometryType();let h=new V(i,8),m=-1,a=new n.J,o=!1;do for(let s=0,n=t.getPathCount();s<n;s++)if(t.queryLoosePathEnvelope(s,a),a.isIntersecting(e)){if(-1===(m=h.insertEx(s,a,m))){o&&(0,r.c)("build_quad_tree_for_paths"),i.assign(t.calculateEnvelope2D(!1)),o=!0,h.reset(i,8);break}o=!1}while(o);return h}(t,e)}function tN(t,e){if(!e){let e=new n.J;t.queryLooseEnvelope(e);let s=new V(e,8),i=-1,h=new n.J,m=t.querySegmentIterator(),a=!1;for(;m.nextPath();)for(;m.hasNextSegment();){let n=m.nextSegment(),o=m.getStartPointIndex();if(n.queryLooseEnvelope(h),-1===(i=s.insertEx(o,h,i))){a&&(0,r.c)(""),e.assign(t.calculateEnvelope2D(!1)),a=!0,s.reset(e,8),m.resetToFirstPath();break}}return s}let s=new n.J;t.queryLooseEnvelope(s);let i=new V(s,8),h=-1,m=new n.J,a=t.querySegmentIterator(),o=!1;for(;a.nextPath();)for(;a.hasNextSegment();){let n=a.nextSegment(),l=a.getStartPointIndex();if(n.queryLooseEnvelope(m),m.isIntersecting(e)&&-1===(h=i.insertEx(l,m,h))){o&&(0,r.c)(""),s.assign(t.calculateEnvelope2D(!1)),o=!0,i.reset(s,8),a.resetToFirstPath();break}}return i}function tC(t,e){if(e){let s=new V(e,8),h=new i.P,m=new n.J,a=!1;for(let i=0;i<t.getPointCount();i++)h.setCoordsPoint2D(t.getXY(i)),e.contains(h)&&(m.setCoords({pt:h}),-1!==s.insert(i,m)||(a&&(0,r.c)(""),a=!0,s.reset(t.calculateEnvelope2D(),8),i=-1));return s}return(0,r.b)("no-extent version not yet impl"),null}class tD{constructor(t){if(this.m_description=null,this.x=Number.NaN,this.y=Number.NaN,this.m_attribs=null,t){if(!t.copy)return t.move?(this.m_description=t.move.m_description,t.move.m_description=null,this.m_attribs=t.move.m_attribs,t.move.m_attribs=null,this.x=t.move.x,void(this.y=t.move.y)):t.vd?(this.m_description=t.vd,void(t.attribBuffer?(this.m_attribs=t.attribBuffer,t.initDefaultValues&&this.setDefaultAttributeValues()):this.ensureAttributes())):t.pt?(this.m_description=v(),void this.setXY(t.pt)):void("x"in t&&("z"in t?(this.m_description=b(),this.ensureAttributes(),this.setXYZ(new N(t.x,t.y,t.z))):(this.m_description=v(),this.setXYCoords(t.x,t.y))));t.copy.copyTo(this)}else this.m_description=v()}assignCopy(t){return this.m_attribs=null,t.copyTo(this),this}assignMove(t){return this.m_attribs=null,t.copyTo(this),t.setEmpty(),this}getXY(){return new i.P(this.x,this.y)}queryXY(t){t.x=this.x,t.y=this.y}setXY(t){this.x=t.x,this.y=t.y}setXYCoords(t,e){this.x=t,this.y=e}getXYZ(){let t=new N;return t.x=this.x,t.y=this.y,t.z=this.getZ(),t}setXYZ(t){this.addAttribute(1),this.x=t.x,this.y=t.y,this.m_attribs[0]=t.z}getX(){return this.x}setX(t){this.x=t}getY(){return this.y}setY(t){this.y=t}getZ(){return this.m_description.hasZ()?this.m_attribs[0]:d.getDefaultValue(1)}setZ(t){this.addAttribute(1),this.m_attribs[0]=t}getM(){return this.getAttributeAsDbl(2,0)}setM(t){this.addAttribute(2),this.m_description.hasZ()?this.m_attribs[1]=t:this.m_attribs[0]=t}getID(){return this.getAttributeAsInt(3,0)}setID(t){this.setAttributeBasic(3,0,t)}isEqualXY(t,e){return void 0===e&&(e=0),Math.abs(t.x-this.x)<=e&&Math.abs(t.y-this.y)<=e}isEqualXYCoords(t,e,s){return void 0===s&&(s=0),Math.abs(t-this.x)<=s&&Math.abs(e-this.y)<=s}getAttributeAsDbl(t,e){if(0===t){if(0===e)return this.x;if(1===e)return this.y;(0,r.n)("")}let s=d.getComponentCount(t);(e<0||e>=s)&&(0,r.n)("");let i=this.m_description.getAttributeIndex(t);return i>=0?this.m_attribs[this.m_description.getPointAttributeOffset(i)-2+e]:d.getDefaultValue(t)}getAttributeAsInt(t,e){return Math.trunc(this.getAttributeAsDbl(t,e))}setAttributeBasic(t,e,s){if(0===t)return void(0===e?this.x=s:1===e?this.y=s:(0,r.n)(""));let i=d.getComponentCount(t);(e<0||e>=i)&&(0,r.n)("");let n=this.m_description.getAttributeIndex(t);n<0&&(this.addAttribute(t),n=this.m_description.getAttributeIndex(t)),this.m_attribs[this.m_description.getPointAttributeOffset(n)-2+e]=s}copyAttributesFrom(t,e){if(this===t)return;let s=t.getDescription();for(let i=e&&s.hasZ()?2:1,n=s.getAttributeCount();i<n;++i){let e=s.getSemantics(i),n=d.getComponentCount(e);for(let s=0;s<n;++s){let i=t.getAttributeAsDbl(e,s);this.setAttributeBasic(e,s,i)}}}getAttributeArray(){return this.m_attribs}getDescription(){return this.m_description}assignVertexDescription(t){this.m_description!==t&&this.assignVertexDescriptionImpl(t)}mergeVertexDescription(t){this.m_description!==t&&(this.m_description.hasAttributesFrom(t)||this.mergeVertexDescriptionImpl(t))}hasAttribute(t){return this.m_description.hasAttribute(t)}addAttribute(t){if(this.m_description.hasAttribute(t))return;let e=y(this.m_description,t);this.assignVertexDescription(e)}dropAttribute(t){if(!this.m_description.hasAttribute(t))return;let e=f(this.m_description,t);this.assignVertexDescription(e)}dropAllAttributes(){let t=v();t!==this.m_description&&this.assignVertexDescription(t)}getGeometryType(){return r.G.enumPoint}getDimension(){return 0}queryEnvelope(t){if(t instanceof tq)return t.setEmpty(),t.assignVertexDescription(this.m_description),void t.merge(this);if(t instanceof C){if(this.isEmpty())return void t.setEmpty();let e=this.getXYZ();return t.xmin=e.x,t.ymin=e.y,t.zmin=e.z,t.xmax=e.x,t.ymax=e.y,void(t.zmax=e.z)}this.isEmpty()?t.setEmpty():(t.xmin=this.x,t.ymin=this.y,t.xmax=this.x,t.ymax=this.y)}queryLooseEnvelope(t){this.queryEnvelope(t)}queryInterval(t,e){let s=new i.E;if(this.isEmpty())return s.setEmpty(),s;let n=this.getAttributeAsDbl(t,e);return s.vmin=n,s.vmax=n,s}applyTransformation(t){if(!this.isEmpty()){if(1===t.m_TransformationType){let e=this.getXY();return t.transformInPlace(e),void this.setXY(e)}(0,r.b)("3d not impl")}}transformAttribute(t,e,s,i,n){if(this.isEmpty())return;this.addAttribute(t);let r=this.getAttributeAsDbl(t,e),h=W(s,i,n);this.setAttributeBasic(t,e,h(r))}createInstance(){return new tD({vd:this.m_description})}copyTo(t){this!==t&&(t.getGeometryType()!==r.G.enumPoint&&(0,r.t)(),t.x=this.x,t.y=this.y,this.m_attribs?(t.assignVertexDescription(this.m_description),t.m_attribs=this.m_attribs.slice()):(t.releaseAttributes(),t.assignVertexDescription(this.m_description)))}isEmpty(){return Number.isNaN(this.x)||Number.isNaN(this.y)}setEmpty(){this.m_description||(this.m_description=v(),this.releaseAttributes()),this.x=Number.NaN,this.y=Number.NaN,this.m_attribs&&(0,i.a)(this.m_attribs,this.m_description.getDefaultPointAttributes(),0,2,this.m_description.getTotalComponentCount()-2)}calculateArea2D(){return 0}calculateLength2D(){return 0}calculateLength3D(t){return 0}equals(t,e){if(t===this)return!0;if(t.getGeometryType()!==r.G.enumPoint||this.m_description!==t.m_description||this.isEmpty()!==t.isEmpty())return!1;if(this.isEmpty())return!0;if(void 0===e&&(e=0),Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e)return!1;for(let s=0,n=this.m_description.getTotalComponentCount()-2;s<n;s++)if(!(0,i.I)(this.m_attribs[s],t.m_attribs[s],e))return!1;return!0}getBoundary(){return null}clone(){let t=new tD({vd:this.m_description});return this.copyTo(t),t}swap(t){this!==t&&(t.getGeometryType()!==r.G.enumPoint&&(0,r.t)("wrong geometry type"),t.m_description=(0,i.b)(this.m_description,this.m_description=t.m_description),t.x=(0,i.b)(this.x,this.x=t.x),t.y=(0,i.b)(this.y,this.y=t.y),t.m_attribs=(0,i.b)(this.m_attribs,this.m_attribs=t.m_attribs))}replaceNaNs(t,e){if(this.addAttribute(t),this.isEmpty())return;let s=d.getComponentCount(t);for(let i=0;i<s;i++)Number.isNaN(this.getAttributeAsDbl(t,i))&&this.setAttributeBasic(t,i,e)}lerp(t,e,s){if(t.getDescription()!==e.getDescription()&&(0,r.t)("Point.lerp"),this.assignVertexDescription(t.getDescription()),t.isEmpty()||e.isEmpty())return this.setEmpty(),this;this.ensureAttributes();let n=u();t.queryValues(n,n.length);let h=u();e.queryValues(h,h.length);let m=u(),a=n,o=h,l=0;for(let t=0,e=this.m_description.getAttributeCount();t<e;t++){let e=this.m_description.getSemantics(t),n=d.getInterpolation(e),r=d.getComponentCount(e),h=d.getDefaultValue(e);(0,i.B)(n,a,o,m,l,r,s,h),a=a.slice(r),o=o.slice(r),l+=r}return this.setValues(m,l),this}setDefaultAttributeValues(){let t=this.m_description.getTotalComponentCount()-2;t>0&&(this.m_attribs?(0,i.a)(this.m_attribs,this.m_description.getDefaultPointAttributes(),0,2,t):this.m_attribs=this.m_description.getDefaultPointAttributes().slice(2))}static sqrDistance2D(t,e){return i.P.sqrDistanceCoords(t.x,t.y,e.x,e.y)}getImpl(){return this}mergeVertexDescriptionImpl(t){let e=g(this.getDescription(),t);this.assignVertexDescription(e)}releaseAttributes(){this.m_attribs=null}assignVertexDescriptionImpl(t){this.m_description||(this.m_description=v());let e=c();E(t,this.m_description,e);let s=null;t.getTotalComponentCount()-2>0&&(s=t.getDefaultPointAttributes().slice(2));for(let i=1,n=t.getAttributeCount();i<n;i++){let n=e[i];if(-1!==n){let e=this.m_description.getPointAttributeOffset(n)-2,r=t.getPointAttributeOffset(i)-2,h=d.getComponentCount(t.getSemantics(i));for(let t=0;t<h;t++)s[r+t]=this.m_attribs[e+t]}}this.m_attribs=s,this.m_description=t}ensureAttributes(){this.m_description.getTotalComponentCount()-2>0&&null===this.m_attribs&&(this.m_attribs=this.m_description.getDefaultPointAttributes().slice(2))}queryValues(t,e){let s=this.m_description.getTotalComponentCount();(0,r.g)(s<=e),t[0]=this.x,t[1]=this.y,(0,i.a)(t,this.m_attribs,2,0,s-2)}copyCommonAttributesTo(t){t.x=this.x,t.y=this.y;let e=t.getDescription();if(e===this.m_description)this.m_attribs&&(0,i.a)(t.m_attribs,this.m_attribs,0,0,this.m_description.getTotalComponentCount()-2);else{let s=0;for(let i=1,n=e.getAttributeCount();i<n;i++){let n=e.getSemantics(i),r=d.getComponentCount(n);if(this.m_description.hasAttribute(n)){let e=this.m_description.getPointAttributeOffset(this.m_description.getAttributeIndex(n))-2;for(;0!==r;)t.m_attribs[s++]=this.m_attribs[e++],r--}else{let e=d.getDefaultValue(n);for(;0!==r;)t.m_attribs[s++]=e,r--}}}}setValues(t,e){let s=this.m_description.getTotalComponentCount();(0,r.g)(s<=e),this.x=t[0],this.y=t[1],(0,i.a)(this.m_attribs,t,0,2,s-2)}dbgDefaultAttribs(){}}function tI(t,e){return e*(t.getTotalComponentCount()-2)}tD.type=r.G.enumPoint;class tP{constructor(t){if(this.m_attributes=null,t)if(void 0!==t.xmin)this.m_envelope2D=new n.J(t.xmin,t.ymin,t.xmax,t.ymax);else if(void 0!==t.env2D)this.m_envelope2D=new n.J(t.env2D);else if(t.move)this.m_envelope2D=new n.J(t.move.m_envelope2D),this.m_attributes=t.move.m_attributes,t.move.m_attributes=null;else{if(!t.moveEnv)throw Error("unrecognized EnvelopeData constructor options");{let e=t.moveEnv.accessEnvelopeData();this.m_envelope2D=new n.J(e.m_envelope2D),this.m_attributes=e.m_attributes,e.m_attributes=null}}else this.m_envelope2D=n.J.constructEmpty()}ensureAttributes(t){let e=t.getTotalComponentCount()-2;!this.m_attributes&&e&&(this.m_attributes=(0,i.d)(2*e,Number.NaN),this.m_attributes.fill(Number.NaN))}copyTo(t,e){let s=t.getTotalComponentCount()-2;e.m_description!==t&&(e.releaseAttributes_(),e.m_description=t,s&&(e.m_data.m_attributes=(0,i.d)(2*s,Number.NaN))),s&&((0,r.g)(this.m_attributes&&e.m_data.m_attributes),(0,i.a)(e.m_data.m_attributes,this.m_attributes,0,0,2*s)),e.m_data.m_envelope2D=new n.J(this.m_envelope2D)}copyToIfNotNull(t,e){e.m_envelope2D=new n.J(this.m_envelope2D),e.releaseAttributes(),t.getTotalComponentCount()-2&&this.m_attributes&&(e.m_attributes=this.m_attributes.slice())}releaseAttributes(){this.m_attributes=null}isEmpty(){return this.m_envelope2D.isEmpty()}transformAttribute(t,e,s,i,n){(0,r.g)(0)}queryInterval(t,e,s,i){if(this.isEmpty())return void i.setEmpty();if(0===e)return void(0===s?this.m_envelope2D.queryIntervalX(i):1===s?this.m_envelope2D.queryIntervalY(i):(0,r.n)(""));let n=d.getComponentCount(e);(s<0||s>=n)&&(0,r.n)("");let h=t.getAttributeIndex(e);if(h>=0)return i.vmin=this.m_attributes[tI(t,0)+t.getPointAttributeOffset(h)-2+s],void(i.vmax=this.m_attributes[tI(t,1)+t.getPointAttributeOffset(h)-2+s]);{let t=d.getDefaultValue(e);return void i.setCoords(t,t)}}queryEnvelope3D(t,e){let s=new i.E;this.queryInterval(t,1,0,s),e.setCoords(this.m_envelope2D.xmin,this.m_envelope2D.ymin,s.vmin,this.m_envelope2D.xmax,this.m_envelope2D.ymax,s.vmax)}setEmpty(t){this.m_envelope2D.setEmpty();let e=t.getTotalComponentCount()-2;e&&(this.m_attributes?this.dbgAssertSize(e):this.m_attributes=(0,i.d)(2*e,Number.NaN),this.m_attributes.fill(Number.NaN))}dbgAssertSize(t){}}let tq=class t{constructor(t){if(this.m_EnvelopeType=4,this.m_description=v(),void 0===t)this.m_data=new tP;else if(void 0!==t.vd)this.m_description=t.vd,this.m_data=new tP,this.ensureAttributes_();else if(t?.env2D)this.m_data=new tP({env2D:t.env2D});else if(void 0!==t.xmin)this.m_data=new tP({xmin:t.xmin,ymin:t.ymin,xmax:t.xmax,ymax:t.ymax});else if(t.copy)this.m_data=new tP,t.copy.copyTo(this);else if(t.move)this.m_description=t.move.m_description,t.move.m_description=null,this.m_data=new tP({move:t.move.m_data});else{if(!t.centerPoint)throw Error("unrecognized Envelope constructor options");this.m_description=t.centerPoint.getDescription(),this.m_data=new tP,this.ensureAttributes_(),this.setFromPoint(t.centerPoint,t.width,t.height)}}accessEnvelopeData(){return this.m_description=null,this.m_data}assignMove(t){return this===t||(this.m_description=t.m_description,t.m_description=null,this.m_data=new tP({move:t.m_data})),this}assignCopy(t){return this===t||t.copyTo(this),this}transformAttribute(t,e,s,i,n){(0,r.g)(0)}setAttributeBasic(t,e,s){if(this.addAttribute(t),this.m_data.isEmpty())return;let i=this.queryInterval(t,e);i.vmin=s,i.vmax=s,this.setIntervalEnvelope(t,e,i)}mergeVertexDescriptionImpl(t){let e=g(this.getDescription(),t);this.assignVertexDescription(e)}asEnvelope2D(){return new n.J(this.m_data.m_envelope2D)}assignVertexDescription(t){this.m_description!==t&&this.assignVertexDescriptionImpl(t)}getGeometryType(){return r.G.enumEnvelope}getDimension(){return 2}getXMin(){return this.m_data.m_envelope2D.xmin}getYMin(){return this.m_data.m_envelope2D.ymin}getXMax(){return this.m_data.m_envelope2D.xmax}getYMax(){return this.m_data.m_envelope2D.ymax}width(){return this.m_data.isEmpty()?Number.NaN:this.m_data.m_envelope2D.width()}height(){return this.m_data.isEmpty()?Number.NaN:this.m_data.m_envelope2D.height()}getCenterXY(){return this.m_data.isEmpty()?new i.P:this.m_data.m_envelope2D.getCenter()}getCenter(t){if(t.assignVertexDescription(this.m_description),this.m_data.isEmpty())return void t.setEmpty();let e=this.m_description.getAttributeCount();for(let s=1;s<e;s++){let e=this.m_description.getSemantics(s),i=d.getComponentCount(e);for(let s=0;s<i;s++){let i=.5*(this.getAttributeAsDblImpl(0,e,s)+this.getAttributeAsDblImpl(1,e,s));t.setAttributeBasic(e,s,i)}}t.setXY(this.m_data.m_envelope2D.getCenter())}setCoords(t,e,s,i){this.m_data.m_envelope2D.setCoords({xmin:t,ymin:e,xmax:s,ymax:i})}setEnvelope(t){if(t instanceof n.J)this.m_data.m_envelope2D=new n.J(t),this.m_data.m_envelope2D.normalize();else{this.addAttribute(1),this.m_data.m_envelope2D=t.getEnvelope2D(),this.m_data.m_envelope2D.normalize();let e=i.E.constructEmpty();e.setCoords(t.zmin,t.zmax),this.setInterval(1,0,e.vmin,e.vmax)}}merge(e){if(e instanceof n.J)return e.isValid()||(0,r.t)(""),void this.m_data.m_envelope2D.mergeEnvelope2D(e);if(e instanceof t){if(e.m_data.isEmpty())return;let t=e.getDescription();this.mergeVertexDescription(t),this.m_data.m_envelope2D.mergeEnvelope2D(e.m_data.m_envelope2D);for(let s=1,i=t.getAttributeCount();s<i;s++){let i=t.getSemantics(s),n=d.getComponentCount(i);for(let t=0;t<n;t++){let s=e.queryInterval(i,t),n=this.queryInterval(i,t);n.merge(s),this.setIntervalEnvelope(i,t,n)}}}else if(e instanceof tD){if(e.isEmpty())return;let t=e.getDescription();if(this.mergeVertexDescription(t),this.m_data.isEmpty())return void this.setFromPoint(e);this.m_data.m_envelope2D.merge(e.getXY());for(let s=1,i=t.getAttributeCount();s<i;s++){let i=t.getSemantics(s),n=d.getComponentCount(i);for(let t=0;t<n;t++){let s=e.getAttributeAsDbl(i,t),n=this.queryInterval(i,t);n.mergeCoordinate(s),this.setIntervalEnvelope(i,t,n)}}}else(0,r.b)("unrecognized type for envelope.merge")}intersect(t){if(!this.m_data.m_envelope2D.intersect(t.m_data.m_envelope2D))return this.setEmpty(),!1;let e=t.getDescription();this.mergeVertexDescription(e);for(let e=1,s=this.m_description.getAttributeCount();e<s;e++){let s=this.m_description.getSemantics(e),i=d.getComponentCount(s);for(let e=0;e<i;e++){let i=t.queryInterval(s,e),n=this.queryInterval(s,e);n.intersect(i),this.setIntervalEnvelope(s,e,n)}}return!0}intersectCommonAttributes(t){if(!this.m_data.m_envelope2D.intersect(t.m_data.m_envelope2D))return this.setEmpty(),!1;let e=t.getDescription();for(let s=1,i=this.m_description.getAttributeCount();s<i;s++){let i=this.m_description.getSemantics(s);if(!e.hasAttribute(i))continue;let n=d.getComponentCount(i);for(let e=0;e<n;e++){let s=t.queryInterval(i,e),n=this.queryInterval(i,e);n.intersect(s),this.setIntervalEnvelope(i,e,n)}}return!0}move(t,e){this.m_data.m_envelope2D.move(t,e)}centerAt(t,e){this.m_data.m_envelope2D.centerAtCoords(t,e)}centerAtPoint(t){this.m_data.m_envelope2D.centerAt(t)}reaspect(t,e){this.m_data.m_envelope2D.reaspect(t,e)}inflateCoords(t,e){this.m_data.m_envelope2D.inflateCoords(t,e)}containsCoords(t,e){return this.m_data.m_envelope2D.containsCoords(t,e)}contains(t){return this.m_data.m_envelope2D.contains(t)}containsPoint(t){return!t.isEmpty()&&this.m_data.m_envelope2D.contains(t.getXY())}containsEnvelope(t){return this.m_data.m_envelope2D.containsEnvelope(t.m_data.m_envelope2D)}setIntervalEnvelope(t,e,s){if(this.addAttribute(t),this.m_data.isEmpty())return;let n=new i.E(s);if(n.normalize(),0===t){if(n.isEmpty())return void this.setEmpty();0===e?(this.m_data.m_envelope2D.xmin=n.vmin,this.m_data.m_envelope2D.xmax=n.vmax):1===e?(this.m_data.m_envelope2D.ymin=n.vmin,this.m_data.m_envelope2D.ymax=n.vmax):(0,r.n)("")}else this.setAttributeAsDblImpl(0,t,e,n.vmin),this.setAttributeAsDblImpl(1,t,e,n.vmax)}setInterval(t,e,s,n){this.setIntervalEnvelope(t,e,new i.E(s,n))}queryInterval(t,e){let s=new i.E;return this.m_data.queryInterval(this.m_description,t,e,s),s}queryEnvelope(t){2!==t.m_EnvelopeType?3!==t.m_EnvelopeType?4!==t.m_EnvelopeType?(0,r.b)("unrecognized type for queryEnveloper"):this.copyTo(t):this.m_data.queryEnvelope3D(this.m_description,t):t.setCoords({env2D:this.m_data.m_envelope2D})}applyTransformation(t){1!==t.m_TransformationType?(0,r.g)(0):t.transformEnvInPlace(this.m_data.m_envelope2D)}createInstance(){return new t({vd:this.m_description})}copyTo(t){t!==this&&this.m_data.copyTo(this.m_description,t)}isEmpty(){return this.m_data.isEmpty()}setEmpty(){this.m_description||(this.m_description=v()),this.m_data.setEmpty(this.m_description)}calculateArea2D(){return this.m_data.m_envelope2D.getArea()}calculateLength2D(){return this.m_data.m_envelope2D.getLength()}calculateLength3D(t){return(0,r.g)(0),0}equals(t,e){if(t===this)return!0;if(this.m_description!==t.m_description||this.m_data.isEmpty()!==t.m_data.isEmpty())return!1;if(this.m_data.isEmpty())return!0;if(void 0===e&&(e=0),Math.abs(this.m_data.m_envelope2D.xmin-t.m_data.m_envelope2D.xmin)>e||Math.abs(this.m_data.m_envelope2D.ymin-t.m_data.m_envelope2D.ymin)>e||Math.abs(this.m_data.m_envelope2D.xmax-t.m_data.m_envelope2D.xmax)>e||Math.abs(this.m_data.m_envelope2D.ymax-t.m_data.m_envelope2D.ymax)>e)return!1;for(let s=0,n=2*(this.m_description.getTotalComponentCount()-2);s<n;s++)if(!(0,i.I)(this.m_data.m_attributes[s],t.m_data.m_attributes[s],e))return!1;return!0}getBoundary(){return(0,r.b)("getBoundary not available in this context. Use the boundary operator with an envelope parameter"),null}clone(){return new t({copy:this})}swap(t){this!==t&&(t.getGeometryType()!==r.G.enumEnvelope&&(0,r.t)("wrong geometry type"),t.m_description=(0,i.b)(this.m_description,this.m_description=t.m_description),t.m_data.m_envelope2D=(0,i.b)(this.m_data.m_envelope2D,this.m_data.m_envelope2D=t.m_data.m_envelope2D),t.m_data.m_attributes=(0,i.b)(this.m_data.m_attributes,this.m_data.m_attributes=t.m_data.m_attributes))}queryCoordinates(t){this.m_data.isEmpty()&&(0,r.t)(""),this.m_data.m_envelope2D.queryCorners(t)}queryCornerByVal(t,e){(t<0||t>3)&&(0,r.n)(""),e.assignVertexDescription(this.m_description);let s=this.getDescription().getAttributeCount();for(let i=1;i<s;i++){let s=this.m_description.getSemantics(i),n=d.getComponentCount(s);for(let i=0;i<n;i++)e.setAttributeBasic(s,i,this.getAttributeAsDblImpl(t%2,s,i))}e.setXY(this.m_data.m_envelope2D.queryCorner(t))}queryCorner(t,e){e.assign(this.m_data.m_envelope2D.queryCorner(t))}getDescription(){return this.m_description}mergeVertexDescription(t){this.m_description!==t&&(this.m_description&&this.m_description.hasAttributesFrom(t)||this.mergeVertexDescriptionImpl(t))}hasAttribute(t){return this.m_description.hasAttribute(t)}addAttribute(t){if(this.m_description.hasAttribute(t))return;let e=y(this.m_description,t);this.assignVertexDescription(e)}dropAttribute(t){if(!this.m_description.hasAttribute(t))return;let e=f(this.m_description,t);this.assignVertexDescription(e)}dropAllAttributes(){let t=v();t!==this.m_description&&this.assignVertexDescription(t)}queryLooseEnvelope(t){this.queryEnvelope(t)}replaceNaNs(t,e){if(this.addAttribute(t),this.m_data.isEmpty())return;let s=d.getComponentCount(t);for(let i=0;i<s;i++){let s=this.queryInterval(t,i);s.isEmpty()&&(s.vmin=e,s.vmax=e,this.setIntervalEnvelope(t,i,s))}}getImpl(){return this}setFromPoint(t,e,s){this.m_data.m_envelope2D.setCoords({center:t.getXY(),width:e??0,height:s??0});let i=t.getDescription();for(let e=1,s=i.getAttributeCount();e<s;e++){let s=i.getSemantics(e),n=d.getComponentCount(s);for(let e=0;e<n;e++){let i=t.getAttributeAsDbl(s,e);this.setInterval(s,e,i,i)}}}assignVertexDescriptionImpl(t){let e=c();E(t,this.m_description,e);let s=null,n=t.getTotalComponentCount()-2,r=this.m_description?this.m_description.getTotalComponentCount()-2:0;n>0&&(s=(0,i.d)(2*n,Number.NaN));for(let h=1;h<t.getAttributeCount();h++){let m=e[h];if(-1!==m){let e=t.getPointAttributeOffset(h)-2,a=d.getComponentCount(t.getSemantics(h)),o=this.m_description.getPointAttributeOffset(m)-2;(0,i.a)(s,this.m_data.m_attributes,e,o,a),(0,i.a)(s,this.m_data.m_attributes,n+e,r+o,a)}}this.releaseAttributes_(),this.m_data.m_attributes=s,this.m_description=t}getAttributeAsDblImpl(t,e,s){if(this.m_data.isEmpty()&&(0,r.u)(""),0===e)return t?s?this.m_data.m_envelope2D.ymax:this.m_data.m_envelope2D.xmax:s?this.m_data.m_envelope2D.ymin:this.m_data.m_envelope2D.xmin;s>=d.getComponentCount(e)&&(0,r.n)("");let i=this.m_description.getAttributeIndex(e);return i>=0?this.m_data.m_attributes[tI(this.m_description,t)+this.m_description.getPointAttributeOffset(i)-2+s]:d.getDefaultValue(e)}setAttributeAsDblImpl(t,e,s,i){0===e&&(t?1===s?this.m_data.m_envelope2D.ymax=i:0===s?this.m_data.m_envelope2D.xmax=i:(0,r.n)(""):1===s?this.m_data.m_envelope2D.ymin=i:0===s?this.m_data.m_envelope2D.xmin=i:(0,r.n)(""));let n=d.getComponentCount(e);(s<0||s>=n)&&(0,r.n)(""),this.addAttribute(e);let h=this.m_description.getAttributeIndex(e);this.m_data.m_attributes[tI(this.m_description,t)+this.m_description.getPointAttributeOffset(h)-2+s]=i}releaseAttributes_(){this.m_data.releaseAttributes()}ensureAttributes_(){this.m_data.ensureAttributes(this.m_description)}};tq.type=r.G.enumEnvelope,Object.freeze(Object.defineProperty({__proto__:null,Envelope:tq,EnvelopeData:tP},Symbol.toStringTag,{value:"Module"}))},73750:(t,e,s)=>{s.d(e,{J:()=>r});var i=s(16404),n=s(92656);class r{static construct(t,e,s,i){return new r(t,e,s,i)}constructor(t,e,s,i){this.m_EnvelopeType=2,void 0===t?(this.xmin=Number.NaN,this.ymin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN):"number"==typeof t?(this.xmin=t,this.ymin=e,this.xmax=s,this.ymax=i):(this.xmin=t.xmin,this.ymin=t.ymin,this.xmax=t.xmax,this.ymax=t.ymax),this.normalize()}static constructEmpty(){return new r(Number.NaN,Number.NaN,Number.NaN,Number.NaN)}clone(){return new r(this)}assign(t){return this.xmin=t.xmin,this.xmax=t.xmax,this.ymin=t.ymin,this.ymax=t.ymax,this}width(){return this.xmax-this.xmin}height(){return this.ymax-this.ymin}maxDimension(){return Math.max(this.width(),this.height())}minDimension(){return Math.min(this.width(),this.height())}sqrDiagonal(){let t=this.width(),e=this.height();return t*t+e*e}diagonal(){return Math.sqrt(this.sqrDiagonal())}getCenterX(){return .5*(this.xmin+this.xmax)}getCenterY(){return .5*(this.ymin+this.ymax)}getCenter(){return n.P.construct(this.getCenterX(),this.getCenterY())}queryCenter(t){t.x=.5*(this.xmin+this.xmax),t.y=.5*(this.ymin+this.ymax)}setEmpty(){this.xmin=Number.NaN,this.ymin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN}setInfinite(){this.xmin=Number.NEGATIVE_INFINITY,this.xmax=Number.POSITIVE_INFINITY,this.ymin=Number.NEGATIVE_INFINITY,this.ymax=Number.POSITIVE_INFINITY}isDegenerate(t){return!this.isEmpty()&&(this.width()<=t||this.height()<=t)}isZero(){return!(this.isEmpty()||this.width()&&this.height())}isEmpty(){return Number.isNaN(this.xmin)||Number.isNaN(this.ymin)||Number.isNaN(this.xmax)||Number.isNaN(this.ymax)}mergeNeCoords(t,e){this.xmin>t?this.xmin=t:this.xmax<t&&(this.xmax=t),this.ymin>e?this.ymin=e:this.ymax<e&&(this.ymax=e)}mergeNe(t){this.mergeNeCoords(t.x,t.y)}mergeCoords(t,e){this.isEmpty()?(this.xmin=t,this.ymin=e,this.xmax=t,this.ymax=e):(this.xmin>t?this.xmin=t:this.xmax<t&&(this.xmax=t),this.ymin>e?this.ymin=e:this.ymax<e&&(this.ymax=e))}merge(t){this.mergeCoords(t.x,t.y)}mergeEnvelope2D(t){t.isEmpty()||(this.mergeCoords(t.xmin,t.ymin),this.mergeNeCoords(t.xmax,t.ymax))}mergePoints(t,e){for(let s=0;s<e;){if(!this.isEmpty()){for(let i=s;i<e;i++)this.mergeNe(t[i]);break}this.setCoords(t[s]),s++}}mergePointsInterleaved(t,e,s){for(let i=2*e,n=i+2*s;i<n;i+=2)this.mergeCoords(t.read(i),t.read(i+1))}inflateCoords(t,e){this.isEmpty()||(this.xmin-=t,this.xmax+=t,this.ymin-=e,this.ymax+=e,(this.xmin>this.xmax||this.ymin>this.ymax)&&this.setEmpty())}getInflatedCoords(t,e){let s=this.clone();return s.inflateCoords(t,e),s}inflate(t){this.inflateCoords(t,t)}getInflated(t){let e=this.clone();return e.inflateCoords(t,t),e}zoom(t,e){this.isEmpty()||this.setCoords({center:this.getCenter(),width:t*this.width(),height:e*this.height()})}scale(t){t<0&&this.setEmpty(),this.xmin*=t,this.xmax*=t,this.ymin*=t,this.ymax*=t}equals(t,e){return!(!this.isEmpty()||!t.isEmpty())||(e?Math.abs(this.xmin-t.xmin)<=e&&Math.abs(this.ymin-t.ymin)<=e&&Math.abs(this.xmax-t.xmax)<=e&&Math.abs(this.ymax-t.ymax)<=e:this.xmin===t.xmin&&this.ymin===t.ymin&&this.xmax===t.xmax&&this.ymax===t.ymax)}setCoords(t){void 0!==t.xmin?(this.xmin=t.xmin,this.xmax=t.xmax,this.ymin=t.ymin,this.ymax=t.ymax):void 0!==t.x?(this.xmin=t.x,this.xmax=t.x,this.ymin=t.y,this.ymax=t.y):void 0!==t.pt1?(this.xmin=t.pt1.x,this.ymin=t.pt1.y,this.xmax=t.pt2.x,this.ymax=t.pt2.y,this.normalize()):void 0!==t.env2D?(this.xmin=t.env2D.xmin,this.xmax=t.env2D.xmax,this.ymin=t.env2D.ymin,this.ymax=t.env2D.ymax,this.normalize()):void 0!==t.pt?(this.xmin=t.pt.x,this.xmax=t.pt.x,this.ymin=t.pt.y,this.ymax=t.pt.y):void 0!==t.center?(this.xmin=t.center.x-.5*t.width,this.xmax=this.xmin+t.width,this.ymin=t.center.y-.5*t.height,this.ymax=this.ymin+t.height,this.normalize()):(0,i.b)("unrecognized input type for setCoords"),this.normalize()}queryIntervalX(t){this.isEmpty()?t.setEmpty():t.setCoords(this.xmin,this.xmax)}queryIntervalY(t){this.isEmpty()?t.setEmpty():t.setCoords(this.ymin,this.ymax)}setFromPoints(t,e){if(0===e)return void this.setEmpty();if(Array.isArray(t)){this.setCoords(t[0]);for(let s=1;s<e;){if(!this.isEmpty()){for(let i=s;i<e;i++)this.mergeNe(t[i]);break}this.setCoords(t[s]),s++}return}this.setCoords({x:t[0],y:t[1]});for(let s=1,i=2*e;s<i;s+=2){if(!this.isEmpty()){for(let i=s,n=2*e;i<n;i+=2)this.mergeNeCoords(t[i],t[i+1]);return}this.setCoords({x:t[s],y:t[s+1]}),s+=2}}normalize(){let t=!1;this.xmin<=this.xmax||([this.xmin,this.xmax]=[this.xmax,this.xmin],t=!0),this.ymin<=this.ymax||([this.ymin,this.ymax]=[this.ymax,this.ymin],t=!0),!t||this.xmin<=this.xmax&&this.ymin<=this.ymax||this.setEmpty()}isValid(){return this.isEmpty()||this.xmin<=this.xmax&&this.ymin<=this.ymax}getLowerLeft(){return new n.P(this.xmin,this.ymin)}getLowerRight(){return new n.P(this.xmax,this.ymin)}getUpperLeft(){return new n.P(this.xmin,this.ymax)}getUpperRight(){return new n.P(this.xmax,this.ymax)}move(t,e){this.isEmpty()||(this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e)}centerAtCoords(t,e){this.move(t-this.getCenterX(),e-this.getCenterY())}centerAt(t){this.centerAtCoords(t.x,t.y)}containsCoords(t,e){return t>=this.xmin&&t<=this.xmax&&e>=this.ymin&&e<=this.ymax}contains(t){return this.containsCoords(t.x,t.y)}containsEnvelope(t){return t.xmin>=this.xmin&&t.xmax<=this.xmax&&t.ymin>=this.ymin&&t.ymax<=this.ymax}containsExclusiveCoords(t,e){return t>this.xmin&&t<this.xmax&&e>this.ymin&&e<this.ymax}containsExclusive(t){return this.containsExclusiveCoords(t.x,t.y)}containsExclusiveEnvelope(t){return t.xmin>this.xmin&&t.xmax<this.xmax&&t.ymin>this.ymin&&t.ymax<this.ymax}isIntersecting(t){return(this.xmin<=t.xmin?this.xmax>=t.xmin:t.xmax>=this.xmin)&&(this.ymin<=t.ymin?this.ymax>=t.ymin:t.ymax>=this.ymin)}isIntersectingNe(t){return(this.xmin<=t.xmin?this.xmax>=t.xmin:t.xmax>=this.xmin)&&(this.ymin<=t.ymin?this.ymax>=t.ymin:t.ymax>=this.ymin)}intersect(t){if(this.isEmpty())return!1;if(t.isEmpty())return this.setEmpty(),!1;t.xmin>this.xmin&&(this.xmin=t.xmin),t.xmax<this.xmax&&(this.xmax=t.xmax),t.ymin>this.ymin&&(this.ymin=t.ymin),t.ymax<this.ymax&&(this.ymax=t.ymax);let e=this.xmin<=this.xmax&&this.ymin<=this.ymax;return e||this.setEmpty(),e}queryCorner(t){switch(3&t){case 0:return new n.P(this.xmin,this.ymin);case 1:return new n.P(this.xmin,this.ymax);case 2:return new n.P(this.xmax,this.ymax);default:return new n.P(this.xmax,this.ymin)}}queryCorners(t){t[0].setCoords(this.xmin,this.ymin),t[1].setCoords(this.xmin,this.ymax),t[2].setCoords(this.xmax,this.ymax),t[3].setCoords(this.xmax,this.ymin)}queryCornersReversed(t){t[0].setCoords(this.xmin,this.ymin),t[1].setCoords(this.xmax,this.ymin),t[2].setCoords(this.xmax,this.ymax),t[3].setCoords(this.xmin,this.ymax)}reaspect(t,e){if(this.isEmpty())return;let s=t/e,i=.5*this.width(),n=.5*this.height()*s;if(i<=n){let t=this.getCenterX();this.xmin=t-n,this.xmax=t+n}else{let t=i/s,e=this.getCenterY();this.ymin=e-t,this.ymax=e+t}this.normalize()}getArea(){return this.isEmpty()?0:this.width()*this.height()}getLength(){return this.isEmpty()?0:2*(this.width()+this.height())}clipCode(t){return t.x<this.xmin|(t.x>this.xmax)<<1|(t.y<this.ymin)<<2|(t.y>this.ymax)<<3}clipLine(t,e){let s=this.clipCode(t),i=this.clipCode(e);if(s&i)return 0;if(!(s|i))return 4;let n=!!s|2*!!i;do{let n=e.x-t.x,h=e.y-t.y;if(Math.abs(n)>Math.abs(h)?s&r.XMASK?(s&r.XLESSXMIN?(t.y+=h*(this.xmin-t.x)/n,t.x=this.xmin):(t.y+=h*(this.xmax-t.x)/n,t.x=this.xmax),s=this.clipCode(t)):i&r.XMASK?(i&r.XLESSXMIN?(e.y+=h*(this.xmin-e.x)/n,e.x=this.xmin):(e.y+=h*(this.xmax-e.x)/n,e.x=this.xmax),i=this.clipCode(e)):s?(s&r.YLESSYMIN?(t.x+=n*(this.ymin-t.y)/h,t.y=this.ymin):(t.x+=n*(this.ymax-t.y)/h,t.y=this.ymax),s=this.clipCode(t)):(i&r.YLESSYMIN?(e.x+=n*(this.ymin-e.y)/h,e.y=this.ymin):(e.x+=n*(this.ymax-e.y)/h,e.y=this.ymax),i=this.clipCode(e)):s&r.YMASK?(s&r.YLESSYMIN?(t.x+=n*(this.ymin-t.y)/h,t.y=this.ymin):(t.x+=n*(this.ymax-t.y)/h,t.y=this.ymax),s=this.clipCode(t)):i&r.YMASK?(i&r.YLESSYMIN?(e.x+=n*(this.ymin-e.y)/h,e.y=this.ymin):(e.x+=n*(this.ymax-e.y)/h,e.y=this.ymax),i=this.clipCode(e)):s?(s&r.XLESSXMIN?(t.y+=h*(this.xmin-t.x)/n,t.x=this.xmin):(t.y+=h*(this.xmax-t.x)/n,t.x=this.xmax),s=this.clipCode(t)):(i&r.XLESSXMIN?(e.y+=h*(this.xmin-e.x)/n,e.x=this.xmin):(e.y+=h*(this.xmax-e.x)/n,e.x=this.xmax),i=this.clipCode(e)),s&i)return 0}while(s|i);return n}distanceFromEnvelope(t){return Math.sqrt(this.sqrDistanceEnvelope(t,null,null))}distance(t){return Math.sqrt(this.sqrDistance(t))}sqrDistanceEnvelope(t,e,s){if(!e&&!s){if(this.isEmpty()||t.isEmpty())return Number.NaN;let e,s=0,i=0;return(e=this.xmin-t.xmax)>s&&(s=e),(e=this.ymin-t.ymax)>i&&(i=e),(e=t.xmin-this.xmax)>s&&(s=e),(e=t.ymin-this.ymax)>i&&(i=e),s*s+i*i}if(this.isEmpty()||t.isEmpty())return e&&e.setNAN(),s&&s.setNAN(),Number.NaN;let i,n=0,r=0,h=Math.max(this.xmin,t.xmin),m=Math.max(this.ymin,t.ymin);return e&&e.setCoords(h,m),s&&s.setCoords(h,m),(i=this.xmin-t.xmax)>n&&(n=i,e&&(e.x=this.xmin),s&&(s.x=t.xmax)),(i=this.ymin-t.ymax)>r&&(r=i,e&&(e.y=this.ymin),s&&(s.y=t.ymax)),(i=t.xmin-this.xmax)>n&&(n=i,e&&(e.x=this.xmax),s&&(s.x=t.xmin)),(i=t.ymin-this.ymax)>r&&(r=i,e&&(e.y=this.ymax),s&&(s.y=t.ymin)),n*n+r*r}sqrDistance(t,e){if(void 0===e){if(this.isEmpty()||t.isNAN())return Number.NaN;let e,s=0,i=0;return(e=this.xmin-t.x)>s&&(s=e),(e=this.ymin-t.y)>i&&(i=e),(e=t.x-this.xmax)>s&&(s=e),(e=t.y-this.ymax)>i&&(i=e),s*s+i*i}if(this.isEmpty()||t.isNAN())return e.setNAN(),Number.NaN;e.assign(t);let s,i=0,n=0;return(s=this.xmin-t.x)>i&&(i=s,e.x=this.xmin),(s=this.ymin-t.y)>n&&(n=s,e.y=this.ymin),(s=t.x-this.xmax)>i&&(i=s,e.x=this.xmax),(s=t.y-this.ymax)>n&&(n=s,e.y=this.ymax),i*i+n*n}sqrMaxMinDistanceEnvelope(t){if(this.isEmpty()||t.isEmpty())return Number.NaN;let e=Number.MAX_VALUE;{let s=n.P.sqrDistanceCoords(this.xmin,this.ymin,t.xmax,t.ymin),i=n.P.sqrDistanceCoords(this.xmin,this.ymin,t.xmax,t.ymax),r=n.P.sqrDistanceCoords(this.xmin,this.ymax,t.xmax,t.ymin);e=Math.min(Math.max(Math.max(s,i),Math.max(r,n.P.sqrDistanceCoords(this.xmin,this.ymax,t.xmax,t.ymax))),e)}{let s=n.P.sqrDistanceCoords(this.xmin,this.ymin,t.xmin,t.ymax),i=n.P.sqrDistanceCoords(this.xmin,this.ymin,t.xmax,t.ymax),r=n.P.sqrDistanceCoords(this.xmax,this.ymin,t.xmin,t.ymax);e=Math.min(Math.max(Math.max(s,i),Math.max(r,n.P.sqrDistanceCoords(this.xmax,this.ymin,t.xmax,t.ymax))),e)}{let s=n.P.sqrDistanceCoords(this.xmax,this.ymin,t.xmin,t.ymin),i=n.P.sqrDistanceCoords(this.xmax,this.ymin,t.xmin,t.ymax),r=n.P.sqrDistanceCoords(this.xmax,this.ymax,t.xmin,t.ymin);e=Math.min(Math.max(Math.max(s,i),Math.max(r,n.P.sqrDistanceCoords(this.xmax,this.ymax,t.xmin,t.ymax))),e)}{let s=n.P.sqrDistanceCoords(this.xmin,this.ymax,t.xmin,t.ymin),i=n.P.sqrDistanceCoords(this.xmin,this.ymax,t.xmax,t.ymin),r=n.P.sqrDistanceCoords(this.xmax,this.ymax,t.xmin,t.ymin);e=Math.min(Math.max(Math.max(s,i),Math.max(r,n.P.sqrDistanceCoords(this.xmax,this.ymax,t.xmax,t.ymin))),e)}return e}sqrMaxDistanceEnvelope(t){if(this.isEmpty()||t.isEmpty())return Number.NaN;let e=0,s=(0,n.m)(n.P,4);this.queryCorners(s);let i=(0,n.m)(n.P,4);t.queryCorners(i);for(let t=0;t<4;t++)for(let r=0;r<4;r++){let h=n.P.sqrDistance(s[t],i[r]);h>e&&(e=h)}return e}sqrMaxMinDistance(t){let e=n.P.sqrDistance(t,this.getLowerLeft()),s=n.P.sqrDistance(t,this.getUpperLeft()),i=n.P.sqrDistance(t,this.getLowerRight()),r=n.P.sqrDistance(t,this.getUpperRight()),h,m=Math.max(e,s);return m>(h=Math.max(e,i))&&(m=h),m>(h=Math.max(s,r))&&(m=h),m>(h=Math.max(i,r))&&(m=h),m}sqrMinDistance(t){return this.contains(t)?0:this.sqrDistance(t)}sqrMaxDistance(t){let e=n.P.sqrDistance(t,this.getLowerLeft());return e=Math.max(n.P.sqrDistance(t,this.getUpperLeft()),e),e=Math.max(n.P.sqrDistance(t,this.getUpperRight()),e),e=Math.max(n.P.sqrDistance(t,this.getLowerRight()),e)}snapToBoundary(t){if(t.isNAN())return!1;if(this.isEmpty())return t.setNAN(),!0;let e=!0;if(t.x<this.xmin?t.x=this.xmin:t.x>this.xmax?t.x=this.xmax:e=!1,t.y<this.ymin?t.y=this.ymin:t.y>this.ymax?t.y=this.ymax:e=!1,e)return!0;if(t.x===this.xmin||t.x===this.xmax||t.y===this.ymin||t.y===this.ymax)return!1;let s=this.xmax-t.x,i=t.x-this.xmin,n=this.ymax-t.y,r=t.y-this.ymin;return Math.max(s,i)>Math.max(n,r)?t.y=r<n?this.ymin:this.ymax:t.x=i<s?this.xmin:this.xmax,!0}snapClip(t){let e=(0,n.c)(t.x,this.xmin,this.xmax),s=(0,n.c)(t.y,this.ymin,this.ymax);return n.P.construct(e,s)}boundaryDistance(t){if(this.isEmpty()||t.isNAN())return Number.NaN;if(t.x===this.xmin)return t.y-this.ymin;let e=this.ymax-this.ymin,s=this.xmax-this.xmin;if(t.y===this.ymax)return e+t.x-this.xmin;if(t.x===this.xmax)return e+s+this.ymax-t.y;if(t.y===this.ymin)return 2*e+s+this.xmax-t.x;let i=new n.P;return i.setCoordsPoint2D(t),this.snapToBoundary(i),this.boundaryDistance(i)}envelopeSide(t){if(this.isEmpty())return -1;let e=this.boundaryDistance(t),s=this.ymax-this.ymin,i=this.xmax-this.xmin;return e<s?0:(e-=s)<i?1:e-i<s?2:3}querySide(t,e){switch(t){case 0:e.constructFromCoords(this.xmin,this.ymin,this.xmin,this.ymax);break;case 1:e.constructFromCoords(this.xmin,this.ymax,this.xmax,this.ymax);break;case 2:e.constructFromCoords(this.xmax,this.ymax,this.xmax,this.ymin);break;case 3:e.constructFromCoords(this.xmax,this.ymin,this.xmin,this.ymin);break;default:(0,i.t)("query_side")}return e}isPointOnBoundary(t,e){return Math.abs(t.x-this.xmin)<=e||Math.abs(t.x-this.xmax)<=e||Math.abs(t.y-this.ymin)<=e||Math.abs(t.y-this.ymax)<=e}calculateToleranceFromEnvelope(){return this.isEmpty()?(0,n.g)():(Math.abs(this.xmin)+Math.abs(this.xmax)+Math.abs(this.ymin)+Math.abs(this.ymax)+1)*(0,n.g)()}toString(){return`[${this.xmin}, ${this.ymin}, ${this.xmax}, ${this.ymax}]`}}r.XLESSXMIN=1,r.YLESSYMIN=4,r.XMASK=3,r.YMASK=12},99506:(t,e,s)=>{s.d(e,{O:()=>a});var i=s(8288),n=s(16404),r=s(32045),h=r.D;class m extends i.G{constructor(t,e,s,i,n,r){super(),this.m_densificator=new h(e,s,i,r,!1,n),this.m_index=-1,this.m_inputGeoms=t}tock(){return!0}getRank(){return 1}next(){let t=null;for(;t=this.m_inputGeoms.next();)return(0,n.d)(t),this.m_index=this.m_inputGeoms.getGeometryID(),this.densify(t);return null}getGeometryID(){return this.m_index}densify(t){return this.m_densificator.densify(t)}}class a{getOperatorType(){return 10202}accelerateGeometry(t,e,s){return!1}canAccelerateGeometry(t){return!1}supportsCurves(){return!0}executeMany(t,e,s,i,n,r=12e3){return new m(t,e,s,i,r,n)}execute(t,e,s,i,n,h=12e3){return(0,r.d)(t,e,s,i,n,h)}}}}]);