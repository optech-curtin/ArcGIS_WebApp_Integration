"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4916],{4916:(e,r,s)=>{s.r(r),s.d(r,{default:()=>M});var a=s(81856),n=s(61939),l=s(40941),o=s(92753),h=s(45257),u=s(91838);s(57845),s(33638);var d=s(12709),p=s(61414),c=s(54506),m=s(88230),g=s(33023),y=s(85511),x=s(80468),f=s(32391),_=s(88776),w=s(72145);let v=e=>{let r=class extends e{initialize(){this.exportImageParameters=new _.r({layer:this.layer})}destroy(){this.exportImageParameters=(0,l.pR)(this.exportImageParameters)}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}get timeExtent(){return(0,w.F)(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(e,r){let{layer:s}=this;if(!e)throw new f.A("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:s});let{popupEnabled:a}=s;if(!a)throw new f.A("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:a});let n=this.createFetchPopupFeaturesQuery(e);if(!n)return[];let{extent:l,width:h,height:u,x:d,y:p}=n;if(!(l&&h&&u))throw new f.A("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:l,width:h,height:u});let c=await s.fetchFeatureInfo(l,h,u,d,p);return(0,o.Te)(r),c}};return(0,a._)([(0,u.MZ)()],r.prototype,"exportImageParameters",void 0),(0,a._)([(0,u.MZ)({readOnly:!0})],r.prototype,"exportImageVersion",null),(0,a._)([(0,u.MZ)()],r.prototype,"layer",void 0),(0,a._)([(0,u.MZ)({readOnly:!0})],r.prototype,"timeExtent",null),r=(0,a._)([(0,d.$)("esri.views.layers.WMSLayerView")],r)},b=class extends v((0,x.A)((0,m.e)(y.A))){constructor(){super(...arguments),this.bitmapContainer=new c.l}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}update(e){this.strategy.update(e).catch(e=>{(0,o.zf)(e)||n.A.getLogger(this).error(e)})}attach(){let{layer:e}=this,{imageMaxHeight:r,imageMaxWidth:s}=e;this.bitmapContainer=new c.l,this.container.addChild(this.bitmapContainer),this.strategy=new g.A({container:this.bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:r,imageMaxWidth:s,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.addAttachHandles((0,h.wB)(()=>this.exportImageVersion,()=>this.requestUpdate()))}detach(){this.strategy=(0,l.pR)(this.strategy),this.container.removeAllChildren()}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){let{view:r,bitmapContainer:s}=this,{x:a,y:n}=e,{spatialReference:l}=r,o,h=0,u=0;if(s.children.some(e=>{let{width:r,height:s,resolution:d,x:c,y:m}=e,g=c+d*r,y=m-d*s;return a>=c&&a<=g&&n<=m&&n>=y&&(o=new p.A({xmin:c,ymin:y,xmax:g,ymax:m,spatialReference:l}),h=r,u=s,!0)}),!o)return null;let d=o.width/h,c=Math.round((a-o.xmin)/d),m=Math.round((o.ymax-n)/d);return{extent:o,width:h,height:u,x:c,y:m}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,r,s,a){return this.layer.fetchImageBitmap(e,r,s,{timeExtent:this.timeExtent,...a})}};(0,a._)([(0,u.MZ)()],b.prototype,"strategy",void 0),(0,a._)([(0,u.MZ)()],b.prototype,"updating",void 0);let M=b=(0,a._)([(0,d.$)("esri.views.2d.layers.WMSLayerView2D")],b)},6272:(e,r,s)=>{s.d(r,{X:()=>a});let a=Symbol("WebScene")},33023:(e,r,s)=>{s.d(r,{A:()=>b});var a=s(81856),n=s(28690);s(57845);var l=s(92753),o=s(91838);s(61939),s(33638);var h=s(12709),u=s(84766),d=s(71760),p=s(33768);let c=Math.PI/180;var m=s(56587),g=s(61849),y=s(79378);let x=(0,u.vt)(),f=[0,0],_=new y.A(0,0,0,0),w={imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1},v=class extends n.A{constructor(e){super(e),this._imagePromise=null,this.bitmaps=[],this.hidpi=w.hidpi,this.imageMaxWidth=w.imageMaxWidth,this.imageMaxHeight=w.imageMaxHeight,this.imageRotationSupported=w.imageRotationSupported,this.imageNormalizationSupported=w.imageNormalizationSupported,this.update=(0,l.sg)(async(e,r)=>{if((0,l.Te)(r),!e.stationary||this.destroyed)return;let s=e.state,a=(0,d.Vp)(s.spatialReference),n=this.hidpi?e.pixelRatio:1,o=s.worldScreenWidth>0,h=o&&this.imageNormalizationSupported&&s.worldScreenWidth<s.size[0],u=Math.round((this.imageMaxWidth??0)/n),p=Math.round((this.imageMaxHeight??0)/n);h?(f[0]=s.worldScreenWidth,f[1]=s.size[1]):this.imageRotationSupported?(f[0]=s.size[0],f[1]=s.size[1]):function(e,r){let s=r.rotation*c,a=Math.abs(Math.cos(s)),n=Math.abs(Math.sin(s)),[l,o]=r.size;e[0]=Math.round(o*n+l*a),e[1]=Math.round(o*a+l*n)}(f,s);let m=Math.floor(f[0])>u||Math.floor(f[1])>p,g=a&&(s.extent.xmin<a.valid[0]||s.extent.xmax>a.valid[1]),y=!this.imageNormalizationSupported&&g,x=this.imageRotationSupported?s.rotation:0,_=this.container.children.slice();if(m||y){let e=Math.min(u,p);o&&(e=Math.min(s.worldScreenWidth,e),e=Math.round(s.worldScreenWidth/Math.ceil(s.worldScreenWidth/e))),this._imagePromise=this._tiledExport(s,e,n,r)}else{let e=h?s.paddedViewState.center:s.center;this._imagePromise=this._singleExport(s,f,e,s.resolution,x,n,r)}try{let e=await this._imagePromise??[];(0,l.Te)(r);let s=[];if(this._imagePromise=null,this.destroyed)return;for(let r of(this.bitmaps=e,_))e.includes(r)||s.push(r.fadeOut().then(()=>{r.remove(),r.destroy()}));for(let r of e)s.push(r.fadeIn());await Promise.all(s)}catch(e){this._imagePromise=null,(0,l.QP)(e)}},5e3),this.updateExports=(0,l.sg)(async e=>{let r=[];for(let s of this.container.children){if(!s.visible||!s.stage)return;r.push(e(s).then(()=>{s.invalidateTexture(),s.requestRender()}))}this._imagePromise=(0,l.Lx)(r).then(()=>this._imagePromise=null),await this._imagePromise})}destroy(){this.bitmaps.forEach(e=>e.destroy()),this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}async _export(e,r,s,a,n,o){let h=await this.fetchSource(e,Math.floor(r*n),Math.floor(s*n),{rotation:a,pixelRatio:n,signal:o});(0,l.Te)(o);let u=new m.mb(null,!0);return u.x=e.xmin,u.y=e.ymax,u.resolution=e.width/r,u.rotation=a,u.pixelRatio=n,u.opacity=0,this.container.addChild(u),await u.setSourceAsync(h,o),(0,l.Te)(o),u}async _singleExport(e,r,s,a,n,l,o){var h=x,d=s,p=a,c=r;let[m,g]=d,[y,f]=c,_=.5*p;h[0]=m-_*y,h[1]=g-_*f,h[2]=m+_*y,h[3]=g+_*f;let w=(0,u.w1)(x,e.spatialReference);return[await this._export(w,r[0],r[1],n,l,o)]}_tiledExport(e,r,s,a){let n=p.A.create({size:r,spatialReference:e.spatialReference,scales:[e.scale]}),l=new g.A(n),o=l.getTileCoverage(e);if(!o)return null;let h=[];return o.forEach((n,o,d,p)=>{_.set(n,o,d,0),l.getTileBounds(x,_);let c=(0,u.w1)(x,e.spatialReference);h.push(this._export(c,r,r,0,s,a).then(e=>(0!==p&&(_.set(n,o,d,p),l.getTileBounds(x,_),e.x=x[0],e.y=x[3]),e)))}),Promise.all(h)}};(0,a._)([(0,o.MZ)()],v.prototype,"_imagePromise",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"bitmaps",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"container",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"fetchSource",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"hidpi",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"imageMaxWidth",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"imageMaxHeight",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"imageRotationSupported",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"imageNormalizationSupported",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"requestUpdate",void 0),(0,a._)([(0,o.MZ)()],v.prototype,"updating",null);let b=v=(0,a._)([(0,h.$)("esri.views.2d.layers.support.ExportStrategy")],v)},42271:(e,r,s)=>{s.d(r,{C:()=>_});var a=s(94360),n=s(90476),l=s(77804),o=s(81856),h=s(21866),u=s(59715);function d(e){let r=function(e){let r=new u.nt(1/6),s=e.multiply(e),a=s.multiply(e),n=r.multiply(a.multiply(-1).add(new u.nt(3).multiply(s)).subtract(new u.nt(3).multiply(e)).add(1)),l=r.multiply(a.multiply(3).subtract(s.multiply(6)).add(4)),o=r.multiply(a.multiply(-3).add(s.multiply(3)).add(e.multiply(3)).add(1)),h=r.multiply(a);return new u.Zb(n,l,o,h)}(e),s=r.x.add(r.y),a=r.z.add(r.w),n=new u.nt(1).subtract(r.y.divide(s)).add(e),l=new u.nt(1).add(r.w.divide(a)).subtract(e);return new u.Zb(n,l,s,a)}class p extends h.ZA{}(0,o._)([(0,h.C5)(0,u.ZY)],p.prototype,"position",void 0);class c extends h.HS{}class m extends h.k2{}(0,o._)([(0,h.Pi)(u.z7)],m.prototype,"texture",void 0),(0,o._)([(0,h.Pi)(u.U)],m.prototype,"dvsMat3",void 0),(0,o._)([(0,h.Pi)(u.ZY)],m.prototype,"coordScale",void 0),(0,o._)([(0,h.Pi)(u.nt)],m.prototype,"opacity",void 0);class g extends h.A{constructor(){super(...arguments),this.type="BitmapShader"}vertex(e){let r=this.config.dvsMat3.multiply(new u.eB(e.position.multiply(this.config.coordScale),1));return{glPosition:new u.Zb(r,1),texcoord:e.position}}fragment(e){let r,s=new h.mm;return r=this.bicubic?function(e,r,s){let a=new u.ZY(new u.nt(1).divide(s.x),0),n=new u.ZY(0,new u.nt(1).divide(s.y)),l=r.multiply(s).subtract(.5),o=d((0,u.jc)(l).x).xyz,h=d((0,u.jc)(l).y).xyz,p=r.add(o.x.multiply(a)),c=r.subtract(o.y.multiply(a)),m=p.add(h.x.multiply(n)),g=c.add(h.x.multiply(n));p=p.subtract(h.y.multiply(n)),c=c.subtract(h.y.multiply(n));let y=(0,u.US)(e,c),x=(0,u.US)(e,p),f=(0,u.US)(e,g),_=(0,u.US)(e,m);return y=(0,u.jh)(y,f,h.z),x=(0,u.jh)(x,_,h.z),y=(0,u.jh)(y,x,o.z)}(this.config.texture,e.texcoord,this.config.coordScale):(0,u.US)(this.config.texture,e.texcoord),s.fragColor=new u.Zb(r.rgb.multiply(this.config.opacity),r.a.multiply(this.config.opacity)),s}}(0,o._)([(0,h.Pi)(m)],g.prototype,"config",void 0),(0,o._)([h.E8],g.prototype,"bicubic",void 0),(0,o._)([(0,o.a)(0,(0,h.hF)(p))],g.prototype,"vertex",null),(0,o._)([(0,o.a)(0,(0,h.hF)(c))],g.prototype,"fragment",null);var y=s(93446);let x={nearest:{samplingMode:y.Cj.NEAREST,mips:!1},bilinear:{samplingMode:y.Cj.LINEAR,mips:!1},bicubic:{samplingMode:y.Cj.LINEAR,mips:!1},trilinear:{samplingMode:y.Cj.LINEAR_MIPMAP_LINEAR,mips:!0}},f=(e,r,s)=>{if("dynamic"===s.samplingMode){let{state:s}=e,a=r.resolution/r.pixelRatio/s.resolution,n=Math.round(e.pixelRatio)!==e.pixelRatio;return s.rotation||a>1.05||a<.95||n||r.isSourceScaled||r.rotation?x.bilinear:x.nearest}return x[s.samplingMode]};class _ extends n.j{constructor(){super(...arguments),this.name="BrushBitmap",this.type=l.N.Bitmap,this.shaders={bitmap:new g}}render(e,r){let{context:s,renderingOptions:n,painter:l}=e;for(let o of r.bitmaps){let r=o.texture;if(!o.source||!o.isReady||null==r)continue;let h=f(e,o,n);e.timeline.begin(this.name),l.setPipelineState({depth:!1,stencil:{test:{mask:255,ref:o.stencilRef,compare:y.MT.EQUAL,op:{fail:y.eA.KEEP,zFail:y.eA.KEEP,zPass:y.eA.KEEP}},write:!1},color:{write:[!0,!0,!0,!0],blendMode:"additive"===o.blendFunction?"additive":"composite"}}),o.setSamplingProfile(h);let{coordScale:u,computedOpacity:d,transforms:p}=o,c={texture:{texture:r,unit:a.YS},dvsMat3:p.displayViewScreenMat3,coordScale:u,opacity:d};l.submitDrawMesh(s,{shader:this.shaders.bitmap,uniforms:{config:c},defines:{bicubic:h===x.bicubic},optionalAttributes:null,useComputeBuffer:!1},l.quadMesh),e.timeline.end(this.name)}}}},54506:(e,r,s)=>{s.d(r,{l:()=>o});var a=s(52548),n=s(24080),l=s(42271);class o extends n.A{constructor(){super(...arguments),this._hasCrossfade=!1,this._bitmapTechnique=null}get requiresDedicatedFBO(){return super.requiresDedicatedFBO||this._hasCrossfade}beforeRender(e){super.beforeRender(e),this._manageFade()}onAttach(){super.onAttach(),this._bitmapTechnique=new l.C}onDetach(){super.onDetach(),this._bitmapTechnique?.shutdown(),this._bitmapTechnique=null}renderChildren(e){super.renderChildren(e),this.visible&&e.drawPhase===a.S5.MAP&&null!=this._bitmapTechnique&&this._bitmapTechnique.render(e,{bitmaps:this.children})}_manageFade(){this.children.reduce((e,r)=>e+ +!!r.inFadeTransition,0)>=2?(this.children.forEach(e=>e.blendFunction="additive"),this._hasCrossfade=!0):(this.children.forEach(e=>e.blendFunction="standard"),this._hasCrossfade=!1)}}},56587:(e,r,s)=>{s.d(r,{LG:()=>m,mb:()=>y,yr:()=>g});var a=s(92753),n=s(6815),l=s(19284),o=s(25561),h=s(19733),u=s(95266),d=s(93446),p=s(87155),c=s(15494);function m(e){return e&&"render"in e}function g(e){let r=document.createElement("canvas");return r.width=e.width,r.height=e.height,e.render(r.getContext("2d")),r}class y extends h.q{constructor(e=null,r=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._texture=null,this._width=void 0,this.x=0,this.y=0,this.immutable=r,this.source=e,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){null==e&&null==this._source||(this._source=e,this.invalidateTexture(),this.requestRender())}get texture(){return this._texture}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(e){this._width=e}beforeRender(e){super.beforeRender(e),this.updateTexture(e)}async setSourceAsync(e,r){null!=this._uploadStatus&&this._uploadStatus.controller.abort();let s=new AbortController,n=(0,a.Tw)();return(0,a.NY)(r,()=>s.abort()),(0,a.NY)(s,e=>n.reject(e)),this._uploadStatus={controller:s,resolver:n},this.source=e,n.promise}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}transitionStep(e,r){e>=64&&(this.fadeTransitionEnabled=!1),super.transitionStep(e,r)}setTransform(e){let r=(0,n.D_)(this.transforms.displayViewScreenMat3),[s,a]=e.toScreenNoRotation([0,0],[this.x,this.y]),l=this.resolution/this.pixelRatio/e.resolution,h=l*this.width,u=l*this.height,d=Math.PI*this.rotation/180;(0,n.Tl)(r,r,(0,o.fA)(s,a)),(0,n.Tl)(r,r,(0,o.fA)(h/2,u/2)),(0,n.e$)(r,r,-d),(0,n.Tl)(r,r,(0,o.fA)(-h/2,-u/2)),(0,n.Oe)(r,r,(0,o.fA)(h,u)),(0,n.lw)(this.transforms.displayViewScreenMat3,e.displayViewMat3,r)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind(e,r){this._texture&&e.bindTexture(this._texture,r)}async updateTexture({context:e,painter:r}){var s;if(!this._textureInvalidated)return;if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(e)),!this.source)return void this._texture.setData(null);this._texture.resize(this._sourceWidth,this._sourceHeight);let n=m(s=this.source)?s instanceof u.A?s.getRenderedRasterPixels()?.renderedRasterPixels:g(s):s;try{if(null!=this._uploadStatus){let{controller:e,resolver:s}=this._uploadStatus,a={signal:e.signal},{width:l,height:o}=this,h=this._texture,u=r.textureUploadManager;await u.enqueueTextureUpdate({data:n,texture:h,width:l,height:o},a),s.resolve(),this._uploadStatus=null}else this._texture.setData(n);this.ready()}catch(e){(0,a.jH)(e)}}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,l.vt)()}}_createTexture(e){let r=this.immutable,s=new c.R;return s.internalFormat=r?d.H0.RGBA8:d.Ab.RGBA,s.wrapMode=d.pF.CLAMP_TO_EDGE,s.isImmutable=r,s.width=this._sourceWidth,s.height=this._sourceHeight,new p.g(e,s)}}},72145:(e,r,s)=>{s.d(r,{F:()=>h}),s(31461),s(33715);var a=s(72359),n=s(47840);function l(e){return void 0!==e.timeInfo}s(24927),s(6272);async function o(e,r){if(0===e.length)return i.allTime;await Promise.all(e.map(e=>e.load({signal:r})));let s=e.filter(l),a=e.filter(e=>!l(e)&&null!=e.visibilityTimeExtent);if(0===s.length&&0===a.length)return i.allTime;let n=[],o=[];for(let e of s)("feature"===e?.type||"map-image"===e?.type)&&e.timeInfo?.hasLiveData?n.push(e):o.push(e);let h=e=>null==e||e.isAllTime,u=[...o.map(e=>{let r=e.timeInfo?.fullTimeExtent,{visibilityTimeExtent:s}=e;return r?.intersection(s)??s}),...a.map(e=>e.visibilityTimeExtent)];if(u.some(h))return i.allTime;let d=n.map(async e=>{let s=(await e.fetchRecomputedExtents({signal:r}))?.timeExtent??e.timeInfo?.fullTimeExtent,{visibilityTimeExtent:a}=e;return s?.intersection(a)??a}),p=(await Promise.allSettled(d)).map(e=>"fulfilled"===e.status?e.value:null);if(p.some(h))return i.allTime;let c=[...p,...u].filter(t);return 0===c.length?i.allTime:c.reduce((e,r)=>e.union(r))}function h(e,r,s){if(null==e?.timeInfo)return null;let{datesInUnknownTimezone:l=!1,timeOffset:o,useViewTime:h}=e,u=e.timeExtent;l&&(u=function(e){if(!e)return e;let{start:r,end:s}=e;return new n.A({start:null!=r?(0,a.S1)(r,r.getTimezoneOffset(),"minutes"):r,end:null!=s?(0,a.S1)(s,s.getTimezoneOffset(),"minutes"):s})}(u));let d=h?r&&u?r.intersection(u):r||u:u;return!d||d.isEmpty||d.isAllTime?d:(o&&(d=d.offset(-o.value,o.unit)),l&&(d=function(e){if(!e)return e;let{start:r,end:s}=e;return new n.A({start:null!=r?(0,a.S1)(r,-r.getTimezoneOffset(),"minutes"):r,end:null!=s?(0,a.S1)(s,-s.getTimezoneOffset(),"minutes"):s})}(d)),d.equals(s)?s:d)}},80468:(e,r,s)=>{s.d(r,{A:()=>u});var a=s(81856),n=s(61939),l=s(92753),o=s(45257);s(57845),s(33638),s(32391);var h=s(12709);let u=e=>{let r=class extends e{initialize(){this.addHandles((0,o.on)(()=>this.layer,"refresh",e=>{this.doRefresh(e.dataChanged).catch(e=>{(0,l.zf)(e)||n.A.getLogger(this).error(e)})}),"RefreshableLayerView")}};return(0,a._)([(0,h.$)("esri.views.layers.RefreshableLayerView")],r)}},88776:(e,r,s)=>{s.d(r,{r:()=>u});var a=s(81856),n=s(28690),l=s(91838);s(57845),s(61939),s(33638);var o=s(12709);let h={visible:"visibleSublayers"},u=class extends n.A{constructor(e){super(e),this.scale=0}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.sublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("wms-sublayer-update",e=>this.notifyChange(h[e.propertyName]))],"layer"))}get layers(){return this.visibleSublayers.filter(({name:e})=>e).map(({name:e})=>e).join()}get version(){this.commitProperty("layers");let e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){let{layer:e,scale:r}=this,s=e?.sublayers,a=[],n=e=>{let{minScale:s,maxScale:l,sublayers:o,visible:h}=e;h&&(0===r||(0===s||r<=s)&&(0===l||r>=l))&&(o?o.forEach(n):a.push(e))};return s?.forEach(n),a}toJSON(){let{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:a,version:n}=e;return{format:s,request:"GetMap",service:"WMS",styles:"",transparent:a?"TRUE":"FALSE",version:n,layers:r}}};(0,a._)([(0,l.MZ)()],u.prototype,"layer",null),(0,a._)([(0,l.MZ)({readOnly:!0})],u.prototype,"layers",null),(0,a._)([(0,l.MZ)({type:Number})],u.prototype,"scale",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],u.prototype,"version",null),(0,a._)([(0,l.MZ)({readOnly:!0})],u.prototype,"visibleSublayers",null),u=(0,a._)([(0,o.$)("esri.layers.support.ExportWMSImageParameters")],u)},95266:(e,r,s)=>{s.d(r,{A:()=>a});class a{constructor(e,r,s){this.pixelBlock=e,this.extent=r,this.originalPixelBlock=s}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(e){let r=this.pixelBlock;if(null==r)return;let s=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??r});if(null==s.pixelBlock)return;s.pixelBlock.maskIsAlpha&&(s.pixelBlock.premultiplyAlpha=!0);let a=s.pixelBlock.getAsRGBA(),n=e.createImageData(s.pixelBlock.width,s.pixelBlock.height);n.data.set(a),e.putImageData(n,0,0)}getRenderedRasterPixels(){let e=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==e.pixelBlock?null:(e.pixelBlock.maskIsAlpha&&(e.pixelBlock.premultiplyAlpha=!0),{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)})}}}}]);