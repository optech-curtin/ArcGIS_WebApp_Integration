"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2140],{22140:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ee});var a,n=r(57845),i=r(26530),s=r(42236),o=r(39859);function l(e){if(null!==e.precision||null!==e.secondary)throw new o.L8(o.Z7.PrimarySecondaryQualifiers)}function u(e,t){if(t.includes(".")){let r=t.split(".");e.second=parseFloat(r[0]),e.millis=parseInt(r[1],10)}else e.second=parseFloat(t)}let c="esri.core.sql.SqlInterval";class d{constructor(){this.declaredRootClass=c,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===c}static createFromMilliseconds(e){let t=new d;return t.second=e/1e3,t}static createFromValueAndQualifier(e,t,r){let a=null,n=new d;if(n.op="-"===r?"-":"+","interval-period"===t.type){l(t);let r=RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new o.L8(o.Z7.YearMonthIntervals);if("second"===t.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(e))throw new o.L8(o.Z7.IllegalInterval);u(n,e)}else{if(!r.test(e))throw new o.L8(o.Z7.IllegalInterval);n[t.period]=parseFloat(e)}}else{if(l(t.start),l(t.end),"year"===t.start.period||"month"===t.start.period||"year"===t.end.period||"month"===t.end.period)throw new o.L8(o.Z7.YearMonthIntervals);switch(t.start.period){case"day":switch(t.end.period){case"hour":if(!RegExp("^[0-9]{1,} [0-9]{1,}$").test(e))throw new o.L8(o.Z7.IllegalInterval);n[t.start.period]=parseFloat(e.split(" ")[0]),n[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(!RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$").test(e))throw new o.L8(o.Z7.IllegalInterval);{n[t.start.period]=parseFloat(e.split(" ")[0]);let r=e.split(" ")[1].split(":");n.hour=parseFloat(r[0]),n.minute=parseFloat(r[1])}break;case"second":if(!RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(e))throw new o.L8(o.Z7.IllegalInterval);{n[t.start.period]=parseFloat(e.split(" ")[0]);let r=e.split(" ")[1].split(":");n.hour=parseFloat(r[0]),n.minute=parseFloat(r[1]),u(n,r[2])}break;default:throw new o.L8(o.Z7.IllegalInterval)}break;case"hour":switch(t.end.period){case"minute":if(!RegExp("^[0-9]{1,}:[0-9]{1,}$").test(e))throw new o.L8(o.Z7.IllegalInterval);n.hour=parseFloat(e.split(":")[0]),n.minute=parseFloat(e.split(":")[1]);break;case"second":if(!RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(e))throw new o.L8(o.Z7.IllegalInterval);{let t=e.split(":");n.hour=parseFloat(t[0]),n.minute=parseFloat(t[1]),u(n,t[2])}break;default:throw new o.L8(o.Z7.IllegalInterval)}break;case"minute":if("second"!==t.end.period||!RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(e))throw new o.L8(o.Z7.IllegalInterval);{let t=e.split(":");n.minute=parseFloat(t[0]),u(n,t[1])}break;default:throw new o.L8(o.Z7.IllegalInterval)}}return n}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*6e4+24*this.day*36e5+this.month*(365/12)*864e5+365*this.year*864e5)}}var p=r(22721),f=r(3677),m=r(87303),h=r(29593);let v=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,w=/^(\d{1,2}):(\d{1,2})$/,g=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,I=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,y=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,T=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,L=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,N=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function S(e,t){if(t instanceof h.bo)return t===m.GB.instance?h.c9.fromMillis(e.getTime(),{zone:m.GB.instance}):h.c9.fromJSDate(e,{zone:t});switch(t){case"system":case"local":case null:return h.c9.fromJSDate(e);default:return"unknown"===t?.toLowerCase()?h.c9.fromMillis(e.getTime(),{zone:m.GB.instance}):h.c9.fromJSDate(e,{zone:t})}}function O(e){return d.isInterval(e)}function x(e){return h.c9.isDateTime(e)}function C(e){return s.n.isDateOnly(e)}function E(e){return f.k.isTimeOnly(e)}function Z(e){return p.g.isTimestampOffset(e)}function M(e){let t=v.exec(e);if(null!==t){let[,e,r,a]=t,n=f.k.fromParts(parseInt(e,10),parseInt(r,10),parseInt(a,10),0);if(null!==n)return n;throw new o.L8(o.Z7.InvalidTime)}if(null!==(t=w.exec(e))){let[,e,r]=t,a=f.k.fromParts(parseInt(e,10),parseInt(r,10),0,0);if(null!==a)return a;throw new o.L8(o.Z7.InvalidTime)}if(null!==(t=g.exec(e))){let[,e,r,a,n]=t,i=f.k.fromParts(parseInt(e,10),parseInt(r,10),parseInt(a,10),parseInt(n,10));if(null!==i)return i}throw new o.L8(o.Z7.InvalidTime)}function b(e,t,r=!1){let a=y.exec(e);if(null!==a){let[,e,r,n,i,s,l,u]=a,c=h.c9.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(n,10),hour:parseInt(i,10),minute:parseInt(s,10),second:parseInt(l,10),millisecond:u?parseInt(u.replace(".",""),10):0},{zone:(0,m.Qo)(t)});if(!1===c.isValid)throw new o.L8(o.Z7.InvalidTimeStamp);return c}if(null!==(a=T.exec(e))){let[,e,t,r,n,i,s,l,u,c,d]=a,f=p.g.fromParts(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(n,10),parseInt(i,10),parseInt(s,10),l?parseInt(l.replace(".",""),10):0,"-"===u,parseInt(c,10),parseInt(d,10));if(!1===f.isValid)throw new o.L8(o.Z7.InvalidTimeStamp);return f}if(null!==(a=L.exec(e))){let[,e,t,r,n,i,s,l,u]=a,c=p.g.fromParts(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(n,10),parseInt(i,10),0,0,"-"===s,parseInt(l,10),parseInt(u,10));if(!1===c.isValid)throw new o.L8(o.Z7.InvalidTimeStamp);return c}if(null!==(a=N.exec(e))){let[,e,r,n,i,s]=a,l=h.c9.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(n,10),hour:parseInt(i,10),minute:parseInt(s,10),second:0},{zone:(0,m.Qo)(t)});if(!1===l.isValid)throw new o.L8(o.Z7.InvalidTimeStamp);return l}if(null!==(a=I.exec(e))){let[,e,r,n]=a,i=h.c9.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(n,10),hour:0,minute:0,second:0},{zone:(0,m.Qo)(t)});if(!1===i.isValid)throw new o.L8(o.Z7.InvalidTimeStamp);return i}throw new o.L8(o.Z7.InvalidTimeStamp)}function P(e,t){let r=I.exec(e);if(null===r)try{return b(e,t)}catch{throw new o.L8(o.Z7.InvalidDate)}let[,a,n,i]=r,l=s.n.fromParts(parseInt(a,10),parseInt(n,10),parseInt(i,10));if(null===l)throw new o.L8(o.Z7.InvalidDate);return l}var F=r(20538),A=r(45714),D=r(48271);function R(e){return!!x(e)||!!Z(e)}function _(e){return!!x(e)||!!C(e)||!!Z(e)||!!E(e)}function U(e){if(x(e))return e.toMillis();if(C(e))return e.toNumber();if(Z(e))return e.toMilliseconds();throw new o.L8(o.Z7.InvalidDataType)}function $(e,t,r,a){if(null==e||null==t)return null;if((0,D.Et)(e)){if((0,D.Et)(t))return J(e,t,r);if((0,D.Kg)(t)){var n=e,i=t,s=r;let a=parseFloat(i);if(!isNaN(a))return J(n,a,s);let o=n.toString();switch(s){case"<>":return o!==i;case"=":return o===i;case">":return o>i;case"<":return o<i;case">=":return o>=i;case"<=":return o<=i}return}if(_(t)||C(t))throw new o.L8(o.Z7.InvalidOperator)}else if((0,D.Kg)(e)){if((0,D.Et)(t)){var l=e,u=t,c=r;let a=parseFloat(l);if(!isNaN(a))return J(a,u,c);let n=u.toString();switch(c){case"<>":return l!==n;case"=":return l===n;case">":return l>n;case"<":return l<n;case">=":return l>=n;case"<=":return l<=n}return}if((0,D.Kg)(t)){var d=e,f=t,v=r;switch(v){case"<>":return d!==f;case"=":return d===f;case">":return d>f;case"<":return d<f;case">=":return d>=f;case"<=":return d<=f}return}if(x(t)||C(t)||E(t)||Z(t))throw new o.L8(o.Z7.InvalidOperator)}else if(x(e)){if(R(t)){if((0,m.Y4)(e.zone)){if(h.c9.isDateTime(t)&&!(0,m.Y4)(t.zone)||p.g.isTimestampOffset(t))return k(e,t,r)}else if(h.c9.isDateTime(t)&&(0,m.Y4)(t.zone)&&(!(0,m.Y4)(e.zone)||p.g.isTimestampOffset(e)))return k(e,t,r);return J(U(e),U(t),r)}if((0,D.Kg)(t))throw new o.L8(o.Z7.InvalidOperator);if(C(t)){var w=e,g=t,I=r;let a=g.toDateTimeLuxon(w.zone);return J((w=w.startOf("day")).toMillis(),a.toMillis(),I)}if(E(t)||(0,D.Et)(t))throw new o.L8(o.Z7.InvalidOperator)}else if(C(e)){if(Z(t)){var y=e,T=t,L=r;let a=y.toDateTimeLuxon(T.toDateTime().zone);return T=T.startOfDay(),J(a.toMillis(),T.toMilliseconds(),L)}if(x(t)){var N=e,S=t,O=r;let a=N.toDateTimeLuxon(S.zone);return S=S.startOf("day"),J(a.toMillis(),S.toMillis(),O)}if((0,D.Kg)(t))throw new o.L8(o.Z7.InvalidOperator);if(C(t))return J(e.toNumber(),t.toNumber(),r);if(E(t)||(0,D.Et)(t))throw new o.L8(o.Z7.InvalidOperator)}else if(E(e)){if(E(t))return J(e.toNumber(),t.toNumber(),r);if((0,D.Kg)(t)||(0,D.Et)(t)||C(t)||R(t))throw new o.L8(o.Z7.InvalidOperator)}else if(Z(e)){if(R(t))return h.c9.isDateTime(t)&&(0,m.Y4)(t.zone)?k(e,t,r):J(U(e),U(t),r);if((0,D.Kg)(t))throw new o.L8(o.Z7.InvalidOperator);if(C(t)){var M=e,b=t,P=r;let a=b.toDateTimeLuxon(M.toDateTime().zone);return J((M=M.startOfDay()).toMilliseconds(),a.toMillis(),P)}if(E(t)||(0,D.Et)(t))throw new o.L8(o.Z7.InvalidOperator)}switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function J(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function k(e,t,r){p.g.isTimestampOffset(e)&&(e=e.toDateTime()),p.g.isTimestampOffset(t)&&(t=t.toDateTime());let a=V(e),n=V(t);switch(r){case"<>":return a!==n;case"=":return a===n;case">":return a>n;case"<":return a<n;case">=":return a>=n;case"<=":return a<=n}}function V(e){return 321408e5*e.year+26784e5*e.month+864e5*e.day+36e5*e.hour+6e4*e.minute+1e3*e.second+e.millisecond}function z(e,t,r){let a=H[e.toLowerCase()];if(null==a)throw new o.L8(o.Z7.FunctionNotRecognized);if(t.length<a.minParams||t.length>a.maxParams)throw new o.L8(o.Z7.InvalidParameterCount,{name:e.toUpperCase()});return a.evaluate(t,r)}function q(e){return!(0,D.$P)(e)&&!C(e)&&!x(e)&&!E(e)&&!Z(e)}let H={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if((0,D.$P)(t))switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(x(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year}else if(C(t))switch(e.toUpperCase()){case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year}else if(E(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour}else if(Z(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":return t.timezoneOffsetHour;case"TIMEZONE_MINUTE":return t.timezoneOffsetMinutes}throw new o.L8(o.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){let[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){let[t,r,a]=e;return null==t||null==r||null==a?null:a<=0?"":t.toString().substring(r-1,r+a-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{let t=3===e.length,r=t?e[1]:" ",a=t?e[2]:e[1];if(null==r||null==a)return null;let n=`(${(0,A.Cj)(r)})`;switch(e[0]){case"BOTH":return a.replaceAll(RegExp(`^${n}*|${n}*$`,"g"),"");case"LEADING":return a.replaceAll(RegExp(`^${n}*`,"g"),"");case"TRAILING":return a.replaceAll(RegExp(`${n}*$`,"g"),"")}throw new o.L8(o.Z7.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{let t=e[0],r=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length||0===e[1]?Math.trunc(e[0]):(0,F.pF)("trunc",e[0],-Number(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>(0,D.Kg)(e[0])?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:e=>{for(let t of e)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cosh(e[0])},sinh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sinh(e[0])},tanh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tanh(e[0])},nullif:{minParams:2,maxParams:2,evaluate:(e,t)=>$(e[0],e[1],"=")?null:e[0]},cast:{minParams:2,maxParams:2,evaluate:(e,t)=>{let r=e[0],a=e[1];if(null===r)return null;switch(a.type){case"integer":{if(!q(r))throw new o.L8(o.Z7.CannotCastValue);let e=parseInt(r,10);if(isNaN(e))throw new o.L8(o.Z7.CannotCastValue);return e}case"smallint":{if(!q(r))throw new o.L8(o.Z7.CannotCastValue);let e=parseInt(r,10);if(isNaN(e)||e>32767||e<-32767)throw new o.L8(o.Z7.CannotCastValue);return e}case"float":case"real":{if(!q(r))throw new o.L8(o.Z7.CannotCastValue);let e=parseFloat(r);if(isNaN(e))throw new o.L8(o.Z7.CannotCastValue);return e}case"time":return function(e){if((0,D.$P)(e))return f.k.fromDateJS(e);if(x(e))return f.k.fromDateTime(e);if(C(e))throw new o.L8(o.Z7.CannotCastValue);if(E(e))return e;if(Z(e))return f.k.fromSqlTimeStampOffset(e);if((0,D.Kg)(e))return M(e);throw new o.L8(o.Z7.CannotCastValue)}(r);case"date":return function(e){if((0,D.$P)(e))return s.n.fromDateJS(e);if(x(e))return s.n.fromParts(e.year,e.month,e.day);if(C(e))return e;if(E(e)||Z(e)&&null===s.n.fromParts(e.year,e.month,e.day))throw new o.L8(o.Z7.CannotCastValue);if((0,D.Kg)(e)){let t=s.n.fromReader(e);if(null!==t&&t.isValid)return t}throw new o.L8(o.Z7.CannotCastValue)}(r);case"timestamp":return function(e,t,r){if((0,D.$P)(e))return S(e,t);if(x(e))return e;if(C(e))return e.toDateTimeLuxon("unknown");if(E(e))throw new o.L8(o.Z7.CannotCastValue);if(Z(e))return e;if((0,D.Kg)(e))return b(e,"unknown",r);throw new o.L8(o.Z7.CannotCastValue)}(r,t,!0===a.withtimezone);case"varchar":{let e=function e(t){return C(t)||E(t)?t.toString():Z(t)?t.toSQLValue():x(t)?0===t.millisecond?t.toFormat("yyyy-LL-dd HH:mm:ss"):t.toSQL({includeOffset:!1}):(0,D.$P)(t)?e(h.c9.fromJSDate(t)):t.toString()}(r);if(e.length>a.size)throw new o.L8(o.Z7.CannotCastValue);return e}default:throw new o.L8(o.Z7.InvalidDataType)}}}};function K(e,t,r,a){if("||"===e)return z("concat",[t,r],a);if(null===t||null===r)return null;if((0,D.Et)(t)){if((0,D.Et)(r))return Y(t,r,e);if(O(r)){var n=t,i=r,s=e;switch(s){case"+":return d.createFromMilliseconds(n+i.valueInMilliseconds());case"-":return d.createFromMilliseconds(n-i.valueInMilliseconds());case"*":return d.createFromMilliseconds(n*i.valueInMilliseconds());case"/":return d.createFromMilliseconds(n/i.valueInMilliseconds())}throw new o.L8(o.Z7.InvalidOperator)}if(E(r)||C(r)||Z(r)||x(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();if((0,D.Kg)(r)){var l=t,u=r,c=e;let a=parseFloat(u);if(isNaN(a))throw new o.L8(o.Z7.InvalidOperator);return Y(l,a,c)}throw new o.L8(o.Z7.InvalidOperator)}if(C(t)){if((0,D.Et)(r)){var p=t,f=r,m=e;let a=1e3*f*86400;switch(m){case"+":return p.plus("milliseconds",a);case"-":return p.plus("milliseconds",-1*a)}throw new o.L8(o.Z7.InvalidOperator)}if(O(r)){var h=t,v=r,w=e;switch(w){case"+":return h.plus("milliseconds",v.valueInMilliseconds());case"-":return h.plus("milliseconds",-1*v.valueInMilliseconds())}throw new o.L8(o.Z7.InvalidOperator)}if(E(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();if(C(r)){var g=t,I=r,y=e;if("-"===y)return g.toDateTimeLuxon("UTC").diff(I.toDateTimeLuxon("UTC")).as("days");throw new o.L8(o.Z7.InvalidOperator)}if(Z(r)){var T=t,L=r,N=e;if("-"===N)return T.toDateTimeLuxon(L.toDateTime().zone).diff(L.toDateTime()).as("days");throw new o.L8(o.Z7.InvalidOperator)}if(x(r)){var S=t,M=r,b=e;if("-"===b)return S.toDateTimeLuxon(M.zone).diff(M).as("days");throw new o.L8(o.Z7.InvalidOperator)}if((0,D.Kg)(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();throw new o.L8(o.Z7.InvalidOperator)}if(E(t)){if((0,D.Et)(r)){var P=t,F=r,A=e;let a=1e3*F*86400;switch(A){case"+":return P.plus("milliseconds",a);case"-":return P.plus("milliseconds",-1*a)}throw new o.L8(o.Z7.InvalidOperator)}if(O(r)){var R=t,_=r,U=e;switch(U){case"+":return R.plus("milliseconds",_.valueInMilliseconds());case"-":return R.plus("milliseconds",-1*_.valueInMilliseconds())}throw new o.L8(o.Z7.InvalidOperator)}if(E(r)||C(r)||Z(r)||x(r)||(0,D.Kg)(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();throw new o.L8(o.Z7.InvalidOperator)}if(O(t)){if((0,D.Et)(r)){var $=t,J=r,k=e;switch(k){case"+":return d.createFromMilliseconds($.valueInMilliseconds()+J);case"-":return d.createFromMilliseconds($.valueInMilliseconds()-J);case"*":return d.createFromMilliseconds($.valueInMilliseconds()*J);case"/":return d.createFromMilliseconds($.valueInMilliseconds()/J)}throw new o.L8(o.Z7.InvalidOperator)}if(O(r)){var V=t,q=r,H=e;switch(H){case"+":return d.createFromMilliseconds(V.valueInMilliseconds()+q.valueInMilliseconds());case"-":return d.createFromMilliseconds(V.valueInMilliseconds()-q.valueInMilliseconds());case"*":return d.createFromMilliseconds(V.valueInMilliseconds()*q.valueInMilliseconds());case"/":return d.createFromMilliseconds(V.valueInMilliseconds()/q.valueInMilliseconds())}throw new o.L8(o.Z7.InvalidOperator)}if(E(r)||C(r)){var K=t,Q=r,j=e;if("+"===j)return Q.plus("milliseconds",K.valueInMilliseconds());throw new o.L8(o.Z7.InvalidOperator)}if(Z(r)){var B=t,G=r,W=e;if("+"===W)return G.addMilliseconds(B.valueInMilliseconds());throw new o.L8(o.Z7.InvalidOperator)}if(x(r)){var X=t,ee=r,et=e;switch(et){case"+":return ee.plus({milliseconds:X.valueInMilliseconds()});case"-":return X.valueInMilliseconds()-ee.toMillis()}throw new o.L8(o.Z7.InvalidOperator)}if((0,D.Kg)(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();throw new o.L8(o.Z7.InvalidOperator)}if(x(t)){if((0,D.Et)(r)){var er=t,ea=r,en=e;let a=1e3*ea*86400;switch(en){case"+":return er.plus({milliseconds:a});case"-":return er.minus({milliseconds:a})}throw new o.L8(o.Z7.InvalidOperator)}if(O(r)){var ei=t,es=r,eo=e;switch(eo){case"+":return ei.plus({milliseconds:es.valueInMilliseconds()});case"-":return ei.minus({milliseconds:es.valueInMilliseconds()})}throw new o.L8(o.Z7.InvalidOperator)}if(E(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();if(C(r)){var el=t,eu=r,ec=e;if("-"===ec)return el.diff(eu.toDateTimeLuxon(el.zone)).as("days");throw new o.L8(o.Z7.InvalidOperator)}if(Z(r)){var ed=t,ep=r,ef=e;if("-"===ef)return ed.diff(ep.toDateTime()).as("days");throw new o.L8(o.Z7.InvalidOperator)}if(x(r)){var em=t,eh=r,ev=e;if("-"===ev)return em.diff(eh).as("days");throw new o.L8(o.Z7.InvalidOperator)}if((0,D.Kg)(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();throw new o.L8(o.Z7.InvalidOperator)}if(Z(t)){if((0,D.Et)(r)){var ew=t,eg=r,eI=e;let a=1e3*eg*86400;switch(eI){case"+":return ew.addMilliseconds(a);case"-":return ew.addMilliseconds(-1*a)}throw new o.L8(o.Z7.InvalidOperator)}if(O(r)){var ey=t,eT=r,eL=e;switch(eL){case"+":return ey.addMilliseconds(eT.valueInMilliseconds());case"-":return ey.addMilliseconds(-1*eT.valueInMilliseconds())}throw new o.L8(o.Z7.InvalidOperator)}if(E(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();if(C(r)){var eN=t,eS=r,eO=e;if("-"===eO)return eN.toDateTime().diff(eS.toDateTimeLuxon(eN.toDateTime().zone)).as("days");throw new o.L8(o.Z7.InvalidOperator)}if(Z(r)){var ex=t,eC=r,eE=e;if("-"===eE)return ex.toDateTime().diff(eC.toDateTime()).as("days");throw new o.L8(o.Z7.InvalidOperator)}if(x(r)){var eZ=t,eM=r,eb=e;if("-"===eb)return eZ.toDateTime().diff(eM).as("days");throw new o.L8(o.Z7.InvalidOperator)}if((0,D.Kg)(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();throw new o.L8(o.Z7.InvalidOperator)}if((0,D.Kg)(t)){if((0,D.Et)(r)){var eP=t,eF=r,eA=e;let a=parseFloat(eP);if(isNaN(a))throw new o.L8(o.Z7.InvalidOperator);return Y(a,eF,eA)}if(O(r)||E(r)||C(r)||Z(r)||x(r))return function(e,t,r){throw new o.L8(o.Z7.InvalidOperator)}();if((0,D.Kg)(r)){var eD=t,eR=r,e_=e;if("+"===e_)return eD+eR;}}throw new o.L8(o.Z7.InvalidOperator)}function Y(e,t,r){switch(r){case"+":return e+t;case"-":return e-t;case"*":return e*t;case"/":return e/t}throw new o.L8(o.Z7.InvalidOperator)}function Q(e,t,r,a){var n=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(n,Q.prototype),n.expected=t,n.found=r,n.location=a,n.name="SyntaxError",n}function j(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}(function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r})(Q,Error),Q.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,a=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){a=e[r].text.split(/\r\n|\n|\r/g);break}var n=this.location.start,i=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(n):n,s=this.location.source+":"+i.line+":"+i.column;if(a){var o=this.location.end,l=j("",i.line.toString().length," "),u=a[n.line-1],c=(n.line===o.line?o.column:u.length+1)-n.column||1;t+="\n --\x3e "+s+"\n"+l+" |\n"+i.line+" | "+u+"\n"+l+" | "+j("",n.column-1," ")+j("",c,"^")}else t+="\n at "+s}return t},Q.buildMessage=function(e,t){var r={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t=e.parts.map(function(e){return Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e)});return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+a(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+a(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+a(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+a(e)})}function s(e){return r[e.type](e)}return"Expected "+function(e){var t,r,a=e.map(s);if(a.sort(),a.length>0){for(t=1,r=1;t<a.length;t++)a[t-1]!==a[t]&&(a[r]=a[t],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."};class B{static parse(e){return function(e,t){var r,a,n,i,s={},o=(t=void 0!==t?t:{}).grammarSource,l={start:e5},u=e5,c=/^[<-=]/,d=/^[+\-]/,p=/^[*\/]/,f=/^[A-Za-z_\x80-\uFFFF]/,m=/^[A-Za-z0-9_]/,h=/^[A-Za-z0-9_.\x80-\uFFFF]/,v=/^["]/,w=/^[^']/,g=/^[0-9]/,I=/^[eE]/,y=/^[ \t\n\r]/,T=/^[^`]/,L=e8("!",!1),N=e8("=",!1),S=e8(">=",!1),O=e8(">",!1),x=e8("<=",!1),C=e8("<>",!1),E=e4([["<","="]],!1,!1),Z=e8("!=",!1),M=e4(["+","-"],!1,!1),b=e8("||",!1),P=e4(["*","/"],!1,!1),F=e4([["A","Z"],["a","z"],"_",["\x80","￿"]],!1,!1),A=e4([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),D=e4([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","￿"]],!1,!1),R=e4(['"'],!1,!1),_=e8("@",!1),U=e8("'",!1),$=e8("N'",!1),J=e8("''",!1),k=e4(["'"],!0,!1),V=e8(".",!1),z=e4([["0","9"]],!1,!1),q=e4(["e","E"],!1,!1),H=e8("NULL",!0),K=e8("TRUE",!0),Y=e8("FALSE",!0),j=e8("IN",!0),B=e8("IS",!0),G=e8("LIKE",!0),W=e8("ESCAPE",!0),X=e8("NOT",!0),ee=e8("AND",!0),et=e8("OR",!0),er=e8("BETWEEN",!0),ea=e8("FROM",!0),en=e8("FOR",!0),ei=e8("SUBSTRING",!0),es=e8("EXTRACT",!0),eo=e8("TRIM",!0),el=e8("POSITION",!0),eu=e8("TIMESTAMP",!0),ec=e8("DATE",!0),ed=e8("TIME",!0),ep=e8("LEADING",!0),ef=e8("TRAILING",!0),em=e8("BOTH",!0),eh=e8("CAST",!0),ev=e8("AS",!0),ew=e8("INTEGER",!0),eg=e8("INT",!0),eI=e8("SMALLINT",!0),ey=e8("FLOAT",!0),eT=e8("REAL",!0),eL=e8("VARCHAR",!0),eN=e8("TO",!0),eS=e8("INTERVAL",!0),eO=e8("YEAR",!0),ex=e8("TIMEZONE_HOUR",!0),eC=e8("TIMEZONE_MINUTE",!0),eE=e8("MONTH",!0),eZ=e8("DAY",!0),eM=e8("HOUR",!0),eb=e8("MINUTE",!0),eP=e8("SECOND",!0),eF=e8("CASE",!0),eA=e8("END",!0),eD=e8("WHEN",!0),eR=e8("THEN",!0),e_=e8("ELSE",!0),eU=e8(",",!1),e$=e8("(",!1),eJ=e8(")",!1),ek=e4([" ","	","\n","\r"],!1,!1),eV=e8("`",!1),ez=e4(["`"],!0,!1),eq=function(e,t,r){return{op:t,expr:r,location:e2()}},eH=function(e,t,r){return{op:t,expr:r,location:e2()}},eK=function(e,t){return{op:e,expr:t,location:e2()}},eY=function(e,t,r){return{op:t,expr:r,location:e2()}},eQ=function(e,t,r){return{op:t,expr:r,location:e2()}},ej=function(){return"'"},eB=0|t.peg$currPos,eG=eB,eW=[{line:1,column:1}],eX=eB,e0=t.peg$maxFailExpected||[],e1=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in l))throw Error("Can't start parsing from rule \""+t.startRule+'".');u=l[t.startRule]}function e2(){return e3(eG,eB)}function e7(e,t){throw new Q(e,null,null,t=void 0!==t?t:e3(eG,eB))}function e8(e,t){return{type:"literal",text:e,ignoreCase:t}}function e4(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function e9(t){var r,a=eW[t];if(a)return a;if(t>=eW.length)r=eW.length-1;else for(r=t;!eW[--r];);for(a={line:(a=eW[r]).line,column:a.column};r<t;)10===e.charCodeAt(r)?(a.line++,a.column=1):a.column++,r++;return eW[t]=a,a}function e3(e,t,r){var a=e9(e),n=e9(t);return{source:o,start:{offset:e,line:a.line,column:a.column},end:{offset:t,line:n.line,column:n.column}}}function e6(e){eB<eX||(eB>eX&&(eX=eB,e0=[]),e0.push(e))}function e5(){var e,t;return e=eB,t6(),(t=tt())!==s?(t6(),eG=e,e=t):(eB=e,e=s),e}function te(){var e,t,r,a,n,i;if(e=eB,t9()!==s){for(t6(),t=[],r=tt();r!==s;)t.push(r),r=eB,a=eB,n=t6(),(i=t4())!==s?a=n=[n,i,t6()]:(eB=a,a=s),a!==s&&(a=tt())===s?(eB=r,r=s):r=a;r=t6(),(a=t3())!==s?(eG=e,e={type:"expression-list",location:e2(),value:t}):(eB=e,e=s)}else eB=e,e=s;return e}function tt(){var e,t,r,a,n,i;if(e=eB,(t=tr())!==s){for(r=[],a=eB,t6(),(n=tk())!==s?(t6(),(i=tr())!==s?(eG=a,a=eq(t,n,i)):(eB=a,a=s)):(eB=a,a=s);a!==s;)r.push(a),a=eB,t6(),(n=tk())!==s?(t6(),(i=tr())!==s?(eG=a,a=eq(t,n,i)):(eB=a,a=s)):(eB=a,a=s);eG=e,e=rr(t,r)}else eB=e,e=s;return e}function tr(){var e,t,r,a,n,i;if(e=eB,(t=ta())!==s){for(r=[],a=eB,t6(),(n=tJ())!==s?(t6(),(i=ta())!==s?(eG=a,a=eH(t,n,i)):(eB=a,a=s)):(eB=a,a=s);a!==s;)r.push(a),a=eB,t6(),(n=tJ())!==s?(t6(),(i=ta())!==s?(eG=a,a=eH(t,n,i)):(eB=a,a=s)):(eB=a,a=s);eG=e,e=rr(t,r)}else eB=e,e=s;return e}function ta(){var t,r,a,n,i,o;return t=eB,(r=t$())===s&&(r=eB,33===e.charCodeAt(eB)?(a="!",eB++):(a=s,0===e1&&e6(L)),a!==s?(n=eB,e1++,61===e.charCodeAt(eB)?(i="=",eB++):(i=s,0===e1&&e6(N)),e1--,i===s?n=void 0:(eB=n,n=s),n!==s?r=a=[a,n]:(eB=r,r=s)):(eB=r,r=s)),r!==s?(a=t6(),(n=ta())!==s?(eG=t,o=n,t={type:"unary-expression",location:e2(),operator:"NOT",expr:o}):(eB=t,t=s)):(eB=t,t=s),t===s&&(t=function(){var t,r,a,n,i,o,l,u,c,d,p,f,m,h,v,w,g,I,y,T,L;return t=eB,(r=to())!==s?(a=eB,t6(),((o=function(){var e,t,r,a,n;if(e=eB,t=[],r=eB,t6(),(a=tn())!==s?(t6(),(n=to())!==s?(eG=r,r=eK(a,n)):(eB=r,r=s)):(eB=r,r=s),r!==s)for(;r!==s;)t.push(r),r=eB,t6(),(a=tn())!==s?(t6(),(n=to())!==s?(eG=r,r=eK(a,n)):(eB=r,r=s)):(eB=r,r=s);else t=s;return t!==s&&(eG=e,t={type:"arithmetic",tail:t}),e=t}())===s&&(l=eB,(u=ts())!==s?(t6(),(c=te())!==s?(eG=l,l={op:u,right:c}):(eB=l,l=s)):(eB=l,l=s),l===s&&(l=eB,(u=ts())!==s?(t6(),(c=tg())!==s?(eG=l,l={op:u,right:c}):(eB=l,l=s)):(eB=l,l=s)),(o=l)===s)&&(o=function(){var e,t,r,a,n,i,o,l,u,c,d;return e=eB,(t=t$())!==s?(t6(),(r=tV())!==s?(a=t6(),n=eB,(i=to())!==s?(t6(),(o=tJ())!==s?(t6(),(l=to())!==s?(eG=n,u=i,n=rt(e2(),u,l)):(eB=n,n=s)):(eB=n,n=s)):(eB=n,n=s),n!==s?(eG=e,e={op:"NOT"+r,right:n}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=tV())!==s?(t6(),r=eB,(a=to())!==s?(n=t6(),(i=tJ())!==s?(t6(),(o=to())!==s?(eG=r,c=a,d=o,r=rt(e2(),c,d)):(eB=r,r=s)):(eB=r,r=s)):(eB=r,r=s),r!==s?(eG=e,e={op:t,right:r}):(eB=e,e=s)):(eB=e,e=s)),e}())===s&&(d=eB,(p=t_())!==s?(t6(),(f=t$())!==s?(t6(),(m=to())!==s?(eG=d,d={op:p+"NOT",right:m}):(eB=d,d=s)):(eB=d,d=s)):(eB=d,d=s),d===s&&(d=eB,(p=t_())!==s?(t6(),(f=to())!==s?(eG=d,d={op:p,right:f}):(eB=d,d=s)):(eB=d,d=s)),(o=d)===s)&&(h=eB,(v=ti())!==s?(t6(),(w=tx())!==s?(t6(),(I=eB,"escape"===(y=e.substr(eB,6)).toLowerCase()?eB+=6:(y=s,0===e1&&e6(W)),y!==s?(T=eB,e1++,L=tm(),e1--,L===s?T=void 0:(eB=T,T=s),T!==s?(eG=I,I="ESCAPE"):(eB=I,I=s)):(eB=I,I=s),I!==s)?(t6(),(g=tC())!==s?(eG=h,h={op:v,right:w,escape:g.value}):(eB=h,h=s)):(eB=h,h=s)):(eB=h,h=s)):(eB=h,h=s),h===s&&(h=eB,(v=ti())!==s?(t6(),(w=tx())!==s?(eG=h,h={op:v,right:w,escape:""}):(eB=h,h=s)):(eB=h,h=s)),o=h),(n=o)!==s)?a=n:(eB=a,a=s),a===s&&(a=null),eG=t,t=""==(i=a)||null==i||null==i?r:"arithmetic"==i.type?rr(r,i.tail):re(i.op,r,i.right,i.escape,e2())):(eB=t,t=s),t}()),t}function tn(){var t;return">="===e.substr(eB,2)?(t=">=",eB+=2):(t=s,0===e1&&e6(S)),t===s&&(62===e.charCodeAt(eB)?(t=">",eB++):(t=s,0===e1&&e6(O)),t===s&&("<="===e.substr(eB,2)?(t="<=",eB+=2):(t=s,0===e1&&e6(x)),t===s&&("<>"===e.substr(eB,2)?(t="<>",eB+=2):(t=s,0===e1&&e6(C)),t===s&&(t=e.charAt(eB),c.test(t)?eB++:(t=s,0===e1&&e6(E)),t===s&&("!="===e.substr(eB,2)?(t="!=",eB+=2):(t=s,0===e1&&e6(Z))))))),t}function ti(){var e,t,r,a,n,i;return e=eB,t=eB,(r=t$())!==s?(a=t6(),(n=tU())!==s?t=r=[r,a,n]:(eB=t,t=s)):(eB=t,t=s),t!==s&&(eG=e,t=(i=t)[0]+" "+i[2]),(e=t)===s&&(e=tU()),e}function ts(){var e,t,r,a,n,i;return e=eB,t=eB,(r=t$())!==s?(a=t6(),(n=tR())!==s?t=r=[r,a,n]:(eB=t,t=s)):(eB=t,t=s),t!==s&&(eG=e,t=(i=t)[0]+" "+i[2]),(e=t)===s&&(e=tR()),e}function to(){var e,t,r,a,n,i;if(e=eB,(t=tu())!==s){for(r=[],a=eB,t6(),(n=tl())!==s?(t6(),(i=tu())!==s?(eG=a,a=eY(t,n,i)):(eB=a,a=s)):(eB=a,a=s);a!==s;)r.push(a),a=eB,t6(),(n=tl())!==s?(t6(),(i=tu())!==s?(eG=a,a=eY(t,n,i)):(eB=a,a=s)):(eB=a,a=s);eG=e,e=rr(t,r)}else eB=e,e=s;return e}function tl(){var t;return t=e.charAt(eB),d.test(t)?eB++:(t=s,0===e1&&e6(M)),t===s&&("||"===e.substr(eB,2)?(t="||",eB+=2):(t=s,0===e1&&e6(b))),t}function tu(){var e,t,r,a,n,i;if(e=eB,(t=td())!==s){for(r=[],a=eB,t6(),(n=tc())!==s?(t6(),(i=td())!==s?(eG=a,a=eQ(t,n,i)):(eB=a,a=s)):(eB=a,a=s);a!==s;)r.push(a),a=eB,t6(),(n=tc())!==s?(t6(),(i=td())!==s?(eG=a,a=eQ(t,n,i)):(eB=a,a=s)):(eB=a,a=s);eG=e,e=rr(t,r)}else eB=e,e=s;return e}function tc(){var t;return t=e.charAt(eB),p.test(t)?eB++:(t=s,0===e1&&e6(P)),t}function td(){var t,r,a,n,i,o,l,u,c,p,f,m,h,v,w,g,I,y,L,N,S,O,x,C,E,Z,b,P,F,A,D,R,_,U,$,J,k,V,z,q,Q,j,B,G,W,X,ee,et,er,ea,es,eu,ec,ed,ep,ef,em,ew,eg,eI,ey,eT,eL,eN,eS,eO,ex,eC,eE,eZ,eM,eb,eP,eF,eA,eD,eR,e_,eU,e$,eJ,ek,eq,eH,eK,eY,eQ,ej,eW;return(a=tC())===s&&(a=function(){var e,t,r,a,n,i,o,l;return e=eB,(n=eB,(i=tb())!==s&&(o=tP())!==s&&(l=tF())!==s?(eG=n,n=parseFloat(i+o+l)):(eB=n,n=s),n===s&&(n=eB,(i=tb())!==s&&(o=tP())!==s?(eG=n,n=parseFloat(i+o)):(eB=n,n=s),n===s&&(n=eB,(i=tb())!==s&&(o=tF())!==s?(eG=n,n=parseFloat(i+o)):(eB=n,n=s),n===s&&(n=eB,(i=tb())!==s&&(eG=n,i=parseFloat(i)),n=i))),(t=n)!==s)?(r=eB,e1++,a=tf(),e1--,a===s?r=void 0:(eB=r,r=s),r!==s?(eG=e,e={type:"number",location:e2(),value:t}):(eB=e,e=s)):(eB=e,e=s),e}())===s&&(n=eB,o=eB,"true"===(l=e.substr(eB,4)).toLowerCase()?eB+=4:(l=s,0===e1&&e6(K)),l!==s?(u=eB,e1++,c=tm(),e1--,c===s?u=void 0:(eB=u,u=s),u!==s?o=l=[l,u]:(eB=o,o=s)):(eB=o,o=s),(i=o)!==s&&(eG=n,i={type:"boolean",location:e2(),value:!0}),(n=i)===s&&(n=eB,p=eB,"false"===(f=e.substr(eB,5)).toLowerCase()?eB+=5:(f=s,0===e1&&e6(Y)),f!==s?(m=eB,e1++,h=tm(),e1--,h===s?m=void 0:(eB=m,m=s),m!==s?p=f=[f,m]:(eB=p,p=s)):(eB=p,p=s),(i=p)!==s&&(eG=n,i={type:"boolean",location:e2(),value:!1}),n=i),(a=n)===s)&&(v=eB,g=eB,"null"===(I=e.substr(eB,4)).toLowerCase()?eB+=4:(I=s,0===e1&&e6(H)),I!==s?(y=eB,e1++,L=tm(),e1--,L===s?y=void 0:(eB=y,y=s),y!==s?g=I=[I,y]:(eB=g,g=s)):(eB=g,g=s),(w=g)!==s&&(eG=v,w={type:"null",location:e2(),value:null}),(a=v=w)===s)&&(a=function(){var e,t,r;return e=eB,tK()!==s?(t6(),(t=tx())!==s?(eG=e,"string"===t.type&&(r=t.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(r)&&e7("Date literal is invalid")),e={type:"date",location:e2(),value:t.value}):(eB=e,e=s)):(eB=e,e=s),e}())===s&&(a=function(){var e,t,r;return e=eB,tH()!==s?(t6(),(t=tx())!==s?(eG=e,"string"===t.type&&(r=t.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(r)&&e7("Timestamp literal is invalid")),e={type:"timestamp",location:e2(),value:t.value}):(eB=e,e=s)):(eB=e,e=s),e}())===s&&(a=function(){var t,r,a,n,i,o,l,u;return t=eB,tQ()!==s?(t6(),r=e.charAt(eB),d.test(r)?eB++:(r=s,0===e1&&e6(M)),r!==s?(t6(),(a=tx())!==s?(t6(),(n=tL())!==s?(eG=t,i=r,o=a,t={type:"interval",location:e2(),value:o,qualifier:n,op:i}):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s),t===s&&(t=eB,tQ()!==s?(t6(),(r=tx())!==s?(t6(),(a=tL())!==s?(eG=t,l=r,u=a,t={type:"interval",location:e2(),value:l,qualifier:u,op:""}):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s)),t}())===s&&(a=function(){var e,t,r;return e=eB,tY()!==s?(t6(),(t=tx())!==s?(eG=e,"string"===t.type&&(r=t.value,!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(r)&&e7("Time literal is invalid")),e={type:"time",location:e2(),value:t.value}):(eB=e,e=s)):(eB=e,e=s),e}()),(t=a)===s&&(N=eB,tq()!==s?(t6(),S=eB,t9()!==s?(t6(),(O=tT())!==s?(t6(),tz()!==s?(t6(),(x=tt())!==s?(t6(),t3()!==s?(eG=S,C=O,E=x,S=rt(e2(),C,E)):(eB=S,S=s)):(eB=S,S=s)):(eB=S,S=s)):(eB=S,S=s)):(eB=S,S=s),S===s&&(S=eB,t9()!==s?(t6(),(O=tT())!==s?(t6(),t4()!==s?(t6(),(x=tt())!==s?(t6(),t3()!==s?(eG=S,Z=O,b=x,S=rt(e2(),Z,b)):(eB=S,S=s)):(eB=S,S=s)):(eB=S,S=s)):(eB=S,S=s)):(eB=S,S=s)),S!==s?(eG=N,P=S,N={type:"function",location:e2(),name:"extract",args:P}):(eB=N,N=s)):(eB=N,N=s),(t=N)===s)&&(F=eB,(B=eB,"substring"===(G=e.substr(eB,9)).toLowerCase()?eB+=9:(G=s,0===e1&&e6(ei)),G!==s?(W=eB,e1++,X=tm(),e1--,X===s?W=void 0:(eB=W,W=s),W!==s?(eG=B,B="SUBSTRING"):(eB=B,B=s)):(eB=B,B=s),B!==s)?(t6(),A=eB,t9()!==s?(t6(),(D=tt())!==s?(t6(),tz()!==s?(t6(),(R=tt())!==s?(t6(),_=eB,(ee=eB,"for"===(et=e.substr(eB,3)).toLowerCase()?eB+=3:(et=s,0===e1&&e6(en)),et!==s?(er=eB,e1++,ea=tm(),e1--,ea===s?er=void 0:(eB=er,er=s),er!==s?(eG=ee,ee="FOR"):(eB=ee,ee=s)):(eB=ee,ee=s),ee!==s)?(U=t6(),($=tt())!==s?(t6(),_=$):(eB=_,_=s)):(eB=_,_=s),_===s&&(_=null),t3()!==s?(eG=A,J=D,k=R,V=_,A=rt(e2(),J,k,...V?[V]:[])):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s),A===s&&(A=eB,t9()!==s?(t6(),(D=tt())!==s?(t6(),t4()!==s?(t6(),(R=tt())!==s?(t6(),(_=t4())!==s?(t6(),(U=tt())!==s&&($=t3())!==s?(eG=A,z=D,q=R,Q=U,A=rt(e2(),z,q,Q)):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s)):(eB=A,A=s)),A!==s?(eG=F,j=A,F={type:"function",location:e2(),name:"substring",args:j}):(eB=F,F=s)):(eB=F,F=s),(t=F)===s)&&(t=function(){var t,r,a,n,i,o,l,u,c,d,p,f,m,h;return t=eB,(p=eB,"trim"===(f=e.substr(eB,4)).toLowerCase()?eB+=4:(f=s,0===e1&&e6(eo)),f!==s?(m=eB,e1++,h=tm(),e1--,h===s?m=void 0:(eB=m,m=s),m!==s?(eG=p,p="TRIM"):(eB=p,p=s)):(eB=p,p=s),p!==s)?(t6(),r=eB,t9()!==s?(t6(),a=ty(),t6(),(n=tt())!==s?(t6(),tz()!==s?(t6(),(i=tt())!==s?(t6(),t3()!==s?(eG=r,o=a,l=n,r=rt(e2(),o,l,i)):(eB=r,r=s)):(eB=r,r=s)):(eB=r,r=s)):(eB=r,r=s)):(eB=r,r=s),r===s&&(r=eB,t9()!==s?(t6(),a=ty(),t6(),(n=tt())!==s?(t6(),t3()!==s?(eG=r,u=a,c=n,r=rt(e2(),u,c)):(eB=r,r=s)):(eB=r,r=s)):(eB=r,r=s)),r!==s?(eG=t,d=r,t={type:"function",location:e2(),name:"trim",args:d}):(eB=t,t=s)):(eB=t,t=s),t}())===s&&(es=eB,(eI=eB,"position"===(ey=e.substr(eB,8)).toLowerCase()?eB+=8:(ey=s,0===e1&&e6(el)),ey!==s?(eT=eB,e1++,eL=tm(),e1--,eL===s?eT=void 0:(eB=eT,eT=s),eT!==s?(eG=eI,eI="POSITION"):(eB=eI,eI=s)):(eB=eI,eI=s),eI!==s)?(t6(),eu=eB,t9()!==s?(t6(),(ec=tt())!==s?(t6(),tR()!==s?(t6(),(ed=tt())!==s?(t6(),t3()!==s?(eG=eu,ep=ec,ef=ed,eu=rt(e2(),ep,ef)):(eB=eu,eu=s)):(eB=eu,eu=s)):(eB=eu,eu=s)):(eB=eu,eu=s)):(eB=eu,eu=s),eu===s&&(eu=eB,t9()!==s?(t6(),(ec=tt())!==s?(t6(),t4()!==s?(t6(),(ed=tt())!==s?(t6(),t3()!==s?(eG=eu,em=ec,ew=ed,eu=rt(e2(),em,ew)):(eB=eu,eu=s)):(eB=eu,eu=s)):(eB=eu,eu=s)):(eB=eu,eu=s)):(eB=eu,eu=s)),eu!==s?(eG=es,eg=eu,es={type:"function",location:e2(),name:"position",args:eg}):(eB=es,es=s)):(eB=es,es=s),(t=es)===s)&&(eN=eB,(eP=eB,"cast"===(eF=e.substr(eB,4)).toLowerCase()?eB+=4:(eF=s,0===e1&&e6(eh)),eF!==s?(eA=eB,e1++,eD=tm(),e1--,eD===s?eA=void 0:(eB=eA,eA=s),eA!==s?(eG=eP,eP="CAST"):(eB=eP,eP=s)):(eB=eP,eP=s),eP!==s)?(t6(),eS=eB,t9()!==s?(t6(),(eO=tt())!==s?(t6(),(eR=eB,"as"===(e_=e.substr(eB,2)).toLowerCase()?eB+=2:(e_=s,0===e1&&e6(ev)),e_!==s?(eU=eB,e1++,e$=tm(),e1--,e$===s?eU=void 0:(eB=eU,eU=s),eU!==s?(eG=eR,eR="AS"):(eB=eR,eR=s)):(eB=eR,eR=s),eR!==s)?(t6(),(ex=tI())!==s?(t6(),t3()!==s?(eG=eS,eC=eO,eE=ex,eS=rt(e2(),eC,eE)):(eB=eS,eS=s)):(eB=eS,eS=s)):(eB=eS,eS=s)):(eB=eS,eS=s)):(eB=eS,eS=s),eS===s&&(eS=eB,t9()!==s?(t6(),(eO=tt())!==s?(t6(),t4()!==s?(t6(),(ex=tI())!==s?(t6(),t3()!==s?(eG=eS,eZ=eO,eM=ex,eS=rt(e2(),eZ,eM)):(eB=eS,eS=s)):(eB=eS,eS=s)):(eB=eS,eS=s)):(eB=eS,eS=s)):(eB=eS,eS=s)),eS!==s?(eG=eN,eb=eS,eN={type:"function",location:e2(),name:"cast",args:eb}):(eB=eN,eN=s)):(eB=eN,eN=s),(t=eN)===s)&&(t=function(){var t,r,a,n,i;return t=eB,r=eB,e1++,a=tq(),e1--,a===s?r=void 0:(eB=r,r=s),r!==s&&(a=function(){var t,r,a,n;if(t=eB,(r=tp())!==s&&(eG=t),(t=r)===s)if(t=eB,96===e.charCodeAt(eB)?(r="`",eB++):(r=s,0===e1&&e6(eV)),r!==s){if(a=[],n=e.charAt(eB),T.test(n)?eB++:(n=s,0===e1&&e6(ez)),n!==s)for(;n!==s;)a.push(n),n=e.charAt(eB),T.test(n)?eB++:(n=s,0===e1&&e6(ez));else a=s;a!==s?(96===e.charCodeAt(eB)?(n="`",eB++):(n=s,0===e1&&e6(eV)),n!==s?(eG=t,t=a.join("")):(eB=t,t=s)):(eB=t,t=s)}else eB=t,t=s;return t}())!==s?(t6(),(n=te())!==s?(eG=t,i=a,t={type:"function",location:e2(),name:i,args:n}):(eB=t,t=s)):(eB=t,t=s),t}())===s&&((eJ=function(){var e,t,r,a,n,i,o,l,u,c;if(e=eB,t1()!==s)if(t6(),(t=tt())!==s){for(t6(),r=[],a=eB,(n=tZ())!==s?(t6(),a=n):(eB=a,a=s);a!==s;)r.push(a),a=eB,(n=tZ())!==s?(t6(),a=n):(eB=a,a=s);(a=t2())!==s?(eG=e,i=t,o=r,e={type:"case-expression",location:e2(),format:"simple",operand:i,clauses:o,else:null,elseLocation:null}):(eB=e,e=s)}else eB=e,e=s;else eB=e,e=s;if(e===s)if(e=eB,t1()!==s)if(t6(),(t=tt())!==s){for(t6(),r=[],a=eB,(n=tZ())!==s?(t6(),a=n):(eB=a,a=s);a!==s;)r.push(a),a=eB,(n=tZ())!==s?(t6(),a=n):(eB=a,a=s);(a=tM())!==s?(n=t6(),t2()!==s?(eG=e,l=t,u=r,c=a,e={type:"case-expression",location:e2(),format:"simple",operand:l,clauses:u,else:c.value,elseLocation:c.location}):(eB=e,e=s)):(eB=e,e=s)}else eB=e,e=s;else eB=e,e=s;return e}())===s&&(eJ=function(){var e,t,r,a,n,i,o;if(e=eB,t1()!==s){for(t6(),t=[],r=eB,(a=tE())!==s?(t6(),r=a):(eB=r,r=s);r!==s;)t.push(r),r=eB,(a=tE())!==s?(t6(),r=a):(eB=r,r=s);(r=t2())!==s?(eG=e,n=t,e={type:"case-expression",location:e2(),format:"searched",clauses:n,else:null,elseLocation:null}):(eB=e,e=s)}else eB=e,e=s;if(e===s)if(e=eB,t1()!==s){for(t6(),t=[],r=eB,(a=tE())!==s?(t6(),r=a):(eB=r,r=s);r!==s;)t.push(r),r=eB,(a=tE())!==s?(t6(),r=a):(eB=r,r=s);(r=tM())!==s?(a=t6(),t2()!==s?(eG=e,i=t,o=r,e={type:"case-expression",location:e2(),format:"searched",clauses:i,else:o.value,elseLocation:o.location}):(eB=e,e=s)):(eB=e,e=s)}else eB=e,e=s;return e}()),(t=eJ)===s)&&(ek=eB,eY=eB,(eQ=function(){var e,t,r,a;if(e=eB,(t=tf())!==s){for(r=[],a=th();a!==s;)r.push(a),a=th();eG=e,e=t+r.join("")}else eB=e,e=s;return e}())!==s&&(eG=eY),(eq=eY=eQ)!==s&&(eG=ek,eH=eq,eq=/^CURRENT_DATE$/i.test(eH)?{type:"current-time",location:e2(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(eH)?{type:"current-time",location:e2(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(eH)?{type:"current-time",location:e2(),mode:"time"}:/^CURRENT_USER$/i.test(eH)?{type:"current-user",location:e2()}:{type:"column-reference",location:e2(),table:"",column:eH}),(ek=eq)===s&&(ek=eB,ej=eB,tw()!==s?(eW=function(){var e,t,r;for(e=eB,t=[],r=tv();r!==s;)t.push(r),r=tv();return eG=e,e=t=t.join("")}(),tw()!==s?(eG=ej,ej=eW):(eB=ej,ej=s)):(eB=ej,ej=s),(eq=ej)!==s&&(eG=ek,eK=eq,eq={type:"column-reference",location:e2(),table:"",column:eK,delimited:!0}),ek=eq),(t=ek)===s)&&(t=tg())===s&&(t=eB,t9()!==s?(t6(),(r=tt())!==s?(t6(),t3()!==s?(eG=t,r.paren=!0,t=r):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s)),t}function tp(){var e,t,r,a;if(e=eB,(t=tf())!==s){for(r=[],a=tm();a!==s;)r.push(a),a=tm();eG=e,e=t+r.join("")}else eB=e,e=s;return e}function tf(){var t;return t=e.charAt(eB),f.test(t)?eB++:(t=s,0===e1&&e6(F)),t}function tm(){var t;return t=e.charAt(eB),m.test(t)?eB++:(t=s,0===e1&&e6(A)),t}function th(){var t;return t=e.charAt(eB),h.test(t)?eB++:(t=s,0===e1&&e6(D)),t}function tv(){var t,r,a;return r=e.charAt(eB),h.test(r)?eB++:(r=s,0===e1&&e6(D)),(t=r)===s&&(a=eB,tw()!==s&&tw()!==s?(eG=a,a='"'):(eB=a,a=s),t=a),t}function tw(){var t;return t=e.charAt(eB),v.test(t)?eB++:(t=s,0===e1&&e6(R)),t}function tg(){var t,r,a,n,i;return t=eB,r=eB,64===e.charCodeAt(eB)?(a="@",eB++):(a=s,0===e1&&e6(_)),a!==s&&(n=tp())!==s?r=a=[a,n]:(eB=r,r=s),r!==s&&(eG=t,i=r,r={type:"parameter",location:e2(),value:i[1]}),t=r}function tI(){var t,r,a,n,i,o,l,u,c,d,p,f,m,h,v,w,g,I,y,T,L,N,S,O,x,C,E;return t=eB,n=eB,"integer"===(i=e.substr(eB,7)).toLowerCase()?eB+=7:(i=s,0===e1&&e6(ew)),i!==s?(o=eB,e1++,l=tm(),e1--,l===s?o=void 0:(eB=o,o=s),o!==s?(eG=n,n="INTEGER"):(eB=n,n=s)):(eB=n,n=s),(r=n)===s&&(u=eB,"int"===(c=e.substr(eB,3)).toLowerCase()?eB+=3:(c=s,0===e1&&e6(eg)),c!==s?(d=eB,e1++,p=tm(),e1--,p===s?d=void 0:(eB=d,d=s),d!==s?(eG=u,u="INT"):(eB=u,u=s)):(eB=u,u=s),r=u),r!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"integer"}}),(t=r)===s&&(t=eB,f=eB,"smallint"===(m=e.substr(eB,8)).toLowerCase()?eB+=8:(m=s,0===e1&&e6(eI)),m!==s?(h=eB,e1++,v=tm(),e1--,v===s?h=void 0:(eB=h,h=s),h!==s?(eG=f,f="SMALLINT"):(eB=f,f=s)):(eB=f,f=s),(r=f)!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"smallint"}}),(t=r)===s&&(t=eB,w=eB,"float"===(g=e.substr(eB,5)).toLowerCase()?eB+=5:(g=s,0===e1&&e6(ey)),g!==s?(I=eB,e1++,y=tm(),e1--,y===s?I=void 0:(eB=I,I=s),I!==s?(eG=w,w="FLOAT"):(eB=w,w=s)):(eB=w,w=s),(r=w)!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"float"}}),(t=r)===s&&(t=eB,T=eB,"real"===(L=e.substr(eB,4)).toLowerCase()?eB+=4:(L=s,0===e1&&e6(eT)),L!==s?(N=eB,e1++,S=tm(),e1--,S===s?N=void 0:(eB=N,N=s),N!==s?(eG=T,T="REAL"):(eB=T,T=s)):(eB=T,T=s),(r=T)!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"real"}}),(t=r)===s&&(t=eB,(r=tK())!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"date"}}),(t=r)===s&&(t=eB,(r=tH())!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"timestamp"}}),(t=r)===s&&(t=eB,(r=tY())!==s&&(eG=t,r={type:"data-type",location:e2(),value:{type:"time"}}),(t=r)===s&&(t=eB,(O=eB,"varchar"===(x=e.substr(eB,7)).toLowerCase()?eB+=7:(x=s,0===e1&&e6(eL)),x!==s?(C=eB,e1++,E=tm(),e1--,E===s?C=void 0:(eB=C,C=s),C!==s?(eG=O,O="VARCHAR"):(eB=O,O=s)):(eB=O,O=s),(r=O)!==s)?(t6(),t9()!==s?(t6(),(a=tA())!==s?(t6(),t3()!==s?(eG=t,t={type:"data-type",location:e2(),value:{type:"varchar",size:parseInt(a)}}):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s)))))))),t}function ty(){var t,r,a,n,i,o,l,u,c,d,p,f,m,h,v;return t=eB,n=eB,"leading"===(i=e.substr(eB,7)).toLowerCase()?eB+=7:(i=s,0===e1&&e6(ep)),i!==s?(o=eB,e1++,l=tm(),e1--,l===s?o=void 0:(eB=o,o=s),o!==s?(eG=n,n="LEADING"):(eB=n,n=s)):(eB=n,n=s),(r=n)===s&&(u=eB,"trailing"===(c=e.substr(eB,8)).toLowerCase()?eB+=8:(c=s,0===e1&&e6(ef)),c!==s?(d=eB,e1++,p=tm(),e1--,p===s?d=void 0:(eB=d,d=s),d!==s?(eG=u,u="TRAILING"):(eB=u,u=s)):(eB=u,u=s),(r=u)===s)&&(f=eB,"both"===(m=e.substr(eB,4)).toLowerCase()?eB+=4:(m=s,0===e1&&e6(em)),m!==s?(h=eB,e1++,v=tm(),e1--,v===s?h=void 0:(eB=h,h=s),h!==s?(eG=f,f="BOTH"):(eB=f,f=s)):(eB=f,f=s),r=f),r===s&&(r=null),eG=t,a=r,t=r={type:"string",location:e2(),value:a??"BOTH"}}function tT(){var t,r,a,n,i,o,l,u,c,d,p;return t=eB,(r=tj())===s&&(r=tB())===s&&(r=tG())===s&&(r=tW())===s&&(r=tX())===s&&(r=t0())===s&&(n=eB,"timezone_hour"===(i=e.substr(eB,13)).toLowerCase()?eB+=13:(i=s,0===e1&&e6(ex)),i!==s?(o=eB,e1++,l=tm(),e1--,l===s?o=void 0:(eB=o,o=s),o!==s?(eG=n,n="TIMEZONE_HOUR"):(eB=n,n=s)):(eB=n,n=s),(r=n)===s)&&(u=eB,"timezone_minute"===(c=e.substr(eB,15)).toLowerCase()?eB+=15:(c=s,0===e1&&e6(eC)),c!==s?(d=eB,e1++,p=tm(),e1--,p===s?d=void 0:(eB=d,d=s),d!==s?(eG=u,u="TIMEZONE_MINUTE"):(eB=u,u=s)):(eB=u,u=s),r=u),r!==s&&(eG=t,a=r,r={type:"string",location:e2(),value:a}),t=r}function tL(){var t,r,a,n,i,o,l;return t=eB,(r=function(){var e,t,r,a,n;return e=eB,(t=tN())!==s?(t6(),t9()!==s?(t6(),(r=tO())!==s?(t6(),t3()!==s?(eG=e,a=t,e={type:"interval-period",location:e2(),period:a.value,precision:r,secondary:null}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=tN())!==s&&(eG=e,n=t,t={type:"interval-period",location:e2(),period:n.value,precision:null,secondary:null}),e=t),e}())!==s?(t6(),(n=eB,"to"===(i=e.substr(eB,2)).toLowerCase()?eB+=2:(i=s,0===e1&&e6(eN)),i!==s?(o=eB,e1++,l=tm(),e1--,l===s?o=void 0:(eB=o,o=s),o!==s?(eG=n,n="TO"):(eB=n,n=s)):(eB=n,n=s),n!==s)?(t6(),(a=function(){var e,t,r,a,n,i,o;return e=eB,(t=tN())!==s&&(eG=e,n=t,t={type:"interval-period",location:e2(),period:n.value,precision:null,secondary:null}),(e=t)===s&&(e=eB,(t=t0())!==s?(t6(),t9()!==s?(t6(),(r=tO())!==s?(t6(),t4()!==s?(t6(),(a=tS())!==s?(t6(),t3()!==s?(eG=e,i=r,e={type:"interval-period",location:e2(),period:"second",precision:i,secondary:a}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=t0())!==s?(t6(),t9()!==s?(t6(),(r=tO())!==s?(t6(),t3()!==s?(eG=e,o=r,e={type:"interval-period",location:e2(),period:"second",precision:o,secondary:null}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=t0())!==s&&(eG=e,t={type:"interval-period",location:e2(),period:"second",precision:null,secondary:null}),e=t))),e}())!==s?(eG=t,t={type:"interval-qualifier",location:e2(),start:r,end:a}):(eB=t,t=s)):(eB=t,t=s)):(eB=t,t=s),t===s&&(t=function(){var e,t,r,a,n,i,o,l,u;return e=eB,(t=tN())!==s?(t6(),t9()!==s?(t6(),(r=tS())!==s?(t6(),t3()!==s?(eG=e,n=t,i=r,e={type:"interval-period",location:e2(),period:n.value,precision:i,secondary:null}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=tN())!==s&&(eG=e,o=t,t={type:"interval-period",location:e2(),period:o.value,precision:null,secondary:null}),(e=t)===s&&(e=eB,(t=t0())!==s?(t6(),t9()!==s?(t6(),(r=tO())!==s?(t6(),t4()!==s?(t6(),(a=tS())!==s?(t6(),t3()!==s?(eG=e,l=r,e={type:"interval-period",location:e2(),period:"second",precision:l,secondary:a}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=t0())!==s?(t6(),t9()!==s?(t6(),(r=tS())!==s?(t6(),t3()!==s?(eG=e,u=r,e={type:"interval-period",location:e2(),period:"second",precision:u,secondary:null}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e===s&&(e=eB,(t=t0())!==s&&(eG=e,t={type:"interval-period",location:e2(),period:"second",precision:null,secondary:null}),e=t)))),e}()),t}function tN(){var e,t;return e=eB,(t=tG())!==s&&(eG=e,t={type:"string",location:e2(),value:"day"}),(e=t)===s&&(e=eB,(t=tW())!==s&&(eG=e,t={type:"string",location:e2(),value:"hour"}),(e=t)===s&&(e=eB,(t=tX())!==s&&(eG=e,t={type:"string",location:e2(),value:"minute"}),(e=t)===s&&(e=eB,(t=tB())!==s&&(eG=e,t={type:"string",location:e2(),value:"month"}),(e=t)===s&&(e=eB,(t=tj())!==s&&(eG=e,t={type:"string",location:e2(),value:"year"}),e=t)))),e}function tS(){var e,t;return e=eB,(t=tA())!==s&&(eG=e,t=parseFloat(t)),e=t}function tO(){var e,t;return e=eB,(t=tA())!==s&&(eG=e,t=parseFloat(t)),e=t}function tx(){var e;return(e=tC())===s&&(e=tg()),e}function tC(){var t,r,a,n,i;if(t=eB,39===e.charCodeAt(eB)?(r="'",eB++):(r=s,0===e1&&e6(U)),r===s&&("N'"===e.substr(eB,2)?(r="N'",eB+=2):(r=s,0===e1&&e6($))),r!==s){for(a=[],n=eB,"''"===e.substr(eB,2)?(i="''",eB+=2):(i=s,0===e1&&e6(J)),i!==s&&(eG=n,i=ej()),(n=i)===s&&(n=e.charAt(eB),w.test(n)?eB++:(n=s,0===e1&&e6(k)));n!==s;)a.push(n),n=eB,"''"===e.substr(eB,2)?(i="''",eB+=2):(i=s,0===e1&&e6(J)),i!==s&&(eG=n,i=ej()),(n=i)===s&&(n=e.charAt(eB),w.test(n)?eB++:(n=s,0===e1&&e6(k)));39===e.charCodeAt(eB)?(n="'",eB++):(n=s,0===e1&&e6(U)),n!==s?(eG=t,t={type:"string",location:e2(),value:a.join("")}):(eB=t,t=s)}else eB=t,t=s;return t}function tE(){var e,t,r;return e=eB,t7()!==s?(t6(),(t=tt())!==s?(t6(),t8()!==s?(t6(),(r=tt())!==s?(eG=e,e={type:"when-clause",location:e2(),operand:t,value:r}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e}function tZ(){var e,t,r;return e=eB,t7()!==s?(t6(),(t=tt())!==s?(t6(),t8()!==s?(t6(),(r=tt())!==s?(eG=e,e={type:"when-clause",location:e2(),operand:t,value:r}):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s)):(eB=e,e=s),e}function tM(){var t,r,a,n,i,o;return t=eB,(a=eB,"else"===(n=e.substr(eB,4)).toLowerCase()?eB+=4:(n=s,0===e1&&e6(e_)),n!==s?(i=eB,e1++,o=tm(),e1--,o===s?i=void 0:(eB=i,i=s),i!==s?(eG=a,a="ELSE"):(eB=a,a=s)):(eB=a,a=s),a!==s)?(t6(),(r=tt())!==s?(eG=t,t={type:"else-clause",location:e2(),value:r}):(eB=t,t=s)):(eB=t,t=s),t}function tb(){var t,r,a,n,i;return(t=tA())===s&&(t=eB,r=e.charAt(eB),d.test(r)?eB++:(r=s,0===e1&&e6(M)),r!==s&&(a=tA())!==s?(eG=t,n=r,i=a,t=n[0]+i):(eB=t,t=s)),t}function tP(){var t,r,a,n;return t=eB,46===e.charCodeAt(eB)?(r=".",eB++):(r=s,0===e1&&e6(V)),r!==s?((a=tA())===s&&(a=null),eG=t,t="."+(null!=(n=a)?n:"")):(eB=t,t=s),t}function tF(){var t,r,a;return t=eB,(r=function(){var t,r,a,n;return t=eB,r=e.charAt(eB),I.test(r)?eB++:(r=s,0===e1&&e6(q)),r!==s?(a=e.charAt(eB),d.test(a)?eB++:(a=s,0===e1&&e6(M)),a===s&&(a=null),eG=t,t="e"+(null===(n=a)?"":n)):(eB=t,t=s),t}())!==s&&(a=tA())!==s?(eG=t,t=r+a):(eB=t,t=s),t}function tA(){var e,t,r;if(e=eB,t=[],(r=tD())!==s)for(;r!==s;)t.push(r),r=tD();else t=s;return t!==s&&(eG=e,t=t.join("")),e=t}function tD(){var t;return t=e.charAt(eB),g.test(t)?eB++:(t=s,0===e1&&e6(z)),t}function tR(){var t,r,a,n;return t=eB,"in"===(r=e.substr(eB,2)).toLowerCase()?eB+=2:(r=s,0===e1&&e6(j)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="IN"):(eB=t,t=s)):(eB=t,t=s),t}function t_(){var t,r,a,n;return t=eB,"is"===(r=e.substr(eB,2)).toLowerCase()?eB+=2:(r=s,0===e1&&e6(B)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="IS"):(eB=t,t=s)):(eB=t,t=s),t}function tU(){var t,r,a,n;return t=eB,"like"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(G)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="LIKE"):(eB=t,t=s)):(eB=t,t=s),t}function t$(){var t,r,a,n;return t=eB,"not"===(r=e.substr(eB,3)).toLowerCase()?eB+=3:(r=s,0===e1&&e6(X)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="NOT"):(eB=t,t=s)):(eB=t,t=s),t}function tJ(){var t,r,a,n;return t=eB,"and"===(r=e.substr(eB,3)).toLowerCase()?eB+=3:(r=s,0===e1&&e6(ee)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="AND"):(eB=t,t=s)):(eB=t,t=s),t}function tk(){var t,r,a,n;return t=eB,"or"===(r=e.substr(eB,2)).toLowerCase()?eB+=2:(r=s,0===e1&&e6(et)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="OR"):(eB=t,t=s)):(eB=t,t=s),t}function tV(){var t,r,a,n;return t=eB,"between"===(r=e.substr(eB,7)).toLowerCase()?eB+=7:(r=s,0===e1&&e6(er)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="BETWEEN"):(eB=t,t=s)):(eB=t,t=s),t}function tz(){var t,r,a,n;return t=eB,"from"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(ea)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="FROM"):(eB=t,t=s)):(eB=t,t=s),t}function tq(){var t,r,a,n;return t=eB,"extract"===(r=e.substr(eB,7)).toLowerCase()?eB+=7:(r=s,0===e1&&e6(es)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="EXTRACT"):(eB=t,t=s)):(eB=t,t=s),t}function tH(){var t,r,a,n;return t=eB,"timestamp"===(r=e.substr(eB,9)).toLowerCase()?eB+=9:(r=s,0===e1&&e6(eu)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="TIMESTAMP"):(eB=t,t=s)):(eB=t,t=s),t}function tK(){var t,r,a,n;return t=eB,"date"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(ec)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="DATE"):(eB=t,t=s)):(eB=t,t=s),t}function tY(){var t,r,a,n;return t=eB,"time"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(ed)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="TIME"):(eB=t,t=s)):(eB=t,t=s),t}function tQ(){var t,r,a,n;return t=eB,"interval"===(r=e.substr(eB,8)).toLowerCase()?eB+=8:(r=s,0===e1&&e6(eS)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="INTERVAL"):(eB=t,t=s)):(eB=t,t=s),t}function tj(){var t,r,a,n;return t=eB,"year"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(eO)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="YEAR"):(eB=t,t=s)):(eB=t,t=s),t}function tB(){var t,r,a,n;return t=eB,"month"===(r=e.substr(eB,5)).toLowerCase()?eB+=5:(r=s,0===e1&&e6(eE)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="MONTH"):(eB=t,t=s)):(eB=t,t=s),t}function tG(){var t,r,a,n;return t=eB,"day"===(r=e.substr(eB,3)).toLowerCase()?eB+=3:(r=s,0===e1&&e6(eZ)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="DAY"):(eB=t,t=s)):(eB=t,t=s),t}function tW(){var t,r,a,n;return t=eB,"hour"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(eM)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="HOUR"):(eB=t,t=s)):(eB=t,t=s),t}function tX(){var t,r,a,n;return t=eB,"minute"===(r=e.substr(eB,6)).toLowerCase()?eB+=6:(r=s,0===e1&&e6(eb)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="MINUTE"):(eB=t,t=s)):(eB=t,t=s),t}function t0(){var t,r,a,n;return t=eB,"second"===(r=e.substr(eB,6)).toLowerCase()?eB+=6:(r=s,0===e1&&e6(eP)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="SECOND"):(eB=t,t=s)):(eB=t,t=s),t}function t1(){var t,r,a,n;return t=eB,"case"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(eF)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="CASE"):(eB=t,t=s)):(eB=t,t=s),t}function t2(){var t,r,a,n;return t=eB,"end"===(r=e.substr(eB,3)).toLowerCase()?eB+=3:(r=s,0===e1&&e6(eA)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="END"):(eB=t,t=s)):(eB=t,t=s),t}function t7(){var t,r,a,n;return t=eB,"when"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(eD)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="WHEN"):(eB=t,t=s)):(eB=t,t=s),t}function t8(){var t,r,a,n;return t=eB,"then"===(r=e.substr(eB,4)).toLowerCase()?eB+=4:(r=s,0===e1&&e6(eR)),r!==s?(a=eB,e1++,n=tm(),e1--,n===s?a=void 0:(eB=a,a=s),a!==s?(eG=t,t="THEN"):(eB=t,t=s)):(eB=t,t=s),t}function t4(){var t;return 44===e.charCodeAt(eB)?(t=",",eB++):(t=s,0===e1&&e6(eU)),t}function t9(){var t;return 40===e.charCodeAt(eB)?(t="(",eB++):(t=s,0===e1&&e6(e$)),t}function t3(){var t;return 41===e.charCodeAt(eB)?(t=")",eB++):(t=s,0===e1&&e6(eJ)),t}function t6(){var e,t;for(e=[],t=t5();t!==s;)e.push(t),t=t5();return e}function t5(){var t;return t=e.charAt(eB),y.test(t)?eB++:(t=s,0===e1&&e6(ek)),t}function re(e,t,r,a,n){let i={type:"binary-expression",location:n,operator:e,left:t,right:r};return void 0!==a&&(i.escape=a),i}function rt(e,...t){return{type:"expression-list",location:e,value:t}}function rr(e,t){let r=e;for(let{op:e,expr:a,location:{end:n}}of t)r=re(e,r,a,void 0,{...r.location,end:n});return r}if(i=u(),t.peg$library)return{peg$result:i,peg$currPos:eB,peg$FAILED:s,peg$maxFailExpected:e0,peg$maxFailPos:eX};if(i!==s&&eB===e.length)return i;throw i!==s&&eB<e.length&&e6({type:"end"}),r=e0,a=eX<e.length?e.charAt(eX):null,n=eX<e.length?e3(eX,eX+1):e3(eX,eX),new Q(Q.buildMessage(r,a),r,a,n)}(e)}}function G(e,t){if(null!=e)switch(t(e),e.type){case"when-clause":G(e.operand,t),G(e.value,t);break;case"case-expression":for(let r of e.clauses)G(r,t);"simple"===e.format&&G(e.operand,t),null!==e.else&&G(e.else,t);break;case"expression-list":for(let r of e.value)G(r,t);break;case"unary-expression":G(e.expr,t);break;case"binary-expression":G(e.left,t),G(e.right,t);break;case"function":G(e.args,t);break;case"interval":G(e.value,t),G(e.qualifier,t);break;case"interval-qualifier":G(e.start,t),G(e.end,t)}}let W=new Set(["current_timestamp","current_date","current_time"]);class X{static makeBool(e){return!0===e}static featureValue(e,t,r,a){return el(e,t,r,a)}static equalsNull(e){return null===e}static applyLike(e,t,r){return eo(e,t,r)}static ensureArray(e){return et(e)}static applyIn(e,t,r){return ei(e,t)}static currentTimestamp(e){return S(new Date,e)}static currentDate(e){return s.n.fromNow(e)}static currentTime(e){let t=S(new Date,e);return f.k.fromDateTime(t)}static makeSqlInterval(e,t,r){return d.createFromValueAndQualifier(e,t,r)}static convertInterval(e){return d.isInterval(e)?e.valueInMilliseconds():e}static compare(e,t,r,a){return $(t,r,e)}static calculate(e,t,r,a){return K(e,t,r,a)}static evaluateTime(e){return M(e)}static evaluateTimestamp(e,t,r){return b(e,t,r)}static evaluateDate(e,t){return P(e,t)}static evaluateFunction(e,t,r){return z(e,t,r)}static lookup(e,t){let r=t[e];return void 0===r?null:r}static between(e,t,r){return null==e||null==t[0]||null==t[1]?null:$(e,t[0],">=")&&$(e,t[1],"<=")}static notbetween(e,t,r){return null==e||null==t[0]||null==t[1]?null:$(e,t[0],"<")||$(e,t[1],">")}static ternaryNot(e){return er(e)}static ternaryAnd(e,t){return ea(e,t)}static ternaryOr(e,t){return en(e,t)}}class ee{constructor(e,t,r="UTC",a=null){this.fieldsIndex=t,this.timeZone=r,this.currentUser=a,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=B.parse(e);let{isStandardized:n,isAggregate:i,currentUserRequired:s,referencedFieldNames:o}=this._extractExpressionInfo(t);this._referencedFieldNames=o,this.isStandardized=n,this.isAggregate=i,this.currentUserRequired=s}static convertValueToStorageFormat(e,t=null){if(null===t)return(0,D.$P)(e)?e.getTime():x(e)?e.toMillis():Z(e)?e.toStorageFormat():E(e)?e.toStorageString():C(e)?e.toStorageFormat():e;switch(t){case"date":return(0,D.$P)(e)?e.getTime():x(e)?e.toMillis():Z(e)?e.toMilliseconds():C(e)?e.toNumber():e;case"date-only":return(0,D.$P)(e)?s.n.fromDateJS(e).toString():Z(e)?s.n.fromSqlTimeStampOffset(e).toString():x(e)?s.n.fromDateTime(e).toString():e;case"time-only":return(0,D.$P)(e)?f.k.fromDateJS(e).toStorageString():x(e)?f.k.fromDateTime(e).toStorageString():Z(e)?f.k.fromSqlTimeStampOffset(e).toStorageString():E(e)?e.toStorageString():e;case"timestamp-offset":if((0,D.$P)(e))return p.g.fromJSDate(e).toStorageFormat();if(x(e))return p.g.fromDateTime(e).toStorageFormat();if(Z(e))return e.toStorageFormat()}return e}static create(e,t={}){return new ee(e,t.fieldsIndex,t.timeZone??void 0,t.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(e,t=eu,r=this.currentUser){return!!this._evaluateNode(this.parseTree,null,t,e,r)}calculateValue(e,t=eu,r=this.currentUser){let a=this._evaluateNode(this.parseTree,e,t,null,r);return d.isInterval(a)?a.valueInMilliseconds()/864e5:a}calculateValueCompiled(e,t=eu,r=this.currentUser){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null):(0,n.A)("esri-csp-restrictions")?this.calculateValue(e,t):(this._compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null))}testFeature(e,t=eu,r=this.currentUser){return!!this._evaluateNode(this.parseTree,e,t,null,r)}testFeatureCompiled(e,t=eu,r=this.currentUser){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null):(0,n.A)("esri-csp-restrictions")?this.testFeature(e,t):(this._compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,G(this.parseTree,e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||W.has(e.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){let e=new Set;return G(this.parseTree,t=>{"function"===t.type&&e.add(t.name.toLowerCase())}),Array.from(e)}getExpressions(){let e=new Map;return G(this.parseTree,t=>{if("function"===t.type){let r=t.name.toLowerCase(),a=t.args.value[0];if("column-reference"===a.type){let t=a.column,n=`${r}-${t}`;e.has(n)||e.set(n,{aggregateType:r,field:t})}}}),[...e.values()]}getVariables(){let e=new Set;return G(this.parseTree,t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())}),Array.from(e)}_compileMe(){let e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",e).bind(X)}_extractExpressionInfo(e){let t=[],r=new Set,a=!0,n=!1,s=!1;return G(this.parseTree,o=>{switch(o.type){case"column-reference":{let a,n,i=e?.get(o.column);a=i?n=i.name??"":(n=o.column).toLowerCase(),r.has(a)||(r.add(a),t.push(n)),o.column=n;break}case"current-user":s=!0;break;case"function":{let{name:e,args:t}=o,r=t.value.length;a&&(a=function(e,t){let r=H[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,r)),!1===n&&(n=(0,i.M)(e,r))}}}),{referencedFieldNames:Array.from(t),isStandardized:a,isAggregate:n,currentUserRequired:s}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case-expression":{let t="";if("simple"===e.format){let r=this.evaluateNodeToJavaScript(e.operand);t="( ";for(let a=0;a<e.clauses.length;a++)t+=" (this.compare('=',"+r+","+this.evaluateNodeToJavaScript(e.clauses[a].operand)+") ? ("+this.evaluateNodeToJavaScript(e.clauses[a].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<e.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"parameter":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expression-list":{let t="[";for(let r of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+"]"}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary-expression":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new o.L8(o.Z7.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new o.L8(o.Z7.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";default:throw new o.L8(o.Z7.UnsupportedOperator,{operator:e.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(e.value);case"time":return"this.evaluateTime("+JSON.stringify(e.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(e.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(e.value)+", 'unknown')";case"current-time":return"date"===e.mode?"this.currentDate(timeZone)":"time"===e.mode?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(e.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+", timeZone)"}throw new o.L8(o.Z7.UnsupportedSyntax,{node:e.type})}_evaluateNode(e,t,r,a,n){let s;switch(e.type){case"interval":{let i=this._evaluateNode(e.value,t,r,a,n);return d.createFromValueAndQualifier(i,e.qualifier,e.op)}case"case-expression":if("simple"===e.format){let i=this._evaluateNode(e.operand,t,r,a,n);for(let s=0;s<e.clauses.length;s++)if($(i,this._evaluateNode(e.clauses[s].operand,t,r,a,n),"=",this.timeZone))return this._evaluateNode(e.clauses[s].value,t,r,a,n);if(null!==e.else)return this._evaluateNode(e.else,t,r,a,n)}else{for(let i=0;i<e.clauses.length;i++)if(!0===this._evaluateNode(e.clauses[i].operand,t,r,a,n))return this._evaluateNode(e.clauses[i].value,t,r,a,n);if(null!==e.else)return this._evaluateNode(e.else,t,r,a,n)}return null;case"parameter":return s=this.parameters[e.value.toLowerCase()],(0,D.$P)(s)?h.c9.fromJSDate(s):null!=s&&"object"==typeof s&&"toDateTime"in s?s.toDateTime():s;case"expression-list":{let i=[];for(let s of e.value)i.push(this._evaluateNode(s,t,r,a,n));return i}case"unary-expression":return er(this._evaluateNode(e.expr,t,r,a,n));case"binary-expression":switch(e.operator){case"AND":return ea(this._evaluateNode(e.left,t,r,a,n),this._evaluateNode(e.right,t,r,a,n));case"OR":return en(this._evaluateNode(e.left,t,r,a,n),this._evaluateNode(e.right,t,r,a,n));case"IS":if("null"!==e.right.type)throw new o.L8(o.Z7.UnsupportedIsRhs);return null===this._evaluateNode(e.left,t,r,a,n);case"ISNOT":if("null"!==e.right.type)throw new o.L8(o.Z7.UnsupportedIsRhs);return null!==this._evaluateNode(e.left,t,r,a,n);case"IN":{let i=et(this._evaluateNode(e.right,t,r,a,n));return ei(this._evaluateNode(e.left,t,r,a,n),i,this.timeZone)}case"NOT IN":{let i=et(this._evaluateNode(e.right,t,r,a,n));return er(ei(this._evaluateNode(e.left,t,r,a,n),i,this.timeZone))}case"BETWEEN":{let i=this._evaluateNode(e.left,t,r,a,n),s=this._evaluateNode(e.right,t,r,a,n);return null==i||null==s[0]||null==s[1]?null:$(i,s[0],">=",this.timeZone)&&$(i,s[1],"<=",this.timeZone)}case"NOTBETWEEN":{let i=this._evaluateNode(e.left,t,r,a,n),s=this._evaluateNode(e.right,t,r,a,n);return null==i||null==s[0]||null==s[1]?null:$(i,s[0],"<",this.timeZone)||$(i,s[1],">",this.timeZone)}case"LIKE":return eo(this._evaluateNode(e.left,t,r,a,n),this._evaluateNode(e.right,t,r,a,n),e.escape);case"NOT LIKE":return er(eo(this._evaluateNode(e.left,t,r,a,n),this._evaluateNode(e.right,t,r,a,n),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return $(this._evaluateNode(e.left,t,r,a,n),this._evaluateNode(e.right,t,r,a,n),e.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return K(e.operator,this._evaluateNode(e.left,t,r,a,n),this._evaluateNode(e.right,t,r,a,n),this.timeZone)}case"null":case"boolean":case"string":case"number":case"data-type":return e.value;case"date":return e.parsedValue??=P(e.value,"unknown"),e.parsedValue;case"timestamp":return e.parsedValue??=b(e.value,"unknown"),e.parsedValue;case"time":return M(e.value);case"current-time":return"date"===e.mode?X.currentDate(this.timeZone):"time"===e.mode?X.currentTime(this.timeZone):X.currentTimestamp(this.timeZone);case"current-user":return n??null;case"column-reference":return el(t,e.column,this.fieldsIndex,r);case"function":{if(this.isAggregate&&(0,i.M)(e.name,e.args.value.length)){let t=[];for(let i of e.args?.value||[]){let e=[];for(let t of a||[])e.push(this._evaluateNode(i,t,r,null,n));t.push(e)}return(0,i.s)(e.name,t)}let s=this._evaluateNode(e.args,t,r,a,n);return z(e.name,s,this.timeZone)}}throw new o.L8(o.Z7.UnsupportedSyntax,{node:e.type})}}function et(e){return Array.isArray(e)?e:[e]}function er(e){return null!==e?!0!==e:null}function ea(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function en(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function ei(e,t,r){if(null==e)return null;let a=!1;for(let r of t)if(null==r)a=null;else{if(e===r){a=!0;break}if(_(e)&&_(r)&&(a=$(e,r,"=")))break}return a}let es="-[]/{}()*+?.\\^$|";function eo(e,t,r){return null==e?null:(function(e,t){let r="",n=a.Normal;for(let i=0;i<e.length;i++){let s=e.charAt(i);switch(n){case a.Normal:s===t?n=a.Escaped:es.includes(s)?r+="\\"+s:r+="%"===s?".*":"_"===s?".":s;break;case a.Escaped:es.includes(s)?r+="\\"+s:r+=s,n=a.Normal}}return RegExp("^"+r+"$","m")})(t,r).test(e)}function el(e,t,r,a){if("getAttributeSQL"in a)return a.getAttributeSQL(e,t);let n=a.getAttribute(e,t),i=r?.get(t);return null==n||"esriFieldTypeDate"!==i?.type&&"date"!==i?.type?null==n||"esriFieldTypeDateOnly"!==i?.type&&"date-only"!==i?.type?null==n||"esriFieldTypeTimeOnly"!==i?.type&&"time-only"!==i?.type?null==n||"esriFieldTypeTimestampOffset"!==i?.type&&"timestamp-offset"!==i?.type?n:new p.g(n):f.k.fromReader(n):s.n.fromReader(n):S(new Date(n),r?.getLuxonTimeZone(i.name)??h.mQ.utcInstance)}!function(e){e[e.Normal=0]="Normal",e[e.Escaped=1]="Escaped"}(a||(a={}));let eu={getAttribute:(e,t)=>(!function(e){return e&&"object"==typeof e.attributes}(e)?e:e.attributes)[t]}},22721:(e,t,r)=>{r.d(t,{g:()=>s});var a=r(29593);function n(e){return Number.isNaN(e)||0===e?e:Math.trunc(e)}let i="esri.core.sql.SqlTimeStampOffset";class s{constructor(e){this._timeStampOffset=e,this.declaredRootClass=i,this._date=null}static isTimestampOffset(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===i}toDateTime(){return this._date??=a.c9.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return n(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return n(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return s.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new s(a.c9.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(e){return new s(e.toISO({includeOffset:!0}))}static fromParts(e,t,r=0,a=0,n=0,i=0,o=0,l=!1,u=0,c=0){let d=`${e.toString().padStart(4,"0")}-${t.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`,p="";i<10&&(p="0");let f=`${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${p+i.toString()}`;return 0!==o&&(f+="."+o.toString().padStart(3,"0")),new s(d+"T"+f+`${l?"-":"+"}${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let e=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return e&&(e=e.replace(".000","")),e}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(e){let t=this.toDateTime().plus(e);return s.fromDateTime(t)}}},26530:(e,t,r)=>{r.d(t,{M:()=>u,s:()=>l});var a=r(42236),n=r(39859),i=r(22721),s=r(3677),o=r(29593);function l(e,t){let r=c[e.toLowerCase()];if(null==r)throw new n.L8(n.Z7.FunctionNotRecognized);if(t.length<r.minParams||t.length>r.maxParams)throw new n.L8(n.Z7.InvalidParameterCount,{name:e.toUpperCase()});return r.evaluate(t)}function u(e,t){let r=c[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}let c={min:{minParams:1,maxParams:1,evaluate:e=>f(e[0],"min")},max:{minParams:1,maxParams:1,evaluate:e=>f(e[0],"max")},avg:{minParams:1,maxParams:1,evaluate:e=>d(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>(function(e){if(null===e)return null;let t=0;for(let r=0;r<e.length;r++){let a=e[r];if(null!==a){if(!p(a))throw new n.L8(n.Z7.InvalidValueForAggregateFunction);t+=a}}return t})(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>(function(e){if(null===e)return null;let t=m(e);return null===t?null:Math.sqrt(t)})(e[0])},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>m(e[0])}};function d(e){if(null===e)return null;let t=0,r=0;for(let a=0;a<e.length;a++){let i=e[a];if(null!==i){if(!p(i))throw new n.L8(n.Z7.InvalidValueForAggregateFunction);r++,t+=i}}return 0===r?null:t/e.length}function p(e){return"number"==typeof e}function f(e,t){if(null===e)return null;let r=null,n=null;for(let l of e){let e=l;e=a.n.isDateOnly(l)||s.k.isTimeOnly(l)?l.toNumber():o.c9.isDateTime(l)?l.toMillis():i.g.isTimestampOffset(l)?l.toMilliseconds():l,(null===r||"max"===t&&null!==n&&null!==e&&n<=e||"min"===t&&null!==n&&null!==e&&n>=e)&&(r=l,n=e)}return r}function m(e){if(null===e||0===(e=e.filter(e=>null!==e)).length)return null;let t=d(e);if(null===t)return null;let r=0;for(let a of e){if(!p(a))throw new n.L8(n.Z7.InvalidValueForAggregateFunction);r+=(t-a)**2}return r/(e.length-1)}},39859:(e,t,r)=>{r.d(t,{L8:()=>s,Z7:()=>a});var a,n=r(45714);!function(e){e.InvalidFunctionParameters="InvalidFunctionParameters",e.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",e.UnsupportedSqlFunction="UnsupportedSqlFunction",e.UnsupportedOperator="UnsupportedOperator",e.UnsupportedSyntax="UnsupportedSyntax",e.UnsupportedIsRhs="UnsupportedIsRhs",e.UnsupportedIsLhs="UnsupportedIsLhs",e.InvalidDataType="InvalidDataType",e.CannotCastValue="CannotCastValue",e.FunctionNotRecognized="FunctionNotRecognized",e.InvalidTime="InvalidTime",e.InvalidParameterCount="InvalidParameterCount",e.InvalidTimeStamp="InvalidTimeStamp",e.InvalidDate="InvalidDate",e.InvalidOperator="InvalidOperator",e.IllegalInterval="IllegalInterval",e.YearMonthIntervals="YearMonthIntervals",e.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",e.MissingStatisticParameters="MissingStatisticParameters"}(a||(a={}));let i={[a.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[a.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[a.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[a.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[a.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[a.UnsupportedOperator]:"Unsupported operator - {operator}",[a.UnsupportedSyntax]:"Unsupported syntax - {node}",[a.UnsupportedSqlFunction]:"Sql function not found = {function}",[a.InvalidDataType]:"Invalid sql data type",[a.InvalidDate]:"Invalid date encountered",[a.InvalidOperator]:"Invalid operator encountered",[a.InvalidTime]:"Invalid time encountered",[a.IllegalInterval]:"Illegal interval",[a.FunctionNotRecognized]:"Function not recognized",[a.InvalidTimeStamp]:"Invalid timestamp encountered",[a.InvalidParameterCount]:"Invalid parameter count for call to {name}",[a.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[a.YearMonthIntervals]:"Year-Month Intervals not supported",[a.CannotCastValue]:"Cannot cast value to the required data type"};class s extends Error{constructor(e,t){super((0,n.HC)(i[e],t)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,s)}}}}]);