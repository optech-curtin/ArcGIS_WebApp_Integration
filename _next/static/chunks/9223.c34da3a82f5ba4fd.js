"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9223],{2370:(e,t,r)=>{r.d(t,{E:()=>F,w:()=>l});var n=r(31461),i=r(28255);r(57845);var s=r(87196),o=r(70115);class l{constructor(e=9,t){this._compareMinX=c,this._compareMinY=f,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),I.prune(),b.prune(),x.prune(),w.prune()}all(e){a(this._data,e)}search(e,t){let r=this._data,n=this._toBBox;if(g(e,r))for(I.clear();r;){for(let i=0,s=r.children.length;i<s;i++){let s=r.children[i],o=r.leaf?n(s):s;g(e,o)&&(r.leaf?t(s):y(e,o)?a(s,t):I.push(s))}r=I.pop()}}collides(e){let t=this._data,r=this._toBBox;if(!g(e,t))return!1;for(I.clear();t;){for(let n=0,i=t.children.length;n<i;n++){let i=t.children[n],s=t.leaf?r(i):i;if(g(e,s)){if(t.leaf||y(e,s))return!0;I.push(i)}}t=I.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){let e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new T([]),this}remove(e){if(!e)return this;let t,r=this._data,s=null,o=0,l=!1,a=this._toBBox(e);for(x.clear(),w.clear();r||x.length>0;){if(r||(r=x.pop(),s=x.data[x.length-1],o=w.pop()??0,l=!0),r.leaf&&-1!==(t=(0,n.qh)(r.children,(0,i.zI)(e),r.children.length,r.indexHint)))return r.children.splice(t,1),x.push(r),this._condense(x),this;l||r.leaf||!y(r,a)?s?(o++,r=s.children[o],l=!1):r=null:(x.push(r),w.push(o),o=0,s=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,r,n){let i=r-t+1,s=this._maxEntries;if(i<=s){let n=new T(e.slice(t,r+1));return u(n,this._toBBox),n}n||(n=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/s**(n-1)));let o=new E([]);o.height=n;let l=Math.ceil(i/s),a=l*Math.ceil(Math.sqrt(s));_(e,t,r,a,this._compareMinX);for(let i=t;i<=r;i+=a){let t=Math.min(i+a-1,r);_(e,i,t,l,this._compareMinY);for(let r=i;r<=t;r+=l){let i=Math.min(r+l-1,t);o.children.push(this._build(e,r,i,n-1))}}return u(o,this._toBBox),o}_insert(e,t,r){let n=this._toBBox,i=r?e:n(e);x.clear();let s=function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){let r,n=1/0,o=1/0;for(let l=0,a=t.children.length;l<a;l++){var i,s;let a=t.children[l],u=m(a),h=(i=e,(Math.max((s=a).maxX,i.maxX)-Math.min(s.minX,i.minX))*(Math.max(s.maxY,i.maxY)-Math.min(s.minY,i.minY))-u);h<o?(o=h,n=u<n?u:n,r=a):h===o&&u<n&&(n=u,r=a)}t=r||t.children[0]}return t}(i,this._data,t,x);for(s.children.push(e),d(s,i);t>=0&&x.data[t].children.length>this._maxEntries;)this._split(x,t),t--;var o=i,l=x,a=t;for(let e=a;e>=0;e--)d(l.data[e],o)}_split(e,t){let r=e.data[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);let s=this._chooseSplitIndex(r,i,n);if(!s)return;let o=r.children.splice(s,r.children.length-s),l=r.leaf?new T(o):new E(o);l.height=r.height,u(r,this._toBBox),u(l,this._toBBox),t?e.data[t-1].children.push(l):this._splitRoot(r,l)}_splitRoot(e,t){this._data=new E([e,t]),this._data.height=e.height+1,u(this._data,this._toBBox)}_chooseSplitIndex(e,t,r){let n,i,s;n=i=1/0;for(let o=t;o<=r-t;o++){let t=h(e,0,o,this._toBBox),l=h(e,o,r,this._toBBox),a=function(e,t){let r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-r)*Math.max(0,Math.min(e.maxY,t.maxY)-n)}(t,l),u=m(t)+m(l);a<n?(n=a,s=o,i=u<i?u:i):a===n&&u<i&&(i=u,s=o)}return s}_chooseSplitAxis(e,t,r){let n=e.leaf?this._compareMinX:c,i=e.leaf?this._compareMinY:f;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);let i=this._toBBox,s=h(e,0,t,i),o=h(e,r-t,r,i),l=p(s)+p(o);for(let n=t;n<r-t;n++){let t=e.children[n];d(s,e.leaf?i(t):t),l+=p(s)}for(let n=r-t-1;n>=t;n--){let t=e.children[n];d(o,e.leaf?i(t):t),l+=p(o)}return l}_condense(e){for(let t=e.length-1;t>=0;t--){let r=e.data[t];if(0===r.children.length)if(t>0){let i=e.data[t-1],s=i.children;s.splice((0,n.qh)(s,r,s.length,i.indexHint),1)}else this.clear();else u(r,this._toBBox)}}_initFormat(e){let t=["return a"," - b",";"];this._compareMinX=Function("a","b",t.join(e[0])),this._compareMinY=Function("a","b",t.join(e[1])),this._toBBox=Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t){let r=e;for(b.clear();r;){if(!0===r.leaf)for(let e of r.children)t((0,i.zI)(e));else b.pushArray(r.children);r=b.pop()??null}}function u(e,t){h(e,0,e.children.length,t,e)}function h(e,t,r,n,i){i||(i=new T([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s,o=t;o<r;o++)s=e.children[o],d(i,e.leaf?n(s):s);return i}function d(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function c(e,t){return e.minX-t.minX}function f(e,t){return e.minY-t.minY}function m(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function p(e){return e.maxX-e.minX+(e.maxY-e.minY)}function y(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e,t,r,n,i){let s=[t,r];for(;s.length;){let t=s.pop(),r=s.pop();if(t-r<=n)continue;let l=r+Math.ceil((t-r)/n/2)*n;(0,o.q)(e,l,r,t,i),s.push(r,l,l,t)}}let I=new s.A,b=new s.A,x=new s.A,w=new s.A({deallocator:void 0});class F{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class M extends F{constructor(){super(...arguments),this.height=1,this.indexHint=new n.vW}}class T extends M{constructor(e){super(),this.children=e,this.leaf=!0}}class E extends M{constructor(e){super(),this.children=e,this.leaf=!1}}},5895:(e,t,r)=>{r.d(t,{T:()=>i});var n=r(82795);let i={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new n.Om(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>e.ensureCentroid(t)}},9223:(e,t,r)=>{r.r(t),r.d(t,{default:()=>F});var n=r(39166),i=r(83610),s=r(32391),o=r(61939),l=r(92753),a=r(31789),u=r(71760),h=r(60729),d=r(86925),c=r(11064),f=r(76461),m=r(41359),p=r(79836),y=r(17135),g=r(43253),_=r(47823),I=r(73368),b=r(39265),x=r(93682);let w={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsQueryAttachmentOrderByFields:!1,supportsQueryBins:!0,supportsQueryWithCacheHint:!0,supportsQueryWithDistance:!0,supportsQueryWithResultType:!0,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0},queryBinsCapabilities:g.PC};class F{constructor(){this._queryEngine=null,this._snapshotFeatures=async e=>{let t=await this._fetch(e);return this._createFeatures(t)}}destroy(){this._queryEngine?.destroy(),this._queryEngine=this._createDefaultAttributes=null}async load(e,t={}){this._loadOptions={url:e.url,customParameters:e.customParameters};let r=[],[n]=await Promise.all([e.url?this._fetch(t?.signal):null,this._checkProjection(e.spatialReference)]),i=(0,p.BM)(n,{geometryType:e.geometryType}),o=e.fields||i.fields||[],l=null!=e.hasZ?e.hasZ:i.hasZ,a=i.geometryType,h=e.objectIdField||i.objectIdFieldName||"__OBJECTID",d=e.spatialReference||u.KK,f=e.timeInfo;o===i.fields&&i.unknownFields.length>0&&r.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:i.unknownFields}});let g=new _.A(o),F=g.get(h);F?("esriFieldTypeString"!==F.type&&(F.type="esriFieldTypeOID"),F.editable=!1,F.nullable=!1,h=F.name):(F={alias:h,name:h,type:"string"===i.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},o.unshift(F));let M={};for(let e of o){if(null==e.name&&(e.name=e.alias),null==e.alias&&(e.alias=e.name),!e.name)throw new s.A("geojson-layer:invalid-field-name","field name is missing",{field:e});if(!I.m.jsonValues.includes(e.type))throw new s.A("geojson-layer:invalid-field-type",`invalid type for field "${e.name}"`,{field:e});if(e.name!==F.name){let t=(0,b.lD)(e);void 0!==t&&(M[e.name]=t)}null==e.length&&(e.length=(0,b._b)(e))}if(f){if(f.startTimeField){let e=g.get(f.startTimeField);e?(f.startTimeField=e.name,e.type="esriFieldTypeDate"):f.startTimeField=null}if(f.endTimeField){let e=g.get(f.endTimeField);e?(f.endTimeField=e.name,e.type="esriFieldTypeDate"):f.endTimeField=null}if(f.trackIdField){let e=g.get(f.trackIdField);e?f.trackIdField=e.name:(f.trackIdField=null,r.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:f}}))}f.startTimeField||f.endTimeField||(r.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:f}}),f=null)}let T=a?(0,y.F0)(a):void 0,E=g.dateFields.length?{timeZoneIANA:x.n$}:null,B={warnings:r,featureErrors:[],layerDefinition:{...w,drawingInfo:T??void 0,templates:(0,y.e2)(M),extent:void 0,geometryType:a,objectIdField:h,fields:o,hasZ:!!l,timeInfo:f,dateFieldsTimeReference:E}};this._queryEngine=new m.do({fieldsIndex:_.A.fromLayerJSON({fields:o,timeInfo:f,dateFieldsTimeReference:E}),geometryType:a,hasM:!1,hasZ:l,objectIdField:h,spatialReference:d,timeInfo:f,featureStore:new c.A({geometryType:a,hasM:!1,hasZ:l})});let N=this._queryEngine.fieldsIndex.requiredFields.indexOf(F);N>-1&&this._queryEngine.fieldsIndex.requiredFields.splice(N,1),this._createDefaultAttributes=(0,y.Vx)(M,h);let A=await this._createFeatures(n);this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,A);let v=this._normalizeFeatures(A,B.featureErrors);this._queryEngine.featureStore.addMany(v);let{fullExtent:S,timeExtent:j}=await this._queryEngine.fetchRecomputedExtents();if(B.layerDefinition.extent=S,j){let{start:e,end:t}=j;B.layerDefinition.timeInfo.timeExtent=[e,t]}return B}async applyEdits(e){let{spatialReference:t,geometryType:r}=this._queryEngine;return await Promise.all([(0,g.$1)(t,r),(0,f.Nk)(e.adds,t),(0,f.Nk)(e.updates,t)]),await this._waitSnapshotComplete(),this._applyEdits(e)}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),(0,d.J)(this._queryEngine,e,t.signal)}async queryAttributeBins(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeAttributeBinsQuery(e,t.signal)}async refresh(e){this._loadOptions.customParameters=e,this._snapshotTask?.abort(),this._snapshotTask=(0,i.UT)(this._snapshotFeatures),this._snapshotTask.promise.then(e=>{this._queryEngine.featureStore.clear(),this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,e);let t=this._normalizeFeatures(e);t&&this._queryEngine.featureStore.addMany(t)},e=>{this._queryEngine.featureStore.clear(),(0,l.zf)(e)||o.A.getLogger("esri.layers.GeoJSONLayer").error(new s.A("geojson-layer:refresh","An error occurred during refresh",{error:e}))}),await this._waitSnapshotComplete();let{fullExtent:t,timeExtent:r}=await this._queryEngine.fetchRecomputedExtents();return{extent:t,timeExtent:r}}async _createFeatures(e){if(null==e)return[];let{geometryType:t,hasZ:r,objectIdField:n}=this._queryEngine,i=(0,p.bd)(e,{geometryType:t,hasZ:r,objectIdField:n});if(!(0,u.aI)(this._queryEngine.spatialReference,u.KK))for(let e of i)null!=e.geometry&&(e.geometry=(0,h.Ux)((0,f.Cv)((0,h.zv)(e.geometry,this._queryEngine.geometryType,this._queryEngine.hasZ,!1),u.KK,this._queryEngine.spatialReference)));return i}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(e){let{url:t,customParameters:r}=this._loadOptions,i=(await (0,n.A)(t??"",{responseType:"json",query:{...r},signal:e})).data;return(0,p.sO)(i),i}_normalizeFeatures(e,t){let{objectIdField:r,fieldsIndex:n}=this._queryEngine,i=[];for(let s of e){let e=this._createDefaultAttributes(),o=(0,g.MB)(n,e,s.attributes,!0);o?t?.push(o):(this._assignObjectId(e,s.attributes,!0),s.attributes=e,s.objectId=e[r],i.push(s))}return i}async _applyEdits(e){let{adds:t,updates:r,deletes:n}=e,i={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t?.length&&this._applyAddEdits(i,t),r?.length&&this._applyUpdateEdits(i,r),n?.length){for(let e of n)i.deleteResults.push((0,g.bP)(e));this._queryEngine.featureStore.removeManyById(n)}let{fullExtent:s,timeExtent:o}=await this._queryEngine.fetchRecomputedExtents();return{extent:s,timeExtent:o,featureEditResults:i}}_applyAddEdits(e,t){let{addResults:r}=e,{geometryType:n,hasM:i,hasZ:s,objectIdField:o,spatialReference:l,featureStore:u,fieldsIndex:d}=this._queryEngine,c=[];for(let i of t){if(i.geometry&&n!==(0,a.$B)(i.geometry)){r.push((0,g.Yx)("Incorrect geometry type."));continue}let t=this._createDefaultAttributes(),s=(0,g.MB)(d,t,i.attributes);if(s)r.push(s);else{if(this._assignObjectId(t,i.attributes),i.attributes=t,null!=i.uid){let t=i.attributes[o];e.uidToObjectId[i.uid]=t}if(null!=i.geometry){let e=i.geometry.spatialReference??l;i.geometry=(0,f.Cv)((0,g.CR)(i.geometry,e),e,l)}c.push(i),r.push((0,g.bP)(i.attributes[o]))}}u.addMany((0,h.Di)([],c,n,s,i,o))}_applyUpdateEdits({updateResults:e},t){let{geometryType:r,hasM:n,hasZ:i,objectIdField:s,spatialReference:o,featureStore:l,fieldsIndex:u}=this._queryEngine;for(let d of t){let{attributes:t,geometry:c}=d,m=t?.[s];if(null==m){e.push((0,g.Yx)(`Identifier field ${s} missing`));continue}if(!l.has(m)){e.push((0,g.Yx)(`Feature with object id ${m} missing`));continue}let p=(0,h.oN)(l.getFeature(m),r,i,n);if(null!=c){if(r!==(0,a.$B)(c)){e.push((0,g.Yx)("Incorrect geometry type."));continue}let t=c.spatialReference??o;p.geometry=(0,f.Cv)((0,g.CR)(c,t),t,o)}if(t){let r=(0,g.MB)(u,p.attributes,t);if(r){e.push(r);continue}}l.add((0,h.E2)(p,r,i,n,s)),e.push((0,g.bP)(m))}}_createObjectIdGenerator(e,t){let r=e.fieldsIndex.get(e.objectIdField);if("esriFieldTypeString"===r.type)return()=>r.name+"-"+Date.now().toString(16);let n=Number.NEGATIVE_INFINITY;for(let e of t)e.objectId&&(n=Math.max(n,e.objectId));return n=Math.max(0,n)+1,()=>n++}_assignObjectId(e,t,r=!1){let n=this._queryEngine.objectIdField;e[n]=r&&n in t?t[n]:this._objectIdGenerator()}async _checkProjection(e){try{await (0,f.Nk)(u.KK,e)}catch{throw new s.A("geojson-layer","Projection not supported")}}}},11064:(e,t,r)=>{r.d(t,{A:()=>m});var n=r(31461),i=r(32391),s=r(74652),o=r(61939),l=r(42845),a=r(84766),u=r(60729),h=r(29499),d=r(33332),c=r(5895);let f=(0,l.vt)();class m{constructor(e){this.geometryInfo=e,this._boundsStore=new h.F,this._featuresById=new Map,this._usedMemory=0,this.events=new s.A,this.featureAdapter=c.T}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach(t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;let[t,r,n,i]=this.fullBounds;return{xmin:t,ymin:r,xmax:n,ymax:i,spatialReference:(0,d.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(let t of e)this._add(t);this._emitChanged()}upsertMany(e){let t=e.map(e=>this._upsert(e));return this._emitChanged(),t.filter(n.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(e){let t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){for(let t of(this._boundsStore.invalidateIndex(),e)){let e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(let r of e){let e=this._boundsStore.get(r.objectId);e&&t((0,l.Jt)(f,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach(t=>e(t))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,e=>{t(this._featuresById.get(e))})}_emitChanged(){this.events.emit("changed",void 0)}_add(e){let t;if(!e)return;let r=e.objectId;if(null==r)return void o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e}));let n=this._featuresById.get(r);if(n?(e.displayId=n.displayId,t=this._boundsStore.get(r),this._boundsStore.delete(r),this._usedMemory-=this.estimateFeatureUsedMemory?.(n)??0):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(r,null),void this._featuresById.set(r,e);null!=(t=(0,u.jQ)(null!=t?t:(0,a.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM))&&this._boundsStore.set(r,t),this._featuresById.set(r,e),this._usedMemory+=this.estimateFeatureUsedMemory?.(e)??0}_upsert(e){let t=e?.objectId;if(null==t)return o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;let r=this._featuresById.get(t);if(!r)return this._add(e),e;this._usedMemory-=this.estimateFeatureUsedMemory?.(r)??0;let{geometry:n,attributes:s}=e;for(let e in s)r.attributes[e]=s[e];return n&&(r.geometry=n,this._boundsStore.set(t,(0,u.jQ)((0,a.vt)(),n,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),this._usedMemory+=this.estimateFeatureUsedMemory?.(r)??0,r}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);let t=e.objectId;return this._boundsStore.delete(t),this._featuresById.delete(t),this._usedMemory-=this.estimateFeatureUsedMemory?.(e)??0,e}}},11506:(e,t,r)=>{function n(e,t){return e?t?4:3:t?3:2}function i(e,t,r,i){if(!t?.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);let s=e.coords,o=[],l=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:a,coords:u}=t,h=n(r,i),d=0;for(let e of a){let t=function(e,t,r,i,s,o){let l=n(s,o),a=r,u=r+l,h=0,d=0,c=0,f=0,m=0;for(let r=0,n=i-1;r<n;r++,a+=l,u+=l){let r=t[a],n=t[a+1],i=t[a+2],o=t[u],l=t[u+1],p=t[u+2],y=r*l-o*n;f+=y,h+=(r+o)*y,d+=(n+l)*y,s&&(y=r*p-o*i,c+=(i+p)*y,m+=y),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),n<e[2]&&(e[2]=n),n>e[3]&&(e[3]=n),s&&(i<e[4]&&(e[4]=i),i>e[5]&&(e[5]=i))}if(f>0&&(f*=-1),m>0&&(m*=-1),!f)return null;let p=[h,d,.5*f];return s&&(p[3]=c,p[4]=.5*m),p}(l,u,d,e,r,i);t&&o.push(t),d+=e*h}if(o.sort((e,t)=>{let n=e[2]-t[2];return 0===n&&r&&(n=e[4]-t[4]),n}),o.length){let e=6*o[0][2];s[0]=o[0][0]/e,s[1]=o[0][1]/e,r&&(e=6*o[0][4],s[2]=0!==e?o[0][3]/e:0),(s[0]<l[0]||s[0]>l[1]||s[1]<l[2]||s[1]>l[3]||r&&(s[2]<l[4]||s[2]>l[5]))&&(s.length=0)}if(!s.length){let e=t.lengths[0]?function(e,t,r,i,s){let o=n(i,s),l=0,a=t+o,u=0,h=0,d=0,c=0;for(let t=0,n=r-1;t<n;t++,l+=o,a+=o){var f,m,p,y,g;let t=e[l],r=e[l+1],n=e[l+2],s=e[a],o=e[a+1],_=e[a+2],I=i?function(e,t,r,n,i,s){let o=n-e,l=i-t,a=s-r;return Math.sqrt(o*o+l*l+a*a)}(t,r,n,s,o,_):function(e,t,r,n){let i=r-e,s=n-t;return Math.sqrt(i*i+s*s)}(t,r,s,o);if(I)if(u+=I,i){let e=[(f=t)+.5*(s-f),(m=r)+.5*(o-m),(p=n)+.5*(_-p)];h+=I*e[0],d+=I*e[1],c+=I*e[2]}else{let e=[(y=t)+.5*(s-y),(g=r)+.5*(o-g)];h+=I*e[0],d+=I*e[1]}}return u>0?i?[h/u,d/u,c/u]:[h/u,d/u]:r>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}(u,0,a[0],r,i):null;if(!e)return null;s[0]=e[0],s[1]=e[1],r&&e.length>2&&(s[2]=e[2])}return e}r.d(t,{Q:()=>i})},17135:(e,t,r)=>{r.d(t,{F0:()=>l,Vx:()=>h,e2:()=>c,f:()=>f});var n=r(57845),i=r(33715),s=r(54781),o=r(64547);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.Cb:"esriGeometryPolyline"===e?o.yM:o.WR}}}let a=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,u=1;function h(e,t){if((0,n.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let r=`this${d(t)} = null;`;for(let t in e)r+=`this${d(t)} = ${JSON.stringify(e[t])};`;let n=Function(`
      return class AttributesClass$${u++} {
        constructor() {
          ${r};
        }
      }
    `)();return()=>new n}catch(r){return()=>({[t]:null,...e})}}function d(e){return a.test(e)?`.${e}`:`["${e}"]`}function c(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function f(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:s.P,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},29499:(e,t,r)=>{r.d(t,{F:()=>l});var n=r(57845),i=r(2370),s=r(84766);let o={minX:0,minY:0,maxX:0,maxY:0};class l{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new i.w(9,(0,n.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){let e=Array(this._idByBounds.size),t=0;this._idByBounds.forEach((r,n)=>{e[t++]=n}),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(e=>this._idByBounds.has(e))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;let e=(0,s.Ie)();for(let t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){let t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){var r;this._loadIndex(),r=this._index,o.minX=e[0],o.minY=e[1],o.maxX=e[2],o.maxY=e[3],r.search(o,e=>t(this._idByBounds.get(e)))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){let t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},43253:(e,t,r)=>{let n;r.d(t,{$1:()=>y,CR:()=>m,MB:()=>f,PC:()=>g,Yx:()=>u,bP:()=>d});var i=r(67039),s=r(71760),o=r(39265);class l{constructor(){this.code=null,this.description=null}}class a{constructor(e){this.error=new l,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}function u(e){return new a(e)}class h{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function d(e){return new h(e)}let c=new Set;function f(e,t,r,n=!1){for(let s in c.clear(),r){let l=e.get(s);if(!l)continue;let a=function(e,t){let r=t;return(0,o.WA)(e)&&"string"==typeof t?r=parseFloat(t):(0,o.yM)(e)&&null!=t&&"string"!=typeof t?r=String(t):(0,o.vE)(e)&&"string"==typeof t&&(r=(0,i._U)(t)),(0,o.WX)(r)}(l,r[s]);if(c.add(l.name),l&&(n||l.editable)){let e=(0,o.CJ)(l,a);if(e)return u((0,o.uo)(e,l,a));t[l.name]=a}}for(let t of e.requiredFields??[])if(!c.has(t.name))return u(`missing required field "${t.name}"`);return null}function m(e,t){if(!e||!(0,s.fn)(t))return e;if("rings"in e||"paths"in e){if(null==n)throw TypeError("geometry engine not loaded");return n.simplify(t,e)}return e}async function p(){return null==n&&(n=await Promise.all([r.e(472),r.e(793)]).then(r.bind(r,29786))),n}async function y(e,t){(0,s.fn)(e)&&("esriGeometryPolygon"===t||"esriGeometryPolyline"===t)&&await p()}let g={supportsAutoIntervalBin:!0,supportsFixedIntervalBin:!0,supportsFixedBoundariesBin:!0,supportsDateBin:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsNormalization:!0,supportedStatisticTypes:["COUNT","SUM","AVG","VAR","STDDEV","MIN","MAX","PERCENTILE_CONT","PERCENTILE_DISC","CentroidAggregate","EnvelopeAggregate","ConvexHullAggregate"],supportedNormalizationTypes:["field","log","naturalLog","percentOfTotal","squareRoot"]}},54805:(e,t,r)=>{r.d(t,{A:()=>n});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){let e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},56599:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(94264);class i{constructor(e=[],t=[]){this.lengths=e??[],this.coords=t??[]}static fromJSON(e){return new i(e.lengths,e.coords)}static fromRect(e){let[t,r,n,s]=e,o=n-t,l=s-r;return new i([5],[t,r,o,0,0,l,-o,0,0,-l])}get isPoint(){return 0===this.lengths.length&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,t)=>e+t)}get usedMemory(){return 64+(0,n.Qf)(this.lengths,this.coords)}area(){let e=0,t=0;if(!this.lengths.length)return 0;for(let r=0;r<this.lengths.length;r++){let n=this.lengths[r];if(n<3)continue;let i=this.coords[2*t],s=this.coords[2*t+1];for(let r=1;r<n;r+=1){let n=this.coords[2*(r+t)],o=this.coords[2*(r+t)+1];e+=-.5*(n-i)*(o+s),i=n,s=o}t+=n}return e}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){let n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}deltaDecode(){let e=this.clone(),{coords:t,lengths:r}=e,n=0;for(let e of r){for(let r=1;r<e;r++)t[2*(n+r)]+=t[2*(n+r)-2],t[2*(n+r)+1]+=t[2*(n+r)-1];n+=e}return e}clone(e){if(0===this.lengths.length)return new i([],[this.coords[0],this.coords[1]]);let t=(0===this.lengths.length?1:this.lengths.reduce((e,t)=>e+t))*2,r=this.coords.slice(0,t);return e?(e.set(r),new i(this.lengths,e)):new i(Array.from(this.lengths),Array.from(r))}}},60729:(e,t,r)=>{r.d(t,{B2:()=>x,BW:()=>Y,Ch:()=>ei,DF:()=>T,Di:()=>Q,E2:()=>z,IE:()=>b,Nl:()=>et,Q4:()=>es,Rk:()=>eo,Ux:()=>$,Ye:()=>Z,ZF:()=>H,eU:()=>X,eY:()=>K,hK:()=>el,jH:()=>ee,jQ:()=>en,kz:()=>er,oN:()=>U,q3:()=>W,qK:()=>C,qN:()=>R,z5:()=>k,zv:()=>V});var n=r(32391),i=r(61939),s=r(40941),o=r(42845),l=r(84766),a=r(31789),u=r(82795),h=r(54805),d=r(56599);function c(e,t){return e?t?4:3:t?3:2}let f=()=>i.A.getLogger("esri.layers.graphics.featureConversionUtils"),m={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},p=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s},y=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2]},g=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+3]},_=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2],e[r+3]=t[n+3]};function I(e,t,r,n){if(e){if(r)return t&&n?_:y;if(t&&n)return g}else if(t&&n)return y;return p}function b({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function x({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function w({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function F({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}function M({scale:e,translate:t},r,n){return r*e[n]+t[n]}function T(e,t,r){return e?t?r?j(e):N(e):r?v(e):E(e):null}function E(e){let t=e.coords;return{x:t[0],y:t[1]}}function B(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function N(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function A(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function v(e){let t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function S(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function j(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function q(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function P(e,t){return e&&t?q:e?A:t?S:B}function R(e,t,r=P(null!=t.z,null!=t.m)){return r(e,t)}function C(e,t,r){if(null==e)return null;let n=c(t,r),i=[];for(let t=0;t<e.coords.length;t+=n){let r=[];for(let i=0;i<n;i++)r.push(e.coords[t+i]);i.push(r)}return t?r?{points:i,hasZ:t,hasM:r}:{points:i,hasZ:t}:r?{points:i,hasM:r}:{points:i}}function G(e,t,r=c(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;let n=e.coords,i=0;for(let e of t.points)for(let t=0;t<r;t++)n[i++]=e[t];return e}function Y(e,t,r){if(!e)return null;let n=c(t,r),{coords:i,lengths:s}=e,o=[],l=0;for(let e of s){let t=[];for(let r=0;r<e;r++){let e=[];for(let t=0;t<n;t++)e.push(i[l++]);t.push(e)}o.push(t)}return t?r?{paths:o,hasZ:t,hasM:r}:{paths:o,hasZ:t}:r?{paths:o,hasM:r}:{paths:o}}function O(e,t,r=c(t.hasZ,t.hasM)){let{lengths:n,coords:i}=e,s=0;for(let e of t.paths){for(let t of e)for(let e=0;e<r;e++)i[s++]=t[e];n.push(e.length)}return e}function k(e,t,r){if(!e)return null;let n=c(t,r),{coords:i,lengths:s}=e,o=[],l=0;for(let e of s){let t=[];for(let r=0;r<e;r++){let e=[];for(let t=0;t<n;t++)e.push(i[l++]);t.push(e)}o.push(t)}return t?r?{rings:o,hasZ:t,hasM:r}:{rings:o,hasZ:t}:r?{rings:o,hasM:r}:{rings:o}}function Z(e,t,r=t.hasZ,n=t.hasM){return X(e,t.rings,r,n)}function X(e,t,r,n){let i=c(r,n),{lengths:s,coords:o}=e,l=0;for(let r of(ea(e),t)){for(let e of r)for(let t=0;t<i;t++)o[l++]=e[t];s.push(r.length)}return e}let D=[],L=[];function z(e,t,r,n,i){D[0]=e;let[s]=Q(L,D,t,r,n,i);return eu(D),eu(L),s}function Q(e,t,r,i,s,o){if(eu(e),!r){for(let r of t){let t=o?r.attributes[o]:void 0;e.push(new u.Om(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":let l=P(i,s);for(let{geometry:r,attributes:n}of t){let t=null!=r?l(new d.A,r):null;e.push(new u.Om(t,n,null,o?n[o]:void 0))}break;case"esriGeometryMultipoint":let a=c(i,s);for(let{geometry:r,attributes:n}of t){let t=null!=r?G(new d.A,r,a):null;e.push(new u.Om(t,n,null,o?n[o]:void 0))}break;case"esriGeometryPolyline":let h=c(i,s);for(let{geometry:r,attributes:n,centroid:i}of t){let t=null!=r?O(new d.A,r,h):null,s=null!=i?R(new d.A,i):null;e.push(new u.Om(t,n,s,o?n[o]:void 0))}break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":for(let{geometry:r,centroid:n,attributes:l}of t){let t=null!=r?Z(new d.A,r,i,s):null,a=o?l[o]:void 0;null!=n?e.push(new u.Om(t,l,B(new d.A,n),a)):e.push(new u.Om(t,l,null,a))}break;default:f().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`)),eu(e)}return e}function U(e,t,r,n){L[0]=e,J(D,L,t,r,n);let i=D[0];return eu(D),eu(L),i}function $(e,t,r){if(null==e)return null;let i=new d.A;return("hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),(0,a.fT)(e))?P(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(i,e):(0,a.Bi)(e)?Z(i,e,t,r):(0,a.Rg)(e)?O(i,e,c(t,r)):(0,a.U9)(e)?G(i,e,c(t,r)):void f().error("convertFromGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${e}'`))}function V(e,t,r,i){let s=e&&("coords"in e?e:e.geometry);if(null==s)return null;switch(t){case"esriGeometryPoint":{let e=E;return r&&i?e=j:r?e=N:i&&(e=v),e(s)}case"esriGeometryMultipoint":return C(s,r,i);case"esriGeometryPolyline":return Y(s,r,i);case"esriGeometryPolygon":return k(s,r,i);default:return f().error("convertToGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${t}'`)),null}}function J(e,t,r,i,s){if(eu(e),null==r){for(let r of t)e.push({attributes:r.attributes});return e}switch(r){case"esriGeometryPoint":let o=E;for(let r of(i&&s?o=j:i?o=N:s&&(o=v),t)){let{geometry:t,attributes:n}=r,i=null!=t?o(t):null;e.push({attributes:n,geometry:i})}break;case"esriGeometryMultipoint":for(let{geometry:r,attributes:n}of t)e.push({attributes:n,geometry:null!=r?C(r,i,s):null});break;case"esriGeometryPolyline":for(let{geometry:r,attributes:n}of t)e.push({attributes:n,geometry:null!=r?Y(r,i,s):null});break;case"esriGeometryPolygon":for(let{geometry:r,attributes:n,centroid:o}of t){let t=null!=r?k(r,i,s):null;if(null!=o){let r=E(o);e.push({attributes:n,centroid:r,geometry:t})}else e.push({attributes:n,geometry:t})}break;default:f().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`))}return e}function H(e){let{objectIdFieldName:t,spatialReference:r,transform:n,fields:i,hasM:s,hasZ:o,features:l,geometryType:a,exceededTransferLimit:u,uniqueIdField:h,queryGeometry:d,queryGeometryType:c}=e,f={features:J([],l,a,o,s),fields:i,geometryType:a,objectIdFieldName:t,spatialReference:r,uniqueIdField:h,queryGeometry:V(d,c,!1,!1)};return n&&(f.transform=n),u&&(f.exceededTransferLimit=u),s&&(f.hasM=s),o&&(f.hasZ=o),f}function W(e,t){let r=new h.A,{hasM:i,hasZ:s,features:o,objectIdFieldName:l,spatialReference:a,geometryType:u,exceededTransferLimit:d,transform:c,fields:m}=e;return m&&(r.fields=m),r.geometryType=u??null,r.objectIdFieldName=l??t??null,r.spatialReference=a??null,r.objectIdFieldName?(o&&Q(r.features,o,u,s,i,r.objectIdFieldName),d&&(r.exceededTransferLimit=d),i&&(r.hasM=i),s&&(r.hasZ=s),c&&(r.transform=c)):f().error(new n.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r}function K(e){let{transform:t,features:r,hasM:n,hasZ:i}=e;if(!t)return e;for(let e of r)null!=e.geometry&&ei(e.geometry,e.geometry,n,i,t),null!=e.centroid&&ei(e.centroid,e.centroid,n,i,t);return e.transform=null,e}function ee(e,t){let{geometryType:r,features:n,hasM:i,hasZ:s}=t;if(!e)return t;for(let t=0;t<n.length;t++){let o=n[t],l=o.weakClone();l.geometry=new d.A,et(l.geometry,o.geometry,i,s,r,e),o.centroid&&(l.centroid=new d.A,et(l.centroid,o.centroid,i,s,"esriGeometryPoint",e)),n[t]=l}return t.transform=e,t}function et(e,t,r,n,i,s,o=r,l=n){if(ea(e),!t?.coords.length)return null;let a=m[i],{coords:u,lengths:h}=t,d=c(r,n),f=c(r&&o,n&&l),p=I(r,n,o,l);if(!h.length)return p(e.coords,u,0,0,b(s,u[0]),x(s,u[1])),ea(e,d,0),e;let y,g,_,w,F=0,M=0,T=0;for(let t of h){if(t<a)continue;let r=0;M=T,_=y=b(s,u[F]),w=g=x(s,u[F+1]),p(e.coords,u,M,F,_,w),r++,F+=d,M+=f;for(let n=1;n<t;n++,F+=d)_=b(s,u[F]),w=x(s,u[F+1]),_===y&&w===g||(p(e.coords,u,M,F,_-y,w-g),M+=f,r++,y=_,g=w);r>=a&&(e.lengths.push(r),T=M)}return eu(e.coords,T),e.coords.length?e:null}function er(e,t,r,n,i,s,o=r,l=n){if(ea(e),!t?.coords.length)return null;let a=m[i],{coords:u,lengths:h}=t,d=c(r,n),f=c(r&&o,n&&l),p=I(r,n,o,l);if(!h.length)return p(e.coords,u,0,0,u[0],u[1]),ea(e,d,0),e;let y=0,g=s*s;for(let t of h){if(t<a){y+=t*d;continue}let r=e.coords.length/f,n=y,i=y+(t-1)*d;p(e.coords,u,e.coords.length,n,u[n],u[n+1]),function e(t,r,n,i,s,o,l){let a,u=i,h=0;for(let e=o+n;e<l;e+=n)(a=function(e,t,r,n){let i=e[t],s=e[t+1],o=e[r],l=e[r+1],a=e[n],u=e[n+1],h=o,d=l,c=a-h,f=u-d;if(0!==c||0!==f){let e=((i-h)*c+(s-d)*f)/(c*c+f*f);e>1?(h=a,d=u):e>0&&(h+=c*e,d+=f*e)}return(c=i-h)*c+(f=s-d)*f}(r,e,o,l))>u&&(h=e,u=a);u>i&&(h-o>n&&e(t,r,n,i,s,o,h),s(t,r,t.length,h,r[h],r[h+1]),l-h>n&&e(t,r,n,i,s,h,l))}(e.coords,u,d,g,p,n,i),p(e.coords,u,e.coords.length,i,u[i],u[i+1]);let s=e.coords.length/f-r;s>=a?e.lengths.push(s):eu(e.coords,r*f),y+=t*d}return e.coords.length?e:null}function en(e,t,r,n){if(!t?.coords?.length)return null;let i=c(r,n),s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;if(t&&t.coords){let e=t.coords;for(let t=0;t<e.length;t+=i){let r=e[t],n=e[t+1];s=Math.min(s,r),u=Math.max(u,r),a=Math.min(a,n),h=Math.max(h,n)}}return(0,o.is)(e)?(0,o.BI)(e,s,a,u,h):(0,l.fA)(s,a,u,h,e),e}function ei(e,t,r,n,i){let{coords:o,lengths:l}=t,a=c(r,n);if(!o.length)return e!==t&&ea(e),e;(0,s.Lw)(i);let{originPosition:u,scale:h,translate:d}=i;eh.originPosition=u;let f=eh.scale;f[0]=h[0]??1,f[1]=-(h[1]??1),f[2]=h[2]??1,f[3]=h[3]??1;let m=eh.translate;if(m[0]=d[0]??0,m[1]=d[1]??0,m[2]=d[2]??0,m[3]=d[3]??0,!l.length){for(let t=0;t<a;++t)e.coords[t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(eh,o[t],t);return e!==t&&ea(e,a,0),e}let p=0;for(let t=0;t<l.length;t++){let r=l[t];e.lengths[t]=r;for(let t=0;t<a;++t)e.coords[p+t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(eh,o[p+t],t);let n=e.coords[p],i=e.coords[p+1];p+=a;for(let t=1;t<r;t++,p+=a){n+=o[p]*f[0],i+=o[p+1]*f[1],e.coords[p]=n,e.coords[p+1]=i;for(let t=2;t<a;++t)e.coords[p+t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(eh,o[p+t],t)}}return e!==t&&ea(e,o.length,l.length),e}function es(e,t,r,n,i,s){if(ea(e),e.lengths.push(...t.lengths),r===i&&n===s)for(let r=0;r<t.coords.length;r++)e.coords.push(t.coords[r]);else{let o=c(r,n),l=I(r,n,i,s),a=t.coords;for(let t=0;t<a.length;t+=o)l(e.coords,a,e.coords.length,t,a[t],a[t+1])}return e}function eo(e,t){let{coords:r,lengths:n}=e,i=0,s=0;for(let e=0;e<n.length;e++){let o=n[e];s+=function(e,t,r,n){let i=0,s=e[n*t],o=e[n*(t+1)];for(let l=1;l<r;l++){let r=s+e[n*(t+l)],a=o+e[n*(t+l)+1],u=(r-s)*(a+o);s=r,o=a,i+=u}return .5*i}(r,i,o,t),i+=o}return Math.abs(s)}function el(e,t,r,n,i){let s=c(n,i);if(!e.lengths.length){if(e.coords.length<2)return null;let[r,n]=e.coords,i=w(t,r),s=F(t,n);return new d.A([],[i,s])}let o=new d.A([],[0,0]),l=m[r],a="esriGeometryPolygon"===r||"esriGeometryPolyline"===r,u=0,h=0;for(let r=0;r<e.lengths.length;r++){let n=e.lengths[r],i=h,d=w(t,e.coords[s*u]),c=F(t,e.coords[s*u+1]);o.coords[h++]=d,o.coords[h++]=c;let m=0,y=0,g=1;for(let r=1;r<n;r++){let n=w(t,e.coords[s*(r+u)]),i=F(t,e.coords[s*(r+u)+1]);if(n!==d||i!==c){var f,p;let e=n-d,t=i-c;a&&0==(f=m)*t-e*(p=y)&&f*e+p*t>0?(o.coords[h-2]+=e,o.coords[h-1]+=t,d+=e,c+=t):(o.coords[h++]=n,o.coords[h++]=i,d=n,c=i,m=e,y=t,g+=1)}}g<l?h=i:o.lengths.push(g),u+=n}return 0===o.lengths.length?null:o}function ea(e,t=0,r=0){eu(e.lengths,r),eu(e.coords,t)}function eu(e,t=0){e.length!==t&&(e.length=t)}let eh={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},67039:(e,t,r)=>{function n(e){return null!=l(e)||null!=o(e)}function i(e){return a.test(e)}function s(e){return l(e)??o(e)}function o(e){let t=new Date(e);return!function(e,t){if(Number.isNaN(e.getTime()))return!1;let r=!0;if(h&&/\d+\W*$/.test(t)){let e=t.match(/[a-zA-Z]{2,}/);if(e){let t=!1,n=0;for(;!t&&n<=e.length;)t=!u.test(e[n]),n++;r=!t}}return r}(t,e)?null:Number.isNaN(t.getTime())?null:t.getTime()-6e4*t.getTimezoneOffset()}function l(e){let t,r=a.exec(e);if(!r?.groups)return null;let n=r.groups,i=+n.year,s=n.month-1,o=+n.day,l=+(n.hours??"0"),u=+(n.minutes??"0"),h=+(n.seconds??"0");if(l>23||u>59||h>59)return null;let d=n.ms??"0",c=d?+d.padEnd(3,"0").slice(0,3):0;if(n.isUTC||!n.offsetSign)t=Date.UTC(i,s,o,l,u,h,c);else{let e=+n.offsetHours,r=+n.offsetMinutes;t=6e4*("+"===n.offsetSign?-1:1)*(60*e+r)+Date.UTC(i,s,o,l,u,h,c)}return Number.isNaN(t)?null:t}r.d(t,{Br:()=>i,Cq:()=>n,_U:()=>s});let a=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,u=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,h=!Number.isNaN(new Date("technology 10").getTime())},79836:(e,t,r)=>{r.d(t,{BM:()=>b,bd:()=>x,sO:()=>I,xD:()=>h});var n=r(67039),i=r(32391),s=r(71760),o=r(82795),l=r(56599),a=r(39265);let u={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function h(e){return u[e]}function*d(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(let t of e.features)t&&(yield t)}}function c(e){let t=0;for(let r=0;r<e.length;r++){let n=e[r],i=e[(r+1)%e.length];t+=n[0]*i[1]-i[0]*n[1]}return t<=0}function f(e){let t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]||e.push(t),e}function m(e,t,r){let n=f(t);c(n)?y(e,n,r):g(e,n,r)}function p(e,t,r){let n=f(t);c(n)?g(e,n,r):y(e,n,r)}function y(e,t,r){for(let n of t)_(e,n,r);e.lengths.push(t.length)}function g(e,t,r){for(let n=t.length-1;n>=0;n--)_(e,t[n],r);e.lengths.push(t.length)}function _(e,t,r){let[n,i,s]=t;e.coords.push(n,i),r.hasZ&&e.coords.push(s||0)}function I(e,t=4326){if(!e)throw new i.A("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new i.A("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});let{crs:r}=e;if(!r)return;let n="string"==typeof r?r:"name"===r.type?r.properties.name:"EPSG"===r.type?r.properties.code:null,o=(0,s.oT)({wkid:t})?RegExp(".*(CRS84H?|4326)$","i"):RegExp(`.*(${t})$`,"i");if(!n||!o.test(n))throw new i.A("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:r})}function b(e,t={}){let r=[],i=new Set,s=new Set,o,l=!1,h=null,c=!1,{geometryType:f=null}=t;for(let t of d(e)){let{geometry:e,properties:d,id:m}=t;if((!e||(f||(f=u[e.type]),u[e.type]===f))&&(l||(l=function(e){for(let t of e)if(t.length>2)return!0;return!1}(function*(e){if(e)switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(let t of e.coordinates)yield*t;break;case"MultiPolygon":for(let t of e.coordinates)for(let e of t)yield*e}}(e))),c||(c=null!=m)&&(o=typeof m,d&&(h=Object.keys(d).filter(e=>d[e]===m))),d&&h&&c&&null!=m&&(h.length>1?h=h.filter(e=>d[e]===m):1===h.length&&(h=d[h[0]]===m?h:[])),d))for(let e in d){if(i.has(e))continue;let t=function(e){switch(typeof e){case"string":return(0,n.Br)(e)?"esriFieldTypeDate":"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}(d[e]);if("unknown"===t){s.add(e);continue}s.delete(e),i.add(e);let o=(0,a.rS)(e);o&&r.push({name:o,alias:e,type:t})}}let m=(0,a.rS)(1===h?.length&&h[0]||null)??void 0;if(m){for(let e of r)if(e.name===m&&(0,a.WA)(e)){e.type="esriFieldTypeOID";break}}return{fields:r,geometryType:f,hasZ:l,objectIdFieldName:m,objectIdFieldType:o,unknownFields:Array.from(s)}}function x(e,t){return Array.from(function*(e,t={}){let{geometryType:r,objectIdField:n}=t;for(let i of e){let e,{geometry:s,properties:a,id:h}=i;if(s&&u[s.type]!==r)continue;let d=a||{};n&&(e=d[n],null==h||e||(d[n]=e=h));let c=new o.Om(s?function(e,t,r){switch(t.type){case"LineString":return n=e,i=t,s=r,y(n,i.coordinates,s),n;case"MultiLineString":var n,i,s,o,l,a,u,h,d,c=e,f=t,g=r;for(let e of f.coordinates)y(c,e,g);return c;case"MultiPoint":return o=e,l=t,a=r,y(o,l.coordinates,a),o;case"MultiPolygon":var I=e,b=t,x=r;for(let e of b.coordinates){m(I,e[0],x);for(let t=1;t<e.length;t++)p(I,e[t],x)}return I;case"Point":return u=e,h=t,d=r,_(u,h.coordinates,d),u;case"Polygon":var w=e,F=t,M=r;let T=F.coordinates;m(w,T[0],M);for(let e=1;e<T.length;e++)p(w,T[e],M);return w}}(new l.A,s,t):null,d,null,e);yield c}}(d(e),t))}},82795:(e,t,r)=>{r.d(t,{N3:()=>l,Om:()=>o});var n=r(94264),i=r(11506),s=r(56599);class o{constructor(e=null,t={},r,n,i=0){this.geometry=e,this.attributes=t,this.centroid=r,this.objectId=n,this.displayId=i}static fromJSON(e){let t=e.geometry?s.A.fromJSON(e.geometry):null,r=e.centroid?s.A.fromJSON(e.centroid):null,n=e.objectId;return new o(t,e.attributes,r,n)}weakClone(){let e=new o(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){let e=new o(this.geometry?.clone(),{...this.attributes},this.centroid?.clone(),this.objectId);return e.displayId=this.displayId,e}ensureCentroid(e){return this.centroid??=(0,i.Q)(new s.A,this.geometry,e.hasZ,e.hasM),this.centroid}get usedMemory(){return 128+(0,n.lM)(this.attributes)+(this.geometry?.usedMemory??0)}}function l(e){return!!e.geometry?.coords?.length}},86925:(e,t,r)=>{r.d(t,{J:()=>m});var n=r(33715),i=r(92753),s=r(31789),o=r(25606),l=r(71760),a=r(76461),u=r(41359),h=r(90804),d=r(91738),c=r(6515),f=r(40513);async function m(e,t,r){let f=(0,i.Mq)(r),{point:m,distance:y,returnEdge:g,vertexMode:_}=t;if(!g&&"none"===_)return{candidates:[]};let I=(0,n.o8)(t.query);I=await e.schedule(()=>(0,d.T2)(I,e.definitionExpression,e.spatialReference),f),I=await e.reschedule(()=>(0,c.B4)(I,{availableFields:e.availableFields,fieldsIndex:e.fieldsIndex,geometryType:e.geometryType,spatialReference:e.spatialReference}),f);let b=!(0,l.aI)(m.spatialReference,e.spatialReference);b&&await (0,a.Nk)(m.spatialReference,e.spatialReference);let x="number"==typeof y?y:y.x,w="number"==typeof y?y:y.y,F={xmin:m.x-x,xmax:m.x+x,ymin:m.y-w,ymax:m.y+w,spatialReference:m.spatialReference},M=b?(0,a.Cv)(F,e.spatialReference):F;if(!M)return{candidates:[]};let T=(await (0,o.el)((0,s.rS)(m),null,{signal:f}))[0],E=(await (0,o.el)((0,s.rS)(M),null,{signal:f}))[0];if(null==T||null==E)return{candidates:[]};let B=new h.G(await e.reschedule(()=>e.searchFeatures((0,u.ux)(E.toJSON())),f),I,e);await e.reschedule(()=>e.executeObjectIdsQuery(B),f),await e.reschedule(()=>e.executeTimeQuery(B),f),await e.reschedule(()=>e.executeAttributesQuery(B),f),await e.reschedule(()=>p(e,B,f),f);let N=T.toJSON(),A=b?(0,a.Cv)(N,e.spatialReference):N,v=b?Math.max(M.xmax-M.xmin,M.ymax-M.ymin)/2:y;return B.createSnappingResponse({...t,point:A,distance:v},m.spatialReference)}async function p(e,t,r){let{query:n}=t,{spatialRel:i}=n;if(!t?.items?.length||!n.geometry||!i)return;let s=await (0,f.xt)(i,n.geometry,e.geometryType,e.hasZ,e.hasM),o=await e.runSpatialFilter(t.items,e=>s(e.geometry),r);t.items=o}},94264:(e,t,r)=>{r.d(t,{Qf:()=>a,Qh:()=>o,RS:()=>i,ez:()=>h,i5:()=>d,lM:()=>s,qK:()=>u});var n=r(48678);let i=16;function s(e){if(!e)return 0;let t=u;for(let r in e)e.hasOwnProperty(r)&&(t+=l(e[r],!1));return t}function o(e){if(!e)return 0;if("number"==typeof e[0])return a(e);if(Array.isArray(e)){var t=e;let r=t.length;if(0===r||"number"==typeof t[0])return function(e,t){return h+e.length*t}(t,8);let n=h;for(let e=0;e<r;e++)n+=l(t[e]);return n}let r=u;for(let t in e)e.hasOwnProperty(t)&&(r+=l(e[t]));return r}function l(e,t=!0){switch(typeof e){case"object":return t?o(e):u;case"string":return 32+e.length;case"number":return i;case"boolean":return 4;default:return 8}}function a(...e){return e.reduce((e,t)=>{var r,s;return e+(t?(0,n.iu)(t)?t.byteLength+d:Array.isArray(t)?(r=t,s=i,h+r.length*s):0:0)},0)}let u=32,h=16,d=145}}]);