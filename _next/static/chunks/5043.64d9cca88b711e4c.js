"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5043],{119:(e,t,r)=>{var n,i;r.d(t,{H6:()=>o,dz:()=>n,oH:()=>i}),function(e){e[e.OBJECT=0]="OBJECT",e[e.HUD=1]="HUD",e[e.TERRAIN=2]="TERRAIN",e[e.OVERLAY=3]="OVERLAY",e[e.I3S=4]="I3S",e[e.PCL=5]="PCL",e[e.LOD=6]="LOD",e[e.VOXEL=7]="VOXEL",e[e.TILES3D=8]="TILES3D"}(n||(n={}));class o{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerUids=[],this.store=i.ALL,this.normalRequired=!0,this.excludeLabels=!1}}!function(e){e[e.MIN=0]="MIN",e[e.MINMAX=1]="MINMAX",e[e.ALL=2]="ALL"}(i||(i={}))},5408:(e,t,r)=>{r.d(t,{C:()=>O,FB:()=>n,ig:()=>_,m7:()=>T,ui:()=>m,vt:()=>p});var n,i,o=r(17656),s=r(40998),l=r(63599),a=r(56911),h=r(13784),u=r(44120),c=r(22892),d=r(72500),f=r(42378);function p(e){return e?[(0,d.vt)(e[0]),(0,d.vt)(e[1]),(0,d.vt)(e[2]),(0,d.vt)(e[3]),(0,d.vt)(e[4]),(0,d.vt)(e[5])]:[(0,d.vt)(),(0,d.vt)(),(0,d.vt)(),(0,d.vt)(),(0,d.vt)(),(0,d.vt)()]}function O(e,t){for(let r=0;r<v;r++)(0,d.C)(e[r],t[r]);return e}function m(e,t,r,o=R){var a,u;let c=(0,s.lw)(f.Rc.get(),t,e);(0,s.B8)(c,c);for(let e=0;e<g;++e){let t=(0,h.t)(f.Km.get(),A[e],c);(0,l.i)(o[e],t[0]/t[3],t[1]/t[3],t[2]/t[3])}a=r,u=o,(0,d.Cr)(u[i.FAR_BOTTOM_LEFT],u[i.NEAR_BOTTOM_LEFT],u[i.NEAR_TOP_LEFT],a[n.LEFT]),(0,d.Cr)(u[i.NEAR_BOTTOM_RIGHT],u[i.FAR_BOTTOM_RIGHT],u[i.FAR_TOP_RIGHT],a[n.RIGHT]),(0,d.Cr)(u[i.FAR_BOTTOM_LEFT],u[i.FAR_BOTTOM_RIGHT],u[i.NEAR_BOTTOM_RIGHT],a[n.BOTTOM]),(0,d.Cr)(u[i.NEAR_TOP_LEFT],u[i.NEAR_TOP_RIGHT],u[i.FAR_TOP_RIGHT],a[n.TOP]),(0,d.Cr)(u[i.NEAR_BOTTOM_LEFT],u[i.NEAR_BOTTOM_RIGHT],u[i.NEAR_TOP_RIGHT],a[n.NEAR]),(0,d.Cr)(u[i.FAR_BOTTOM_RIGHT],u[i.FAR_BOTTOM_LEFT],u[i.FAR_TOP_LEFT],a[n.FAR])}function T(e,t){for(let r=0;r<v;r++){let n=e[r];if(n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]>=t[3])return!1}return!0}function _(e,t){for(let r=0;r<v;r++){let n=e[r];if(!(0,d.b6)(n,t))return!1}return!0}!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.BOTTOM=2]="BOTTOM",e[e.TOP=3]="TOP",e[e.NEAR=4]="NEAR",e[e.FAR=5]="FAR"}(n||(n={})),function(e){e[e.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",e[e.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",e[e.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",e[e.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",e[e.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",e[e.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",e[e.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",e[e.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(i||(i={})),i.FAR_BOTTOM_RIGHT,i.NEAR_BOTTOM_RIGHT,i.NEAR_BOTTOM_LEFT,i.FAR_BOTTOM_LEFT,i.NEAR_BOTTOM_LEFT,i.NEAR_BOTTOM_RIGHT,i.NEAR_TOP_RIGHT,i.NEAR_TOP_LEFT,i.FAR_BOTTOM_RIGHT,i.FAR_BOTTOM_LEFT,i.FAR_TOP_LEFT,i.FAR_TOP_RIGHT,i.NEAR_BOTTOM_RIGHT,i.FAR_BOTTOM_RIGHT,i.FAR_TOP_RIGHT,i.NEAR_TOP_RIGHT,i.FAR_BOTTOM_LEFT,i.NEAR_BOTTOM_LEFT,i.NEAR_TOP_LEFT,i.FAR_TOP_LEFT,i.FAR_TOP_LEFT,i.NEAR_TOP_LEFT,i.NEAR_TOP_RIGHT,i.FAR_TOP_RIGHT;let v=6,g=8,A=[(0,u.fA)(-1,-1,-1,1),(0,u.fA)(1,-1,-1,1),(0,u.fA)(1,1,-1,1),(0,u.fA)(-1,1,-1,1),(0,u.fA)(-1,-1,1,1),(0,u.fA)(1,-1,1,1),(0,u.fA)(1,1,1,1),(0,u.fA)(-1,1,1,1)],R=(new o.I(c.vt),[(0,a.vt)(),(0,a.vt)(),(0,a.vt)(),(0,a.vt)(),(0,a.vt)(),(0,a.vt)(),(0,a.vt)(),(0,a.vt)()])},17202:(e,t,r)=>{r.d(t,{B$:()=>o,HE:()=>s,R6:()=>l});var n=r(56911);class i{constructor(e,t,r){this.object=e,this.geometryId=t,this.triangleNr=r}}class o extends i{constructor(e,t,r,i){super(e,t,r),this.center=null!=i?(0,n.o8)(i):null}}class s{constructor(e){this.layerUid=e}}class l extends s{constructor(e,t){super(e),this.graphicUid=t}}},19908:(e,t,r)=>{r.d(t,{i3:()=>i}),r(63599);var n=r(56911);function i(e){return null!=e?.dist}r(56429),r(119),(0,n.vt)()},22892:(e,t,r)=>{r.d(t,{$e:()=>l,j1:()=>a,mO:()=>h,vt:()=>s});var n=r(17656),i=r(63599),o=r(23146);function s(e){return e?{ray:(0,o.vt)(e.ray),c0:e.c0,c1:e.c1}:{ray:(0,o.vt)(),c0:0,c1:Number.MAX_VALUE}}function l(e,t=s()){return(0,o.C)(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function a(e,t){return u(e,e.c0,t)}function h(e,t){return u(e,e.c1,t)}function u(e,t,r){return(0,i.g)(r,e.ray.origin,(0,i.h)(r,e.ray.direction,t))}new n.I(()=>s())},26928:(e,t,r)=>{r.d(t,{CN:()=>a,PY:()=>h,Q_:()=>l,ny:()=>u,sZ:()=>c}),r(57845);var n=r(62377),i=r(44120),o=r(17914),s=r(93446);let l=128,a=.5,h=(0,i.CN)(a/2,a/2,1-a/2,1-a/2);function u(e){return"cross"===e||"x"===e}function c(e,t=l,r=t*a,n=0){let i=function(e,t=l,r=t*a,n=0){switch(e){case"circle":default:var i,o,s=t,h=r;let u=s/2-.5;return m(s,p(u,u,h/2));case"square":return d(t,r,!1);case"cross":return function(e,t,r=0){return f(e,t,!1,r)}(t,r,n);case"x":return function(e,t,r=0){return f(e,t,!0,r)}(t,r,n);case"kite":return d(t,r,!0);case"triangle":return m(i=t,O(i/2,o=r,o/2));case"arrow":return function(e,t){let r=t/2,n=e/2,i=.8*t,o=p(n,(e-t)/2-i,Math.sqrt(i*i+r*r)),s=O(n,t,r);return m(e,(e,t)=>Math.max(s(e,t),-o(e,t)))}(t,r)}}(e,t,r,n);return new o.g(i,{mipmap:!1,wrap:{s:s.pF.CLAMP_TO_EDGE,t:s.pF.CLAMP_TO_EDGE},width:t,height:t,components:4,noUnpackFlip:!0,reloadable:!0})}function d(e,t,r){return r&&(t/=Math.SQRT2),m(e,(n,i)=>{let o=n-.5*e+.25,s=.5*e-i-.75;if(r){let e=(o+s)/Math.SQRT2;s=(s-o)/Math.SQRT2,o=e}return Math.max(Math.abs(o),Math.abs(s))-.5*t})}function f(e,t,r,n=0){t-=n,r&&(t*=Math.SQRT2);let i=.5*t;return m(e,(t,o)=>{let s=t-.5*e,l=.5*e-o-1;if(r){let e=(s+l)/Math.SQRT2;l=(l-s)/Math.SQRT2,s=e}return((s=Math.abs(s))>(l=Math.abs(l))?s>i?Math.sqrt((s-i)*(s-i)+l*l):l:l>i?Math.sqrt(s*s+(l-i)*(l-i)):s)-n/2})}function p(e,t,r){return(n,i)=>{let o=n-e,s=i-t;return Math.sqrt(o*o+s*s)-r}}function O(e,t,r){let n=Math.sqrt(t*t+r*r);return(i,o)=>{let s=Math.abs(i-e)-r,l=o-e+t/2+.75;return Math.max((t*s+r*l)/n,-l)}}function m(e,t){let r=new Uint8Array(4*e*e);for(let i=0;i<e;i++)for(let o=0;o<e;o++){let s=o+e*i,l=t(o,i);l=l/e+.5,(0,n.U)(l,r,4*s)}return r}},36885:(e,t,r)=>{r.d(t,{y:()=>h});var n=r(63943),i=r(74806),o=r(85263),s=r(90475),l=r(86416),a=r(70762);function h(e){e.vertex.uniforms.add(new s.U("renderTransparentlyOccludedHUD",e=>e.hudRenderStyle===i.D.Occluded?1:.75*(e.hudRenderStyle!==i.D.NotOccluded)),new o.I("viewport",e=>e.camera.fullViewport),new a.x("hudVisibilityTexture",e=>e.hudVisibility?.getTexture())),e.vertex.include(n.K),e.vertex.code.add((0,l.H)`bool testHUDVisibility(vec4 posProj) {
vec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);
vec4 occlusionPixel = texture(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);
if (renderTransparentlyOccludedHUD > 0.5) {
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * renderTransparentlyOccludedHUD < 1.0;
}
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;
}`)}},53297:(e,t,r)=>{r.d(t,{Q:()=>d,R:()=>c});var n=r(84797),i=r(54126),o=r(82784),s=r(85263),l=r(90475),a=r(76085),h=r(86416),u=r(53041);let c=.5;function d(e,t){e.include(i.Y6),e.attributes.add(u.r.POSITION,"vec3"),e.attributes.add(u.r.NORMAL,"vec3"),e.attributes.add(u.r.CENTEROFFSETANDDISTANCE,"vec4");let r=e.vertex;(0,o.NB)(r,t),(0,o.yu)(r,t),r.uniforms.add(new s.I("viewport",e=>e.camera.fullViewport),new a.m("polygonOffset",e=>e.shaderPolygonOffset),new l.U("cameraGroundRelative",e=>e.camera.aboveGround?1:-1)),t.hasVerticalOffset&&(0,n.V)(r),r.constants.add("smallOffsetAngle","float",.984807753012208),r.code.add((0,h.H)`struct ProjectHUDAux {
vec3 posModel;
vec3 posView;
vec3 vnormal;
float distanceToCamera;
float absCosAngle;
};`),r.code.add((0,h.H)`
    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {
      float pointGroundSign = ${t.terrainDepthTest?h.H.float(0):(0,h.H)`sign(pointGroundDistance)`};
      if (pointGroundSign == 0.0) {
        pointGroundSign = cameraGroundRelative;
      }

      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground
      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise
      float groundRelative = cameraGroundRelative * pointGroundSign;

      // view angle dependent part of polygon offset emulation: we take the absolute value because the sign that is
      // dropped is instead introduced using the ground-relative position of the symbol and the camera
      if (polygonOffset > .0) {
        float cosAlpha = clamp(absCosAngle, 0.01, 1.0);
        float tanAlpha = sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;
        float factor = (1.0 - tanAlpha / viewport[2]);

        // same side of the terrain
        if (groundRelative > 0.0) {
          posView *= factor;
        }
        // opposite sides of the terrain
        else {
          posView /= factor;
        }
      }

      return groundRelative;
    }
  `),t.draped&&!t.hasVerticalOffset||(0,o.S7)(r),t.draped||(r.uniforms.add(new l.U("perDistancePixelRatio",e=>Math.tan(e.camera.fovY/2)/(e.camera.fullViewport[2]/2))),r.code.add((0,h.H)`
    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {
      float distanceToCamera = length(posView);

      // Compute offset in world units for a half pixel shift
      float pixelOffset = distanceToCamera * perDistancePixelRatio * ${h.H.float(c)};

      // Apply offset along normal in the direction away from the ground surface
      vec3 modelOffset = normalModel * cameraGroundRelative * pixelOffset;

      // Apply the same offset also on the view space position
      vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;

      posModel += modelOffset;
      posView += viewOffset;
    }
  `)),t.screenCenterOffsetUnitsEnabled&&(0,o.Nz)(r),t.hasScreenSizePerspective&&(0,i.OH)(r),r.code.add((0,h.H)`
    vec4 projectPositionHUD(out ProjectHUDAux aux) {
      vec3 centerOffset = centerOffsetAndDistance.xyz;
      float pointGroundDistance = centerOffsetAndDistance.w;

      aux.posModel = position;
      aux.posView = (view * vec4(aux.posModel, 1.0)).xyz;
      aux.vnormal = normal;
      ${t.draped?"":"applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);"}

      // Screen sized offset in world space, used for example for line callouts
      // Note: keep this implementation in sync with the CPU implementation, see
      //   - MaterialUtil.verticalOffsetAtDistance
      //   - HUDMaterial.applyVerticalOffsetTransformation

      aux.distanceToCamera = length(aux.posView);

      vec3 viewDirObjSpace = normalize(cameraPosition - aux.posModel);
      float cosAngle = dot(aux.vnormal, viewDirObjSpace);

      aux.absCosAngle = abs(cosAngle);

      ${t.hasScreenSizePerspective&&(t.hasVerticalOffset||t.screenCenterOffsetUnitsEnabled)?"vec3 perspectiveFactor = screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":""}

      ${t.hasVerticalOffset?t.hasScreenSizePerspective?"float verticalOffsetScreenHeight = applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight = verticalOffset.x;":""}

      ${t.hasVerticalOffset?(0,h.H)`
            float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);
            vec3 modelOffset = aux.vnormal * worldOffset;
            aux.posModel += modelOffset;
            vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;
            aux.posView += viewOffset;
            // Since we elevate the object, we need to take that into account
            // in the distance to ground
            pointGroundDistance += worldOffset;`:""}

      float groundRelative = applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);

      ${t.screenCenterOffsetUnitsEnabled?"":(0,h.H)`
            // Apply x/y in view space, but z in screen space (i.e. along posView direction)
            aux.posView += vec3(centerOffset.x, centerOffset.y, 0.0);

            // Same material all have same z != 0.0 condition so should not lead to
            // branch fragmentation and will save a normalization if it's not needed
            if (centerOffset.z != 0.0) {
              aux.posView -= normalize(aux.posView) * centerOffset.z;
            }
          `}

      vec4 posProj = proj * vec4(aux.posView, 1.0);

      ${t.screenCenterOffsetUnitsEnabled?t.hasScreenSizePerspective?"float centerOffsetY = applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY = centerOffset.y;":""}

      ${t.screenCenterOffsetUnitsEnabled?"posProj.xy += vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""}

      // constant part of polygon offset emulation
      posProj.z -= groundRelative * polygonOffset * posProj.w;
      return posProj;
    }
  `)}},54919:(e,t,r)=>{r.d(t,{v:()=>n});function n(e){return"point"===e.type}},58710:(e,t,r)=>{r.d(t,{W:()=>i});var n=r(86416);function i(e){e.code.add((0,n.H)`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}`),e.code.add((0,n.H)`const vec4 RGBA_TO_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgbaTofloat(vec4 rgba) {
return dot(rgba, RGBA_TO_FLOAT_FACTORS);
}`),e.code.add((0,n.H)`const vec4 uninterpolatedRGBAToFloatFactors = vec4(
1.0 / 256.0,
1.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0 / 256.0
);
float uninterpolatedRGBAToFloat(vec4 rgba) {
return (dot(round(rgba * 255.0), uninterpolatedRGBAToFloatFactors) - 0.5) * 2.0;
}`)}},61004:(e,t,r)=>{r.d(t,{V:()=>o});var n=r(2907),i=r(73024);class o extends i.n{constructor(e,t){super(e,"vec4",n.c.Draw,(r,n,i)=>r.setUniform4fv(e,t(n,i)))}}},63943:(e,t,r)=>{r.d(t,{K:()=>o});var n=r(93205),i=r(86416);function o(e){e.uniforms.add(new n.o("alignPixelEnabled",e=>e.alignPixelEnabled)),e.code.add((0,i.H)`vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {
if (!alignPixelEnabled)
return clipCoord;
vec2 xy = vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`),e.code.add((0,i.H)`vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {
if (!alignPixelEnabled)
return clipCoord;
vec2 xy = vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`)}},64835:(e,t,r)=>{r.d(t,{G7:()=>A,hz:()=>T});var n=r(40998),i=r(38715),o=r(63599),s=r(56911),l=r(13784),a=r(44120),h=r(23146),u=r(10954),c=r(119),d=r(17202),f=r(19908),p=r(16337);class O{constructor(e){this.options=new c.H6,this._results=new _,this.transform=new p.dg,this.tolerance=1e-5,this.verticalOffset=null,this._ray=(0,h.vt)(),this._rayEnd=(0,s.vt)(),this._rayBeginTransformed=(0,s.vt)(),this._rayEndTransformed=(0,s.vt)(),this.viewingMode=e??u.RT.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,t,r){this.resetWithRay((0,h.Cr)(e,t,this._ray),r)}resetWithRay(e,t){this.camera=t,e!==this._ray&&(0,h.C)(e,this._ray),0!==this.options.verticalOffset?this.viewingMode===u.RT.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,(0,o.g)(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,t,r,n,i){this.point=t,this.filterPredicate=n,this.tolerance=r??1e-5;let o=(0,p.ou)(this.verticalOffset);if(e&&e.length>0){let t=i?e=>{i(e)&&this.intersectObject(e)}:e=>{this.intersectObject(e)};for(let r of e){let e=r.getSpatialQueryAccelerator?.();null!=e?(null!=o?e.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,t,o):e.forEachAlongRay(this._ray.origin,this._ray.direction,t),this.options.selectionMode&&this.options.hud&&e.forEachDegenerateObject(t)):r.objects.forAll(e=>t(e))}}this.sortResults()}intersectObject(e){let t=e.geometries;if(!t)return;let r=e.effectiveTransformation,n=(0,p.ou)(this.verticalOffset);for(let s of t){if(!s.visible)continue;let{material:t,id:l}=s;if(!t.visible)continue;this.transform.setAndInvalidateLazyTransforms(r,s.transformation),(0,o.t)(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),(0,o.t)(this._rayEndTransformed,this.rayEnd,this.transform.inverse);let a=this.transform.transform;null!=n&&(n.objectTransform=this.transform),t.intersect(s,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(t,r,n,o,s,h)=>{if(t>=0){if(null!=this.filterPredicate&&!this.filterPredicate(this._ray.origin,this._rayEnd,t))return;let u=o?this._results.hud:this._results,f=o?o=>{let a=new d.B$(e,l,n,h);o.set(c.dz.HUD,a,t,r,i.zK,s)}:i=>i.set(c.dz.OBJECT,{object:e,geometryId:l,triangleNr:n},t,r,a,s);if((null==u.min.drapedLayerOrder||s>=u.min.drapedLayerOrder)&&(null==u.min.dist||t<u.min.dist)&&f(u.min),this.options.store!==c.oH.MIN&&(null==u.max.drapedLayerOrder||s<u.max.drapedLayerOrder)&&(null==u.max.dist||t>u.max.dist)&&f(u.max),this.options.store===c.oH.ALL)if(o){let e=new g(this._ray);f(e),this._results.hud.all.push(e)}else{let e=new v(this._ray);f(e),this._results.all.push(e)}}})}}sortResults(e=this._results.all){e.sort((e,t)=>e.dist!==t.dist?(e.dist??0)-(t.dist??0):e.drapedLayerOrder!==t.drapedLayerOrder?m(e.drapedLayerOrder,t.drapedLayerOrder):m(e.drapedLayerGraphicOrder,t.drapedLayerGraphicOrder))}}function m(e,t){return(t??-Number.MAX_VALUE)-(e??-Number.MAX_VALUE)}function T(e){return new O(e)}class _{constructor(){this.min=new v((0,h.vt)()),this.max=new v((0,h.vt)()),this.hud={min:new g((0,h.vt)()),max:new g((0,h.vt)()),all:[]},this.ground=new v((0,h.vt)()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}}class v{get ray(){return this._ray}get distanceInRenderSpace(){return null!=this.dist?((0,o.h)(R,this.ray.direction,this.dist),(0,o.l)(R)):null}withinDistance(e){return!!(0,f.i3)(this)&&this.distanceInRenderSpace<=e}getIntersectionPoint(e){return!!(0,f.i3)(this)&&((0,o.h)(R,this.ray.direction,this.dist),(0,o.g)(e,this.ray.origin,R),!0)}getTransformedNormal(e){return(0,o.c)(y,this.normal),y[3]=0,(0,l.t)(y,y,this.transformation),(0,o.c)(e,y),(0,o.n)(e,e)}constructor(e){this.intersector=c.dz.OBJECT,this.normal=(0,s.vt)(),this.transformation=(0,i.vt)(),this._ray=(0,h.vt)(),this.init(e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=c.dz.OBJECT,(0,h.C)(e,this._ray)}set(e,t,r,l,a,h,u){this.intersector=e,this.dist=r,(0,o.c)(this.normal,l??s.Cb),(0,n.C)(this.transformation,a??i.zK),this.target=t,this.drapedLayerOrder=h,this.drapedLayerGraphicOrder=u}copy(e){(0,h.C)(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,(0,o.c)(this.normal,e.normal),(0,n.C)(this.transformation,e.transformation)}}class g extends v{constructor(){super(...arguments),this.intersector=c.dz.HUD}}function A(e){return new v(e)}let R=(0,s.vt)(),y=(0,a.vt)()},73275:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(98570),i=r(87196),o=r(63599),s=r(56911),l=r(5408),a=r(23146),h=r(7916),u=r(97681);class c{get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}constructor(e,t){this.objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new d,this._objectCount=0,t&&(void 0!==t.maximumObjectsPerNode&&(this._maximumObjectsPerNode=t.maximumObjectsPerNode),void 0!==t.maximumDepth&&(this._maximumDepth=t.maximumDepth))}destroy(){this._degenerateObjects.clear(),d.clearPool(),M[0]=null,E.prune(),C.prune()}add(e,t=e.length){this._objectCount+=t,this._grow(e,t);let r=d.acquire();for(let n=0;n<t;n++){let t=e[n];this._isDegenerate(t)?this._degenerateObjects.add(t):(r.init(this._root),this._add(t,r))}d.release(r)}remove(e,t=null){this._objectCount-=e.length;let r=d.acquire();for(let n of e){let e=t??(0,h.e)(this.objectToBoundingSphere(n),P);g(e[3])?(r.init(this._root),function(e,t,r){E.clear();let n=r.advanceTo(t,(e,t)=>{E.push(e.node),E.push(t)})?r.node.terminals:r.node.residents;if(n.removeUnordered(e),0===n.length){var o,s;for(let e=E.length-2;e>=0&&(o=E.data[e],(s=E.data[e+1])>=0&&(o.children[s]=null),O(o)&&(null===o.residents&&(o.residents=new i.A({shrink:!0})),1));e-=2);}}(n,e,r)):this._degenerateObjects.delete(n)}d.release(r),this._shrink()}update(e,t){var r;if(!g(t[3])&&this._isDegenerate(e))return;let n=(r=e,M[0]=r,M);this.remove(n,t),this.add(n)}forEachAlongRay(e,t,r){let n=(0,a.LV)(e,t);f(this._root,e=>{var t,i;if(t=n,i=e,m((0,h.a)(i.bounds),-(2*i.halfSize),x),m((0,h.a)(i.bounds),2*i.halfSize,S),!(0,u.O_)(t.origin,t.direction,x,S))return!1;let o=e.node;return o.terminals.forAll(e=>{this._intersectsObject(n,e)&&r(e)}),null!==o.residents&&o.residents.forAll(e=>{this._intersectsObject(n,e)&&r(e)}),!0})}forEachAlongRayWithVerticalOffset(e,t,r,n){let i=(0,a.LV)(e,t);f(this._root,e=>{var t,o,s;if(t=i,o=e,s=n,m((0,h.a)(o.bounds),-(2*o.halfSize),x),m((0,h.a)(o.bounds),2*o.halfSize,S),s.applyToMinMax(x,S),!(0,u.O_)(t.origin,t.direction,x,S))return!1;let l=e.node;return l.terminals.forAll(e=>{this._intersectsObjectWithOffset(i,e,n)&&r(e)}),null!==l.residents&&l.residents.forAll(e=>{this._intersectsObjectWithOffset(i,e,n)&&r(e)}),!0})}forEach(e){f(this._root,t=>{let r=t.node;return r.terminals.forAll(e),null!==r.residents&&r.residents.forAll(e),!0}),this._degenerateObjects.forEach(e)}forEachDegenerateObject(e){this._degenerateObjects.forEach(e)}findClosest(e,t,r,n=()=>!0,i=1/0){let s=1/0,a=1/0,u=null,c=_(e,t),d=o=>{if(--i,!n(o))return;let c=this.objectToBoundingSphere(o);if(!(0,l.m7)(r,c))return;let d=v(e,t,(0,h.a)(c)),f=d-c[3],p=d+c[3];f<s&&(s=f,a=p,u=o)};return p(this._root,n=>{if(i<=0||!(0,l.m7)(r,n.bounds)||((0,o.h)(w,c,n.halfSize),(0,o.g)(w,w,(0,h.a)(n.bounds)),v(e,t,w)>a))return!1;let s=n.node;return s.terminals.forAll(e=>d(e)),null!==s.residents&&s.residents.forAll(e=>d(e)),!0},e,t),u}forEachInDepthRange(e,t,r,n,i,s,a){let u=-1/0,d=1/0,f={setRange:e=>{r===c.DepthOrder.FRONT_TO_BACK?(u=Math.max(u,e.near),d=Math.min(d,e.far)):(u=Math.max(u,-e.far),d=Math.min(d,-e.near))}};f.setRange(n);let O=v(t,r,e),m=_(t,r),T=_(t,-r),g=e=>{if(!a(e))return;let n=this.objectToBoundingSphere(e),o=v(t,r,(0,h.a)(n))-O,c=o-n[3],p=o+n[3];c>d||p<u||!(0,l.m7)(s,n)||i(e,f)};p(this._root,e=>{if(!(0,l.m7)(s,e.bounds)||((0,o.h)(w,m,e.halfSize),(0,o.g)(w,w,(0,h.a)(e.bounds)),v(t,r,w)-O>d)||((0,o.h)(w,T,e.halfSize),(0,o.g)(w,w,(0,h.a)(e.bounds)),v(t,r,w)-O<u))return!1;let n=e.node;return n.terminals.forAll(e=>g(e)),null!==n.residents&&n.residents.forAll(e=>g(e)),!0},t,r)}forEachNode(e){f(this._root,t=>e(t.node,t.bounds,t.halfSize,t.depth))}forEachNeighbor(e,t){let r=(0,h.g)(t),n=(0,h.a)(t),i=t=>{let i=this.objectToBoundingSphere(t),s=r+(0,h.g)(i);return!((0,o.s)((0,h.a)(i),n)-s*s<=0)||e(t)},s=!0,l=e=>{s&&(s=i(e))};f(this._root,e=>{let t=r+(0,h.g)(e.bounds);if((0,o.s)((0,h.a)(e.bounds),n)-t*t>0)return!1;let i=e.node;return i.terminals.forAll(l),s&&null!==i.residents&&i.residents.forAll(l),s}),s&&this.forEachDegenerateObject(l)}_intersectsObject(e,t){let r=this.objectToBoundingSphere(t);return!(r[3]>0)||(0,h.i)(r,e)}_intersectsObjectWithOffset(e,t,r){let n=this.objectToBoundingSphere(t);return!(n[3]>0)||(0,h.i)(r.applyToBoundingSphere(n),e)}_add(e,t){t.advanceTo(this.objectToBoundingSphere(e))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}_split(e){let t=e.node.residents;e.node.residents=null;for(let r=0;r<t.length;r++){let n=d.acquire().init(e);this._add(t.at(r),n),d.release(n)}}_grow(e,t){if(0!==t&&(T(e,t,e=>this.objectToBoundingSphere(e),N),g(N[3])&&!this._fitsInsideTree(N)))if(O(this._root.node))(0,h.e)(N,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{let e=this._rootBoundsForRootAsSubNode(N);this._placingRootViolatesMaxDepth(e)?this._rebuildTree(N,e):this._growRootAsSubNode(e),d.release(e)}}_rebuildTree(e,t){(0,o.c)((0,h.a)(F),(0,h.a)(t.bounds)),F[3]=t.halfSize,T([e,F],2,e=>e,I);let r=d.acquire().init(this._root);this._root.initFrom(null,I,I[3]),this._root.increaseHalfSize(1.25),f(r,e=>(this.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&this.add(e.node.residents.data,e.node.residents.length),!0)),d.release(r)}_placingRootViolatesMaxDepth(e){let t=Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E,r=0;return f(this._root,e=>(r=Math.max(r,e.depth))+t<=this._maximumDepth),r+t>this._maximumDepth}_rootBoundsForRootAsSubNode(e){let t=e[3],r=-1/0,n=this._root.bounds,i=this._root.halfSize;for(let o=0;o<3;o++){let s=n[o]-i-(e[o]-t),l=e[o]+t-(n[o]+i),a=Math.max(0,Math.ceil(s/(2*i))),h=Math.max(0,Math.ceil(l/(2*i)))+1;r=Math.max(r,2**Math.ceil(Math.log(a+h)*Math.LOG2E)),L[o].min=a,L[o].max=h}for(let e=0;e<3;e++){let t=L[e].min,o=L[e].max,s=(r-(t+o))/2;t+=Math.ceil(s),o+=Math.floor(s);let l=n[e]-i-t*i*2;b[e]=l+(o+t)*i}let o=r*i;return b[3]=o*y,d.acquire().initFrom(null,b,o,0)}_growRootAsSubNode(e){let t=this._root.node;(0,o.c)((0,h.a)(N),(0,h.a)(this._root.bounds)),N[3]=this._root.halfSize,this._root.init(e),e.advanceTo(N,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}_shrink(){for(;;){let e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return -1;let e=null,t=this._root.node.children,r=0,n=0;for(;n<t.length&&null==e;)e=t[r=n++];for(;n<t.length;)if(t[n++])return -1;return r}_isDegenerate(e){return!g(this.objectToBoundingSphere(e)[3])}_fitsInsideTree(e){let t=this._root.bounds,r=this._root.halfSize;return e[3]<=r&&e[0]>=t[0]-r&&e[0]<=t[0]+r&&e[1]>=t[1]-r&&e[1]<=t[1]+r&&e[2]>=t[2]-r&&e[2]<=t[2]+r}toJSON(){let{maximumDepth:e,maximumObjectsPerNode:t,_objectCount:r}=this,n=this._nodeToJSON(this._root.node);return{maximumDepth:e,maximumObjectsPerNode:t,objectCount:r,root:{bounds:this._root.bounds,halfSize:this._root.halfSize,depth:this._root.depth,node:n}}}_nodeToJSON(e){let t=e.children.map(e=>e?this._nodeToJSON(e):null);return{children:t,residents:e.residents?.map(e=>this.objectToBoundingSphere(e)),terminals:e.terminals?.map(e=>this.objectToBoundingSphere(e))}}static fromJSON(e){let t=new c(e=>e,{maximumDepth:e.maximumDepth,maximumObjectsPerNode:e.maximumObjectsPerNode});return t._objectCount=e.objectCount,t._root.initFrom(e.root.node,e.root.bounds,e.root.halfSize,e.root.depth),t}}class d{constructor(){this.bounds=(0,h.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(e){return this.initFrom(e.node,e.bounds,e.halfSize,e.depth)}initFrom(e,t,r,n=this.depth){return this.node=null!=e?e:d.createEmptyNode(),t&&(0,h.e)(t,this.bounds),this.halfSize=r,this.depth=n,this}increaseHalfSize(e){this.halfSize*=e,this.updateBoundsRadiusFromHalfSize()}updateBoundsRadiusFromHalfSize(){this.bounds[3]=this.halfSize*y}advance(e){let t=this.node.children[e];t||(t=d.createEmptyNode(),this.node.children[e]=t),this.node=t,this.halfSize/=2,this.depth++;let r=A[e];return this.bounds[0]+=r[0]*this.halfSize,this.bounds[1]+=r[1]*this.halfSize,this.bounds[2]+=r[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}advanceTo(e,t,r=!1){for(;;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()){if(!r)return t&&t(this,-1),!1;this.node.residents=null}let n=this._childIndex(e);t&&t(this,n),this.advance(n)}}isLeaf(){return null!=this.node.residents}isTerminalFor(e){return e[3]>this.halfSize/2}_childIndex(e){let t=this.bounds;return+(t[0]<e[0])+2*(t[1]<e[1])+4*(t[2]<e[2])}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new i.A({shrink:!0}),residents:new i.A({shrink:!0})}}static acquire(){return d._pool.acquire()}static release(e){d._pool.release(e)}static clearPool(){d._pool.prune()}}function f(e,t){let r=d.acquire().init(e),n=[r];for(;0!==n.length;){if(t(r=n.pop())&&!r.isLeaf())for(let e=0;e<r.node.children.length;e++)r.node.children[e]&&n.push(d.acquire().init(r).advance(e));d.release(r)}}function p(e,t,r,n=c.DepthOrder.FRONT_TO_BACK){let i=d.acquire().init(e),o=[i];for(function(e,t,r){if(!C.length)for(let e=0;e<8;++e)C.push({index:0,distance:0});for(let r=0;r<8;++r){let n=A[r];C.data[r].index=r,C.data[r].distance=v(e,t,n)}C.sort((e,t)=>e.distance-t.distance);for(let e=0;e<8;++e)r[e]=C.data[e].index}(r,n,z);0!==o.length;){if(t(i=o.pop())&&!i.isLeaf())for(let e=7;e>=0;--e){let t=z[e];i.node.children[t]&&o.push(d.acquire().init(i).advance(t))}d.release(i)}}function O(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(let t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}function m(e,t,r){r[0]=e[0]+t,r[1]=e[1]+t,r[2]=e[2]+t}function T(e,t,r,n){if(1===t){let t=r(e[0]);(0,h.e)(t,n)}else{x[0]=1/0,x[1]=1/0,x[2]=1/0,S[0]=-1/0,S[1]=-1/0,S[2]=-1/0;for(let n=0;n<t;n++){let t=r(e[n]);g(t[3])&&(x[0]=Math.min(x[0],t[0]-t[3]),x[1]=Math.min(x[1],t[1]-t[3]),x[2]=Math.min(x[2],t[2]-t[3]),S[0]=Math.max(S[0],t[0]+t[3]),S[1]=Math.max(S[1],t[1]+t[3]),S[2]=Math.max(S[2],t[2]+t[3]))}(0,o.m)((0,h.a)(n),x,S,.5),n[3]=Math.max(S[0]-x[0],S[1]-x[1],S[2]-x[2])/2}}function _(e,t){let r,n=1/0;for(let i=0;i<8;++i){let o=v(e,t,R[i]);o<n&&(n=o,r=R[i])}return r}function v(e,t,r){return t*(e[0]*r[0]+e[1]*r[1]+e[2]*r[2])}function g(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}d._pool=new n.A(d),function(e){var t;(t=e.DepthOrder||(e.DepthOrder={}))[t.FRONT_TO_BACK=1]="FRONT_TO_BACK",t[t.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(c);let A=[(0,s.fA)(-1,-1,-1),(0,s.fA)(1,-1,-1),(0,s.fA)(-1,1,-1),(0,s.fA)(1,1,-1),(0,s.fA)(-1,-1,1),(0,s.fA)(1,-1,1),(0,s.fA)(-1,1,1),(0,s.fA)(1,1,1)],R=[(0,s.fA)(-1,-1,-1),(0,s.fA)(-1,-1,1),(0,s.fA)(-1,1,-1),(0,s.fA)(-1,1,1),(0,s.fA)(1,-1,-1),(0,s.fA)(1,-1,1),(0,s.fA)(1,1,-1),(0,s.fA)(1,1,1)],y=Math.sqrt(3),M=[null],b=(0,h.c)(),w=(0,s.vt)(),x=(0,s.vt)(),S=(0,s.vt)(),E=new i.A,P=(0,h.c)(),N=(0,h.c)(),F=(0,h.c)(),I=(0,h.c)(),L=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],C=new i.A,z=[0,0,0,0,0,0,0,0]},74806:(e,t,r)=>{var n;r.d(t,{D:()=>n}),function(e){e[e.Occluded=0]="Occluded",e[e.NotOccluded=1]="NotOccluded",e[e.Both=2]="Both",e[e.COUNT=3]="COUNT"}(n||(n={}))},85640:(e,t,r)=>{r.d(t,{Ci:()=>o,PC:()=>s,Vk:()=>l});var n=r(56911),i=r(13636);function o(e,t){return null==e&&(e=[]),e.push(t),e}function s(e,t){if(null==e)return null;let r=e.filter(e=>e!==t);return 0===r.length?null:r}function l(e,t,r,n,o){a[0]=e.get(t,0),a[1]=e.get(t,1),a[2]=e.get(t,2),(0,i.jS)(a,h,3),r.set(o,0,h[0]),n.set(o,0,h[1]),r.set(o,1,h[2]),n.set(o,1,h[3]),r.set(o,2,h[4]),n.set(o,2,h[5])}let a=(0,n.vt)(),h=new Float32Array(6)},91220:(e,t,r)=>{r.d(t,{$2:()=>b,$C:()=>A,Hj:()=>y,Mh:()=>M,W$:()=>T,pW:()=>R,t8:()=>g,vY:()=>w});var n=r(8922),i=r(40998),o=r(38715),s=r(56911),l=r(13784),a=r(44120),h=r(65111),u=r(42845),c=r(84766),d=r(2010),f=r(60470),p=r(19474),O=r(40838),m=r(83048);function T(e,t){if("point"===e.type)return v(e,t,!1);if((0,m.gr)(e))switch(e.type){case"extent":return v(e.center,t,!1);case"polygon":return v(e.centroid,t,!1);case"polyline":return v(_(e),t,!0);case"mesh":return v((0,p.MW)(e.vertexSpace,e.spatialReference)??e.extent.center,t,!1);case"multipoint":return}else switch(e.type){case"extent":var r;return v((r=e,(0,O.T)(.5*(r.xmax+r.xmin),.5*(r.ymax+r.ymin),null!=r.zmin&&null!=r.zmax&&isFinite(r.zmin)&&isFinite(r.zmax)?.5*(r.zmax+r.zmin):void 0,r.spatialReference)),t,!0);case"polygon":return v(function(e){let t=e.rings[0];if(!t||0===t.length)return null;let r=(0,d.S8)(e.rings,!!e.hasZ);return(0,O.T)(r[0],r[1],r[2],e.spatialReference)}(e),t,!0);case"polyline":return v(_(e),t,!0);case"multipoint":return}}function _(e){let t=e.paths[0];if(!t||0===t.length)return null;let r=(0,f.$H)(t,(0,f.Yl)(t)/2);return(0,O.T)(r[0],r[1],r[2],e.spatialReference)}function v(e,t,r){let n=r?e:(0,m.EL)(e);return t&&e?(0,h.projectPoint)(e,n,t)?n:null:n}function g(e,t,r,n=0){if(e){t||(t=(0,c.vt)());let i=.5*e.width*(r-1),o=.5*e.height*(r-1);return e.width<1e-7*e.height?i+=o/20:e.height<1e-7*e.width&&(o+=i/20),(0,l.s)(t,e.xmin-i-n,e.ymin-o-n,e.xmax+i+n,e.ymax+o+n),t}return null}function A(e,t,r=null){let n=(0,a.o8)(a.Un);return null!=e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2]),null!=t?n[3]=t:null!=e&&e.length>3&&(n[3]=e[3]),r&&(n[0]*=r,n[1]*=r,n[2]*=r,n[3]*=r),n}function R(e=s.Un,t,r,n=1){let i=[,,,];if(null==t||null==r)i[0]=1,i[1]=1,i[2]=1;else{let n,o=0;for(let s=2;s>=0;s--){let l,a=e[s],h=null!=a,u=0===s&&!n&&!h,c=r[s];"symbol-value"===a||u?l=0!==c?t[s]/c:1:h&&"proportional"!==a&&isFinite(a)&&(l=0!==c?a/c:1),null!=l&&(i[s]=l,n=l,o=Math.max(o,Math.abs(l)))}for(let e=2;e>=0;e--)null==i[e]?i[e]=n:0===i[e]&&(i[e]=.001*o)}for(let e=2;e>=0;e--)i[e]/=n;return(0,s.ci)(i)}function y(e){return M(null!=e.isPrimitive?[e.width,e.depth,e.height]:e)?null:"Symbol sizes may not be negative values"}function M(e){let t=e=>null==e||e>=0;return Array.isArray(e)?e.every(t):t(e)}function b(e,t,r,n=(0,o.vt)()){return e&&(0,i.Qr)(n,n,-e/180*Math.PI),t&&(0,i.eL)(n,n,t/180*Math.PI),r&&(0,i.Z8)(n,n,r/180*Math.PI),n}function w(e,t,r){if(null!=r.minDemResolution)return r.minDemResolution;let i=(0,n.GA)(t),o=(0,u.VL)(e)*i,s=(0,u.yr)(e)*i,l=(0,u.uJ)(e)*(t.isGeographic?1:i);return 0===o&&0===s&&0===l?r.minDemResolutionForPoints:.01*Math.max(o,s,l)}},96319:(e,t,r)=>{r.d(t,{zC:()=>en,C1:()=>M,EE:()=>K,YG:()=>J,nW:()=>Y,td:()=>E,_B:()=>et,Nq:()=>Z,DJ:()=>X,uX:()=>k,Z8:()=>ee,CM:()=>q,Gj:()=>W,Ho:()=>U,Nb:()=>Q,Xl:()=>eo,xh:()=>er});var n,i=r(63599),o=r(89988),s=r(56911),l=r(40200),a=r(75169),h=r(95775),u=r(72500),c=r(23146),d=r(4023);!function(e){e.length=function(e,t){let r=e[t],n=e[t+1],i=e[t+2];return Math.sqrt(r*r+n*n+i*i)},e.normalize=function(e,t){let r=e[t],n=e[t+1],i=e[t+2],o=1/Math.sqrt(r*r+n*n+i*i);e[t]*=o,e[t+1]*=o,e[t+2]*=o},e.scale=function(e,t,r){e[t]*=r,e[t+1]*=r,e[t+2]*=r},e.add=function(e,t,r,n,i,o=t){(i=i||e)[o]=e[t]+r[n],i[o+1]=e[t+1]+r[n+1],i[o+2]=e[t+2]+r[n+2]},e.subtract=function(e,t,r,n,i,o=t){(i=i||e)[o]=e[t]-r[n],i[o+1]=e[t+1]-r[n+1],i[o+2]=e[t+2]-r[n+2]}}(n||(n={}));var f=r(74405),p=r(63497),O=r(97681),m=r(53041);let T=n,_=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],v=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],g=[0,0,1,0,1,1,0,1],A=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],R=Array(36);for(let e=0;e<6;e++)for(let t=0;t<6;t++)R[6*e+t]=e;let y=Array(36);for(let e=0;e<6;e++)y[6*e]=0,y[6*e+1]=1,y[6*e+2]=2,y[6*e+3]=2,y[6*e+4]=3,y[6*e+5]=0;function M(e,t){Array.isArray(t)||(t=[t,t,t]);let r=Array(24);for(let e=0;e<8;e++)r[3*e]=_[e][0]*t[0],r[3*e+1]=_[e][1]*t[1],r[3*e+2]=_[e][2]*t[2];return new p.V(e,[[m.r.POSITION,new d.n(r,A,3,!0)],[m.r.NORMAL,new d.n(v,R,3)],[m.r.UV0,new d.n(g,y,2)]])}let b=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],w=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],x=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],S=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];function E(e,t){Array.isArray(t)||(t=[t,t,t]);let r=Array(18);for(let e=0;e<6;e++)r[3*e]=b[e][0]*t[0],r[3*e+1]=b[e][1]*t[1],r[3*e+2]=b[e][2]*t[2];return new p.V(e,[[m.r.POSITION,new d.n(r,x,3,!0)],[m.r.NORMAL,new d.n(w,S,3)]])}let P=(0,o.fA)(-.5,0,-.5),N=(0,o.fA)(.5,0,-.5),F=(0,o.fA)(0,0,.5),I=(0,o.fA)(0,.5,0),L=(0,o.vt)(),C=(0,o.vt)(),z=(0,o.vt)(),H=(0,o.vt)(),B=(0,o.vt)();(0,i.d)(L,P,I),(0,i.d)(C,P,N),(0,i.e)(z,L,C),(0,i.n)(z,z),(0,i.d)(L,N,I),(0,i.d)(C,N,F),(0,i.e)(H,L,C),(0,i.n)(H,H),(0,i.d)(L,F,I),(0,i.d)(C,F,P),(0,i.e)(B,L,C),(0,i.n)(B,B);let j=[P,N,F,I],D=[0,-1,0,z[0],z[1],z[2],H[0],H[1],H[2],B[0],B[1],B[2]],G=[0,1,2,3,1,0,3,2,1,3,0,2],V=[0,0,0,1,1,1,2,2,2,3,3,3];function U(e,t){Array.isArray(t)||(t=[t,t,t]);let r=Array(12);for(let e=0;e<4;e++)r[3*e]=j[e][0]*t[0],r[3*e+1]=j[e][1]*t[1],r[3*e+2]=j[e][2]*t[2];return new p.V(e,[[m.r.POSITION,new d.n(r,G,3,!0)],[m.r.NORMAL,new d.n(D,V,3)]])}function q(e,t,r,n,i={uv:!0}){let o=-Math.PI,s=2*Math.PI,l=-Math.PI/2,u=Math.PI,c=Math.max(3,Math.floor(r)),f=Math.max(2,Math.floor(n)),O=(c+1)*(f+1),T=(0,a.oe)(3*O),_=(0,a.oe)(3*O),v=(0,a.oe)(2*O),g=[],A=0;for(let e=0;e<=f;e++){let r=[],n=e/f,i=l+n*u,a=Math.cos(i);for(let e=0;e<=c;e++){let l=e/c,h=o+l*s,u=Math.cos(h)*a,d=Math.sin(i),f=-Math.sin(h)*a;T[3*A]=u*t,T[3*A+1]=d*t,T[3*A+2]=f*t,_[3*A]=u,_[3*A+1]=d,_[3*A+2]=f,v[2*A]=l,v[2*A+1]=n,r.push(A),++A}g.push(r)}let R=[];for(let e=0;e<f;e++)for(let t=0;t<c;t++){let r=g[e][t],n=g[e][t+1],i=g[e+1][t+1],o=g[e+1][t];0===e?(R.push(r),R.push(i),R.push(o)):e===f-1?(R.push(r),R.push(n),R.push(i)):(R.push(r),R.push(n),R.push(i),R.push(i),R.push(o),R.push(r))}let y=[[m.r.POSITION,new d.n(T,R,3,!0)],[m.r.NORMAL,new d.n(_,R,3,!0)]];return i.uv&&y.push([m.r.UV0,new d.n(v,R,2,!0)]),i.offset&&(y[0][0]=m.r.OFFSET,y.push([m.r.POSITION,new d.n(Float64Array.from(i.offset),(0,h.EH)(R.length),3,!0)])),new p.V(e,y)}function k(e,t,r,n){let i=function(e,t,r){let n,i;if(r)n=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],i=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1];else{let t=e*(1+Math.sqrt(5))/2;n=[-e,t,0,e,t,0,-e,-t,0,e,-t,0,0,-e,t,0,e,t,0,-e,-t,0,e,-t,t,0,-e,t,0,e,-t,0,-e,-t,0,e],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]}for(let t=0;t<n.length;t+=3)T.scale(n,t,e/T.length(n,t));let o={};function s(t,r){t>r&&([t,r]=[r,t]);let i=t.toString()+"."+r.toString();if(o[i])return o[i];let s=n.length;return n.length+=3,T.add(n,3*t,n,3*r,n,s),T.scale(n,s,e/T.length(n,s)),s/=3,o[i]=s,s}for(let e=0;e<t;e++){let e=i.length,t=Array(4*e);for(let r=0;r<e;r+=3){let e=i[r],n=i[r+1],o=i[r+2],l=s(e,n),a=s(n,o),h=s(o,e),u=4*r;t[u]=e,t[u+1]=l,t[u+2]=h,t[u+3]=n,t[u+4]=a,t[u+5]=l,t[u+6]=o,t[u+7]=h,t[u+8]=a,t[u+9]=l,t[u+10]=a,t[u+11]=h}i=t,o={}}let l=(0,a.Wz)(n);for(let e=0;e<l.length;e+=3)T.normalize(l,e);return[[m.r.POSITION,new d.n((0,a.Wz)(n),i,3,!0)],[m.r.NORMAL,new d.n(l,i,3,!0)]]}(t,r,n);return new p.V(e,i)}function X(e,t={}){let{normal:r,position:n,color:i,rotation:o,size:l,centerOffsetAndDistance:a,uvs:u,featureAttribute:c,objectAndLayerIdColor:O=null}=t,T=n?(0,s.o8)(n):(0,s.vt)(),_=r?(0,s.o8)(r):(0,s.fA)(0,0,1),v=i?[255*i[0],255*i[1],255*i[2],i.length>3?255*i[3]:255]:[255,255,255,255],g=null!=l&&2===l.length?l:[1,1],A=(0,h.EH)(1),R=[[m.r.POSITION,new d.n(T,A,3,!0)],[m.r.NORMAL,new d.n(_,A,3,!0)],[m.r.COLOR,new d.n(v,A,4,!0)],[m.r.SIZE,new d.n(g,A,2)],[m.r.ROTATION,new d.n(null!=o?[o]:[0],A,1,!0)]];if(u&&R.push([m.r.UV0,new d.n(u,A,u.length)]),null!=a){let e=[a[0],a[1],a[2],a[3]];R.push([m.r.CENTEROFFSETANDDISTANCE,new d.n(e,A,4)])}if(c){let e=[c[0],c[1],c[2],c[3]];R.push([m.r.FEATUREATTRIBUTE,new d.n(e,A,4)])}return new p.V(e,R,null,f.X.Point,O)}let $=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function W(e,t=$){let r=Array(12);for(let e=0;e<4;e++)for(let n=0;n<3;n++)r[3*e+n]=t[e][n];let n=[0,1,2,2,3,0],i=[0,0,0,0,0,0],o=[[m.r.POSITION,new d.n(r,n,3,!0)],[m.r.NORMAL,new d.n([0,0,1],i,3,!0)],[m.r.UV0,new d.n([0,0,1,0,1,1,0,1],n,2,!0)],[m.r.COLOR,new d.n([255,255,255,255],i,4,!0)]];return new p.V(e,o)}function J(e,t,r,n,i=!0,s=!0){let l=0,h=(0,o.fA)(0,l,0),u=(0,o.fA)(0,l+e,0),c=(0,o.fA)(0,-1,0),f=(0,o.fA)(0,1,0);n&&(l=e,u=(0,o.fA)(0,0,0),h=(0,o.fA)(0,l,0),c=(0,o.fA)(0,1,0),f=(0,o.fA)(0,-1,0));let p=[u,h],O=[c,f],T=r+2,_=Math.sqrt(e*e+t*t);if(n)for(let n=r-1;n>=0;n--){let i=2*Math.PI/r*n,s=(0,o.fA)(Math.cos(i)*t,l,Math.sin(i)*t);p.push(s);let a=(0,o.fA)(e*Math.cos(i)/_,-t/_,e*Math.sin(i)/_);O.push(a)}else for(let n=0;n<r;n++){let i=2*Math.PI/r*n,s=(0,o.fA)(Math.cos(i)*t,l,Math.sin(i)*t);p.push(s);let a=(0,o.fA)(e*Math.cos(i)/_,t/_,e*Math.sin(i)/_);O.push(a)}let v=[],g=[];if(i){for(let e=3;e<p.length;e++)v.push(1),v.push(e-1),v.push(e),g.push(0),g.push(0),g.push(0);v.push(p.length-1),v.push(2),v.push(1),g.push(0),g.push(0),g.push(0)}if(s){for(let e=3;e<p.length;e++)v.push(e),v.push(e-1),v.push(0),g.push(e),g.push(e-1),g.push(1);v.push(0),v.push(2),v.push(p.length-1),g.push(1),g.push(2),g.push(O.length-1)}let A=(0,a.oe)(3*T);for(let e=0;e<T;e++)A[3*e]=p[e][0],A[3*e+1]=p[e][1],A[3*e+2]=p[e][2];let R=(0,a.oe)(3*T);for(let e=0;e<T;e++)R[3*e]=O[e][0],R[3*e+1]=O[e][1],R[3*e+2]=O[e][2];return[[m.r.POSITION,new d.n(A,v,3,!0)],[m.r.NORMAL,new d.n(R,g,3,!0)]]}function K(e,t,r,n,i,o=!0,s=!0){return new p.V(e,J(t,r,n,i,o,s))}function Y(e,t,r,n,s,l,h){let u=s?(0,o.o8)(s):(0,o.fA)(1,0,0),c=l?(0,o.o8)(l):(0,o.fA)(0,0,0);h??=!0;let f=(0,o.vt)();(0,i.n)(f,u);let O=(0,o.vt)();(0,i.h)(O,f,Math.abs(t));let T=(0,o.vt)();(0,i.h)(T,O,-.5),(0,i.g)(T,T,c);let _=(0,o.fA)(0,1,0);.2>Math.abs(1-(0,i.f)(f,_))&&(0,i.i)(_,0,0,1);let v=(0,o.vt)();(0,i.e)(v,f,_),(0,i.n)(v,v),(0,i.e)(_,v,f);let g=2*n+2*!!h,A=n+2*!!h,R=(0,a.oe)(3*g),y=(0,a.oe)(3*A),M=(0,a.oe)(2*g),b=Array(3*n*(h?4:2)),w=Array(3*n*(h?4:2));h&&(R[3*(g-2)]=T[0],R[3*(g-2)+1]=T[1],R[3*(g-2)+2]=T[2],M[2*(g-2)]=0,M[2*(g-2)+1]=0,R[3*(g-1)]=R[3*(g-2)]+O[0],R[3*(g-1)+1]=R[3*(g-2)+1]+O[1],R[3*(g-1)+2]=R[3*(g-2)+2]+O[2],M[2*(g-1)]=1,M[2*(g-1)+1]=1,y[3*(A-2)]=-f[0],y[3*(A-2)+1]=-f[1],y[3*(A-2)+2]=-f[2],y[3*(A-1)]=f[0],y[3*(A-1)+1]=f[1],y[3*(A-1)+2]=f[2]);let x=(e,t,r)=>{b[e]=t,w[e]=r},S=0,E=(0,o.vt)(),P=(0,o.vt)();for(let e=0;e<n;e++){let t=2*Math.PI/n*e;(0,i.h)(E,_,Math.sin(t)),(0,i.h)(P,v,Math.cos(t)),(0,i.g)(E,E,P),y[3*e]=E[0],y[3*e+1]=E[1],y[3*e+2]=E[2],(0,i.h)(E,E,r),(0,i.g)(E,E,T),R[3*e]=E[0],R[3*e+1]=E[1],R[3*e+2]=E[2],M[2*e]=e/n,M[2*e+1]=0,R[3*(e+n)]=R[3*e]+O[0],R[3*(e+n)+1]=R[3*e+1]+O[1],R[3*(e+n)+2]=R[3*e+2]+O[2],M[2*(e+n)]=e/n,M[2*e+1]=1;let o=(e+1)%n;x(S++,e,e),x(S++,e+n,e),x(S++,o,o),x(S++,o,o),x(S++,e+n,e),x(S++,o+n,o)}if(h){for(let e=0;e<n;e++){let t=(e+1)%n;x(S++,g-2,A-2),x(S++,e,A-2),x(S++,t,A-2)}for(let e=0;e<n;e++){let t=(e+1)%n;x(S++,e+n,A-1),x(S++,g-1,A-1),x(S++,t+n,A-1)}}let N=[[m.r.POSITION,new d.n(R,b,3,!0)],[m.r.NORMAL,new d.n(y,w,3,!0)],[m.r.UV0,new d.n(M,b,2,!0)]];return new p.V(e,N)}function Q(e,t,r,n,i,o){n=n||10,i=null==i||i,(0,O.vA)(t.length>1);let s=[],l=[];for(let e=0;e<n;e++){s.push([0,-e-1,-(e+1)%n-1]);let t=e/n*2*Math.PI;l.push([Math.cos(t)*r,Math.sin(t)*r])}return Z(e,l,t,[[0,0,0]],s,i,o)}function Z(e,t,r,n,l,h,f=(0,o.fA)(0,0,0)){let O=t.length,T=(0,a.oe)(r.length*O*3+(6*n.length||0)),_=(0,a.oe)(r.length*O*3+6*!!n),v=[],g=[],A=0,R=0,y=(0,s.vt)(),M=(0,s.vt)(),b=(0,s.vt)(),w=(0,s.vt)(),x=(0,s.vt)(),S=(0,s.vt)(),E=(0,s.vt)(),P=(0,s.vt)(),N=(0,s.vt)(),F=(0,s.vt)(),I=(0,s.vt)(),L=(0,s.vt)(),C=(0,s.vt)(),z=(0,u.vt)();(0,i.i)(N,0,1,0),(0,i.d)(M,r[1],r[0]),(0,i.n)(M,M),h?((0,i.g)(P,r[0],f),(0,i.n)(b,P)):(0,i.i)(b,0,0,1),eo(M,b,N,N,x,b,es),(0,i.c)(w,b),(0,i.c)(L,x);for(let e=0;e<n.length;e++)(0,i.h)(S,x,n[e][0]),(0,i.h)(P,b,n[e][2]),(0,i.g)(S,S,P),(0,i.g)(S,S,r[0]),T[A++]=S[0],T[A++]=S[1],T[A++]=S[2];_[R++]=-M[0],_[R++]=-M[1],_[R++]=-M[2];for(let e=0;e<l.length;e++)v.push(l[e][0]>0?l[e][0]:-l[e][0]-1+n.length),v.push(l[e][1]>0?l[e][1]:-l[e][1]-1+n.length),v.push(l[e][2]>0?l[e][2]:-l[e][2]-1+n.length),g.push(0),g.push(0),g.push(0);let H=n.length,B=n.length-1;for(let e=0;e<r.length;e++){let n=!1;e>0&&((0,i.c)(y,M),e<r.length-1?((0,i.d)(M,r[e+1],r[e]),(0,i.n)(M,M)):n=!0,(0,i.g)(F,y,M),(0,i.n)(F,F),(0,i.g)(I,r[e-1],w),(0,u.O_)(r[e],F,z),(0,u.Ui)(z,(0,c.LV)(I,y),P)?((0,i.d)(P,P,r[e]),(0,i.n)(b,P),(0,i.e)(x,F,b),(0,i.n)(x,x)):eo(F,w,L,N,x,b,es),(0,i.c)(w,b),(0,i.c)(L,x)),h&&((0,i.g)(P,r[e],f),(0,i.n)(C,P));for(let o=0;o<O;o++)if((0,i.h)(S,x,t[o][0]),(0,i.h)(P,b,t[o][1]),(0,i.g)(S,S,P),(0,i.n)(E,S),_[R++]=E[0],_[R++]=E[1],_[R++]=E[2],(0,i.g)(S,S,r[e]),T[A++]=S[0],T[A++]=S[1],T[A++]=S[2],!n){let e=(o+1)%O;v.push(H+o),v.push(H+O+o),v.push(H+e),v.push(H+e),v.push(H+O+o),v.push(H+O+e);for(let e=0;e<6;e++){let t=v.length-6;g.push(v[t+e]-B)}}H+=O}let j=r[r.length-1];for(let e=0;e<n.length;e++)(0,i.h)(S,x,n[e][0]),(0,i.h)(P,b,n[e][1]),(0,i.g)(S,S,P),(0,i.g)(S,S,j),T[A++]=S[0],T[A++]=S[1],T[A++]=S[2];let D=R/3;_[R++]=M[0],_[R++]=M[1],_[R++]=M[2];let G=H-O;for(let e=0;e<l.length;e++)v.push(l[e][0]>=0?H+l[e][0]:-l[e][0]-1+G),v.push(l[e][2]>=0?H+l[e][2]:-l[e][2]-1+G),v.push(l[e][1]>=0?H+l[e][1]:-l[e][1]-1+G),g.push(D),g.push(D),g.push(D);let V=[[m.r.POSITION,new d.n(T,v,3,!0)],[m.r.NORMAL,new d.n(_,g,3,!0)]];return new p.V(e,V)}function ee(e,t,r,n){(0,O.vA)(t.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),(0,O.vA)(3===t[0].length,"createPolylineGeometry(): malformed vertex"),(0,O.vA)(null==r||r.length===t.length,"createPolylineGeometry: need same number of points and normals"),(0,O.vA)(null==r||3===r[0].length,"createPolylineGeometry(): malformed normal");let i=(0,l.jh)(3*t.length),o=Array(2*(t.length-1)),s=0,u=0;for(let e=0;e<t.length;e++){for(let r=0;r<3;r++)i[s++]=t[e][r];e>0&&(o[u++]=e-1,o[u++]=e)}let c=[[m.r.POSITION,new d.n(i,o,3,!0)]];if(r){let e=(0,a.oe)(3*r.length),n=0;for(let i=0;i<t.length;i++)for(let t=0;t<3;t++)e[n++]=r[i][t];c.push([m.r.NORMAL,new d.n(e,o,3,!0)])}return n&&c.push([m.r.COLOR,new d.n(n,(0,h.tM)(n.length/4),4)]),new p.V(e,c,null,f.X.Line)}function et(e,t,r,n,i,o=0){let s=Array(18),l=[[-r,o,i/2],[n,o,i/2],[0,t+o,i/2],[-r,o,-i/2],[n,o,-i/2],[0,t+o,-i/2]];for(let e=0;e<6;e++)s[3*e]=l[e][0],s[3*e+1]=l[e][1],s[3*e+2]=l[e][2];return new p.V(e,[[m.r.POSITION,new d.n(s,[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5],3,!0)]])}function er(e,t){let r=e.getMutableAttribute(m.r.POSITION).data;for(let e=0;e<r.length;e+=3){let n=r[e],o=r[e+1],s=r[e+2];(0,i.i)(el,n,o,s),(0,i.t)(el,el,t),r[e]=el[0],r[e+1]=el[1],r[e+2]=el[2]}}function en(e,t=e){let r=e.attributes,n=r.get(m.r.POSITION).data,i=r.get(m.r.NORMAL).data;if(i){let e=t.getMutableAttribute(m.r.NORMAL).data;for(let t=0;t<i.length;t+=3){let r=i[t+1];e[t+1]=-i[t+2],e[t+2]=r}}if(n){let e=t.getMutableAttribute(m.r.POSITION).data;for(let t=0;t<n.length;t+=3){let r=n[t+1];e[t+1]=-n[t+2],e[t+2]=r}}}function ei(e,t,r,n,o){return!(Math.abs((0,i.f)(t,e))>o)&&((0,i.e)(r,e,t),(0,i.n)(r,r),(0,i.e)(n,r,e),(0,i.n)(n,n),!0)}function eo(e,t,r,n,i,o,s){return ei(e,t,i,o,s)||ei(e,r,i,o,s)||ei(e,n,i,o,s)}let es=.99619469809,el=(0,s.vt)()}}]);