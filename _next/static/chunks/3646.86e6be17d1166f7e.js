"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3646],{2370:(e,t,r)=>{r.d(t,{E:()=>M,w:()=>a});var n=r(31461),s=r(28255);r(57845);var i=r(87196),o=r(70115);class a{constructor(e=9,t){this._compareMinX=c,this._compareMinY=f,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),x.prune(),I.prune(),w.prune(),b.prune()}all(e){l(this._data,e)}search(e,t){let r=this._data,n=this._toBBox;if(p(e,r))for(x.clear();r;){for(let s=0,i=r.children.length;s<i;s++){let i=r.children[s],o=r.leaf?n(i):i;p(e,o)&&(r.leaf?t(i):y(e,o)?l(i,t):x.push(i))}r=x.pop()}}collides(e){let t=this._data,r=this._toBBox;if(!p(e,t))return!1;for(x.clear();t;){for(let n=0,s=t.children.length;n<s;n++){let s=t.children[n],i=t.leaf?r(s):s;if(p(e,i)){if(t.leaf||y(e,i))return!0;x.push(s)}}t=x.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){let e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new F([]),this}remove(e){if(!e)return this;let t,r=this._data,i=null,o=0,a=!1,l=this._toBBox(e);for(w.clear(),b.clear();r||w.length>0;){if(r||(r=w.pop(),i=w.data[w.length-1],o=b.pop()??0,a=!0),r.leaf&&-1!==(t=(0,n.qh)(r.children,(0,s.zI)(e),r.children.length,r.indexHint)))return r.children.splice(t,1),w.push(r),this._condense(w),this;a||r.leaf||!y(r,l)?i?(o++,r=i.children[o],a=!1):r=null:(w.push(r),b.push(o),o=0,i=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,r,n){let s=r-t+1,i=this._maxEntries;if(s<=i){let n=new F(e.slice(t,r+1));return u(n,this._toBBox),n}n||(n=Math.ceil(Math.log(s)/Math.log(i)),i=Math.ceil(s/i**(n-1)));let o=new T([]);o.height=n;let a=Math.ceil(s/i),l=a*Math.ceil(Math.sqrt(i));_(e,t,r,l,this._compareMinX);for(let s=t;s<=r;s+=l){let t=Math.min(s+l-1,r);_(e,s,t,a,this._compareMinY);for(let r=s;r<=t;r+=a){let s=Math.min(r+a-1,t);o.children.push(this._build(e,r,s,n-1))}}return u(o,this._toBBox),o}_insert(e,t,r){let n=this._toBBox,s=r?e:n(e);w.clear();let i=function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){let r,n=1/0,o=1/0;for(let a=0,l=t.children.length;a<l;a++){var s,i;let l=t.children[a],u=m(l),h=(s=e,(Math.max((i=l).maxX,s.maxX)-Math.min(i.minX,s.minX))*(Math.max(i.maxY,s.maxY)-Math.min(i.minY,s.minY))-u);h<o?(o=h,n=u<n?u:n,r=l):h===o&&u<n&&(n=u,r=l)}t=r||t.children[0]}return t}(s,this._data,t,w);for(i.children.push(e),d(i,s);t>=0&&w.data[t].children.length>this._maxEntries;)this._split(w,t),t--;var o=s,a=w,l=t;for(let e=l;e>=0;e--)d(a.data[e],o)}_split(e,t){let r=e.data[t],n=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,n);let i=this._chooseSplitIndex(r,s,n);if(!i)return;let o=r.children.splice(i,r.children.length-i),a=r.leaf?new F(o):new T(o);a.height=r.height,u(r,this._toBBox),u(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,t){this._data=new T([e,t]),this._data.height=e.height+1,u(this._data,this._toBBox)}_chooseSplitIndex(e,t,r){let n,s,i;n=s=1/0;for(let o=t;o<=r-t;o++){let t=h(e,0,o,this._toBBox),a=h(e,o,r,this._toBBox),l=function(e,t){let r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-r)*Math.max(0,Math.min(e.maxY,t.maxY)-n)}(t,a),u=m(t)+m(a);l<n?(n=l,i=o,s=u<s?u:s):l===n&&u<s&&(s=u,i=o)}return i}_chooseSplitAxis(e,t,r){let n=e.leaf?this._compareMinX:c,s=e.leaf?this._compareMinY:f;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,s)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);let s=this._toBBox,i=h(e,0,t,s),o=h(e,r-t,r,s),a=g(i)+g(o);for(let n=t;n<r-t;n++){let t=e.children[n];d(i,e.leaf?s(t):t),a+=g(i)}for(let n=r-t-1;n>=t;n--){let t=e.children[n];d(o,e.leaf?s(t):t),a+=g(o)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){let r=e.data[t];if(0===r.children.length)if(t>0){let s=e.data[t-1],i=s.children;i.splice((0,n.qh)(i,r,i.length,s.indexHint),1)}else this.clear();else u(r,this._toBBox)}}_initFormat(e){let t=["return a"," - b",";"];this._compareMinX=Function("a","b",t.join(e[0])),this._compareMinY=Function("a","b",t.join(e[1])),this._toBBox=Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function l(e,t){let r=e;for(I.clear();r;){if(!0===r.leaf)for(let e of r.children)t((0,s.zI)(e));else I.pushArray(r.children);r=I.pop()??null}}function u(e,t){h(e,0,e.children.length,t,e)}function h(e,t,r,n,s){s||(s=new F([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let i,o=t;o<r;o++)i=e.children[o],d(s,e.leaf?n(i):i);return s}function d(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function c(e,t){return e.minX-t.minX}function f(e,t){return e.minY-t.minY}function m(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function g(e){return e.maxX-e.minX+(e.maxY-e.minY)}function y(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e,t,r,n,s){let i=[t,r];for(;i.length;){let t=i.pop(),r=i.pop();if(t-r<=n)continue;let a=r+Math.ceil((t-r)/n/2)*n;(0,o.q)(e,a,r,t,s),i.push(r,a,a,t)}}let x=new i.A,I=new i.A,w=new i.A,b=new i.A({deallocator:void 0});class M{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class B extends M{constructor(){super(...arguments),this.height=1,this.indexHint=new n.vW}}class F extends B{constructor(e){super(),this.children=e,this.leaf=!0}}class T extends B{constructor(e){super(),this.children=e,this.leaf=!1}}},5895:(e,t,r)=>{r.d(t,{T:()=>s});var n=r(82795);let s={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new n.Om(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>e.ensureCentroid(t)}},11064:(e,t,r)=>{r.d(t,{A:()=>m});var n=r(31461),s=r(32391),i=r(74652),o=r(61939),a=r(42845),l=r(84766),u=r(60729),h=r(29499),d=r(33332),c=r(5895);let f=(0,a.vt)();class m{constructor(e){this.geometryInfo=e,this._boundsStore=new h.F,this._featuresById=new Map,this._usedMemory=0,this.events=new i.A,this.featureAdapter=c.T}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach(t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;let[t,r,n,s]=this.fullBounds;return{xmin:t,ymin:r,xmax:n,ymax:s,spatialReference:(0,d.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(let t of e)this._add(t);this._emitChanged()}upsertMany(e){let t=e.map(e=>this._upsert(e));return this._emitChanged(),t.filter(n.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(e){let t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){for(let t of(this._boundsStore.invalidateIndex(),e)){let e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(let r of e){let e=this._boundsStore.get(r.objectId);e&&t((0,a.Jt)(f,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach(t=>e(t))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,e=>{t(this._featuresById.get(e))})}_emitChanged(){this.events.emit("changed",void 0)}_add(e){let t;if(!e)return;let r=e.objectId;if(null==r)return void o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.A("featurestore:invalid-feature","feature id is missing",{feature:e}));let n=this._featuresById.get(r);if(n?(e.displayId=n.displayId,t=this._boundsStore.get(r),this._boundsStore.delete(r),this._usedMemory-=this.estimateFeatureUsedMemory?.(n)??0):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(r,null),void this._featuresById.set(r,e);null!=(t=(0,u.jQ)(null!=t?t:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM))&&this._boundsStore.set(r,t),this._featuresById.set(r,e),this._usedMemory+=this.estimateFeatureUsedMemory?.(e)??0}_upsert(e){let t=e?.objectId;if(null==t)return o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;let r=this._featuresById.get(t);if(!r)return this._add(e),e;this._usedMemory-=this.estimateFeatureUsedMemory?.(r)??0;let{geometry:n,attributes:i}=e;for(let e in i)r.attributes[e]=i[e];return n&&(r.geometry=n,this._boundsStore.set(t,(0,u.jQ)((0,l.vt)(),n,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),this._usedMemory+=this.estimateFeatureUsedMemory?.(r)??0,r}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);let t=e.objectId;return this._boundsStore.delete(t),this._featuresById.delete(t),this._usedMemory-=this.estimateFeatureUsedMemory?.(e)??0,e}}},13646:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var n=r(83610),s=r(32391),i=r(61939),o=r(92753),a=r(58985),l=r(71760),u=r(60729),h=r(86925),d=r(11064),c=r(76461),f=r(41359),m=r(79836),g=r(43253),y=r(17719),p=r(47823),_=r(48271),x=r(93682);let I="esri.layers.WFSLayer";class w{constructor(){this._customParameters=null,this._queryEngine=null,this._supportsPagination=!0}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(e,t={}){let{getFeatureUrl:r,getFeatureOutputFormat:n,fields:i,geometryType:a,featureType:l,maxRecordCount:u,maxTotalRecordCount:h,maxPageCount:m,objectIdField:g,customParameters:_}=e,{spatialReference:I,getFeatureSpatialReference:w}=(0,y.UH)(r,l,e.spatialReference);try{await (0,c.Nk)(w,I)}catch{throw new s.A("unsupported-projection","Projection not supported",{inSpatialReference:w,outSpatialReference:I})}(0,o.Te)(t),this._customParameters=_,this._featureType=l,this._fieldsIndex=p.A.fromLayerJSON({fields:i,dateFieldsTimeReference:i.some(e=>"esriFieldTypeDate"===e.type)?{timeZoneIANA:x.n$}:null}),this._geometryType=a,this._getFeatureUrl=r,this._getFeatureOutputFormat=n,this._getFeatureSpatialReference=w,this._maxRecordCount=u,this._maxTotalRecordCount=h,this._maxPageCount=m,this._objectIdField=g,this._spatialReference=I;let b=await this._snapshotFeatures(t);if(b.errors.length>0&&(this._supportsPagination=!1,(b=await this._snapshotFeatures(t)).errors.length>0))throw b.errors[0];return this._queryEngine=new f.do({fieldsIndex:this._fieldsIndex,geometryType:a,hasM:!1,hasZ:!1,objectIdField:g,spatialReference:I,timeInfo:null,featureStore:new d.A({geometryType:a,hasM:!1,hasZ:!1})}),this._queryEngine.featureStore.addMany(b.features),{warnings:M(b),extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new s.A("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),(await this._queryEngine.executeQueryForIds(e,t.signal)).filter(_.Et)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),(0,h.J)(this._queryEngine,e,t.signal)}async queryAttributeBins(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeAttributeBinsQuery(e,t.signal)}async refresh(e){return this._customParameters=e.customParameters,this._maxRecordCount=e.maxRecordCount,this._maxTotalRecordCount=e.maxTotalRecordCount,this._maxPageCount=e.maxPageCount,this._snapshotTask?.abort(),this._snapshotTask=(0,n.UT)(e=>this._snapshotFeatures({signal:e})),this._snapshotTask.promise.then(e=>{for(let t of(this._queryEngine.featureStore.clear(),this._queryEngine.featureStore.addMany(e.features),M(e)))i.A.getLogger(I).warn(new a.A("wfs-layer:refresh-warning",t.message,t.details));e.errors?.length&&i.A.getLogger(I).warn(new a.A("wfs-layer:refresh-error","Refresh completed with errors",{errors:e.errors}))},()=>{this._queryEngine.featureStore.clear()}),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures(e){let t=e?.signal,r=this._maxTotalRecordCount,n=this._maxPageCount,s=this._supportsPagination?await (0,y.E)(this._getFeatureUrl,this._featureType.typeName,{customParameters:this._customParameters,signal:t}):void 0,i=[],a=[];if(null==s)try{i=await this._singleQuery(t)}catch(e){(0,o.zf)(e)||a.push(e)}else{let e=function*(e,t,r){for(let n=0;n<t;n++)yield e._pageQuery(n,r)}(this,Math.max(1,Math.min(Math.ceil(Math.min(s,r)/this._maxRecordCount),n)),t);await Promise.allSettled(Array.from({length:10}).map(()=>b(e,i,a)))}return(0,o.Te)(t),{features:i,totalRecordCount:s,maxTotalRecordCount:r,maxPageCount:n,errors:a}}async _singleQuery(e){let t=await (0,y.x$)(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,signal:e});return this._processGeoJSON(t,{signal:e})}async _pageQuery(e,t){let r=e*this._maxRecordCount,n=await (0,y.x$)(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,startIndex:r,count:this._maxRecordCount,signal:t});return this._processGeoJSON(n,{startIndex:r,signal:t})}_processGeoJSON(e,t){(0,m.sO)(e,this._getFeatureSpatialReference.wkid);let{startIndex:r,signal:n}=t;(0,o.Te)(n);let s=(0,m.bd)(e,{geometryType:this._geometryType,hasZ:!1,objectIdField:this._objectIdField});if(!(0,l.aI)(this._spatialReference,this._getFeatureSpatialReference))for(let e of s)null!=e.geometry&&(e.geometry=(0,u.Ux)((0,c.Cv)((0,u.zv)(e.geometry,this._geometryType,!1,!1),this._getFeatureSpatialReference,this._spatialReference)));let i=r??1;for(let e of s){let t={};(0,g.MB)(this._fieldsIndex,t,e.attributes,!0),e.attributes=t,null==t[this._objectIdField]&&(e.objectId=t[this._objectIdField]=i++)}return s}}async function b(e,t,r){let n=e.next();for(;!n.done;){try{let e=await n.value;t.push(...e)}catch(e){(0,o.zf)(e)||r.push(e)}n=e.next()}}function M(e){let t=[];return null!=e.totalRecordCount&&(e.features.length<e.totalRecordCount&&t.push({name:"wfs-layer:maxRecordCount-too-low",message:`Could only fetch ${e.features.length} of ${e.totalRecordCount} in ${e.maxPageCount} queries. Try increasing the value of WFSLayer.maxRecordCount.`,details:{recordCount:e.features.length,totalRecordCount:e.totalRecordCount}}),e.totalRecordCount>e.maxTotalRecordCount&&t.push({name:"wfs-layer:large-dataset",message:`The number of ${e.totalRecordCount} features exceeds the maximum allowed of ${e.maxTotalRecordCount}.`,details:{recordCount:e.features.length,totalRecordCount:e.totalRecordCount,maxTotalRecordCount:e.maxTotalRecordCount}})),t}},29499:(e,t,r)=>{r.d(t,{F:()=>a});var n=r(57845),s=r(2370),i=r(84766);let o={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s.w(9,(0,n.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){let e=Array(this._idByBounds.size),t=0;this._idByBounds.forEach((r,n)=>{e[t++]=n}),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(e=>this._idByBounds.has(e))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;let e=(0,i.Ie)();for(let t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){let t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){var r;this._loadIndex(),r=this._index,o.minX=e[0],o.minY=e[1],o.maxX=e[2],o.maxY=e[3],r.search(o,e=>t(this._idByBounds.get(e)))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){let t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},43253:(e,t,r)=>{let n;r.d(t,{$1:()=>y,CR:()=>m,MB:()=>f,PC:()=>p,Yx:()=>u,bP:()=>d});var s=r(67039),i=r(71760),o=r(39265);class a{constructor(){this.code=null,this.description=null}}class l{constructor(e){this.error=new a,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}function u(e){return new l(e)}class h{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function d(e){return new h(e)}let c=new Set;function f(e,t,r,n=!1){for(let i in c.clear(),r){let a=e.get(i);if(!a)continue;let l=function(e,t){let r=t;return(0,o.WA)(e)&&"string"==typeof t?r=parseFloat(t):(0,o.yM)(e)&&null!=t&&"string"!=typeof t?r=String(t):(0,o.vE)(e)&&"string"==typeof t&&(r=(0,s._U)(t)),(0,o.WX)(r)}(a,r[i]);if(c.add(a.name),a&&(n||a.editable)){let e=(0,o.CJ)(a,l);if(e)return u((0,o.uo)(e,a,l));t[a.name]=l}}for(let t of e.requiredFields??[])if(!c.has(t.name))return u(`missing required field "${t.name}"`);return null}function m(e,t){if(!e||!(0,i.fn)(t))return e;if("rings"in e||"paths"in e){if(null==n)throw TypeError("geometry engine not loaded");return n.simplify(t,e)}return e}async function g(){return null==n&&(n=await Promise.all([r.e(472),r.e(793)]).then(r.bind(r,29786))),n}async function y(e,t){(0,i.fn)(e)&&("esriGeometryPolygon"===t||"esriGeometryPolyline"===t)&&await g()}let p={supportsAutoIntervalBin:!0,supportsFixedIntervalBin:!0,supportsFixedBoundariesBin:!0,supportsDateBin:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsNormalization:!0,supportedStatisticTypes:["COUNT","SUM","AVG","VAR","STDDEV","MIN","MAX","PERCENTILE_CONT","PERCENTILE_DISC","CentroidAggregate","EnvelopeAggregate","ConvexHullAggregate"],supportedNormalizationTypes:["field","log","naturalLog","percentOfTotal","squareRoot"]}},54805:(e,t,r)=>{r.d(t,{A:()=>n});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){let e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},60729:(e,t,r)=>{r.d(t,{B2:()=>w,BW:()=>G,Ch:()=>es,DF:()=>F,Di:()=>Q,E2:()=>z,IE:()=>I,Nl:()=>et,Q4:()=>ei,Rk:()=>eo,Ux:()=>J,Ye:()=>Z,ZF:()=>V,eU:()=>L,eY:()=>K,hK:()=>ea,jH:()=>ee,jQ:()=>en,kz:()=>er,oN:()=>$,q3:()=>H,qK:()=>Y,qN:()=>q,z5:()=>k,zv:()=>D});var n=r(32391),s=r(61939),i=r(40941),o=r(42845),a=r(84766),l=r(31789),u=r(82795),h=r(54805),d=r(56599);function c(e,t){return e?t?4:3:t?3:2}let f=()=>s.A.getLogger("esri.layers.graphics.featureConversionUtils"),m={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},g=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i},y=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2]},p=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+3]},_=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2],e[r+3]=t[n+3]};function x(e,t,r,n){if(e){if(r)return t&&n?_:y;if(t&&n)return p}else if(t&&n)return y;return g}function I({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function w({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function b({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function M({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}function B({scale:e,translate:t},r,n){return r*e[n]+t[n]}function F(e,t,r){return e?t?r?A(e):C(e):r?S(e):T(e):null}function T(e){let t=e.coords;return{x:t[0],y:t[1]}}function R(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function C(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function v(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function S(e){let t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function E(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function A(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function N(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function P(e,t){return e&&t?N:e?v:t?E:R}function q(e,t,r=P(null!=t.z,null!=t.m)){return r(e,t)}function Y(e,t,r){if(null==e)return null;let n=c(t,r),s=[];for(let t=0;t<e.coords.length;t+=n){let r=[];for(let s=0;s<n;s++)r.push(e.coords[t+s]);s.push(r)}return t?r?{points:s,hasZ:t,hasM:r}:{points:s,hasZ:t}:r?{points:s,hasM:r}:{points:s}}function X(e,t,r=c(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;let n=e.coords,s=0;for(let e of t.points)for(let t=0;t<r;t++)n[s++]=e[t];return e}function G(e,t,r){if(!e)return null;let n=c(t,r),{coords:s,lengths:i}=e,o=[],a=0;for(let e of i){let t=[];for(let r=0;r<e;r++){let e=[];for(let t=0;t<n;t++)e.push(s[a++]);t.push(e)}o.push(t)}return t?r?{paths:o,hasZ:t,hasM:r}:{paths:o,hasZ:t}:r?{paths:o,hasM:r}:{paths:o}}function j(e,t,r=c(t.hasZ,t.hasM)){let{lengths:n,coords:s}=e,i=0;for(let e of t.paths){for(let t of e)for(let e=0;e<r;e++)s[i++]=t[e];n.push(e.length)}return e}function k(e,t,r){if(!e)return null;let n=c(t,r),{coords:s,lengths:i}=e,o=[],a=0;for(let e of i){let t=[];for(let r=0;r<e;r++){let e=[];for(let t=0;t<n;t++)e.push(s[a++]);t.push(e)}o.push(t)}return t?r?{rings:o,hasZ:t,hasM:r}:{rings:o,hasZ:t}:r?{rings:o,hasM:r}:{rings:o}}function Z(e,t,r=t.hasZ,n=t.hasM){return L(e,t.rings,r,n)}function L(e,t,r,n){let s=c(r,n),{lengths:i,coords:o}=e,a=0;for(let r of(el(e),t)){for(let e of r)for(let t=0;t<s;t++)o[a++]=e[t];i.push(r.length)}return e}let O=[],U=[];function z(e,t,r,n,s){O[0]=e;let[i]=Q(U,O,t,r,n,s);return eu(O),eu(U),i}function Q(e,t,r,s,i,o){if(eu(e),!r){for(let r of t){let t=o?r.attributes[o]:void 0;e.push(new u.Om(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":let a=P(s,i);for(let{geometry:r,attributes:n}of t){let t=null!=r?a(new d.A,r):null;e.push(new u.Om(t,n,null,o?n[o]:void 0))}break;case"esriGeometryMultipoint":let l=c(s,i);for(let{geometry:r,attributes:n}of t){let t=null!=r?X(new d.A,r,l):null;e.push(new u.Om(t,n,null,o?n[o]:void 0))}break;case"esriGeometryPolyline":let h=c(s,i);for(let{geometry:r,attributes:n,centroid:s}of t){let t=null!=r?j(new d.A,r,h):null,i=null!=s?q(new d.A,s):null;e.push(new u.Om(t,n,i,o?n[o]:void 0))}break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":for(let{geometry:r,centroid:n,attributes:a}of t){let t=null!=r?Z(new d.A,r,s,i):null,l=o?a[o]:void 0;null!=n?e.push(new u.Om(t,a,R(new d.A,n),l)):e.push(new u.Om(t,a,null,l))}break;default:f().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`)),eu(e)}return e}function $(e,t,r,n){U[0]=e,W(O,U,t,r,n);let s=O[0];return eu(O),eu(U),s}function J(e,t,r){if(null==e)return null;let s=new d.A;return("hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),(0,l.fT)(e))?P(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(s,e):(0,l.Bi)(e)?Z(s,e,t,r):(0,l.Rg)(e)?j(s,e,c(t,r)):(0,l.U9)(e)?X(s,e,c(t,r)):void f().error("convertFromGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${e}'`))}function D(e,t,r,s){let i=e&&("coords"in e?e:e.geometry);if(null==i)return null;switch(t){case"esriGeometryPoint":{let e=T;return r&&s?e=A:r?e=C:s&&(e=S),e(i)}case"esriGeometryMultipoint":return Y(i,r,s);case"esriGeometryPolyline":return G(i,r,s);case"esriGeometryPolygon":return k(i,r,s);default:return f().error("convertToGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${t}'`)),null}}function W(e,t,r,s,i){if(eu(e),null==r){for(let r of t)e.push({attributes:r.attributes});return e}switch(r){case"esriGeometryPoint":let o=T;for(let r of(s&&i?o=A:s?o=C:i&&(o=S),t)){let{geometry:t,attributes:n}=r,s=null!=t?o(t):null;e.push({attributes:n,geometry:s})}break;case"esriGeometryMultipoint":for(let{geometry:r,attributes:n}of t)e.push({attributes:n,geometry:null!=r?Y(r,s,i):null});break;case"esriGeometryPolyline":for(let{geometry:r,attributes:n}of t)e.push({attributes:n,geometry:null!=r?G(r,s,i):null});break;case"esriGeometryPolygon":for(let{geometry:r,attributes:n,centroid:o}of t){let t=null!=r?k(r,s,i):null;if(null!=o){let r=T(o);e.push({attributes:n,centroid:r,geometry:t})}else e.push({attributes:n,geometry:t})}break;default:f().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`))}return e}function V(e){let{objectIdFieldName:t,spatialReference:r,transform:n,fields:s,hasM:i,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:h,queryGeometry:d,queryGeometryType:c}=e,f={features:W([],a,l,o,i),fields:s,geometryType:l,objectIdFieldName:t,spatialReference:r,uniqueIdField:h,queryGeometry:D(d,c,!1,!1)};return n&&(f.transform=n),u&&(f.exceededTransferLimit=u),i&&(f.hasM=i),o&&(f.hasZ=o),f}function H(e,t){let r=new h.A,{hasM:s,hasZ:i,features:o,objectIdFieldName:a,spatialReference:l,geometryType:u,exceededTransferLimit:d,transform:c,fields:m}=e;return m&&(r.fields=m),r.geometryType=u??null,r.objectIdFieldName=a??t??null,r.spatialReference=l??null,r.objectIdFieldName?(o&&Q(r.features,o,u,i,s,r.objectIdFieldName),d&&(r.exceededTransferLimit=d),s&&(r.hasM=s),i&&(r.hasZ=i),c&&(r.transform=c)):f().error(new n.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r}function K(e){let{transform:t,features:r,hasM:n,hasZ:s}=e;if(!t)return e;for(let e of r)null!=e.geometry&&es(e.geometry,e.geometry,n,s,t),null!=e.centroid&&es(e.centroid,e.centroid,n,s,t);return e.transform=null,e}function ee(e,t){let{geometryType:r,features:n,hasM:s,hasZ:i}=t;if(!e)return t;for(let t=0;t<n.length;t++){let o=n[t],a=o.weakClone();a.geometry=new d.A,et(a.geometry,o.geometry,s,i,r,e),o.centroid&&(a.centroid=new d.A,et(a.centroid,o.centroid,s,i,"esriGeometryPoint",e)),n[t]=a}return t.transform=e,t}function et(e,t,r,n,s,i,o=r,a=n){if(el(e),!t?.coords.length)return null;let l=m[s],{coords:u,lengths:h}=t,d=c(r,n),f=c(r&&o,n&&a),g=x(r,n,o,a);if(!h.length)return g(e.coords,u,0,0,I(i,u[0]),w(i,u[1])),el(e,d,0),e;let y,p,_,b,M=0,B=0,F=0;for(let t of h){if(t<l)continue;let r=0;B=F,_=y=I(i,u[M]),b=p=w(i,u[M+1]),g(e.coords,u,B,M,_,b),r++,M+=d,B+=f;for(let n=1;n<t;n++,M+=d)_=I(i,u[M]),b=w(i,u[M+1]),_===y&&b===p||(g(e.coords,u,B,M,_-y,b-p),B+=f,r++,y=_,p=b);r>=l&&(e.lengths.push(r),F=B)}return eu(e.coords,F),e.coords.length?e:null}function er(e,t,r,n,s,i,o=r,a=n){if(el(e),!t?.coords.length)return null;let l=m[s],{coords:u,lengths:h}=t,d=c(r,n),f=c(r&&o,n&&a),g=x(r,n,o,a);if(!h.length)return g(e.coords,u,0,0,u[0],u[1]),el(e,d,0),e;let y=0,p=i*i;for(let t of h){if(t<l){y+=t*d;continue}let r=e.coords.length/f,n=y,s=y+(t-1)*d;g(e.coords,u,e.coords.length,n,u[n],u[n+1]),function e(t,r,n,s,i,o,a){let l,u=s,h=0;for(let e=o+n;e<a;e+=n)(l=function(e,t,r,n){let s=e[t],i=e[t+1],o=e[r],a=e[r+1],l=e[n],u=e[n+1],h=o,d=a,c=l-h,f=u-d;if(0!==c||0!==f){let e=((s-h)*c+(i-d)*f)/(c*c+f*f);e>1?(h=l,d=u):e>0&&(h+=c*e,d+=f*e)}return(c=s-h)*c+(f=i-d)*f}(r,e,o,a))>u&&(h=e,u=l);u>s&&(h-o>n&&e(t,r,n,s,i,o,h),i(t,r,t.length,h,r[h],r[h+1]),a-h>n&&e(t,r,n,s,i,h,a))}(e.coords,u,d,p,g,n,s),g(e.coords,u,e.coords.length,s,u[s],u[s+1]);let i=e.coords.length/f-r;i>=l?e.lengths.push(i):eu(e.coords,r*f),y+=t*d}return e.coords.length?e:null}function en(e,t,r,n){if(!t?.coords?.length)return null;let s=c(r,n),i=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;if(t&&t.coords){let e=t.coords;for(let t=0;t<e.length;t+=s){let r=e[t],n=e[t+1];i=Math.min(i,r),u=Math.max(u,r),l=Math.min(l,n),h=Math.max(h,n)}}return(0,o.is)(e)?(0,o.BI)(e,i,l,u,h):(0,a.fA)(i,l,u,h,e),e}function es(e,t,r,n,s){let{coords:o,lengths:a}=t,l=c(r,n);if(!o.length)return e!==t&&el(e),e;(0,i.Lw)(s);let{originPosition:u,scale:h,translate:d}=s;eh.originPosition=u;let f=eh.scale;f[0]=h[0]??1,f[1]=-(h[1]??1),f[2]=h[2]??1,f[3]=h[3]??1;let m=eh.translate;if(m[0]=d[0]??0,m[1]=d[1]??0,m[2]=d[2]??0,m[3]=d[3]??0,!a.length){for(let t=0;t<l;++t)e.coords[t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(eh,o[t],t);return e!==t&&el(e,l,0),e}let g=0;for(let t=0;t<a.length;t++){let r=a[t];e.lengths[t]=r;for(let t=0;t<l;++t)e.coords[g+t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(eh,o[g+t],t);let n=e.coords[g],s=e.coords[g+1];g+=l;for(let t=1;t<r;t++,g+=l){n+=o[g]*f[0],s+=o[g+1]*f[1],e.coords[g]=n,e.coords[g+1]=s;for(let t=2;t<l;++t)e.coords[g+t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(eh,o[g+t],t)}}return e!==t&&el(e,o.length,a.length),e}function ei(e,t,r,n,s,i){if(el(e),e.lengths.push(...t.lengths),r===s&&n===i)for(let r=0;r<t.coords.length;r++)e.coords.push(t.coords[r]);else{let o=c(r,n),a=x(r,n,s,i),l=t.coords;for(let t=0;t<l.length;t+=o)a(e.coords,l,e.coords.length,t,l[t],l[t+1])}return e}function eo(e,t){let{coords:r,lengths:n}=e,s=0,i=0;for(let e=0;e<n.length;e++){let o=n[e];i+=function(e,t,r,n){let s=0,i=e[n*t],o=e[n*(t+1)];for(let a=1;a<r;a++){let r=i+e[n*(t+a)],l=o+e[n*(t+a)+1],u=(r-i)*(l+o);i=r,o=l,s+=u}return .5*s}(r,s,o,t),s+=o}return Math.abs(i)}function ea(e,t,r,n,s){let i=c(n,s);if(!e.lengths.length){if(e.coords.length<2)return null;let[r,n]=e.coords,s=b(t,r),i=M(t,n);return new d.A([],[s,i])}let o=new d.A([],[0,0]),a=m[r],l="esriGeometryPolygon"===r||"esriGeometryPolyline"===r,u=0,h=0;for(let r=0;r<e.lengths.length;r++){let n=e.lengths[r],s=h,d=b(t,e.coords[i*u]),c=M(t,e.coords[i*u+1]);o.coords[h++]=d,o.coords[h++]=c;let m=0,y=0,p=1;for(let r=1;r<n;r++){let n=b(t,e.coords[i*(r+u)]),s=M(t,e.coords[i*(r+u)+1]);if(n!==d||s!==c){var f,g;let e=n-d,t=s-c;l&&0==(f=m)*t-e*(g=y)&&f*e+g*t>0?(o.coords[h-2]+=e,o.coords[h-1]+=t,d+=e,c+=t):(o.coords[h++]=n,o.coords[h++]=s,d=n,c=s,m=e,y=t,p+=1)}}p<a?h=s:o.lengths.push(p),u+=n}return 0===o.lengths.length?null:o}function el(e,t=0,r=0){eu(e.lengths,r),eu(e.coords,t)}function eu(e,t=0){e.length!==t&&(e.length=t)}let eh={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},86925:(e,t,r)=>{r.d(t,{J:()=>m});var n=r(33715),s=r(92753),i=r(31789),o=r(25606),a=r(71760),l=r(76461),u=r(41359),h=r(90804),d=r(91738),c=r(6515),f=r(40513);async function m(e,t,r){let f=(0,s.Mq)(r),{point:m,distance:y,returnEdge:p,vertexMode:_}=t;if(!p&&"none"===_)return{candidates:[]};let x=(0,n.o8)(t.query);x=await e.schedule(()=>(0,d.T2)(x,e.definitionExpression,e.spatialReference),f),x=await e.reschedule(()=>(0,c.B4)(x,{availableFields:e.availableFields,fieldsIndex:e.fieldsIndex,geometryType:e.geometryType,spatialReference:e.spatialReference}),f);let I=!(0,a.aI)(m.spatialReference,e.spatialReference);I&&await (0,l.Nk)(m.spatialReference,e.spatialReference);let w="number"==typeof y?y:y.x,b="number"==typeof y?y:y.y,M={xmin:m.x-w,xmax:m.x+w,ymin:m.y-b,ymax:m.y+b,spatialReference:m.spatialReference},B=I?(0,l.Cv)(M,e.spatialReference):M;if(!B)return{candidates:[]};let F=(await (0,o.el)((0,i.rS)(m),null,{signal:f}))[0],T=(await (0,o.el)((0,i.rS)(B),null,{signal:f}))[0];if(null==F||null==T)return{candidates:[]};let R=new h.G(await e.reschedule(()=>e.searchFeatures((0,u.ux)(T.toJSON())),f),x,e);await e.reschedule(()=>e.executeObjectIdsQuery(R),f),await e.reschedule(()=>e.executeTimeQuery(R),f),await e.reschedule(()=>e.executeAttributesQuery(R),f),await e.reschedule(()=>g(e,R,f),f);let C=F.toJSON(),v=I?(0,l.Cv)(C,e.spatialReference):C,S=I?Math.max(B.xmax-B.xmin,B.ymax-B.ymin)/2:y;return R.createSnappingResponse({...t,point:v,distance:S},m.spatialReference)}async function g(e,t,r){let{query:n}=t,{spatialRel:s}=n;if(!t?.items?.length||!n.geometry||!s)return;let i=await (0,f.xt)(s,n.geometry,e.geometryType,e.hasZ,e.hasM),o=await e.runSpatialFilter(t.items,e=>i(e.geometry),r);t.items=o}}}]);