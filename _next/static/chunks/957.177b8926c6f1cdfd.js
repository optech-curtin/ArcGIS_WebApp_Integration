"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{10431:(e,t,i)=>{i.d(t,{By:()=>f,Jb:()=>u,My:()=>l,i8:()=>x,mR:()=>c,qE:()=>d,ue:()=>p,xo:()=>h});var r=i(70152),s=i(32391),n=i(61939),a=i(46499);let o=()=>n.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils");function l(e,t){return[!!e?.minScale&&t.scaleToZoom(e.minScale)||0,!!e?.maxScale&&t.scaleToZoom(e.maxScale)||100]}function c(e){return 1<<e}function h(e){let t=0;for(let[i,r]of e)r&&(t|=1<<i);return t}function u(e){let t;if(!e)return[0,0,0,0];if("string"==typeof e){let i=r.A.fromString(e);if(!i)return o().errorOnce(new s.A("mapview:mesh-processing","Unable to parse string into color",{color:e})),[0,0,0,0];t=i.toArray()}else t=e;let[i,n,a,l]=t;return[l/255*i,l/255*n,l/255*a,l]}function p(e){switch(e){case"butt":case a.uT.Butt:return a.xR.BUTT;case"round":case a.uT.Round:return a.xR.ROUND;case"square":case a.uT.Square:return a.xR.SQUARE}}function d(e){switch(e){case"bevel":case a.wd.Bevel:return a.JO.BEVEL;case"miter":case a.wd.Miter:return a.JO.MITER;case"round":case a.wd.Round:return a.JO.ROUND}}function x(e,t){return Math.round(Math.min(Math.sqrt(e*t),255))}function f(e,t){return Math.round(e*t)/t}},13453:(e,t,i)=>{i.d(t,{Bw:()=>f,Eq:()=>d});var r=i(55048),s=i(70412),n=i(94360),a=i(25408),o=i(38038),l=i(10431),c=i(54598),h=i(21722),u=i(93446);class p{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0,this.pathLength=0}}let d={createComputedParams:e=>e,optionalAttributes:{zoomRange:{type:u.pe.SHORT,count:2,packPrecisionFactor:n.fq,pack:({scaleInfo:e},{tileInfo:t})=>(0,l.My)(e,t)}},attributes:{id:{type:u.pe.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:u.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:u.pe.UNSIGNED_BYTE,count:1},color:{type:u.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>(0,l.Jb)(e)},offset:{type:u.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({extrusionOffsetX:e,extrusionOffsetY:t})=>[(0,l.By)(e,16),(0,l.By)(t,16)]},normal:{type:u.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({normalX:e,normalY:t})=>[(0,l.By)(e,16),(0,l.By)(t,16)]},halfWidth:{type:u.pe.HALF_FLOAT,count:1,pack:({width:e})=>(0,r.Lz)(.5*e)},referenceHalfWidth:{type:u.pe.HALF_FLOAT,count:1,pack:({referenceWidth:e})=>(0,r.Lz)(.5*e)}}};class x{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0,this.pathLength=0}}class f extends c.r{constructor(e,t,i,r){super(e,t,i,r),this.vertexSpec=d,this._currentWrite=new x,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new p,this._initializeTessellator()}writeLineVertices(e,t,i){let r=this._getLines(t);null!=r&&this._writeVertices(e,i,r)}_initializeTessellator(){this._lineTessellator=new a.i(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(e,t,i){let r=i??s.z.fromFeatureSetReaderCIM(t);r&&this._writeGeometry(e,t,r)}_writeGeometry(e,t,i,r){e.recordStart(this.instanceId,this.attributeLayout,r),this.writeLineVertices(e,i,t),e.recordEnd()}_getLines(e){return(0,o.uS)(e,(0,h.Z0)(this.evaluatedMeshParams))}_writeVertices(e,t,i){let{_currentWrite:s,_tessellationOptions:a,evaluatedMeshParams:o}=this,{width:c,capType:h,joinType:u,miterLimit:p,hasSizeVV:d}=o,x=(0,r.Lz)(.5*c);a.halfWidth=x,a.capType=(0,l.ue)(h),a.joinType=(0,l.qE)(u),a.miterLimit=p;let f=!d;for(let{line:r,start:o,pathLength:l}of(s.out=e,s.id=t.getDisplayId(),s.vertexCount=0,s.indexCount=0,s.vertexFrom=e.vertexCount(),s.vertexBounds=f&&x<n.Gh?0:1,i))a.initialDistance=o%65535,s.pathLength=l,this._lineTessellator.tessellate(r,a,f)}_writeTesselatedVertex(e,t,i,r,s,n,a,o,l,c,h){let{out:u,id:p,vertexBounds:d,pathLength:x}=this._currentWrite;return this.hasEffects&&u.recordBounds(e,t,d,d),this._tessParams.extrusionOffsetX=a,this._tessParams.extrusionOffsetY=o,this._tessParams.normalX=l,this._tessParams.normalY=c,this._tessParams.directionX=s,this._tessParams.directionY=n,this._tessParams.distance=h,this._tessParams.pathLength=x,this._writeVertex(u,p,e,t,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(e,t,i){let{out:r}=this._currentWrite;r.indexEnsureSize(3),r.indexWrite(e),r.indexWrite(t),r.indexWrite(i),this._currentWrite.indexCount+=3}}},21163:(e,t,i)=>{i.d(t,{k:()=>a});var r=i(34292),s=i(93446);let n={createComputedParams:e=>e,optionalAttributes:{},attributes:{id:{type:s.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.pe.UNSIGNED_BYTE,count:1},pos:{type:s.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:s.pe.FLOAT,count:1,packTessellation:({inverseArea:e})=>e}}};class a extends r.N{constructor(){super(...arguments),this.vertexSpec=n}createTesselationParams(e){return{inverseArea:1/e.readGeometryArea()}}}},21490:(e,t,i)=>{i.d(t,{R:()=>n,z:()=>s});let r=null;function s(){return r}async function n(){r=await Promise.all([i.e(472),i.e(3174)]).then(i.bind(i,29786))}},21689:(e,t,i)=>{i.d(t,{H:()=>S});var r=i(55048),s=i(44460),n=i(47389),a=i(54036),o=i(70412),l=i(77700),c=i(46499),h=i(32464),u=i(94360),p=i(10431),d=i(95832);class x{static from(e){return"width"in e?this.fromSimpleMeshParams(e):this.fromComplexMeshParams(e)}static fromSimpleMeshParams(e){let t=new x(e.sprite,e.color,e.outlineColor,e.minPixelBuffer,e.placement,e.scaleInfo,e.effects),{type:i,width:s,height:n,angle:a,alignment:o,outlineSize:l,referenceSize:c,sprite:h,overrideOutlineColor:u}=e;return t.rawWidth=(0,r.Lz)(s),t.rawHeight=(0,r.Lz)(n),t.angle=a,t.alignment=o,t.outlineSize=(0,r.Lz)(l),t.referenceSize=(0,r.Lz)(c),t.overrideOutlineColor=u,t.offsetX=(0,r.Lz)(e.offsetX),t.offsetY=(0,r.Lz)(e.offsetY),"simple"!==i||h.sdf||(t.rawWidth=h.width,t.rawHeight=h.height),t._computeSize(e,!1),t}static fromComplexMeshParams(e){let t=new x(e.sprite,e.color,e.outlineColor,e.minPixelBuffer,e.placement,e.scaleInfo,e.effects),{alignment:i,transforms:s,size:n,scaleX:a,anchorX:o,anchorY:l,angle:c,colorLocked:h,frameHeight:u,widthRatio:p,offsetX:f,offsetY:y,outlineSize:_,referenceSize:m,scaleFactor:g,sizeRatio:v,isAbsoluteAnchorPoint:w,rotateClockwise:k,scaleSymbolsProportionally:b,sprite:S}=e;if(s&&s.infos.length>0){let e=(0,d.zb)(n,c,k,f,y,s);n=e.size,c=e.rotation,f=e.offsetX,y=e.offsetY,k=!1}g&&(n*=g,f*=g,y*=g);let T=a*(S.width/S.height);t.alignment=i,t.rawHeight=(0,r.Lz)(n),t.rawWidth=t.rawHeight*T,t.referenceSize=(0,r.Lz)(m),t.sizeRatio=v,t.sdfDecodeCoeff=(S.sdfDecodeCoeff??1)*v,t.angle=c,t.rotateClockwise=k,t.anchorX=o,t.anchorY=l,t.offsetX=(0,r.Lz)(f),t.offsetY=(0,r.Lz)(y),w&&n&&(S.sdf?t.anchorX=o/(n*p):t.anchorX=o/(n*T),t.anchorY=l/n);let M=b&&u?n/u:1;return t.outlineSize=0===_||isNaN(_)?0:(0,r.Lz)(_)*M,t.scaleSymbolsProportionally=b,t.colorLocked=h,t._computeSize(e,!0),t}constructor(e,t,i,r,s,n,a){this.sprite=e,this.color=t,this.outlineColor=i,this.minPixelBuffer=r,this.placement=s,this.scaleInfo=n,this.effects=a,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.sdfDecodeCoeff=1,this.alignment=c.C1.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(e,t){let{sprite:i,hasSizeVV:r}=e,s=!!i.sdf,n=i.sdfPaddingRatio??.5,{rawWidth:a,rawHeight:o,sizeRatio:l,outlineSize:c}=this,h=i.rect,p=a*l,d=o*l,x=0,_=0;if(s){let e=1/(1-n);if(p*=e,d*=e,r)this.computedWidth=p,this.computedHeight=d;else{let e=t&&a>o?p:a,r=c+2;this.computedWidth=Math.min(e+r,p),this.computedHeight=Math.min(o+r,d);let s=Math.max(i.width,i.height)/Math.max(p,d);x=(this.computedWidth-p)*s,_=(this.computedHeight-d)*s}}else this.computedWidth=p*(h.width/i.width),this.computedHeight=d*(h.height/i.height),x=2*u.hM,_=2*u.hM;let m=h.x+u.hM-x/2,g=h.y+u.hM-_/2,v=m+i.width+x,w=g+i.height+_;this.texXmin=f(m),this.texYmin=f(g),this.texXmax=y(v),this.texYmax=y(w),this.computedWidth*=(this.texXmax-this.texXmin)/(v-m),this.computedHeight*=(this.texYmax-this.texYmin)/(w-g),this.anchorX*=p/this.computedWidth,this.anchorY*=d/this.computedHeight}}function f(e,t=1e-7){let i=Math.ceil(e);return i-e<t?i:Math.floor(e)}function y(e,t=1e-7){let i=Math.floor(e);return e-i<t?i:Math.ceil(e)}var _=i(35161),m=i(21490),g=i(54598),v=i(93446);let w=3.14159265359/180,k=128/Math.PI,b={createComputedParams:e=>x.from(e),optionalAttributes:{zoomRange:{type:v.pe.SHORT,count:2,packPrecisionFactor:u.fq,pack:({scaleInfo:e},{tileInfo:t})=>(0,p.My)(e,t)}},attributes:{pos:{type:v.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:v.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:v.pe.UNSIGNED_BYTE,count:1,pack:({sprite:e,alignment:t,scaleSymbolsProportionally:i,overrideOutlineColor:r,colorLocked:s})=>{let n=0;return e.sdf&&(n|=(0,p.mR)(_.c.bitset.isSDF)),t===c.C1.MAP&&(n|=(0,p.mR)(_.c.bitset.isMapAligned)),i&&(n|=(0,p.mR)(_.c.bitset.scaleSymbolsProportionally)),r&&(n|=(0,p.mR)(_.c.bitset.overrideOutlineColor)),s&&(n|=(0,p.mR)(_.c.bitset.colorLocked)),n}},offset:{type:v.pe.HALF_FLOAT,count:2,packAlternating:{count:4,pack:({angle:e,computedWidth:t,computedHeight:i,anchorX:r,anchorY:o,offsetX:l,offsetY:c,rotateClockwise:h})=>{let u=function(e,t,i,r,a=!1){let o=(0,n.vt)();return(0,s.D_)(o),(t||i)&&(0,s.Tl)(o,o,[t,-i]),r&&(0,s.e$)(o,o,-((a?1:-1)*w*r)),o}(0,l,c,-e,h),p=-(.5+r)*t,d=-(.5-o)*i,x=[p,d],f=[p+t,d],y=[p,d+i],_=[p+t,d+i];return(0,a.l0)(x,x,u),(0,a.l0)(f,f,u),(0,a.l0)(y,y,u),(0,a.l0)(_,_,u),[x,f,y,_]}}},textureUV:{type:v.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({texXmax:e,texXmin:t,texYmax:i,texYmin:r})=>[[t,r],[e,r],[t,i],[e,i]]}},color:{type:v.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>(0,p.Jb)(e)},outlineColor:{type:v.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:e})=>(0,p.Jb)(e)},sizing:{type:v.pe.UNSIGNED_BYTE,count:4,pack:({rawWidth:e,rawHeight:t,outlineSize:i,referenceSize:r})=>{let s=Math.max(e,t);return[(0,p.i8)(s,128),(0,p.i8)(i,128),(0,p.i8)(r,128),0]}},placementAngle:{type:v.pe.UNSIGNED_BYTE,count:1,packTessellation:({placementAngle:e})=>(function(e){var t;return Math.abs((t=e*k%256)>=0?t:t+256)})(e)},sdfDecodeCoeff:{type:v.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:({sdfDecodeCoeff:e})=>e}}};class S extends g.r{constructor(){super(...arguments),this.vertexSpec=b}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(e,t,i){let r=this.evaluatedMeshParams.sprite?.textureBinding,s=t.getDisplayId();e.recordStart(this.instanceId,this.attributeLayout,r);let n=this.evaluatedMeshParams.minPixelBuffer,a=Math.max(this.evaluatedMeshParams.computedWidth,n),o=Math.max(this.evaluatedMeshParams.computedHeight,n),c=-this.evaluatedMeshParams.anchorX*this.evaluatedMeshParams.computedWidth,h=this.evaluatedMeshParams.anchorY*this.evaluatedMeshParams.computedHeight,u=this.evaluatedMeshParams.offsetX+c,p=-this.evaluatedMeshParams.offsetY+h;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(e,t,i,a,o);else if(i?.nextPath()){i.nextPoint();let t=i.x,r=i.y;e.recordBounds(t+u,r+p,a,o),this._writeQuad(e,s,t,r)}else if("esriGeometryPolygon"===t.geometryType){let i=t.readCentroidForDisplay();if(!i)return;let[r,n]=i.coords;e.recordBounds(r+u,n+p,a,o),this._writeQuad(e,s,r,n)}else if("esriGeometryPoint"===t.geometryType){let i=t.readXForDisplay(),r=t.readYForDisplay();e.recordBounds(i+u,r+p,a,o),this._writeQuad(e,s,i,r)}else{let i=t.readGeometryForDisplay();i?.forEachVertex((t,i)=>{e.recordBounds(t+u,i+p,a,o),Math.abs(t)>l.$u||Math.abs(i)>l.$u||this._writeQuad(e,s,t,i)})}e.recordEnd()}_writePlacedMarkers(e,t,i,s,n){let a=i??o.z.fromFeatureSetReaderCIM(t)?.clone();if(!a)return;let c=h.l.getPlacement(a,-1,this.evaluatedMeshParams.placement,(0,r.Lz)(1),e.id,(0,m.z)());if(!c)return;let u=t.getDisplayId(),p=c.next(),d=this.evaluatedMeshParams.offsetX,x=-this.evaluatedMeshParams.offsetY;for(;null!=p;){let t=p.tx,i=-p.ty;if(Math.abs(t)>l.$u||Math.abs(i)>l.$u){p=c.next();continue}let r=-p.getAngle();e.recordBounds(t+d,i+x,s,n),this._writeQuad(e,u,t,i,r),p=c.next()}}_writeQuad(e,t,i,r,s){let n=e.vertexCount();this._writeVertex(e,t,i,r,null==s?null:{placementAngle:s}),e.indexWrite(n+0),e.indexWrite(n+1),e.indexWrite(n+2),e.indexWrite(n+1),e.indexWrite(n+3),e.indexWrite(n+2)}}},21722:(e,t,i)=>{i.d(t,{Ph:()=>function e(t,i,r,s,n,a,o){if(t.primitiveName===i){let e=s?.readWithDefault(n,a,t[r]&&o);return"text"===t.type&&(e=e.toString()),void(t[r]=e)}if("type"in t&&null!=t.type){if(t.effects)for(let l of t.effects)e(l,i,r,s,n,a,o);switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.symbolLayers)for(let l of t.symbolLayers)e(l,i,r,s,n,a,o);break;case"CIMTextSymbol":t.symbol&&e(t.symbol,i,r,s,n,a,o);break;case"CIMHatchFill":t.lineSymbol&&e(t.lineSymbol,i,r,s,n,a,o);break;case"CIMPictureMarker":case"CIMCharacterMarker":case"CIMVectorMarker":if(t.markerPlacement&&e(t.markerPlacement,i,r,s,n,a,o),"CIMVectorMarker"===t.type&&t.markerGraphics)for(let l of t.markerGraphics)e(l,i,r,s,n,a,o),e(l.symbol,i,r,s,n,a,o)}}},Z0:()=>n,hU:()=>s});var r=i(45714);function s(e){let t=e.map(({name:e,count:t,type:i})=>`${e}.${t}.${i}`).join(",");return(0,r.Wm)(t)}function n(e){let t=e.width;return null!=e.effects?400:Math.max(1.25*t,8)}},25408:(e,t,i)=>{i.d(t,{i:()=>d});var r=i(46499),s=i(94360);function n(e,t){return e.x===t.x&&e.y===t.y}function a(e,t){return e.x=t.y,e.y=-t.x,e}function o(e,t){return e.x=-t.y,e.y=t.x,e}function l(e,t){return e.x=t.x,e.y=t.y,e}function c(e,t){return e.x=-t.x,e.y=-t.y,e}function h(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function u(e,t){return e.x*t.x+e.y*t.y}function p(e,t,i,r){return e.x=t.x*i+t.y*r,e.y=t.x*r-t.y*i,e}class d{constructor(e,t,i){this._writeVertex=e,this._writeTriangle=t,this._canUseThinTessellation=i,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(e,t,i=this._canUseThinTessellation){(function(e){if(!e)return;let t=e.length;if(t<=1)return;let i=0;for(let r=1;r<t;r++)n(e[r],e[i])||++i===r||(e[i]=e[r]);e.length=i+1})(e),i&&t.halfWidth<s.Gh&&!t.offset?this._tessellateThin(e,t):this._tessellate(e,t)}_tessellateThin(e,t){if(e.length<2)return;let i=t.wrapDistance||65535,r=t.initialDistance||0,s=!1,n=e[0].x,a=e[0].y,o=e.length;for(let t=1;t<o;++t){s&&(s=!1,r=0);let o=e[t].x,l=e[t].y,c=o-n,h=l-a,u=Math.sqrt(c*c+h*h);if(c/=u,h/=u,r+u>i){s=!0;let e=(i-r)/u;u=i-r,o=(1-e)*n+e*o,l=(1-e)*a+e*l,--t}let p=this._writeVertex(n,a,0,0,c,h,h,-c,0,-1,r),d=this._writeVertex(n,a,0,0,c,h,-h,c,0,1,r);r+=u;let x=this._writeVertex(o,l,0,0,c,h,h,-c,0,-1,r),f=this._writeVertex(o,l,0,0,c,h,-h,c,0,1,r);this._writeTriangle(p,d,x),this._writeTriangle(d,x,f),n=o,a=l}}_tessellate(e,t){let i,s,d=e[0],x=e[e.length-1],f=n(d,x);if(e.length<(f?3:2))return;let y=t.pixelCoordRatio,_=null!=t.capType?t.capType:r.xR.BUTT,m=null!=t.joinType?t.joinType:r.JO.MITER,g=null!=t.miterLimit?Math.min(t.miterLimit,4):2,v=null!=t.roundLimit?Math.min(t.roundLimit,1.05):1.05,w=null!=t.halfWidth?t.halfWidth:2,k=!!t.textured,b,S,T,M=null,P=this._prevNormal,z=this._nextNormal,E=-1,L=-1,I=this._joinNormal,A=this._textureNormalLeft,N=this._textureNormalRight,R=this._textureNormal,B=-1,D=-1,F=t.wrapDistance||65535,C=t.initialDistance||0,O=this._writeVertex,Y=this._writeTriangle,G=(e,t,r,n,a,o)=>{let l=O(S,T,i,s,r,n,e,t,a,o,C);return B>=0&&D>=0&&l>=0&&Y(B,D,l),B=D,D=l,l};f&&(b=e[e.length-2],z.x=x.x-b.x,z.y=x.y-b.y,L=h(z),z.x/=L,z.y/=L);let U=!1;for(let t=0;t<e.length;++t){if(U&&(U=!1,C=0),b&&(P.x=-z.x,P.y=-z.y,C+(E=L)>F&&(U=!0)),U){let i=(F-C)/E;E=F-C,b={x:(1-i)*b.x+i*e[t].x,y:(1-i)*b.y+i*e[t].y},--t}else b=e[t];S=b.x,T=b.y;let n=t<=0&&!U,d=t===e.length-1;if(n||(C+=E),(M=d?f?e[1]:null:e[t+1])?(z.x=M.x-S,z.y=M.y-T,L=h(z),z.x/=L,z.y/=L):(z.x=void 0,z.y=void 0),!f){if(n){o(I,z),i=I.x,s=I.y,_===r.xR.SQUARE&&(G(-z.y-z.x,z.x-z.y,z.x,z.y,0,-1),G(z.y-z.x,-z.x-z.y,z.x,z.y,0,1)),_===r.xR.ROUND&&(G(-z.y-z.x,z.x-z.y,z.x,z.y,-1,-1),G(z.y-z.x,-z.x-z.y,z.x,z.y,-1,1)),_!==r.xR.ROUND&&_!==r.xR.BUTT||(G(-z.y,z.x,z.x,z.y,0,-1),G(z.y,-z.x,z.x,z.y,0,1));continue}if(d){a(I,P),i=I.x,s=I.y,_!==r.xR.ROUND&&_!==r.xR.BUTT||(G(P.y,-P.x,-P.x,-P.y,0,-1),G(-P.y,P.x,-P.x,-P.y,0,1)),_===r.xR.SQUARE&&(G(P.y-P.x,-P.x-P.y,-P.x,-P.y,0,-1),G(-P.y-P.x,P.x-P.y,-P.x,-P.y,0,1)),_===r.xR.ROUND&&(G(P.y-P.x,-P.x-P.y,-P.x,-P.y,1,-1),G(-P.y-P.x,P.x-P.y,-P.x,-P.y,1,1));continue}}let x,O,Y=-(P.x*z.y-P.y*z.x);if(.01>Math.abs(Y))u(P,z)>0?(I.x=P.x,I.y=P.y,Y=1,x=Number.MAX_VALUE,O=!0):(o(I,z),Y=1,x=1,O=!1);else{I.x=(P.x+z.x)/Y,I.y=(P.y+z.y)/Y;let e=((x=h(I))-1)*w*y;O=x>4||e>E&&e>L}i=I.x,s=I.y;let V=m;switch(m){case r.JO.BEVEL:x<1.05&&(V=r.JO.MITER);break;case r.JO.ROUND:x<v&&(V=r.JO.MITER);break;case r.JO.MITER:x>g&&(V=r.JO.BEVEL)}switch(V){case r.JO.MITER:if(G(I.x,I.y,-P.x,-P.y,0,-1),G(-I.x,-I.y,-P.x,-P.y,0,1),d)break;if(k){let e=U?0:C;B=this._writeVertex(S,T,i,s,z.x,z.y,I.x,I.y,0,-1,e),D=this._writeVertex(S,T,i,s,z.x,z.y,-I.x,-I.y,0,1,e)}break;case r.JO.BEVEL:{let e,t,r,n,h=Y<0;if(h){let i=B;B=D,D=i,e=A,t=N}else e=N,t=A;if(O)r=h?o(this._innerPrev,P):a(this._innerPrev,P),n=h?a(this._innerNext,z):o(this._innerNext,z);else{let e=h?c(this._inner,I):l(this._inner,I);r=e,n=e}let u=h?a(this._bevelStart,P):o(this._bevelStart,P);G(r.x,r.y,-P.x,-P.y,e.x,e.y);let x=G(u.x,u.y,-P.x,-P.y,t.x,t.y);if(d)break;let f=h?o(this._bevelEnd,z):a(this._bevelEnd,z);if(O){let r=this._writeVertex(S,T,i,s,-P.x,-P.y,0,0,0,0,C);B=this._writeVertex(S,T,i,s,z.x,z.y,n.x,n.y,e.x,e.y,C),D=this._writeVertex(S,T,i,s,z.x,z.y,f.x,f.y,t.x,t.y,C),this._writeTriangle(x,r,D)}else{if(k){let t=this._bevelMiddle;t.x=(u.x+f.x)/2,t.y=(u.y+f.y)/2,p(R,t,-P.x,-P.y),G(t.x,t.y,-P.x,-P.y,R.x,R.y),p(R,t,z.x,z.y),B=this._writeVertex(S,T,i,s,z.x,z.y,t.x,t.y,R.x,R.y,C),D=this._writeVertex(S,T,i,s,z.x,z.y,n.x,n.y,e.x,e.y,C)}else{let e=B;B=D,D=e}G(f.x,f.y,z.x,z.y,t.x,t.y)}if(h){let e=B;B=D,D=e}break}case r.JO.ROUND:{let e,t,r,n,h,f,y=Y<0;if(y){let i=B;B=D,D=i,e=A,t=N}else e=N,t=A;let _=y?c(this._inner,I):l(this._inner,I);O?(r=y?o(this._innerPrev,P):a(this._innerPrev,P),n=y?a(this._innerNext,z):o(this._innerNext,z)):(r=_,n=_);let m=y?a(this._roundStart,P):o(this._roundStart,P),g=y?o(this._roundEnd,z):a(this._roundEnd,z),v=G(r.x,r.y,-P.x,-P.y,e.x,e.y),w=G(m.x,m.y,-P.x,-P.y,t.x,t.y);if(d)break;let b=this._writeVertex(S,T,i,s,-P.x,-P.y,0,0,0,0,C);O||this._writeTriangle(B,D,b);let M=c(this._outer,_),E=this._writeVertex(S,T,i,s,z.x,z.y,g.x,g.y,t.x,t.y,C),L=x>2;if(L){let e;x!==Number.MAX_VALUE?(M.x/=x,M.y/=x,e=(x*((e=u(P,M))*e-1)+1)/e):e=-1,h=y?a(this._startBreak,P):o(this._startBreak,P),h.x+=P.x*e,h.y+=P.y*e,f=y?o(this._endBreak,z):a(this._endBreak,z),f.x+=z.x*e,f.y+=z.y*e}p(R,M,-P.x,-P.y);let F=this._writeVertex(S,T,i,s,-P.x,-P.y,M.x,M.y,R.x,R.y,C);p(R,M,z.x,z.y);let U=k?this._writeVertex(S,T,i,s,z.x,z.y,M.x,M.y,R.x,R.y,C):F,V=k?this._writeVertex(S,T,i,s,z.x,z.y,0,0,0,0,C):b,W=-1,H=-1;if(L&&(p(R,h,-P.x,-P.y),W=this._writeVertex(S,T,i,s,-P.x,-P.y,h.x,h.y,R.x,R.y,C),p(R,f,z.x,z.y),H=this._writeVertex(S,T,i,s,z.x,z.y,f.x,f.y,R.x,R.y,C)),k?L?(this._writeTriangle(b,w,W),this._writeTriangle(b,W,F),this._writeTriangle(V,U,H),this._writeTriangle(V,H,E)):(this._writeTriangle(b,w,F),this._writeTriangle(V,U,E)):L?(this._writeTriangle(b,w,W),this._writeTriangle(b,W,H),this._writeTriangle(b,H,E)):(this._writeTriangle(b,w,F),this._writeTriangle(b,U,E)),O?B=this._writeVertex(S,T,i,s,z.x,z.y,n.x,n.y,e.x,e.y,C):(B=k?this._writeVertex(S,T,i,s,z.x,z.y,n.x,n.y,e.x,e.y,C):v,this._writeTriangle(B,V,E)),D=E,y){let e=B;B=D,D=e}}}}}}},32464:(e,t,i)=>{i.d(t,{l:()=>s});var r=i(29319);class s{static getPlacement(e,t,i,s,n,a){let o=(0,r.c)(i);return o?(-1===t&&e.invertY(),o.execute(e,i,s,n,a)):null}}},32932:(e,t,i)=>{i.d(t,{F:()=>o,l:()=>c});var r=i(81048),s=i(57845);let n=null,a=null;async function o(){return n||(n=l()),n}async function l(){let e=(0,s.A)("esri-csp-restrictions")?await Promise.all([i.e(5687),i.e(5183)]).then(i.bind(i,68068)).then(e=>e.l):await i.e(3974).then(i.bind(i,3974)).then(e=>e.l);a=await e.default({locateFile:e=>(0,r.s)(`esri/core/libs/libtess/${e}`)})}function c(e,t){let i=Math.max(e.length,128e3);return a.triangulate(e,t,i)}},33291:(e,t,i)=>{i.d(t,{h:()=>a});var r=i(54598),s=i(93446);let n={createComputedParams:e=>e,optionalAttributes:{},attributes:{pos:{type:s.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:s.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.pe.UNSIGNED_BYTE,count:1},offset:{type:s.pe.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};class a extends r.r{constructor(){super(...arguments),this.vertexSpec=n}_write(e,t){e.recordStart(this.instanceId,this.attributeLayout);let i=t.getDisplayId();if("esriGeometryPoint"===t.geometryType){let r=t.readXForDisplay(),s=t.readYForDisplay();this._writeQuad(e,i,r,s)}else if("esriGeometryMultipoint"===t.geometryType){let r=t.readGeometryForDisplay();r?.forEachVertex((t,r)=>{t>=0&&t<=512&&r>=0&&r<=512&&this._writeQuad(e,i,t,r)})}e.recordEnd()}_writeQuad(e,t,i,r){let s=e.vertexCount();this._writeVertex(e,t,i,r),e.indexWrite(s+0),e.indexWrite(s+1),e.indexWrite(s+2),e.indexWrite(s+1),e.indexWrite(s+3),e.indexWrite(s+2)}}},34281:(e,t,i)=>{i.d(t,{l:()=>a,m:()=>o});var r=i(94360),s=i(65659),n=i(93446);let a={createComputedParams:e=>e,optionalAttributes:s.v.optionalAttributes,attributes:{...s.v.attributes,tlbr:{count:4,type:n.pe.UNSIGNED_SHORT,pack:({sprite:e})=>{let{rect:t,width:i,height:s}=e,n=t.x+r.hM,a=t.y+r.hM;return[n,a,n+i,a+s]}},inverseRasterizationScale:{count:1,type:n.pe.BYTE,packPrecisionFactor:16,pack:({sprite:e})=>1/e.rasterizationScale}}};class o extends s.Y{constructor(){super(...arguments),this.vertexSpec=a}_write(e,t,i){let r=i?.asOptimized()??t.readGeometryForDisplay(),s=this._clip(r);if(!s)return;let n=this.evaluatedMeshParams.sprite?.textureBinding;e.recordStart(this.instanceId,this.attributeLayout,n),this._writeGeometry(e,t,s),e.recordEnd()}}},34292:(e,t,i)=>{i.d(t,{N:()=>l});var r=i(57845),s=i(32932),n=i(38038),a=i(54598);let o=(0,r.A)("featurelayer-fast-triangulation-enabled");class l extends a.r{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,s.F)()])}_write(e,t,i){let r=i?.asOptimized()??t.readGeometryForDisplay(),s=this._clip(r);s&&(e.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(e,t,s),e.recordEnd())}_clip(e){if(!e)return null;let t=this.hasEffects;return(0,n.FE)(e,t?256:8)}_writeGeometry(e,t,i){let r=i.maxLength>100,s=[],a=this.createTesselationParams(t);if(!r&&o&&(0,n.lO)(s,i))return void(s.length&&this._writeVertices(e,t,i.coords,a,s));let l=(0,n.XZ)(i);this._writeVertices(e,t,l,a)}_writeVertices(e,t,i,r,s){let n=t.getDisplayId(),a=e.vertexCount(),o=this.hasEffects,l=0;if(s)for(let t of s){let s=i[2*t],a=i[2*t+1];o&&e.recordBounds(s,a,0,0),this._writeVertex(e,n,s,a,r),l++}else for(let t=0;t<i.length;t+=2){let s=Math.round(i[t]),a=Math.round(i[t+1]);o&&e.recordBounds(s,a,0,0),this._writeVertex(e,n,s,a,r),l++}e.indexEnsureSize(l);for(let t=0;t<l;t++)e.indexWrite(t+a)}}},36365:(e,t,i)=>{i.d(t,{A:()=>c});var r,s=i(57845),n=i(94264),a=i(98570);!function(e){e[e.varint=0]="varint",e[e.fixed64=1]="fixed64",e[e.delimited=2]="delimited",e[e.fixed32=5]="fixed32",e[e.unknown=99]="unknown"}(r||(r={}));let o=new TextDecoder("utf-8"),l=(0,s.A)("safari")||(0,s.A)("ios")?6:(0,s.A)("ff")?12:32;class c{constructor(e,t,i=0,s=e?e.byteLength:0){this._tag=0,this._dataType=r.unknown,this._init(e,t,i,s)}_init(e,t,i,r){this._data=e,this._dataView=t,this._pos=i,this._end=r}get usedMemory(){return 64+(0,n.Qf)(this._data)}asUnsafe(){return this}clone(){return new c(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;let t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;let e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=0xffffffff;if(e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128||(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128)||(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128)||(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128)||(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128))return e;throw Error("Varint overflow")}getUInt64(){return this._decodeVarint()}getSInt32(){let e=this.getUInt32();return e>>>1^-(1&e)}getSInt64(){return this._decodeSVarint()}getBool(){let e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){let e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+0x100000000*e.getUint32(t+4,!0);return this._skip(8),i}getSFixed64(){let e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+0x100000000*e.getInt32(t+4,!0);return this._skip(8),i}getDouble(){let e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){let e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){let e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){let e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){let e=this._getLength(),t=this._pos,i=this._toString(this._data,t,t+e);return this._skip(e),i}getBytes(){let e=this._getLength(),t=this._pos,i=this._toBytes(this._data,t,t+e);return this._skip(e),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,i,r){let s=this.getMessage(),n=e(s,t,i,r);return s.release(),n}processMessage(e){let t=this.getMessage(),i=e(t);return t.release(),i}getMessage(){let e=this._getLength(),t=c.pool.acquire();return t._init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){c.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case r.varint:this._decodeVarint();break;case r.fixed64:this._skip(8);break;case r.delimited:this._skip(this._getLength());break;case r.fixed32:this._skip(4);break;default:throw Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){let e=this._data,t=this._pos,i=0,r=0;if(this._end-t>=10)do{if(i|=127&(r=e[t++]),!(128&r)||(i|=(127&(r=e[t++]))<<7,!(128&r))||(i|=(127&(r=e[t++]))<<14,!(128&r))||(i|=(127&(r=e[t++]))<<21,!(128&r))||(i+=0x10000000*(127&(r=e[t++])),!(128&r))||(i+=0x800000000*(127&(r=e[t++])),!(128&r))||(i+=0x40000000000*(127&(r=e[t++])),!(128&r))||(i+=0x2000000000000*(127&(r=e[t++])),!(128&r))||(i+=0x100000000000000*(127&(r=e[t++])),!(128&r))||(i+=0x8000000000000000*(127&(r=e[t++])),!(128&r)))break;throw Error("Varint too long!")}while(0);else{let s=1;for(;t!==this._end&&128&(r=e[t]);)++t,i+=(127&r)*s,s*=128;if(t===this._end)throw Error("Varint overrun!");++t,i+=r*s}return this._pos=t,i}_decodeSVarint(){let e=this._data,t,i=0,r=0,s=1&e[this._pos];if(i|=127&(r=e[this._pos++]),!(128&r)||(i|=(127&(r=e[this._pos++]))<<7,!(128&r))||(i|=(127&(r=e[this._pos++]))<<14,!(128&r))||(i|=(127&(r=e[this._pos++]))<<21,!(128&r))||(i+=0x10000000*(127&(r=e[this._pos++])),!(128&r))||(i+=0x800000000*(127&(r=e[this._pos++])),!(128&r))||(i+=0x40000000000*(127&(r=e[this._pos++])),!(128&r)))return s?-(i+1)/2:i/2;if(t=BigInt(i)+562949953421312n*BigInt(127&(r=e[this._pos++])),!(128&r)||(t+=0x100000000000000n*BigInt(127&(r=e[this._pos++])),!(128&r))||(t+=0x8000000000000000n*BigInt(127&(r=e[this._pos++])),!(128&r)))return Number(s?-(t+1n)/2n:t/2n);throw Error("Varint too long!")}_getLength(){if(this._dataType!==r.delimited)throw Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,i){if((i=Math.min(this._end,i))-t>l){let r=e.subarray(t,i);return o.decode(r)}let r="",s="";for(let n=t;n<i;++n){let t=e[n];128&t?s+="%"+t.toString(16):(r+=decodeURIComponent(s)+String.fromCharCode(t),s="")}return s.length&&(r+=decodeURIComponent(s)),r}_toBytes(e,t,i){return i=Math.min(this._end,i),new Uint8Array(e.buffer,t,i-t)}}c.pool=new a.A(c,void 0,e=>{e._data=null,e._dataView=null})},37787:(e,t,i)=>{i.d(t,{KE:()=>p,KI:()=>h,lB:()=>u,oI:()=>c});var r=i(55048),s=i(61070),n=i(10431),a=i(34281),o=i(37390),l=i(93446);function c(e){let{sprite:t,aspectRatio:i,scaleProportionally:s}=e,n=(0,r.Lz)(e.height),a=n>0?n:t.height,o=n*i;return o<=0?o=t.width:s&&(o*=t.width/t.height),{width:o,height:a}}function h(e){let{applyRandomOffset:t,sampleAlphaOnly:i}=e;return(0,n.xo)([[o.Fz,t],[o.cn,i]])}let u={createComputedParams:e=>e,optionalAttributes:a.l.optionalAttributes,attributes:{...a.l.attributes,bitset:{count:1,type:l.pe.UNSIGNED_BYTE,pack:h},width:{count:1,type:l.pe.HALF_FLOAT,pack:e=>c(e).width},height:{count:1,type:l.pe.HALF_FLOAT,pack:e=>c(e).height},offset:{count:2,type:l.pe.HALF_FLOAT,pack:({offsetX:e,offsetY:t})=>[(0,r.Lz)(e),-(0,r.Lz)(t)]},scale:{count:2,type:l.pe.UNSIGNED_BYTE,packPrecisionFactor:16,pack:({scaleX:e,scaleY:t})=>[e,t]},angle:{count:1,type:l.pe.UNSIGNED_BYTE,pack:({angle:e})=>(0,s.wV)(e)}}};class p extends a.m{constructor(){super(...arguments),this.vertexSpec=u}}},38038:(e,t,i)=>{i.d(t,{uS:()=>z,FE:()=>P,lO:()=>T,XZ:()=>M}),i(23352);var r=i(32932),s=i(82459),n=i(56599),a=i(94360);function o(e,t,i,r,s,n,a){let o;if(a===function(e,t,i,r,s,n){let a=0;for(let i=r,o=s-n;i<s;i+=n)a+=(e[o+t*n]-e[i+t*n])*(e[i+1+t*n]+e[o+1+t*n]),o=i;return a}(e,t,0,r,s,n)>0)for(let i=r;i<s;i+=n)o=c(i+t*n,e[i+t*n],e[i+1+t*n],o);else for(let i=s-n;i>=r;i-=n)o=c(i+t*n,e[i+t*n],e[i+1+t*n],o);return o&&y(o,o.next)&&(h(o),o=o.next),o}function l(e,t=e){if(!e)return e;let i,r=e;do if(i=!1,r.steiner||!y(r,r.next)&&0!==u(r.prev,r,r.next))r=r.next;else{if(h(r),(r=t=r.prev)===r.next)break;i=!0}while(i||r!==t);return t}i(57845);function c(e,t,i,r){let s=g.create(e,t,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function h(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function u(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function p(e,t,i,r){return!!(y(e,t)&&y(i,r)||y(e,r)&&y(i,t))||u(e,t,i)>0!=u(e,t,r)>0&&u(i,r,e)>0!=u(i,r,t)>0}function d(e,t,i,r,s,n,a,o){return(s-a)*(t-o)-(e-a)*(n-o)>=0&&(e-a)*(r-o)-(i-a)*(t-o)>=0&&(i-a)*(n-o)-(s-a)*(r-o)>=0}function x(e,t){return 0>u(e.prev,e,e.next)?u(e,t,e.next)>=0&&u(e,e.prev,t)>=0:0>u(e,t,e.prev)||0>u(e,e.next,t)}function f(e,t,i,r,s){return(e=0x55555555&((e=0x33333333&((e=0xf0f0f0f&((e=0xff00ff&((e=32767*(e-i)*s)|e<<8))|e<<4))|e<<2))|e<<1))|(t=0x55555555&((t=0x33333333&((t=0xf0f0f0f&((t=0xff00ff&((t=32767*(t-r)*s)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function y(e,t){return e.x===t.x&&e.y===t.y}function _(e,t){return e.x-t.x}function m(e,t){let i=g.create(e.index,e.x,e.y),r=g.create(t.index,t.x,t.y),s=e.next,n=t.prev;return e.next=t,t.prev=e,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}class g{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(e,t,i){let r=w<v.length?v[w++]:new g;return r.index=e,r.x=t,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}let v=[],w=0;for(let e=0;e<8096;e++)v.push(new g);let k=new s.O3(0,0,0,1,0),b=new s.O3(0,0,0,1,0);function S(e,t,i){let r=0;for(let s=1;s<i;s++){let i=e[2*(t+s-1)],n=e[2*(t+s-1)+1];r+=(e[2*(t+s)]-i)*(e[2*(t+s)+1]+n)}return r}function T(e,t){let{coords:i,lengths:r}=t,s=0;for(let t=0;t<r.length;){let n=t,a=r[t],c=S(i,s,a),g=[];for(;++n<r.length;){let e=r[n],t=S(i,s+a,e);if(!(t>0))break;c+=t,g.push(s+a),a+=e}let v=e.length;!function(e,t,i,r,s,n,a){w=0;let c=(r-i)*2,g=s&&s.length,v=g?(s[0]-i)*2:c,k,b,S,T,M,P=o(t,i,r,0,v,n,!0);if(P&&P.next!==P.prev){if(g&&(P=function(e,t,i,r,s,n){let a=[];for(let s=0,l=r.length;s<l;s++){let c=o(e,t,i,r[s]*n,s<l-1?r[s+1]*n:i*n,n,!1);c===c.next&&(c.steiner=!0),a.push(function(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}(c))}for(let e of(a.sort(_),a))s=function(e,t){let i=function(e,t){let i=t,r=e.x,s=e.y,n,a=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){let e=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=r&&e>a){if(a=e,e===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===a)return n.prev;let o=n,l=n.x,c=n.y,h,u=1/0;for(i=n.next;i!==o;)r>=i.x&&i.x>=l&&r!==i.x&&d(s<c?r:a,s,l,c,s<c?a:r,s,i.x,i.y)&&((h=Math.abs(s-i.y)/(r-i.x))<u||h===u&&i.x>n.x)&&x(i,e)&&(n=i,u=h),i=i.next;return n}(e,t);if(!i)return t;let r=m(i,e);return l(r,r.next),l(i,i.next)}(e,s);return s}(t,i,r,s,P,n)),c>80*n){k=S=t[0+i*n],b=T=t[1+i*n];for(let e=n;e<v;e+=n){let r=t[e+i*n],s=t[e+1+i*n];k=Math.min(k,r),b=Math.min(b,s),S=Math.max(S,r),T=Math.max(T,s)}M=0!==(M=Math.max(S-k,T-b))?1/M:0}!function e(t,i,r,s,n,a,o,c){if(!t)return;!c&&a&&(t=function e(t,i,r,s){let n;for(;n!==t;n=n.next){if(null===(n=n||t).z&&(n.z=f(n.x,n.y,i,r,s)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,e(t,i,r,s);n.prevZ=n.prev,n.nextZ=n.next}return t.prevZ.nextZ=null,t.prevZ=null,function(e){let t,i=1;for(;;){let r,s=e;e=null,t=null;let n=0;for(;s;){n++,r=s;let a=0;for(;a<i&&r;a++)r=r.nextZ;let o=i;for(;a>0||o>0&&r;){let i;0===a?(i=r,r=r.nextZ,o--):0!==o&&r?s.z<=r.z?(i=s,s=s.nextZ,a--):(i=r,r=r.nextZ,o--):(i=s,s=s.nextZ,a--),t?t.nextZ=i:e=i,i.prevZ=t,t=i}s=r}if(t.nextZ=null,i*=2,n<2)return e}}(t)}(t,s,n,a));let _=t;for(;t.prev!==t.next;){let g=t.prev,v=t.next;if(a?function(e,t,i,r){let s=e.prev,n=e.next;if(u(s,e,n)>=0)return!1;let a=s.x<e.x?s.x<n.x?s.x:n.x:e.x<n.x?e.x:n.x,o=s.y<e.y?s.y<n.y?s.y:n.y:e.y<n.y?e.y:n.y,l=s.x>e.x?s.x>n.x?s.x:n.x:e.x>n.x?e.x:n.x,c=s.y>e.y?s.y>n.y?s.y:n.y:e.y>n.y?e.y:n.y,h=f(a,o,t,i,r),p=f(l,c,t,i,r),x=e.prevZ,y=e.nextZ;for(;x&&x.z>=h&&y&&y.z<=p;){if(x!==e.prev&&x!==e.next&&d(s.x,s.y,e.x,e.y,n.x,n.y,x.x,x.y)&&u(x.prev,x,x.next)>=0||(x=x.prevZ,y!==e.prev&&y!==e.next&&d(s.x,s.y,e.x,e.y,n.x,n.y,y.x,y.y)&&u(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;x&&x.z>=h;){if(x!==e.prev&&x!==e.next&&d(s.x,s.y,e.x,e.y,n.x,n.y,x.x,x.y)&&u(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;y&&y.z<=p;){if(y!==e.prev&&y!==e.next&&d(s.x,s.y,e.x,e.y,n.x,n.y,y.x,y.y)&&u(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}(t,s,n,a):function(e){let t=e.prev,i=e.next;if(u(t,e,i)>=0)return!1;let r=e.next.next,s=r,n=0;for(;r!==e.prev&&(0===n||r!==s);){if(n++,d(t.x,t.y,e.x,e.y,i.x,i.y,r.x,r.y)&&u(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}(t))i.push(g.index/r+o),i.push(t.index/r+o),i.push(v.index/r+o),h(t),t=v.next,_=v.next;else if((t=v)===_){c?1===c?e(t=function(e,t,i,r){let s=e;do{let n=s.prev,a=s.next.next;!y(n,a)&&p(n,s,s.next,a)&&x(n,a)&&x(a,n)&&(t.push(n.index/i+r),t.push(s.index/i+r),t.push(a.index/i+r),h(s),h(s.next),s=e=a),s=s.next}while(s!==e);return s}(t,i,r,o),i,r,s,n,a,o,2):2===c&&function(t,i,r,s,n,a,o){let c=t;do{let t=c.next.next;for(;t!==c.prev;){var h,u;if(c.index!==t.index&&(h=c,u=t,h.next.index!==u.index&&h.prev.index!==u.index&&!function(e,t){let i=e;do{if(i.index!==e.index&&i.next.index!==e.index&&i.index!==t.index&&i.next.index!==t.index&&p(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(h,u)&&x(h,u)&&x(u,h)&&function(e,t){let i=e,r=!1,s=(e.x+t.x)/2,n=(e.y+t.y)/2;do i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}(h,u))){let h=m(c,t);return c=l(c,c.next),h=l(h,h.next),e(c,i,r,s,n,a,o,0),void e(h,i,r,s,n,a,o,0)}t=t.next}c=c.next}while(c!==t)}(t,i,r,s,n,a,o):e(l(t),i,r,s,n,a,o,1);break}}}(P,e,n,k,b,M,0,0)}}(e,i,s,s+a,g,2,0);let k=function(e,t,i,r,s){let n=0;for(let a=i;a<r;a+=3){let i=(e[a]-0)*2,r=(e[a+1]-0)*2,o=(e[a+2]-s)*2;n+=Math.abs((t[i]-t[o])*(t[r+1]-t[i+1])-(t[i]-t[r])*(t[o+1]-t[i+1]))}return n}(e,i,v,e.length,0),b=Math.abs(c);if(Math.abs((k-b)/Math.max(1e-7,b))>1e-5)return e.length=0,!1;t=n,s+=a}return!0}function M(e){let{coords:t,lengths:i}=e,{buffer:s}=(0,r.l)(t,i);return s}function P(e,t){if(null==e)return null;if(!function(e,t,i){let r=0;for(let t=0;t<e.lengths.length;t++){let s=e.lengths[t];for(let t=0;t<s;t++){let s=e.coords[2*(t+r)],n=e.coords[2*(t+r)+1];if(s<-128||s>i||n<-128||n>i)return!0}r+=s}return!1}(e,-128,a.CQ+128))return e;k.setPixelMargin(t),k.reset(s.dC.Polygon);let i=0;for(let t=0;t<e.lengths.length;t++){let r=e.lengths[t],s=e.coords[2*(0+i)],n=e.coords[2*(0+i)+1];k.moveTo(s,n);for(let t=1;t<r;t++)s=e.coords[2*(t+i)],n=e.coords[2*(t+i)+1],k.lineTo(s,n);k.close(),i+=r}let r=k.result(!1);if(!r)return null;let o=[],l=[];for(let e of r){let t=0;for(let i of e)l.push(i.x),l.push(i.y),t++;o.push(t)}return new n.A(o,l)}function z(e,t){b.setPixelMargin(t);let i=-t,r=a.CQ+t,n=[],o=!1;if(!e.nextPath())return null;let l=e.pathLength(),c=!0;for(;c;){e.seekPathStart();let t=[];if(!e.pathSize)return null;b.reset(s.dC.LineString),e.nextPoint();let a=e.x,h=e.y;if(o)b.moveTo(a,h);else{if(a<i||a>r||h<i||h>r){o=!0;continue}t.push({x:a,y:h})}let u=!1;for(;e.nextPoint();)if(a=e.x,h=e.y,o)b.lineTo(a,h);else{if(a<i||a>r||h<i||h>r){u=!0;break}t.push({x:a,y:h})}if(u)o=!0;else{if(o){let e=b.resultWithStarts();if(e)for(let t of e)n.push({...t,pathLength:l})}else n.push({line:t,start:0,pathLength:l});l=(c=e.nextPath())?e.pathLength():0,o=!1}}return 0===(n=n.filter(e=>e.line.length>1)).length?null:n}k.setExtent(a.CQ),b.setExtent(a.CQ)},38756:(e,t,i)=>{i.d(t,{K:()=>p});var r=i(55048),s=i(70412),n=i(46499),a=i(94360),o=i(10431),l=i(13453),c=i(37390),h=i(93446);let u={createComputedParams:e=>e,optionalAttributes:l.Eq.optionalAttributes,attributes:{...l.Eq.attributes,bitset:{type:h.pe.UNSIGNED_BYTE,count:1,pack:({shouldSampleAlphaOnly:e,shouldScaleDash:t,isSDF:i})=>(0,o.xo)([[c.cn,e],[c.kx,t],[c.b5,i]])},tlbr:{type:h.pe.UNSIGNED_SHORT,count:4,pack:({sprite:e})=>{let{rect:t,width:i,height:r}=e,s=t.x+a.hM,n=t.y+a.hM;return[s,n,s+i,n+r]}},accumulatedDistance:{type:h.pe.UNSIGNED_SHORT,count:1,packTessellation:({distance:e})=>e},segmentDirection:{type:h.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:e,directionY:t})=>[e,t]},offsetAlongLine:{type:h.pe.HALF_FLOAT,count:1,pack:({offsetAlongLine:e})=>(0,r.Lz)(e)},capType:{type:h.pe.UNSIGNED_BYTE,count:1,pack:({capType:e})=>{switch(e){case n.uT.Butt:case"butt":return 0;case n.uT.Square:case"square":return 1;case n.uT.Round:case"round":return 2;default:return 0}}}}};class p extends l.Bw{constructor(e,t,i,r){super(e,t,i,r),this.vertexSpec=u,this._tessellationOptions.textured=!0}_write(e,t,i){let r=i??s.z.fromFeatureSetReaderCIM(t);if(!r)return;let{sprite:n}=this.evaluatedMeshParams;this._writeGeometry(e,t,r,n?.textureBinding)}}},54598:(e,t,i)=>{i.d(t,{r:()=>d});var r=i(70412),s=i(95330),n=i(21490),a=i(5651);i(57845);var o=i(21722),l=i(93446);function c(e){switch(e){case l.pe.BYTE:case l.pe.UNSIGNED_BYTE:return 1;case l.pe.SHORT:case l.pe.UNSIGNED_SHORT:case l.pe.HALF_FLOAT:return 2;case l.pe.FLOAT:case l.pe.INT:case l.pe.UNSIGNED_INT:return 4}}class h{static fromVertexSpec(e,t){let i,r,s,{attributes:n,optionalAttributes:a}=e,o=[];for(let e in n){let t=n[e];"position"===t.pack?i={...t,name:e,offset:0}:"id"===t.pack?r={...t,name:e,offset:4}:"bitset"===e?s={...t,name:e,offset:7}:o.push({...t,name:e})}for(let e in a)if(!0===t[e]){let t=a[e];o.push({...t,name:e})}let l=function(e){let t=[],i=[],r=[];for(let s of e){let e=c(s.type)*s.count;switch(e%2||e%4||4){case 4:t.push(s);continue;case 2:i.push(s);continue;case 1:r.push(s);continue;default:throw Error("Found unexpected dataType byte count")}}return t.push(...i),t.push(...r),t}(o),u=[],p=8,d=1;for(let e of l)u.push({...e,offset:p}),p+=c(e.type)*e.count,e.packAlternating&&(d=Math.max(e.packAlternating.count,d));let x=Uint32Array.BYTES_PER_ELEMENT,f=p%x;return new h(i,r,s,u,p+(f?x-f:0),d)}constructor(e,t,i,r,s,n){this.position=e,this.id=t,this.bitset=i,this.standardAttributes=r,this.stride=s,this.packVertexCount=n,r.push(i),this._attributes=[e,t,i,...r]}get attributeLayout(){if(!this._attributeLayout){let e=(0,o.hU)(this._attributes),t=this._attributes.map(e=>({name:e.name,count:e.count,offset:e.offset,type:e.type,packPrecisionFactor:e.packPrecisionFactor,normalized:e.normalized??!1}));this._attributeLayout={attributes:t,hash:e,stride:this.stride}}return this._attributeLayout}}var u=i(84634);class p{static fromVertexSpec(e,t){return new p(h.fromVertexSpec(e,t))}constructor(e){this._spec=e,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(e,t,i,r,s,n){for(let e=0;e<this._spec.packVertexCount;e++){let a=e*this._spec.stride;this._packPosition(i,r,a),this._packId(t,a);let o=this._spec.bitset;if(n){if(o.packTessellation){let e=o.packTessellation(n,s,i,r);this._pack(e,o,a)}for(let e of this._spec.standardAttributes)if(null!=e.packTessellation){let t=e.packTessellation(n,s,i,r);this._pack(t,e,a)}else if(e.packAlternating?.packTessellation){let t=e.packAlternating.packTessellation(n,s,i,r);for(let i=0;i<this._spec.packVertexCount;i++){let r=t[i];this._pack(r,e,i*this._spec.stride)}}}}e.vertexWriteRegion(this._packedU32View)}pack(e,t){for(let i of this._spec.standardAttributes)if(i.pack&&"string"!=typeof i.pack){let r=i.pack(e,t);for(let e=0;e<this._spec.packVertexCount;e++)this._pack(r,i,e*this._spec.stride)}else if(i.packAlternating?.pack){let r=i.packAlternating.pack(e,t);for(let e=0;e<this._spec.packVertexCount;e++){let t=r[e];this._pack(t,i,e*this._spec.stride)}}}_packPosition(e,t,i){let{offset:r}=this._spec.position,s=this._spec.position.packPrecisionFactor??1,n=(0,a.M9)(e*s,t*s);this._dataView.setUint32(i+r,n,!0)}_packId(e,t){let i=e*(this._spec.id.packPrecisionFactor??1),r=0xff000000&this._dataView.getUint32(t+this._spec.id.offset,!0);this._dataView.setUint32(t+this._spec.id.offset,i|r,!0)}_pack(e,t,i){(0,u.F)(this._dataView,e,t,i)}}class d{constructor(e,t,i,r){this._instanceId=e,this._evaluator=t,this._enabledOptionalAttributes=i,this._viewParams=r,this._evaluator.evaluator=e=>this.vertexSpec.createComputedParams(e)}get _vertexPack(){if(!this._cachedVertexPack){let e=p.fromVertexSpec(this.vertexSpec,this._enabledOptionalAttributes);this._evaluator.hasDynamicProperties||e.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=e}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}get _preventEffectClipping(){return!1}setReferences(e){this._references=e}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){(function(e){if(!e)return!1;for(let t of e)switch(t.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(this._evaluator.inputMeshParams.effects?.effectInfos)&&await (0,n.R)()}enqueueRequest(e,t,i){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(e,t,i)}write(e,t,i,a,o){let l;this.ensurePacked(t,i,a);let c=this.evaluatedMeshParams.effects;if(!c||0===c.length)return void this._write(e,i,void 0,o);let h=i.readGeometryForDisplay()?.clone();if(!h)return;let u=r.z.fromOptimizedCIM(h,i.geometryType),p=(0,n.z)();u.invertY();let d=e.id||"",x=s.V.executeEffects(c,u,d,p,this._preventEffectClipping);for(;l=x.next();)l.invertY(),this._write(e,i,l,o)}ensurePacked(e,t,i){if(!this._evaluator.hasDynamicProperties)return;let r=this._evaluator.evaluateMeshParams(e,t,i);this._vertexPack.pack(r,this._viewParams)}hasArcadeDependency(e){return this._evaluator.hasArcadeDependency(e)}_writeVertex(e,t,i,r,s){let n=this.evaluatedMeshParams;this._vertexPack.writeVertex(e,t,i,r,n,s)}}},57129:(e,t,i)=>{i.d(t,{S:()=>v});var r=i(46499),s=i(94360),n=i(34292),a=i(65659),o=i(42646),l=i(61939),c=i(20538),h=i(55048);let u=()=>l.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.fill.GradientSizeHelper");class p{constructor(e,t){this._size=e,this._sizeUnits=t,this._relativeSize=null}get relativeSize(){return this._relativeSize??=this.calculateRelativeSize(),this._relativeSize}calculateRelativeSize(){if(this._sizeUnits===r.OW.Relative){let e=Math.min(this._size/100,1);return[e,e]}return this.calculateRelativeSizeFromAbsolute()}}class d extends p{constructor(e,t,i,r){super(t,i),this.rotationMatrix00=1,this.rotationMatrix01=0,this.rotationMatrix10=0,this.rotationMatrix11=1,this.bounds={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0},this.rotationMatrix00=Math.cos(r),this.rotationMatrix01=-Math.sin(r),this.rotationMatrix10=-this.rotationMatrix01,this.rotationMatrix11=this.rotationMatrix00;let{bounds:s,rotationMatrix00:n,rotationMatrix01:a,rotationMatrix10:o,rotationMatrix11:l}=this;e.forEachVertex((e,t)=>{let i=e*n+t*a,r=e*o+t*l;s.xmin=Math.min(s.xmin,i),s.ymin=Math.min(s.ymin,r),s.xmax=Math.max(s.xmax,i),s.ymax=Math.max(s.ymax,r)}),this.center=[(s.xmin+s.xmax)/2,(s.ymin+s.ymax)/2]}}class x extends d{constructor(e,t,i,r){super(e,t,i,r),this.method="linear"}getRelativePosition(e,t){let{rotationMatrix00:i,rotationMatrix01:r,bounds:s}=this,{xmin:n,xmax:a}=s;return[(e*i+t*r-n)/(a-n),0]}calculateRelativeSizeFromAbsolute(){let{_size:e,bounds:t}=this,{xmin:i,xmax:r}=t;return[(0,h.Lz)(e)/(r-i),0]}}class f extends d{constructor(e,t,i,r){super(e,t,i,r),this.method="rectangular"}getRelativePosition(e,t){let{bounds:i,center:r,rotationMatrix00:s,rotationMatrix01:n,rotationMatrix10:a,rotationMatrix11:o}=this,l=e*s+t*n-r[0],c=e*a+t*o-r[1];return[l*(2/(i.xmax-i.xmin)),-c*(2/(i.ymax-i.ymin))]}calculateRelativeSizeFromAbsolute(){let{_size:e,bounds:t}=this,{xmin:i,ymin:r,xmax:s,ymax:n}=t;return[(0,h.Lz)(2*e)/(s-i),(0,h.Lz)(2*e)/(n-r)]}}class y extends d{constructor(e,t,i){super(e,t,i,0),this.method="circular";let{xmin:r,xmax:s,ymin:n,ymax:a}=this.bounds,o=s-r,l=a-n;this.radius=Math.sqrt(o*o+l*l)/2}getRelativePosition(e,t){let{center:i,radius:r}=this;return[(e-i[0])/r,-((t-i[1])/r)]}calculateRelativeSizeFromAbsolute(){let{_size:e}=this;return[(0,h.Lz)(e)/this.radius,0]}}var _=i(10431),m=i(93446);let g={createComputedParams:e=>e,optionalAttributes:a.v.optionalAttributes,attributes:{...a.v.attributes,bitset:{type:m.pe.UNSIGNED_BYTE,count:1,pack:({gradientSizeUnits:e,gradientType:t})=>{let i=0;return e===r.OW.Absolute&&(i|=(0,_.mR)(o.Q.isAbsolute)),"discrete"===t.toLowerCase()&&(i|=(0,_.mR)(o.Q.isDiscrete)),i}},tlbr:{count:4,type:m.pe.UNSIGNED_SHORT,pack:({sprite:e})=>{let{rect:t,width:i,height:r}=e,n=t.x+s.hM+s.MZ,a=t.y+s.hM;return[n,a,n+i-2*s.MZ,a+r]}},relativePosition:{count:2,type:m.pe.HALF_FLOAT,packTessellation:({gradientStats:e},t,i,r)=>e?.getRelativePosition(i,r)??[0,0]},relativeGradientSize:{count:2,type:m.pe.HALF_FLOAT,packTessellation:({gradientStats:e})=>e?.relativeSize??[1,1]},gradientMethod:{count:1,type:m.pe.UNSIGNED_BYTE,pack:({gradientMethod:e})=>{switch(e.toLowerCase()){case"rectangular":return o.m.rectangular;case"circular":return o.m.circular;default:return o.m.linear}}}}};class v extends n.N{constructor(){super(...arguments),this.vertexSpec=g}get _preventEffectClipping(){return!0}createTesselationParams(e){return{gradientStats:function(e,t){if(null==e)return null;let i=(0,c.kU)(t.angle),r=t.gradientSize,s=t.gradientSizeUnits;switch(t.gradientMethod.toLowerCase()){case"linear":return new x(e,r,s,i);case"rectangular":return new f(e,r,s,i);case"circular":return new y(e,r,s);default:return u().errorOnce(`Gradient fill method "${t.gradientMethod}" currently unsupported.`),null}}(e.readGeometryForDisplay(),this.evaluatedMeshParams)}}_write(e,t,i){let r=i?.asOptimized()??t.readGeometryForDisplay(),s=this._clip(r);if(!s)return;let n=this.evaluatedMeshParams.sprite?.textureBinding;e.recordStart(this.instanceId,this.attributeLayout,n),this._writeGeometry(e,t,s),e.recordEnd()}}},62037:(e,t,i)=>{i.d(t,{O:()=>f});var r=i(55048),s=i(70412),n=i(37787),a=i(10431),o=i(83637),l=i(37390),c=i(93446);let h=n.lB,u=o.e4,p={createComputedParams:e=>e,optionalAttributes:h.optionalAttributes,attributes:{...h.attributes,bitset:{type:c.pe.UNSIGNED_BYTE,count:1,pack:e=>(0,n.KI)(e)},aux1:{count:1,type:c.pe.HALF_FLOAT,pack:e=>(0,n.oI)(e).width},aux2:{count:1,type:c.pe.HALF_FLOAT,pack:e=>(0,n.oI)(e).height},aux3:{count:2,type:c.pe.HALF_FLOAT,pack:({offsetX:e,offsetY:t})=>[(0,r.Lz)(e),(0,r.Lz)(t)]},aux4:{count:2,type:c.pe.UNSIGNED_BYTE,pack:({scaleX:e,scaleY:t})=>[e*l.cZ,t*l.cZ]}}},d={createComputedParams:e=>e,optionalAttributes:h.optionalAttributes,attributes:{...h.attributes,color:u.attributes.color,bitset:{type:c.pe.UNSIGNED_BYTE,count:1,pack:e=>(0,a.xo)([[l.Xx,!0]])},aux1:{count:1,type:c.pe.HALF_FLOAT,pack:e=>(0,r.Lz)(.5*e.width)},aux2:{count:1,type:c.pe.HALF_FLOAT,pack:e=>(0,r.Lz)(.5*e.referenceWidth)},aux3:{count:2,type:c.pe.HALF_FLOAT,packTessellation:({extrusionOffsetX:e,extrusionOffsetY:t})=>[e,t]},aux4:{count:2,type:c.pe.UNSIGNED_BYTE,packTessellation:({normalX:e,normalY:t})=>[e*l.cZ+l.v9,t*l.cZ+l.v9]}}};class x extends o.eY{constructor(){super(...arguments),this.vertexSpec=d}}class f extends o.w0{constructor(){super(...arguments),this.vertexSpec=p}_createOutlineWriter(e,t,i,r){return new x(e,t,i,r)}_write(e,t,i){let r=i?.asOptimized()??t.readGeometryForDisplay(),n=this._clip(r);if(!n)return;let a=this.evaluatedMeshParams.sprite?.textureBinding;e.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(e,t,n),this._lineMeshWriter.writeLineVertices(e,s.z.fromOptimizedCIM(n,"esriGeometryPolyline"),t),e.recordEnd()}ensurePacked(e,t,i){super.ensurePacked(e,t,i),this._lineMeshWriter.ensurePacked(e,t,i)}enqueueRequest(e,t,i){super.enqueueRequest(e,t,i),this._lineMeshWriter.enqueueRequest(e,t,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},63391:(e,t,i)=>{i.d(t,{Q:()=>c});var r=i(70412),s=i(83637),n=i(34281);let a={optionalAttributes:n.l.optionalAttributes,createComputedParams:e=>e,attributes:{...n.l.attributes,...s.Lm.attributes}},o={optionalAttributes:n.l.optionalAttributes,createComputedParams:e=>e,attributes:{...n.l.attributes,...s.e4.attributes}};class l extends s.eY{constructor(){super(...arguments),this.vertexSpec=o}}class c extends s.w0{constructor(){super(...arguments),this.vertexSpec=a}_createOutlineWriter(e,t,i,r){return new l(e,t,i,r)}_write(e,t,i){let s=i?.asOptimized()??t.readGeometryForDisplay(),n=this._clip(s);if(!n)return;let a=this.evaluatedMeshParams.sprite?.textureBinding;e.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(e,t,n),this._lineMeshWriter.writeLineVertices(e,r.z.fromOptimizedCIM(n,"esriGeometryPolyline"),t),e.recordEnd()}ensurePacked(e,t,i){super.ensurePacked(e,t,i),this._lineMeshWriter.ensurePacked(e,t,i)}enqueueRequest(e,t,i){super.enqueueRequest(e,t,i),this._lineMeshWriter.enqueueRequest(e,t,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},65659:(e,t,i)=>{i.d(t,{Y:()=>l,v:()=>o});var r=i(94360),s=i(34292),n=i(10431),a=i(93446);let o={createComputedParams:e=>e,optionalAttributes:{zoomRange:{type:a.pe.SHORT,count:2,packPrecisionFactor:r.fq,pack:({scaleInfo:e},{tileInfo:t})=>(0,n.My)(e,t)}},attributes:{id:{type:a.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:a.pe.UNSIGNED_BYTE,count:1},pos:{type:a.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},color:{type:a.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>(0,n.Jb)(e)}}};class l extends s.N{constructor(){super(...arguments),this.vertexSpec=o}createTesselationParams(e){return null}}},73143:(e,t,i)=>{i.d(t,{F:()=>p});var r=i(55048),s=i(70412),n=i(46499),a=i(94360),o=i(10431),l=i(12702),c=i(13453),h=i(93446);let u={createComputedParams:e=>e,optionalAttributes:c.Eq.optionalAttributes,attributes:{...c.Eq.attributes,bitset:{type:h.pe.UNSIGNED_BYTE,count:1,pack:({gradientMethod:e,gradientSizeUnits:t,gradientType:i})=>(0,o.xo)([[l.Q.isAlongLine,"alongline"===e.toLowerCase()],[l.Q.isAbsoluteSize,t===n.OW.Absolute],[l.Q.isDiscrete,"discrete"===i.toLowerCase()]])},tlbr:{type:h.pe.UNSIGNED_SHORT,count:4,pack:({sprite:e})=>{let{rect:t,width:i,height:r}=e,s=t.x+a.hM+a.MZ,n=t.y+a.hM;return[s,n,s+i-2*a.MZ,n+r]}},accumulatedDistance:{type:h.pe.UNSIGNED_SHORT,count:1,packTessellation:({distance:e})=>e},gradientSize:{type:h.pe.HALF_FLOAT,count:1,pack:({gradientSize:e,gradientSizeUnits:t})=>t===n.OW.Relative?e/100:(0,r.Lz)(e)},totalLength:{type:h.pe.HALF_FLOAT,count:1,packTessellation:({pathLength:e})=>e},segmentDirection:{type:h.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:e,directionY:t})=>[e,t]}}};class p extends c.Bw{get _preventEffectClipping(){return!0}constructor(e,t,i,r){super(e,t,i,r),this.vertexSpec=u,this._tessellationOptions.textured=!0}_write(e,t,i){let r=i??s.z.fromFeatureSetReaderCIM(t);if(!r)return;let{sprite:n}=this.evaluatedMeshParams;this._writeGeometry(e,t,r,n?.textureBinding)}}},83637:(e,t,i)=>{i.d(t,{Lm:()=>u,e4:()=>p,eY:()=>d,w0:()=>x});var r=i(70412),s=i(38038),n=i(65659),a=i(10431),o=i(13453),l=i(21722),c=i(37390),h=i(93446);let u={createComputedParams:e=>e,optionalAttributes:o.Eq.optionalAttributes,attributes:{...o.Eq.attributes,bitset:{type:h.pe.UNSIGNED_BYTE,count:1,pack:e=>0},color:{type:h.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>(0,a.Jb)(e)}}},p={createComputedParams:e=>e,optionalAttributes:o.Eq.optionalAttributes,attributes:{...o.Eq.attributes,bitset:{type:h.pe.UNSIGNED_BYTE,count:1,pack:e=>(0,a.xo)([[c.Xx,!0]])},color:{type:h.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:e})=>(0,a.Jb)(e)}}};class d extends o.Bw{constructor(){super(...arguments),this.vertexSpec=p}}class x extends n.Y{constructor(e,t,i,r){super(e,t,i,r),this.vertexSpec=u,this._lineMeshWriter=this._createOutlineWriter(e,t,i,r)}_createOutlineWriter(e,t,i,r){return new d(e,t,i,r)}_write(e,t,i){let s=i?.asOptimized()??t.readGeometryForDisplay(),n=this._clip(s);n&&(e.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(e,t,n),this._lineMeshWriter.writeLineVertices(e,r.z.fromOptimizedCIM(n,"esriGeometryPolyline"),t),e.recordEnd())}_clip(e){return e?(0,s.FE)(e,(0,l.Z0)(this.evaluatedMeshParams)):null}ensurePacked(e,t,i){super.ensurePacked(e,t,i),this._lineMeshWriter.ensurePacked(e,t,i)}enqueueRequest(e,t,i){super.enqueueRequest(e,t,i),this._lineMeshWriter.enqueueRequest(e,t,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},85017:(e,t,i)=>{i.d(t,{v:()=>l});var r=i(55048),s=i(10431),n=i(54598),a=i(93446);let o={createComputedParams:e=>e,optionalAttributes:{},attributes:{pos:{type:a.pe.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:a.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:a.pe.UNSIGNED_BYTE,count:1,pack:e=>0},offset:{type:a.pe.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:({size:e})=>{let t=(0,r.Lz)(e),i=-t/2,s=-t/2;return[[i,s],[i+t,s],[i,s+t],[i+t,s+t]]}}},texCoords:{type:a.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:a.pe.UNSIGNED_BYTE,count:2,pack:({size:e})=>[e,e]},referenceSize:{type:a.pe.UNSIGNED_BYTE,count:1,pack:({size:e})=>(0,r.Lz)(e)},zoomRange:{type:a.pe.UNSIGNED_BYTE,count:2,pack:({scaleInfo:e},{tileInfo:t})=>(0,s.My)(e,t)}}};class l extends n.r{constructor(){super(...arguments),this.vertexSpec=o}_write(e,t){let i,s,n=t.getDisplayId(),a=this.evaluatedMeshParams.minPixelBuffer,o=Math.max((0,r.Lz)(this.evaluatedMeshParams.size),a);if("esriGeometryPoint"===t.geometryType)i=t.readXForDisplay(),s=t.readYForDisplay();else{let e=t.readCentroidForDisplay();if(!e)return;i=e?.coords[0],s=e?.coords[1]}e.recordStart(this.instanceId,this.attributeLayout),e.recordBounds(i,s,o,o);let l=e.vertexCount();this._writeVertex(e,n,i,s),e.indexWrite(l+0),e.indexWrite(l+1),e.indexWrite(l+2),e.indexWrite(l+1),e.indexWrite(l+3),e.indexWrite(l+2),e.recordEnd()}}},91438:(e,t,i)=>{i.d(t,{G8:()=>L,GJ:()=>_});var r=i(20538),s=i(55048),n=i(70412),a=i(32464),o=i(50240),l=i(94360),c=i(66319),h=i(10431),u=i(21490),p=i(54598),d=i(37390),x=i(95832);class f{constructor(e){let{offsetX:t,offsetY:i,postAngle:r,fontSize:s,haloSize:n,outlineSize:a,scaleFactor:o,transforms:l}=e;if(this.offsetX=t,this.offsetY=i,this.postAngle=r,this.fontSize=Math.min(s,96),this.haloSize=n??0,this.outlineSize=a??0,this.transforms=l,l&&l.infos.length>1){let e=(0,x.zb)(s,r,!1,t,i,l,!1);this.fontSize=Math.min(e.size,96);let n=e.size/s;this.haloSize*=n,this.outlineSize*=n,this.postAngle=e.rotation,this.offsetX=e.offsetX,this.offsetY=e.offsetY}o&&(this.fontSize*=o,this.offsetX*=o,this.offsetY*=o)}}var y=i(93446);let _=28,m=[4,4],g=[16,4],v={topLeft:g,topRight:g,bottomLeft:g,bottomRight:g},w=[4,2],k=[4,6],b={topLeft:w,topRight:w,bottomLeft:k,bottomRight:k},S={topLeft:w,topRight:k,bottomLeft:w,bottomRight:k},T={topLeft:k,topRight:k,bottomLeft:m,bottomRight:m},M={topLeft:m,topRight:m,bottomLeft:k,bottomRight:k},P={topLeft:k,topRight:m,bottomLeft:k,bottomRight:m},z={topLeft:m,topRight:k,bottomLeft:m,bottomRight:k},E={createComputedParams:e=>e,optionalAttributes:{zoomRange:{type:y.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:l.fq,packTessellation:({minZoom:e,maxZoom:t})=>[e||0,t||_]},clipAngle:{type:y.pe.UNSIGNED_BYTE,count:1,packTessellation:({clipAngle:e})=>I(e||0)},referenceSymbol:{type:y.pe.BYTE,count:4,packPrecisionFactor:1,packTessellation:(e,t)=>{let i=e.isLineLabel||!e.referenceBounds,r=(0,o.iT)(i?"center":t.horizontalAlignment),n=(0,o.Dy)(i?"middle":t.verticalAlignment),{offsetX:a,offsetY:l,size:c}=i?{offsetX:0,offsetY:0,size:0}:e.referenceBounds;return[(0,s.Lz)(a),-(0,s.Lz)(l),Math.round((0,s.Lz)(c)),r+1<<2|n+1]}}},attributes:{pos:{type:y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:y.pe.UNSIGNED_BYTE,count:1,packTessellation:({isBackground:e,mapAligned:t})=>(0,h.xo)([[d.bg,e],[d.ti,!!t]])},offset:{type:y.pe.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:({offsets:e})=>{let{bottomLeft:t,bottomRight:i,topLeft:r,topRight:s}=e;return[r,s,t,i]}}},textureUV:{type:y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:({texcoords:e})=>{let{bottomLeft:t,bottomRight:i,topLeft:r,topRight:s}=e;return[r,s,t,i]}}},color:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:({color:e})=>e},fontSize:{type:y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:({fontSize:e})=>Math.round((0,s.Lz)(e))},referenceSize:{type:y.pe.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:({fontSize:e},{referenceSize:t})=>Math.round((0,s.Lz)(t??e))},outlineColor:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:e})=>(0,h.Jb)(e)},haloColor:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({haloColor:e})=>(0,h.Jb)(e)},outlineAndHaloSize:{type:y.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:4,packTessellation:({outlineSize:e,haloSize:t})=>[Math.round((0,s.Lz)(e)),Math.round((0,s.Lz)(t))]}}};class L extends p.r{constructor(){super(...arguments),this.vertexSpec=E,this._textMeshParamsPropsInitialized=!1}ensurePacked(e,t,i){super.ensurePacked(e,t,i),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new f(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(e,t,i){let r=this._getShaping();if(!r)return;let s=t.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(e,t,r,i);if(i?.nextPath())return i.nextPoint(),this._writeGlyphs(e,s,i.x,i.y,r,0);if("esriGeometryPolygon"===t.geometryType){let i=t.readCentroidForDisplay();if(!i)return;let[n,a]=i.coords;return this._writeGlyphs(e,s,n,a,r,0)}if("esriGeometryMultipoint"===t.geometryType){let i=t.readGeometryForDisplay();return void i?.forEachVertex((t,i)=>this._writeGlyphs(e,s,t,i,r,0))}let n=t.readXForDisplay(),a=t.readYForDisplay();return this._writeGlyphs(e,s,n,a,r,0)}_writePlacedTextMarkers(e,t,i,r){let o=r??n.z.fromFeatureSetReaderCIM(t);if(!o)return;let l=a.l.getPlacement(o,-1,this.evaluatedMeshParams.placement,(0,s.Lz)(1),e.id,(0,u.z)());if(!l)return;let c=t.getDisplayId(),h=l.next();for(;null!=h;){let t=h.tx,r=-h.ty,s=-h.getAngle();this._writeGlyphs(e,c,t,r,i,s),h=l.next()}}_getShaping(e){let t=this._textMeshTransformProps,i=this.evaluatedMeshParams;if(!i.glyphs?.glyphs.length)return null;let n=(0,s.Lz)(t.fontSize),a=(0,s.Lz)(t.offsetX),o=(0,s.Lz)(t.offsetY),h=(0,r.qE)((0,s.Lz)(i.lineWidth),l.GR,l.cp),u=l.DY*(0,r.qE)(i.lineHeightRatio,.25,4);return(0,c.Tl)(i.glyphs,{scale:n/l.eG,angle:t.postAngle,xOffset:a,yOffset:o,horizontalAlignment:i.horizontalAlignment,verticalAlignment:e||i.verticalAlignment,maxLineWidth:h,lineHeight:u,decoration:i.decoration,borderLineSizePx:(0,s.Lz)(i.boxBorderLineSize),hasBackground:!!i.boxBackgroundColor,useCIMAngleBehavior:i.useCIMAngleBehavior})}_writeGlyphs(e,t,i,r,n,a,o,l){let c=this.evaluatedMeshParams,u=this._textMeshTransformProps,p=(0,s.Lz)(u.fontSize),d=u.haloSize,x=u.outlineSize,f=(0,s.Lz)(u.offsetX),y=(0,s.Lz)(u.offsetY),[_,m]=(0,h.My)(c.scaleInfo,this.getTileInfo());0!==a&&n.setRotation(a);let g=n.bounds,v=i+g.x+f,w=r+g.y-y,k=2*(c.minPixelBuffer?c.minPixelBuffer/p:1),b=Math.max(g.width,g.height)*k;for(let s of(n.textBox&&(e.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding),e.recordBounds(v,w,b,b),this._writeTextBox(e,t,i,r,n.textBox,o,l),e.recordEnd()),n.glyphs)){e.recordStart(this.instanceId,this.attributeLayout,s.textureBinding),e.recordBounds(v,w,b,b);let{texcoords:n,offsets:a}=s;this._writeQuad(e,t,i,r,{texcoords:n,offsets:a,fontSize:p,haloSize:d,outlineSize:x,color:(0,h.Jb)(c.color),isBackground:!1,referenceBounds:o,minZoom:_,maxZoom:m,...l}),e.recordEnd()}0!==a&&n.setRotation(-a)}_writeTextBox(e,t,i,r,s,n,a){let o=this.evaluatedMeshParams,{fontSize:l,haloSize:c,outlineSize:u}=this._textMeshTransformProps,{boxBackgroundColor:p,boxBorderLineColor:d}=o,x={isBackground:!0,fontSize:l,haloSize:c,outlineSize:u,referenceBounds:n,...a};p&&(this._writeQuad(e,t,i,r,{texcoords:v,offsets:s.main,color:(0,h.Jb)(p),...x}),d||(this._writeQuad(e,t,i,r,{texcoords:T,offsets:s.top,color:(0,h.Jb)(p),...x}),this._writeQuad(e,t,i,r,{texcoords:M,offsets:s.bot,color:(0,h.Jb)(p),...x}),this._writeQuad(e,t,i,r,{texcoords:P,offsets:s.left,color:(0,h.Jb)(p),...x}),this._writeQuad(e,t,i,r,{texcoords:z,offsets:s.right,color:(0,h.Jb)(p),...x}))),d&&(this._writeQuad(e,t,i,r,{texcoords:b,offsets:s.top,color:(0,h.Jb)(d),...x}),this._writeQuad(e,t,i,r,{texcoords:b,offsets:s.bot,color:(0,h.Jb)(d),...x}),this._writeQuad(e,t,i,r,{texcoords:S,offsets:s.left,color:(0,h.Jb)(d),...x}),this._writeQuad(e,t,i,r,{texcoords:S,offsets:s.right,color:(0,h.Jb)(d),...x}))}_writeQuad(e,t,i,r,s){let n=e.vertexCount();this._writeVertex(e,t,i,r,s),e.indexWrite(n+0),e.indexWrite(n+1),e.indexWrite(n+2),e.indexWrite(n+1),e.indexWrite(n+3),e.indexWrite(n+2)}}let I=e=>Math.round(254/360*e)},95330:(e,t,i)=>{i.d(t,{V:()=>c});var r=i(70412),s=i(16979),n=i(99868),a=i(29319),o=i(5886);let l=96/72;class c{static executeEffects(e,t,i,r,s){let c=(0,o.ll)(e),h=new n.k(t);for(let t of e){let e=(0,a.A)(t);e&&(h=e.execute(h,t,l,i,r,c,s))}return h}static applyEffects(e,t,i){if(!e)return t;let l=(0,o.ll)(e),c,h=new n.k(r.z.fromJSONCIM(t));for(let t of e){let e=(0,a.A)(t);e&&(h=e.execute(h,t,1,null,i,l,!1))}let u=[],p=null;for(;c=h.next();)u.push(...(0,s.x)(c)),p=c.geometryType;return 0===u.length||null===p?null:"esriGeometryPolygon"===p?{rings:u}:{paths:u}}}}}]);