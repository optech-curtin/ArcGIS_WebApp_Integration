"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1507],{35063:(e,a,r)=>{r.d(a,{K:()=>d,Q:()=>l});var t=r(81194);let n=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function l(e,a){let{loadContext:r,...n}=a||{},l=r?await r.fetchServiceMetadata(e,n):await (0,t.V)(e,n);c(l),u(l);let i={serviceJSON:l};if((l.currentVersion??0)<10.5)return i;let s=`${e}/layers`,o=r?await r.fetchServiceMetadata(s,n):await (0,t.V)(s,n);return c(o),u(o),i.layersJSON={layers:o.layers,tables:o.tables},i}function i(e){let{type:a}=e;return!!a&&n.has(a)}function s(e){return"Table"===e.type}function u(e){e.layers=e.layers?.filter(i),e.tables=e.tables?.filter(s)}function o(e){e.type||="Feature Layer"}function y(e){e.type||="Table"}function c(e){e.layers?.forEach(o),e.tables?.forEach(y)}function d(e){switch(e){case"Feature Layer":case"Table":break;case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},42956:(e,a,r)=>{r.d(a,{L:()=>y});var t=r(57664),n=r(39166),l=r(32391),i=r(92753),s=r(21371),u=r(14307),o=r(28015);async function y(e,a){let r=(0,s.qg)(e);if(!r)throw new l.A("invalid-url","Invalid scene service url");let t={...a,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(t.sceneLayerItem??=await c(t),null==t.sceneLayerItem)return w(t.sceneServerUrl.replace("/SceneServer","/FeatureServer"),t);let n=await h(t);if(!n?.url)throw new l.A("related-service-not-found","Could not find feature service through portal item relationship");t.featureServiceItem=n;let i=await w(n.url,t);return i.portalItem=n,i}async function c(e){let a=(await d(e)).serviceItemId;if(!a)return null;let r=new o.default({id:a,apiKey:e.apiKey}),t=await f(e);null!=t&&(r.portal=new u.A({url:t}));try{return await r.load({signal:e.signal})}catch(e){return(0,i.QP)(e),null}}async function d(e){if(e.rootDocument)return e.rootDocument;let a={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{let r=await (0,n.A)(e.sceneServerUrl,a);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function f(e){let a=t.id?.findServerInfo(e.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;let r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{let a=(await (0,n.A)(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(e){(0,i.QP)(e)}return null}async function w(e,a){let r=(0,s.qg)(e);if(!r)throw new l.A("invalid-feature-service-url","Invalid feature service url");let t=r.url.path,i=a.layerId;if(null==i)return{serverUrl:t};let u=d(a),o=a.featureServiceItem?await a.featureServiceItem.fetchData("json"):null,y=(o?.layers?.[0]||o?.tables?.[0])?.customParameters,c=e=>{let r={query:{f:"json",...y},responseType:"json",authMode:e,signal:a.signal};return(0,n.A)(t,r)},f=c("anonymous").catch(()=>c("no-prompt")),[w,h]=await Promise.all([f,u]),m=h?.layers,p=w.data&&w.data.layers;if(!Array.isArray(p))throw Error("expected layers array");if(Array.isArray(m)){for(let e=0;e<Math.min(m.length,p.length);e++)if(m[e].id===i)return{serverUrl:t,layerId:p[e].id}}else if(null!=i&&i<p.length)return{serverUrl:t,layerId:p[i].id};throw Error("could not find matching associated sublayer")}async function h({sceneLayerItem:e,signal:a}){if(!e)return null;try{let r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:a})).find(e=>"Feature Service"===e.type)||null;if(!r)return null;let t=new o.default({portal:r.portal,id:r.id});return await t.load(),t}catch(e){return(0,i.QP)(e),null}}},51507:(e,a,r)=>{r.r(a),r.d(a,{fromUrl:()=>d});var t=r(32391),n=r(90525),l=r(21371),i=r(42956),s=r(35063),u=r(71086),o=r(85924),y=r(81194);let c={FeatureLayer:!0,SceneLayer:!0};async function d(e){let{properties:a,url:t}=e,n={...a,url:t},l=await m(t,a?.customParameters),{Constructor:i,layerId:s,sourceJSON:u,parsedUrl:o,layers:y,tables:c}=l;if(y.length+c.length===0)return null!=s&&(n.layerId=s),null!=u&&(n.sourceJSON=u),new i(n);let d=new(0,(await r.e(6384).then(r.bind(r,36384))).default)({title:o.title});return await h(d,l,n),d}function f(e,a){return e?e.find(({id:e})=>e===a):null}function w(e,a,r,t,n){let l={...n,layerId:a};return null!=e&&(l.url=e),null!=r&&(l.sourceJSON=r),"sublayerTitleMode"in t.prototype&&(l.sublayerTitleMode="service-name"),new t(l)}async function h(e,a,r){let t=a.sublayerConstructorProvider;for(let{id:n,serverUrl:l}of a.layers){let i=f(a.sublayerInfos,n),s=w(l,n,i,(i&&t?.(i))??a.Constructor,r);e.add(s)}if(a.tables.length){let t=await L("FeatureLayer");a.tables.forEach(({id:n,serverUrl:l})=>{let i=w(l,n,f(a.tableInfos,n),t,r);e.tables.add(i)})}}async function m(e,a){let r,n=(0,l.qg)(e);if(null==n&&(n=await p(e,a)),null==n)throw new t.A("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});let{serverType:i,sublayer:o}=n,d="FeatureServer"===i,f="SceneServer"===i,w={parsedUrl:n,Constructor:null,layerId:d||f?o??void 0:void 0,layers:[],tables:[]};switch(i){case"MapServer":if(null!=o){let{type:n}=await (0,y.V)(e,{customParameters:a});switch(r="FeatureLayer",n){case"Catalog Layer":r="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new t.A("arcgis-layers:unsupported",`fromUrl() not supported for "${n}" layers`)}}else r=await g(e,a)?"TileLayer":"MapImageLayer";break;case"ImageServer":{let{tileInfo:t,cacheType:n}=await (0,y.V)(e,{customParameters:a});r=t?"LERC"!==t?.format?.toUpperCase()||n&&"elevation"!==n.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{let e=await (0,y.V)(n.url.path,{customParameters:a});if(r="SceneLayer",e){let a=e?.layers;if("Voxel"===e?.layerType)r="VoxelLayer";else if(a?.length){let e=a[0]?.layerType;null!=e&&null!=u.XX[e]&&(r=u.XX[e])}}break}case"3DTilesServer":throw new t.A("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(r="FeatureLayer",null!=o){let t=await (0,y.V)(e,{customParameters:a});w.sourceJSON=t,r=(0,s.K)(t.type)}break;default:r=({FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"})[i]}if(c[r]&&null==o){let t=await v(e,i,a);if(d&&(w.sublayerInfos=t.layerInfos,w.tableInfos=t.tableInfos),1!==t.layers.length+t.tables.length)w.layers=t.layers,w.tables=t.tables,d&&t.layerInfos?.length&&(w.sublayerConstructorProvider=await I(t.layerInfos));else if(d||f){let e=t.layerInfos?.[0]??t.tableInfos?.[0];if(w.layerId=t.layers[0]?.id??t.tables[0]?.id,w.sourceJSON=e,d){let a=e?.type;r=(0,s.K)(a)}}}return w.Constructor=await L(r),w}async function p(e,a){let r=await (0,y.V)(e,{customParameters:a}),t=null,i=null,s=r.type;if("Feature Layer"===s||"Table"===s?(t="FeatureServer",i=r.id??null):"indexedVector"===s?t="VectorTileServer":r.hasOwnProperty("mapName")?t="MapServer":r.hasOwnProperty("bandCount")&&r.hasOwnProperty("pixelSizeX")?t="ImageServer":r.hasOwnProperty("maxRecordCount")&&r.hasOwnProperty("allowGeometryUpdates")?t="FeatureServer":r.hasOwnProperty("streamUrls")?t="StreamServer":b(r)?(t="SceneServer",i=r.id):r.hasOwnProperty("layers")&&b(r.layers?.[0])&&(t="SceneServer"),!t)return null;let u=null!=i?(0,l.iz)(e):null;return{title:null!=u&&r.name||(0,n.e7)(e),serverType:t,sublayer:i,url:{path:null!=u?u.serviceUrl:(0,n.An)(e).path}}}function b(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function v(e,a,r){let t,n,l=!1;switch(a){case"FeatureServer":{let a=await (0,s.Q)(e,{customParameters:r});l=!!a.layersJSON,t=a.layersJSON||a.serviceJSON;break}case"SceneServer":{let a=await S(e,r);t=a.serviceInfo,n=a.tableServerUrl;break}default:t=await (0,y.V)(e,{customParameters:r})}let i=t?.layers,u=t?.tables;return{layers:i?.map(e=>({id:e.id})).reverse()||[],tables:u?.map(e=>({serverUrl:n,id:e.id})).reverse()||[],layerInfos:l?i:[],tableInfos:l?u:[]}}async function S(e,a){let r=await (0,y.V)(e,{customParameters:a});if(!r.layers?.[0])return{serviceInfo:r};try{let{serverUrl:t}=await (0,i.L)(e),n=await (0,y.V)(t,{customParameters:a}).catch(()=>null);return n&&(r.tables=n.tables),{serviceInfo:r,tableServerUrl:t}}catch{return{serviceInfo:r}}}async function L(e){return(0,o.S[e])()}async function g(e,a){return(await (0,y.V)(e,{customParameters:a})).tileInfo}async function I(e){if(!e.length)return;let a=new Set,r=[];for(let{type:t}of e)a.has(t)||(a.add(t),r.push(L((0,s.K)(t))));let t=await Promise.all(r),n=new Map;return Array.from(a).forEach((e,a)=>{n.set(e,t[a])}),e=>n.get(e.type)}},81194:(e,a,r)=>{r.d(a,{V:()=>n});var t=r(39166);async function n(e,a){let{data:r}=await (0,t.A)(e,{responseType:"json",query:{f:"json",...a?.customParameters,token:a?.apiKey}});return r}},85924:(e,a,r)=>{r.d(a,{S:()=>t});let t={BingMapsLayer:async()=>(await r.e(5628).then(r.bind(r,85628))).default,BuildingSceneLayer:async()=>(await Promise.all([r.e(3081),r.e(9653),r.e(2035),r.e(1777),r.e(8029)]).then(r.bind(r,88029))).default,CSVLayer:async()=>(await r.e(533).then(r.bind(r,60533))).default,CatalogLayer:async()=>(await Promise.all([r.e(1170),r.e(7328),r.e(8542)]).then(r.bind(r,58542))).default,DimensionLayer:async()=>(await r.e(3406).then(r.bind(r,73406))).default,ElevationLayer:async()=>(await r.e(379).then(r.bind(r,50379))).default,FeatureLayer:async()=>(await Promise.resolve().then(r.bind(r,43778))).default,GeoJSONLayer:async()=>(await r.e(5712).then(r.bind(r,25712))).default,GeoRSSLayer:async()=>(await r.e(3076).then(r.bind(r,83076))).default,GroupLayer:async()=>(await r.e(6384).then(r.bind(r,36384))).default,ImageryLayer:async()=>(await Promise.all([r.e(1170),r.e(6098),r.e(1543),r.e(3315),r.e(7607)]).then(r.bind(r,6961))).default,ImageryTileLayer:async()=>(await Promise.all([r.e(6098),r.e(1543),r.e(1182),r.e(3315),r.e(7945),r.e(8610)]).then(r.bind(r,58610))).default,IntegratedMesh3DTilesLayer:async()=>(await r.e(3901).then(r.bind(r,43901))).default,IntegratedMeshLayer:async()=>(await Promise.all([r.e(1777),r.e(6517)]).then(r.bind(r,66517))).default,KMLLayer:async()=>(await r.e(6383).then(r.bind(r,6383))).default,KnowledgeGraphLayer:async()=>(await Promise.all([r.e(7970),r.e(2140),r.e(9368),r.e(8560),r.e(6283),r.e(3004),r.e(9017)]).then(r.bind(r,29017))).default,LineOfSightLayer:async()=>(await Promise.all([r.e(8343),r.e(5910)]).then(r.bind(r,35910))).default,LinkChartLayer:async()=>(await Promise.all([r.e(7970),r.e(2140),r.e(9368),r.e(8560),r.e(6283),r.e(3004),r.e(2946)]).then(r.bind(r,82946))).default,MapImageLayer:async()=>(await Promise.all([r.e(1170),r.e(9386),r.e(1264)]).then(r.bind(r,7108))).default,MapNotesLayer:async()=>(await r.e(7711).then(r.bind(r,80092))).default,MediaLayer:async()=>(await r.e(3837).then(r.bind(r,13837))).default,OGCFeatureLayer:async()=>(await r.e(8708).then(r.bind(r,28708))).default,OpenStreetMapLayer:async()=>(await r.e(4448).then(r.bind(r,84448))).default,OrientedImageryLayer:async()=>(await r.e(6339).then(r.bind(r,76339))).default,PointCloudLayer:async()=>(await r.e(8362).then(r.bind(r,18362))).default,RouteLayer:async()=>(await Promise.all([r.e(8556),r.e(6365)]).then(r.bind(r,6365))).default,SceneLayer:async()=>(await Promise.all([r.e(3081),r.e(9653),r.e(2035),r.e(1777),r.e(6852)]).then(r.bind(r,86852))).default,StreamLayer:async()=>(await r.e(8434).then(r.bind(r,18434))).default,SubtypeGroupLayer:async()=>(await r.e(2606).then(r.bind(r,62606))).default,TileLayer:async()=>(await Promise.all([r.e(1170),r.e(9386),r.e(5897)]).then(r.bind(r,94225))).default,UnknownLayer:async()=>(await r.e(71).then(r.bind(r,50071))).default,UnsupportedLayer:async()=>(await r.e(368).then(r.bind(r,368))).default,VectorTileLayer:async()=>(await Promise.all([r.e(6840),r.e(1798)]).then(r.bind(r,65459))).default,VideoLayer:async()=>(await Promise.all([r.e(4008),r.e(4899),r.e(7614)]).then(r.bind(r,57330))).default,ViewshedLayer:async()=>(await Promise.all([r.e(8343),r.e(6888)]).then(r.bind(r,26888))).default,VoxelLayer:async()=>(await r.e(2640).then(r.bind(r,90259))).default,WCSLayer:async()=>(await Promise.all([r.e(6098),r.e(1543),r.e(1182),r.e(3315),r.e(7945),r.e(5885)]).then(r.bind(r,95885))).default,WFSLayer:async()=>(await Promise.all([r.e(7719),r.e(3507)]).then(r.bind(r,13507))).default,WMSLayer:async()=>(await r.e(6574).then(r.bind(r,86574))).default,WMTSLayer:async()=>(await r.e(3202).then(r.bind(r,23202))).default,WebTileLayer:async()=>(await r.e(23).then(r.bind(r,40023))).default}}}]);