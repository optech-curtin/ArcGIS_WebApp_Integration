"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3611,7034],{1485:(e,t,r)=>{r.d(t,{z:()=>function e(t){let r={};for(let n in t){if("declaredClass"===n)continue;let i=t[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){r[n]=[];for(let t=0;t<i.length;t++)r[n][t]=e(i[t])}else"object"==typeof i?i.toJSON&&(r[n]=JSON.stringify(i)):r[n]=i}return r}})},2370:(e,t,r)=>{r.d(t,{E:()=>v,w:()=>o});var n=r(31461),i=r(28255);r(57845);var s=r(87196),a=r(70115);class o{constructor(e=9,t){this._compareMinX=h,this._compareMinY=f,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),b.prune(),x.prune(),I.prune(),w.prune()}all(e){l(this._data,e)}search(e,t){let r=this._data,n=this._toBBox;if(p(e,r))for(b.clear();r;){for(let i=0,s=r.children.length;i<s;i++){let s=r.children[i],a=r.leaf?n(s):s;p(e,a)&&(r.leaf?t(s):_(e,a)?l(s,t):b.push(s))}r=b.pop()}}collides(e){let t=this._data,r=this._toBBox;if(!p(e,t))return!1;for(b.clear();t;){for(let n=0,i=t.children.length;n<i;n++){let i=t.children[n],s=t.leaf?r(i):i;if(p(e,s)){if(t.leaf||_(e,s))return!0;b.push(i)}}t=b.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){let e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new S([]),this}remove(e){if(!e)return this;let t,r=this._data,s=null,a=0,o=!1,l=this._toBBox(e);for(I.clear(),w.clear();r||I.length>0;){if(r||(r=I.pop(),s=I.data[I.length-1],a=w.pop()??0,o=!0),r.leaf&&-1!==(t=(0,n.qh)(r.children,(0,i.zI)(e),r.children.length,r.indexHint)))return r.children.splice(t,1),I.push(r),this._condense(I),this;o||r.leaf||!_(r,l)?s?(a++,r=s.children[a],o=!1):r=null:(I.push(r),w.push(a),a=0,s=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,r,n){let i=r-t+1,s=this._maxEntries;if(i<=s){let n=new S(e.slice(t,r+1));return u(n,this._toBBox),n}n||(n=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/s**(n-1)));let a=new R([]);a.height=n;let o=Math.ceil(i/s),l=o*Math.ceil(Math.sqrt(s));y(e,t,r,l,this._compareMinX);for(let i=t;i<=r;i+=l){let t=Math.min(i+l-1,r);y(e,i,t,o,this._compareMinY);for(let r=i;r<=t;r+=o){let i=Math.min(r+o-1,t);a.children.push(this._build(e,r,i,n-1))}}return u(a,this._toBBox),a}_insert(e,t,r){let n=this._toBBox,i=r?e:n(e);I.clear();let s=function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){let r,n=1/0,a=1/0;for(let o=0,l=t.children.length;o<l;o++){var i,s;let l=t.children[o],u=m(l),d=(i=e,(Math.max((s=l).maxX,i.maxX)-Math.min(s.minX,i.minX))*(Math.max(s.maxY,i.maxY)-Math.min(s.minY,i.minY))-u);d<a?(a=d,n=u<n?u:n,r=l):d===a&&u<n&&(n=u,r=l)}t=r||t.children[0]}return t}(i,this._data,t,I);for(s.children.push(e),c(s,i);t>=0&&I.data[t].children.length>this._maxEntries;)this._split(I,t),t--;var a=i,o=I,l=t;for(let e=l;e>=0;e--)c(o.data[e],a)}_split(e,t){let r=e.data[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);let s=this._chooseSplitIndex(r,i,n);if(!s)return;let a=r.children.splice(s,r.children.length-s),o=r.leaf?new S(a):new R(a);o.height=r.height,u(r,this._toBBox),u(o,this._toBBox),t?e.data[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this._data=new R([e,t]),this._data.height=e.height+1,u(this._data,this._toBBox)}_chooseSplitIndex(e,t,r){let n,i,s;n=i=1/0;for(let a=t;a<=r-t;a++){let t=d(e,0,a,this._toBBox),o=d(e,a,r,this._toBBox),l=function(e,t){let r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-r)*Math.max(0,Math.min(e.maxY,t.maxY)-n)}(t,o),u=m(t)+m(o);l<n?(n=l,s=a,i=u<i?u:i):l===n&&u<i&&(i=u,s=a)}return s}_chooseSplitAxis(e,t,r){let n=e.leaf?this._compareMinX:h,i=e.leaf?this._compareMinY:f;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);let i=this._toBBox,s=d(e,0,t,i),a=d(e,r-t,r,i),o=g(s)+g(a);for(let n=t;n<r-t;n++){let t=e.children[n];c(s,e.leaf?i(t):t),o+=g(s)}for(let n=r-t-1;n>=t;n--){let t=e.children[n];c(a,e.leaf?i(t):t),o+=g(a)}return o}_condense(e){for(let t=e.length-1;t>=0;t--){let r=e.data[t];if(0===r.children.length)if(t>0){let i=e.data[t-1],s=i.children;s.splice((0,n.qh)(s,r,s.length,i.indexHint),1)}else this.clear();else u(r,this._toBBox)}}_initFormat(e){let t=["return a"," - b",";"];this._compareMinX=Function("a","b",t.join(e[0])),this._compareMinY=Function("a","b",t.join(e[1])),this._toBBox=Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function l(e,t){let r=e;for(x.clear();r;){if(!0===r.leaf)for(let e of r.children)t((0,i.zI)(e));else x.pushArray(r.children);r=x.pop()??null}}function u(e,t){d(e,0,e.children.length,t,e)}function d(e,t,r,n,i){i||(i=new S([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s,a=t;a<r;a++)s=e.children[a],c(i,e.leaf?n(s):s);return i}function c(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function h(e,t){return e.minX-t.minX}function f(e,t){return e.minY-t.minY}function m(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function g(e){return e.maxX-e.minX+(e.maxY-e.minY)}function _(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function y(e,t,r,n,i){let s=[t,r];for(;s.length;){let t=s.pop(),r=s.pop();if(t-r<=n)continue;let o=r+Math.ceil((t-r)/n/2)*n;(0,a.q)(e,o,r,t,i),s.push(r,o,o,t)}}let b=new s.A,x=new s.A,I=new s.A,w=new s.A({deallocator:void 0});class v{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class T extends v{constructor(){super(...arguments),this.height=1,this.indexHint=new n.vW}}class S extends T{constructor(e){super(),this.children=e,this.leaf=!0}}class R extends T{constructor(e){super(),this.children=e,this.leaf=!1}}},2907:(e,t,r)=>{var n;r.d(t,{c:()=>n}),function(e){e[e.Bind=0]="Bind",e[e.Pass=1]="Pass",e[e.Draw=2]="Draw"}(n||(n={}))},3391:(e,t,r)=>{function n(){return[1,0,0,0,1,0,0,0,1]}function i(e,t,r,n,i,s,a,o,l){return[e,t,r,n,i,s,a,o,l]}r.d(t,{fA:()=>i,vt:()=>n,zK:()=>s});let s=n();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:s,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},create:n,createView:function(e,t){return new Float64Array(e,t,9)},fromValues:i},Symbol.toStringTag,{value:"Module"}))},4547:(e,t,r)=>{r.d(t,{h:()=>i}),r(119);var n=r(17202);r(19908);class i extends n.R6{constructor(e,t,r,n,i){super(e,t),this.layerUid=e,this.graphicUid=t,this.triangleNr=r,this.baseBoundingSphere=n,this.numLodLevels=i}}},7916:(e,t,r)=>{r.d(t,{N:()=>g,a:()=>v,c:()=>_,e:()=>b,f:()=>T,g:()=>w,i:()=>C,l:()=>x,m:()=>p,n:()=>R,o:()=>G,p:()=>N,s:()=>U,w:()=>I}),r(57845),r(61939);var n=r(20538),i=r(40998),s=r(63599),a=r(56911),o=r(13784),l=r(44120),u=r(19461),d=r(97067),c=r(23146);function h(e,t){let r=(0,s.l)(e),i=(0,n.YN)(e[2]/r),a=Math.atan2(e[1]/r,e[0]/r);return(0,s.i)(t,r,i,a),t}var f=r(47325),m=r(42378);let g=_();function _(){return(0,l.vt)()}let p=o.e,y=o.e;function b(e,t){return(0,o.c)(t,e)}function x(e,t){return(0,l.fA)(e[0],e[1],e[2],t)}function I(e){return e}function w(e){return e[3]}function v(e){return e}function T(e,t,r,n){return(0,l.fA)(e,t,r,n)}function S(e,t,r){if(null==t||!A(e,t,M))return!1;let{t0:n,t1:i}=M;if((n<0||i<n&&i>0)&&(n=i),n<0)return!1;if(r){let{origin:e,direction:i}=t;r[0]=e[0]+i[0]*n,r[1]=e[1]+i[1]*n,r[2]=e[2]+i[2]*n}return!0}function R(e,t,r){let n=(0,c.Cr)(t,r);if(!A(e,n,M))return[];let{origin:i,direction:o}=n,{t0:l,t1:d}=M,h=t=>{let r=(0,a.vt)();return(0,s.b)(r,i,o,t),N(e,r,r)};return Math.abs(l-d)<(0,u.FD)()?[h(l)]:[h(l),h(d)]}let M={t0:0,t1:0};function A(e,t,r){let{origin:n,direction:i}=t;E[0]=n[0]-e[0],E[1]=n[1]-e[1],E[2]=n[2]-e[2];let s=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];if(0===s)return!1;let a=2*(i[0]*E[0]+i[1]*E[1]+i[2]*E[2]),o=a*a-4*s*(E[0]*E[0]+E[1]*E[1]+E[2]*E[2]-e[3]*e[3]);if(o<0)return!1;let l=Math.sqrt(o);return r.t0=(-a-l)/(2*s),r.t1=(-a+l)/(2*s),!0}let E=(0,a.vt)();function C(e,t){return S(e,t,null)}function F(e,t,r){let n=m.rq.get(),a=m.Rc.get();(0,s.e)(n,t.origin,t.direction);let o=w(e);(0,s.e)(r,n,t.origin),(0,s.h)(r,r,1/(0,s.l)(r)*o);let l=O(e,t.origin),u=(0,f.g7)(t.origin,r);return(0,i.$0)(a,u+l,n),(0,s.t)(r,r,a),r}function N(e,t,r){let n=(0,s.d)(m.rq.get(),t,v(e)),i=(0,s.h)(m.rq.get(),n,e[3]/(0,s.l)(n));return(0,s.g)(r,i,v(e))}function O(e,t){let r=(0,s.d)(m.rq.get(),t,v(e)),i=(0,s.l)(r),a=w(e),o=a+Math.abs(a-i);return(0,n.XM)(a/o)}let B=(0,a.vt)();function P(e,t,r,n){let i=(0,s.d)(B,t,v(e));switch(r){case d._.X:{let e=h(i,B)[2];return(0,s.i)(n,-Math.sin(e),Math.cos(e),0)}case d._.Y:{let e=h(i,B),t=e[1],r=e[2],a=Math.sin(t);return(0,s.i)(n,-a*Math.cos(r),-a*Math.sin(r),Math.cos(t))}case d._.Z:return(0,s.n)(n,i);default:return}}function k(e,t){let r=(0,s.d)(L,t,v(e));return(0,s.l)(r)-e[3]}function G(e,t){let r=(0,s.s)(v(e),t),n=w(e);return r<=n*n}let L=(0,a.vt)(),D=_(),U=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:g,altitudeAt:k,angleToSilhouette:O,axisAt:P,cameraFrustumCoverage:function(e,t,r,n){let i=w(e),s=i*i,a=t+.5*Math.PI,o=r*r+s-2*Math.cos(a)*r*i,l=Math.sqrt(o),u=o-s;return u<=0?.5:Math.min(1,(Math.acos(Math.sqrt(u)/l)-Math.asin(i/(l/Math.sin(a)))+.5*n)/n)},clear:function(e){e[0]=e[1]=e[2]=e[3]=0},closestPoint:function(e,t,r){return S(e,t,r)?r:((0,c.oC)(t,v(e),r),N(e,r,r))},closestPointOnSilhouette:F,containsPoint:G,copy:b,create:_,distanceToSilhouette:function(e,t){let r=(0,s.d)(m.rq.get(),t,v(e));return Math.sqrt(Math.abs((0,s.k)(r)-e[3]*e[3]))},elevate:function(e,t,r){return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=e[3]+t,r},equals:y,exactEquals:p,fromCenterAndRadius:x,fromRadius:function(e,t){return e[0]=e[1]=e[2]=0,e[3]=t,e},fromValues:T,getCenter:v,getExtent:function(e,t){return t},getRadius:w,intersectLine:R,intersectRay:S,intersectRayClosestSilhouette:function(e,t,r){if(S(e,t,r))return r;let n=F(e,t,m.rq.get());return(0,s.g)(r,t.origin,(0,s.h)(m.rq.get(),t.direction,(0,s.j)(t.origin,n)/(0,s.l)(t.direction))),r},intersectsRay:C,projectPoint:N,setAltitudeAt:function(e,t,r,n){let i=k(e,t),a=P(e,t,d._.Z,L),o=(0,s.h)(L,a,r-i);return(0,s.g)(n,t,o)},setExtent:function(e,t,r){return e!==r&&b(e,r),r},tmpSphere:D,union:function(e,t,r=(0,l.vt)()){let n=(0,s.j)(v(e),v(t)),i=e[3],a=t[3];return n+a<i?(0,o.c)(r,e):n+i<a?(0,o.c)(r,t):((0,s.m)(r,v(e),v(t),(n+a-i)/(2*n)),r[3]=(n+i+a)/2),r},wrap:I},Symbol.toStringTag,{value:"Module"}))},9892:(e,t,r)=>{r.d(t,{F:()=>s}),r(65111);var n=r(91463),i=r(86835);function s(e,t,r,n,s){return!(null==t||null==n||e.length<2)&&(a.x=e[0],a.y=e[1],a.z=e[2],a.spatialReference=t,(0,i.g)(a,r,n,s))}let a=(0,r(40838).T)(0,0,0,n.A.WGS84)},11506:(e,t,r)=>{function n(e,t){return e?t?4:3:t?3:2}function i(e,t,r,i){if(!t?.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);let s=e.coords,a=[],o=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:l,coords:u}=t,d=n(r,i),c=0;for(let e of l){let t=function(e,t,r,i,s,a){let o=n(s,a),l=r,u=r+o,d=0,c=0,h=0,f=0,m=0;for(let r=0,n=i-1;r<n;r++,l+=o,u+=o){let r=t[l],n=t[l+1],i=t[l+2],a=t[u],o=t[u+1],g=t[u+2],_=r*o-a*n;f+=_,d+=(r+a)*_,c+=(n+o)*_,s&&(_=r*g-a*i,h+=(i+g)*_,m+=_),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),n<e[2]&&(e[2]=n),n>e[3]&&(e[3]=n),s&&(i<e[4]&&(e[4]=i),i>e[5]&&(e[5]=i))}if(f>0&&(f*=-1),m>0&&(m*=-1),!f)return null;let g=[d,c,.5*f];return s&&(g[3]=h,g[4]=.5*m),g}(o,u,c,e,r,i);t&&a.push(t),c+=e*d}if(a.sort((e,t)=>{let n=e[2]-t[2];return 0===n&&r&&(n=e[4]-t[4]),n}),a.length){let e=6*a[0][2];s[0]=a[0][0]/e,s[1]=a[0][1]/e,r&&(e=6*a[0][4],s[2]=0!==e?a[0][3]/e:0),(s[0]<o[0]||s[0]>o[1]||s[1]<o[2]||s[1]>o[3]||r&&(s[2]<o[4]||s[2]>o[5]))&&(s.length=0)}if(!s.length){let e=t.lengths[0]?function(e,t,r,i,s){let a=n(i,s),o=0,l=t+a,u=0,d=0,c=0,h=0;for(let t=0,n=r-1;t<n;t++,o+=a,l+=a){var f,m,g,_,p;let t=e[o],r=e[o+1],n=e[o+2],s=e[l],a=e[l+1],y=e[l+2],b=i?function(e,t,r,n,i,s){let a=n-e,o=i-t,l=s-r;return Math.sqrt(a*a+o*o+l*l)}(t,r,n,s,a,y):function(e,t,r,n){let i=r-e,s=n-t;return Math.sqrt(i*i+s*s)}(t,r,s,a);if(b)if(u+=b,i){let e=[(f=t)+.5*(s-f),(m=r)+.5*(a-m),(g=n)+.5*(y-g)];d+=b*e[0],c+=b*e[1],h+=b*e[2]}else{let e=[(_=t)+.5*(s-_),(p=r)+.5*(a-p)];d+=b*e[0],c+=b*e[1]}}return u>0?i?[d/u,c/u,h/u]:[d/u,c/u]:r>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}(u,0,l[0],r,i):null;if(!e)return null;s[0]=e[0],s[1]=e[1],r&&e.length>2&&(s[2]=e[2])}return e}r.d(t,{Q:()=>i})},15853:(e,t,r)=>{r.r(t),r.d(t,{default:()=>eK});var n=r(81856),i=r(74652),s=r(92753),a=r(45257),o=r(91838),l=r(57845);r(61939),r(33638);var u=r(12709),d=r(61414),c=r(65111),h=r(91463),f=r(41359),m=r(86099),g=r(28690),_=r(31461),p=r(69358),y=r(22303),b=r(84766);let x=class extends g.A{constructor(e){super(e),this._updatingCount=0,this._tileHandles=new p.A,this._wanted=new p.A}destroy(){for(let e of this._tileHandles.values())e.abort();this._tileHandles.clear(),this._wanted.clear()}get updating(){return this._updatingCount>0}get _boundingRect(){let{extent:e}=this;return null==e?null:(0,b.VY)(e)}get _missingTiles(){let e=[],t=this._wanted;for(let r of this._tileHandles.values())t.has(r.id)&&!v(r)&&e.push(r);return e}async onTileTreeChange(e){++this._updatingCount;try{let{added:t,removed:r}=e,n=this._tileHandles,{_boundingRect:i}=this,s=null!=i?t.filter(e=>(0,b.HY)(i,e.extent)):t,a=this._wanted,o=[];for(let e of r){let{id:r}=e;if(a.delete(r),t.some(t=>I(t,e)||I(e,t)))continue;let i=n.get(r);null!=i&&o.push(this._removeTile(i))}for(let e of s)a.set(e.id,e),o.push(this._addTile(e));await Promise.allSettled(o)}finally{--this._updatingCount}}async _removeTile(e){this._tileHandles.delete(e.id),e.abort(),this._validate();let{tile:t}=e,r=new T(e.untilSettled(),null!=t?this.createRemoveTileCommand(t):null);e.nextEvent=null;let{command:n}=await r.getCommand();n?.execute()}async _addTile(e){let{_tileHandles:t}=this,r=t.get(e.id);if(null!=r)return!v(r)||r.tile.isComplete||(r.tile=r.tile.reset(),r.nextEvent=this._onTileLoad(r)),void await r.untilSettled();let n=new w(e);this._tileHandles.set(n.id,n);let i=this.loadTile(e,n.signal);n.nextEvent=i;let a=await i;if(n.aborted)throw(0,s.NK)();n.tile=a,function(e){if(!v(e))throw Error()}(n),n.nextEvent=this._onTileLoad(n),await n.untilSettled()}async _onTileLoad(e){let{_wanted:t,_tileHandles:r,_missingTiles:n}=this,i=e.descriptor,s=[],a=[],o=new Set;for(let l of r.values()){if(l===e)continue;let{descriptor:u,id:d}=l;if(t.has(d)||n.some(({descriptor:e})=>I(e,u)||I(u,e))){if(v(l)){if(I(i,u))for(let e of l.tile.objectIds())o.add(e);if(I(u,i)){let t=new Set(e.tile.objectIds()),r=l.tile,n=r.exclude(t);l.tile=n;let i=AbortSignal.any([l.signal,e.signal]),o=l.untilSettled();s.push(new T(o,this.createRemoveTileCommand(r))),s.push(new T(o,this.createAddTileCommand(n,i),i)),a.push(l),this._validateRemoval(n,t)}}}else{l.abort(),r.delete(d);let{tile:e}=l;null!=e&&s.push(new T(l.untilSettled(),this.createRemoveTileCommand(e))),l.nextEvent=null}}o.size>0&&(e.tile=e.tile.exclude(o),this._validateRemoval(e.tile,o)),s.push(new T(e.untilSettled(),this.createAddTileCommand(e.tile,e.signal),e.signal)),a.push(e),this._validate();let l=this._joinCommands(s);for(let e of a)e.nextEvent=l;await l}async _joinCommands(e){let t=(await Promise.allSettled(e.map(async e=>e.getCommand()))).map(e=>"fulfilled"!==e.status||e.value.signal?.aborted?null:e.value.command).filter(_.Ru);0!==t.length&&t.reduce((e,t)=>(e.append(t),e)).execute()}_validate(){if(!(0,l.A)("feature-pipeline-3d-test-validation"))return;let e=[];for(let t of this._tileHandles.values()){if(!v(t))continue;let{tile:r}=t,n=new Uint32Array(r.featureCount);r.readObjectIds(n),e.push({tile:r,objectIds:new Set(n)})}for(let t=0;t<e.length;++t){let{tile:r,objectIds:n}=e[t];for(let i=t+1;i<e.length;++i){let{tile:t,objectIds:s}=e[i];for(let e of s)if(n.has(e)){let n=I(t.descriptor,r.descriptor),i=I(r.descriptor,t.descriptor);throw Error(`${r.descriptor.id} and ${t.descriptor.id} both contain ${e}. aInB: ${n}; bInA: ${i}`)}}}}_validateRemoval(e,t){if((0,l.A)("feature-pipeline-3d-test-validation")){for(let r of e.objectIds())if(t.has(r))throw Error(`Failed to remove ${r} from ${e.descriptor.id}!`)}}};function I({lij:[e,t,r]},{lij:[n,i,s]}){let a=n-e;return a>=0&&t===i>>a&&r===s>>a}(0,n._)([(0,o.MZ)()],x.prototype,"updating",null),(0,n._)([(0,o.MZ)({constructOnly:!0})],x.prototype,"loadTile",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],x.prototype,"createAddTileCommand",void 0),(0,n._)([(0,o.MZ)({constructOnly:!0})],x.prototype,"createRemoveTileCommand",void 0),(0,n._)([(0,o.MZ)()],x.prototype,"_updatingCount",void 0),(0,n._)([(0,o.MZ)()],x.prototype,"extent",void 0),(0,n._)([(0,o.MZ)()],x.prototype,"_boundingRect",null),(0,n._)([(0,o.MZ)()],x.prototype,"_missingTiles",null),x=(0,n._)([(0,u.$)("esri.views.3d.layers.graphics.pipeline.Tile3DManager")],x);class w{constructor(e){this.descriptor=e,this._controller=new AbortController,this._tile=(0,y.v)(null),this.nextEvent=null}get id(){return this.descriptor.id}get tile(){return this._tile.value}set tile(e){this._tile.value=e}get signal(){return this._controller.signal}abort(){this._controller.abort()}get aborted(){return this._controller.signal.aborted}async untilSettled(){try{await this.nextEvent}catch(e){(0,s.zf)(e)||console.error(e)}}}function v(e){return null!=e.tile}class T{constructor(e,t,r){this.previousEventSettled=e,this.commandPromise=t,this.signal=r}async getCommand(){let{previousEventSettled:e,commandPromise:t,signal:r}=this,[n]=await Promise.all([t,e]);if(r?.aborted)throw(0,s.NK)();return{command:n,signal:r}}}var S=r(94264);class R{constructor(e,t){this.tile=e,this._tileIndices=t}get id(){return this.tile.id}get featureCount(){return this._tileIndices?.length??this.tile.featureCount}get usedMemory(){return S.qK+(this._tileIndices?.byteLength??0)}get extent(){return this.tile.descriptor.extent}readObjectIds(e,t){let{_tileIndices:r,tile:n}=this;return n.readObjectIds(e,r,t)}readCoordinates(e,t){let{_tileIndices:r,tile:n}=this;return n.readCoordinates(e,r,t)}subset(e){let{_tileIndices:t,tile:r}=this;if(null==t)return new R(r,e);let n=new Uint32Array(e.length);for(let r=0;r<n.length;++r)n[r]=t[e[r]];return new R(r,n)}}class M{constructor(){this._tileToFeatureData=new Map}add(e){this._tileToFeatureData.set(e.tile,e)}remove(e){this._tileToFeatureData.delete(e)}get(e){return this._tileToFeatureData.get(e)}}var A=r(2370),E=r(11506),C=r(56599);class F{constructor(e,t){this._index=e,this._view=t}get usedMemory(){return S.qK+S.RS}getObjectId(){return this._view.getObjectId(this._index)}getAttribute(e){return this._view.getAttribute(this._index,e)}getAttributeAsTimestamp(e){return this._view.getAttributeAsTimestamp(this._index,e)}getAttributes(){return this._view.getAttributes(this._index)}getOptimizedGeometry(){return this._view.getOptimizedGeometry(this._index)}getCentroid(e){return this._view.getCentroid(this._index,e)}getBounds(){return this._view.getBounds(this._index)}getBoundingBox(){return this._view.getBoundingBox(this._index)}cloneWithGeometry(e){return new N(this._index,this._view,e)}}class N extends F{constructor(e,t,r){super(e,t),this._geometryOverride=r}getOptimizedGeometry(){return this._geometryOverride}getCentroid(e){return(0,E.Q)(new C.A,this._geometryOverride,e.hasZ,e.hasM)}}class O{constructor(){this._tileBounds=new Map,this.events=new i.A,this.featureAdapter=B.shared}get usedMemory(){return S.qK+S.qK*this._tileBounds.size}addTile(e){let{featureCount:t}=e;if(0===t)return;let r=new A.w(9,t=>e.getBounds(t)),n=[];for(let e=0;e<t;++e)n[e]=e;r.load(n),this._tileBounds.set(e,r),this.events.emit("changed")}removeTile(e){this._tileBounds.delete(e),this.events.emit("changed")}clear(){this._tileBounds.clear(),this.events.emit("changed")}forEach(e){for(let[t,r]of this._tileBounds)r.all(r=>e(new F(r,t)))}forEachInBounds(e,t){for(let[r,n]of(P.minX=e[0],P.minY=e[1],P.maxX=e[2],P.maxY=e[3],this._tileBounds))n.search(P,e=>t(new F(e,r)))}forEachBounds(e,t){for(let r of e)t(r.getBoundingBox())}getFullExtent(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(let e of this._tileBounds.values()){let{minX:s,minY:a,maxX:o,maxY:l}=e.toJSON();t=Math.min(t,s),r=Math.min(r,a),n=Math.min(n,o),i=Math.min(i,l)}return{xmin:t,ymin:r,xmax:n,ymax:i,spatialReference:e}}}class B{getObjectId(e){return e.getObjectId()}getAttribute(e,t){return e.getAttribute(t)}getAttributeAsTimestamp(e,t){return e.getAttributeAsTimestamp(t)}getAttributes(e){return e.getAttributes()}getGeometry(e){return e.getOptimizedGeometry()}getCentroid(e,t){return e.getCentroid(t)}cloneWithGeometry(e,t){return e.cloneWithGeometry(t)}}B.shared=new B;let P=new A.E;var k=r(79136);class G{constructor(e,t,r=function(e){let t=e.reduce((e,{featureCount:t})=>e+t,0),r=[];if(0===t)return r;let n=e[0].featureCount;for(let e=0;e<t;++e)r[2*e]=Math.floor(e/n),r[2*e+1]=e%n;return r}(t)){this.descriptor=e,this._pages=t,this._addressTable=r;let n=S.ez+t.reduce((e,{usedMemory:t})=>e+t,0),i=3*S.RS,s=(0,S.Qf)(r);this.usedMemory=S.qK+n+i+s,this.featureCount=Math.floor(this._addressTable.length/2),this.isComplete=this.featureCount===t.reduce((e,t)=>e+t.featureCount,0)}get id(){return this.descriptor.id}getObjectId(e){let{pageIndex:t,featurePageIndex:r}=this._translateIndex(e);return this._pages[t].getObjectId(r)}getAttribute(e,t){let{pageIndex:r,featurePageIndex:n}=this._translateIndex(e);return this._pages[r].getAttribute(n,t)}getAttributeAsTimestamp(e,t){let{pageIndex:r,featurePageIndex:n}=this._translateIndex(e);return this._pages[r].getAttributeAsTimestamp(n,t)}getAttributes(e){let{pageIndex:t,featurePageIndex:r}=this._translateIndex(e);return this._pages[t].getAttributes(r)}getCoordinates(e,t,r){let{pageIndex:n,featurePageIndex:i}=this._translateIndex(e);this._pages[n].getCoordinates(i,t,r)}getOptimizedGeometry(e){let{pageIndex:t,featurePageIndex:r}=this._translateIndex(e);return this._pages[t].getOptimizedGeometry(r)}getCentroid(e,t){let{pageIndex:r,featurePageIndex:n}=this._translateIndex(e);return this._pages[r].getCentroid(n,t)}getBounds(e){let{pageIndex:t,featurePageIndex:r}=this._translateIndex(e);return this._pages[t].getBounds(r)}getBoundingBox(e){let{pageIndex:t,featurePageIndex:r}=this._translateIndex(e);return this._pages[t].getBoundingBox(r)}readObjectIds(e,t=this._allFeatureIndices(),r=0){let n=r;for(let{page:r,indices:i}of this._batchPageIndices(t))n=r.readObjectIds(e,i,n);return n}readCoordinates(e,t=this._allFeatureIndices(),r=0){let n=r;for(let{page:r,indices:i}of this._batchPageIndices(t))n=r.readCoordinates(e,i,n);return n}*objectIds(e=this._allFeatureIndices()){for(let{page:t,indices:r}of this._batchPageIndices(e))for(let e of t.objectIds(r))yield e}exclude(e){if(0===e.size)return this;let{_addressTable:t,featureCount:r}=this,n=[];for(let i=0;i<r;++i){let r=this.getObjectId(i);e.has(r)||(n.push(t[2*i]),n.push(t[2*i+1]))}return new G(this.descriptor,this._pages,n)}reset(){let{isComplete:e,_pages:t}=this;return e?this:new G(this.descriptor,t)}*_allFeatureIndices(){let{featureCount:e}=this;for(let t=0;t<e;++t)yield t}_translateIndex(e){let{_addressTable:t}=this;return{pageIndex:t[2*e],featurePageIndex:t[2*e+1]}}*_batchPageIndices(e){let t=[];{let r=0,n=[];for(let i of e){let{pageIndex:e,featurePageIndex:s}=this._translateIndex(i);r!==e&&(0!==n.length&&t.push({pageIndex:r,indices:n}),r=e,n=[]),n.push(s)}0!==n.length&&t.push({pageIndex:r,indices:n})}let{_pages:r}=this;for(let{pageIndex:e,indices:n}of t)yield{page:r[e],indices:n}}}var L=r(32391),D=r(36365),U=r(56911),q=r(42845),V=r(99572),j=r(47823),z=r(65642);class Y{constructor(e){this._reader=new D.A(new Uint8Array(e),new DataView(e)),this._index=function(e){for(;e.next();){if(2===e.tag()){for(var t=e.getMessage();t.next();){if(1===t.tag())return function(e){let t,r,n=!1,i=!1,s=0,a=[],o=[],l=[];for(;e.next();)switch(e.tag()){case 1:r=e.getString();break;case 7:0!==e.getEnum()&&Z();break;case 9:n=e.getBool()??!1;break;case 12:t=(0,V.Q1)(e.processMessage(z.ae));break;case 13:{let t=e.processMessage(z.cn);t.index=s++,a.push(t);break}case 15:{o.push(e.pos());let t=e.getUInt32(),r=e.pos()+t;for(;e.pos()<r&&e.next();)1===e.tag()&&l.push(e.pos()),e.skip();break}case 10:i=e.getBool()??!1;break;default:e.skip()}let u=new j.A(a);return null!=t&&i&&null!=r&&u.has(r)||Z(),{transform:t,exceededTransferLimit:n,fieldsIndex:u,objectIdFieldName:r,featureIndices:o,attributeIndices:l}}(t.getMessage());t.skip()}Z();return}e.skip()}Z()}(this._reader)}get featureCount(){return this._index.featureIndices.length}get exceededTransferLimit(){return this._index.exceededTransferLimit}get usedMemory(){return this._reader.usedMemory}getObjectId(e){return this.getAttribute(e,this._index.objectIdFieldName)}getAttribute(e,t){let{_index:{fieldsIndex:r,attributeIndices:n}}=this,i=r.get(t)?.index;if(null==i)return;let s=n[e*r.fields.length+i],a=this._reader;return a.move(s),$(a)}getAttributeAsTimestamp(e,t){let r=this.getAttribute(e,t);return"string"==typeof r?new Date(r).getTime():"number"==typeof r||null==r?r:null}getAttributes(e){let{_index:{fieldsIndex:t,attributeIndices:r}}=this,n=e*t.fields.length,i=this._reader,s={};for(let e of t.fields){let t=r[n+e.index];i.move(t),s[e.name]=$(i)}return s}getCoordinates(e,t,r=0){let n=this._reader,{transform:i,featureIndices:s}=this._index,{scale:a,translate:o}=i;n.move(s[e]),this._readCoordinates(a,o,t,r)}getOptimizedGeometry(e){let t=(0,U.vt)();return this.getCoordinates(e,t),new C.A([],t)}getCentroid(e,{hasZ:t,hasM:r}){this.getCoordinates(e,X);let[n,i,s]=X,a=[n,i];return t&&(a[3]=s),r&&(a[t?4:3]=0),new C.A([],a)}getBounds(e){this.getCoordinates(e,X);let[t,r]=X,n=new A.E;return n.minX=t,n.minY=r,n.maxX=t,n.maxY=r,n}getBoundingBox(e){this.getCoordinates(e,X);let[t,r,n]=X;return(0,q.fA)(t,r,n,t,r,n)}readObjectIds(e,t=this._allFeatureIndices(),r=0){let n=this._reader,{objectIdFieldName:i,attributeIndices:s,fieldsIndex:a}=this._index,o=a.get(i).index,l=a.fields.length;for(let i of t){let t=s[i*l+o];n.move(t),e[r++]=$(n)}return r}readCoordinates(e,t=this._allFeatureIndices(),r=0){let n=this._reader,{transform:i,featureIndices:s}=this._index,{scale:a,translate:o}=i;for(let i of t){let t=s[i];n.move(t),r=this._readCoordinates(a,o,e,r)}return r}*objectIds(e=this._allFeatureIndices()){let t=this._reader,{objectIdFieldName:r,attributeIndices:n,fieldsIndex:i}=this._index,s=i.get(r).index,a=i.fields.length;for(let r of e){let e=n[r*a+s];t.move(e),yield $(t)}}*_allFeatureIndices(){let{featureCount:e}=this;for(let t=0;t<e;++t)yield t}_readCoordinates([e,t,r],[n,i,s],a,o){let l=this._reader,u=l.getLength(),d=l.pos()+u;for(;l.pos()<d&&l.next();)if(2===l.tag()){let u=l.getLength(),d=l.pos()+u;for(;l.pos()<d&&l.next();)3===l.tag()?(l.getUInt32(),a[o++]=n+e*l.getSInt64(),a[o++]=i+t*l.getSInt64(),a[o++]=s+r*l.getSInt64()):l.skip()}else l.skip();return o}}function Z(){let e=new L.A("pbf-parsing-failed","Error while parsing PBF",Error());throw console.error(e),e}function $(e){let t=e.getLength(),r=e.pos()+t;for(;e.pos()<r&&e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}let X=(0,U.vt)();class W{constructor(e,t,r,n,i){this.spatialReference=e,this.url=r,this.objectIdField=n,this.capabilities=i;let{supportsMaxRecordCountFactor:s,maxRecordCount:a}=this.capabilities.query,o=s?4:1,l=(a??8e3)*o;this._pageSize=Math.min(8e3,l);let u=t.clone();u.cacheHint=!0,u.resultType="tile",u.outSpatialReference=e,u.returnGeometry=!0,u.returnZ=!0,u.maxRecordCountFactor=o,u.num=this._pageSize,u.outFields=[n],this._baseQuery=u}async fetch(e,t){let{spatialReference:r}=this,n=(0,b.w1)(e.extent,r),i=this._baseQuery.clone();i.geometry=n;let a=[],o=0,l=!1,u=1;for(;!l;){let e=[];for(let r=0;r<u;++r)e.push(this._fetchPage(i,o++,t));let r=await Promise.all(e);for(let e of((0,s.Te)(t),r)){let t=0!==e.featureCount;l||=!e.exceededTransferLimit||!t,t&&a.push(e)}u=Math.min(u+1,4)}return new G(e,a)}async _fetchPage(e,t,r){let n=e.clone();n.start=t*this._pageSize;let i=(await (0,k.kS)(this.url,n,{signal:r})).data;return(0,s.Te)(r),new Y(i)}}var H=r(10954),Q=r(95775),J=r(19158),K=r(40941),ee=r(44120),et=r(76397),er=r(26434),en=r(4538),ei=r(15529),es=r(7332),ea=r(22045),eo=r(16669);class el extends eo.gy{constructor(e=(0,U.vt)()){super(),this.origin=e}get slicePlaneLocalOrigin(){return this.origin}}let eu=class extends ei.RW{constructor(e){super(e),this._glMaterials=null,this._produces=new Map,this._renderGeometries=new Map,this._vaoCache=null,this._drawParameters=new el,this._bufferWriter=null}get produces(){return this._produces}get numFeatures(){let e=0;return this._renderGeometries.forEach(t=>e+=t.numElements/6),e}get usedMemory(){let e=0;return this._renderGeometries.forEach(t=>{e+=t.vao.usedMemory}),e}initialize(){this._bufferWriter=this.material.createBufferWriter(),this.material.produces.forEach((e,t)=>{this._produces.set(t,t=>t!==en.V.Highlight&&t!==en.V.ShadowHighlight&&e(t))})}destroy(){for(let e of(this._glMaterials.dispose(),this._renderGeometries.keys()))this.removeRenderGeometry(e)}acquireTechniques(e){let t=this.material;if(!t.shouldRender(e))return null;let{output:r,bind:n}=e,i=t.produces.get(n.slot);if(!i?.(r)||r===en.V.Highlight||r===en.V.ShadowHighlight)return null;let s=this._glMaterials.load(e.rctx,n.slot,r);return s?.beginSlot(n)}render(e,t){let r=this._renderGeometries;if(0===r.size)return;let{bind:n}=e,i=n.slot===ea.N.OCCLUDER_MATERIAL||n.slot===ea.N.TRANSPARENT_OCCLUDER_MATERIAL?n.slot:null,s=e.rctx;s.runAppleAmdDriverHelper(),s.bindTechnique(t,n,this.material.parameters);let a=t.program;for(let[e,o]of r)this._drawParameters.origin=o.localOrigin,a.bindDraw(n,this.material.parameters,this._drawParameters),t.ensureAttributeLocations(o.vao),s.bindVAO(o.vao),s.setPipelineState(t.getPipeline(!1,i)),s.drawArrays(t.primitiveType,0,o.numElements)}initializeRenderContext(e,t){this._glMaterials=new es.c(this.material,e.materials),this._vaoCache=e.renderContext.rctx.getVaoCache(this.material.vertexAttributeLocations,(0,er.U)(this._bufferWriter.vertexBufferLayout))}uninitializeRenderContext(){}addRenderGeometry(e,t,r){this.removeRenderGeometry(e);let n=this._vaoCache.newVao(t.data.byteLength);n.vertexBuffers.get("geometry").setSubData(new Uint8Array(t.data),0,0,t.data.byteLength);let i={localOrigin:r,vao:n,numElements:t.elementCount};return this._renderGeometries.set(e,i),i}removeRenderGeometry(e){let t=this._renderGeometries.get(e);null!=t&&(this._vaoCache.deleteVao(t.vao),this._renderGeometries.delete(e))}hasHighlightOptions(e){return!1}};(0,n._)([(0,o.MZ)({constructOnly:!0})],eu.prototype,"material",void 0),eu=(0,n._)([(0,u.$)("esri.views.3d.layers.graphics.pipeline.rendering.DirectRenderer")],eu);var ed=r(53041),ec=r(93873),eh=r(72977);let ef=class{constructor(e){this._optionalFields=[],this._featureIdToInstanceIndex=new Map,this._disposeResourceHandles=[],this._lodRendererResources=null,this.layerUid=e.layerUid,this.view=e.view,this.sharedResources=this.view.sharedSymbolResources,this.scheduler=this.view.resourceController.scheduler}get numFeatures(){return this._featureIdToInstanceIndex.size}get usedMemory(){let e=this._lodRendererResources?.lodRenderer,t=e?.symbol;return(t?.computeUsedMemory()??0)+16*this._featureIdToInstanceIndex.size}destroy(){this._disposeResourceHandles.forEach(e=>e())}async doLoad(e,t,r){(0,l.A)("enable-feature:objectAndLayerId-rendering")&&this._optionalFields.push(ed.r.OBJECTANDLAYERIDCOLOR);let n=function(e,t){let r=t.levels.map(t=>{let r=t.components.map(t=>{var r;let n=e(t.materialId);if(!(null!=(r=n)&&"materialType"in r&&"default"===r.materialType))throw Error("LodRenderer only supports DefaultMaterial");let i=new eh.Rn(n,t.renderGeometryBuffer.data,t.renderGeometryBuffer.elementCount,t.boundingInfo);return new eh.iC(i)});return new eh.hr(r,t.minScreenSpaceRadius)});return new eh.Fe(r)}(e=>t(e),e),i=this.view._stage,a=n.getMaterials();i.addMany(a),this._addDisposeResource(()=>i.removeMany(a));let o=n.getTextures();i.addMany(o),this._addDisposeResource(()=>{o.forEach(e=>e.unload()),i.removeMany(o)}),await Promise.all(o.map(e=>this.view._stage.schedule(()=>e.load(i.renderView.renderingContext),r))),(0,s.Te)(r);let u=await this._createLodRenderer(n,r);this._lodRendererResources={lodRenderer:u,materials:a,textures:o}}addInstances(e){let t=this._lodRendererResources;if(null==t)return;let{featureIds:r,localTransforms:n,globalTransforms:i}=e,s=t.lodRenderer;if(null==s)return;let a=s.instanceData,o=r.length;for(let e=0;e<o;++e){let t=r[e],s=a.addInstance(),o=a.view,l=16*e;o.localTransform.copyFromTypedBuffer(s,n,l),o.globalTransform.copyFromTypedBuffer(s,i,l),a.updateModelTransform(s),a.setVisible(s,!0),this._featureIdToInstanceIndex.set(t,s)}}removeInstances(e){let t=this._lodRendererResources;if(null==t)return;let r=t.lodRenderer.instanceData,n=this._featureIdToInstanceIndex,i=e.length;for(let t=0;t<i;++t){let i=e[t],s=n.get(i);null!=s&&(r.removeInstance(s),n.delete(i))}}_addDisposeResource(e){this._disposeResourceHandles.push(e)}async _createLodRenderer(e,t){let r=this.view._stage,n={layerUid:this.layerUid,graphicUid:e=>1,notifyGraphicGeometryChanged:e=>1,notifyGraphicVisibilityChanged:e=>1},i=new ec.L({symbol:e,optionalFields:this._optionalFields,metadata:n,shaderTransformation:null},this.scheduler);return i.slicePlaneEnabled=!1,this._addDisposeResource(()=>{r.removeRenderPlugin(i),i.destroy()}),await r.addRenderPlugin(i,t),i}};ef=(0,n._)([(0,u.$)("esri.views.3d.layers.graphics.pipeline.rendering.LodRenderer")],ef);var em=r(26928),eg=r(18189),e_=r(82243),ep=r(92057),ey=r(87903);let eb=class extends g.A{constructor(e){super(),this.view=null,this.layerUid=null,this._renderGeometries=new Map,this._materials=new Map,this._directRenderers=new Map,this._lodRenderers=new Map,this.totalFeatures=0,this.view=e.view,this.layerUid=e.layerUid}initialize(){}destroy(){this.removeAllHandles(),this._lodRenderers.forEach(e=>e.destroy())}async executeRenderCommands(e){for(let t of e)switch(t.id){case"create-material":await this._createMaterial(t);break;case"create-direct-renderer":await this._createDirectRenderer(t);break;case"add-direct-renderer-geometry":await this._addDirectRendererGeometry(t),this._updateFeatureCount();break;case"remove-direct-renderer-geometry":await this._removeDirectRendererGeometry(t),this._updateFeatureCount();break;case"create-lod-renderer":await this._createLodRenderer(t);break;case"add-lod-instances":await this._addLodInstances(t),this._updateFeatureCount();break;case"remove-lod-instances":await this._removeLodInstances(t),this._updateFeatureCount()}}_updateFeatureCount(){let e=0;for(let t of this._directRenderers.values())e+=t.numFeatures;for(let t of this._lodRenderers.values())e+=t.numFeatures;this._set("totalFeatures",e)}get usedMemory(){let e=0;for(let t of this._directRenderers.values())e+=t.usedMemory;for(let t of this._lodRenderers.values())e+=t.usedMemory;return e}async _createMaterial(e){let{view:t}=this,{sharedSymbolResources:r}=t;if(null==r)throw Error("No shared symbol resources found!");let{textures:n}=r,i=t.state.viewingMode===H.RT.Global,s=null;switch(e.type){case"default":s=function(e,t,r){let n={usePBR:t.physicalBasedRenderingEnabled,isSchematic:!0,mrrFactors:ey.Bt,ambient:U.Un,diffuse:U.Un,hasSlicePlane:t.slicePlaneEnabled,castShadows:t.castShadows,offsetTransparentBackfaces:!t.isPrimitive};return function(e){let t=e.opacity??1,r=t<1;e.transparent=r,e.opacity=t,e.cullFace=r?eg.s2.None:eg.s2.Back}(n),t.screenSizePerspectiveEnabled&&(n.screenSizePerspective=e.screenSizePerspectiveSettings),n.externalColor=ee.Un,n.isInstanced=!0,new e_.$U(n,{spherical:r,doublePrecisionRequiresObfuscation:!0})}(r,{physicalBasedRenderingEnabled:!0,slicePlaneEnabled:!1,castShadows:!0,isPrimitive:!0,screenSizePerspectiveEnabled:!0,doublePrecisionRequiresObfuscation:t._stage.renderView.renderingContext.driverTest.doublePrecisionRequiresObfuscation.result},i);break;case"hud":{let[e,t]=ex(n,i);this.addHandles([(0,J.hA)(()=>(0,K.Gz)(t))]),s=e}break;default:throw Error(`unable to create unknown material type ${e.type}`)}this._materials.set(e.materialId,s)}_getMaterial(e){return this._materials.get(e)}async _createDirectRenderer(e){let t=e.materialId,r=this._getMaterial(t);if(null==r)throw Error(`material not found ${t}`);let{view:n}=this,i=new eu({material:r});this._directRenderers.set(t,i),n._stage.addRenderPlugin(i),n._stage.renderView.renderer.updateHasFlags()}async _addDirectRendererGeometry(e){let t=e.renderGeometryId,r=e.materialId;await this._removeDirectRendererGeometry({renderGeometryId:t});let n=this._directRenderers.get(r);if(null==n)return void console.error("no renderer assigned to provided material");let i=n.addRenderGeometry(t,e.renderGeometryBuffer,e.localOrigin);this._renderGeometries.set(t,{renderGeometry:i,materialId:r}),this.view._stage.renderView.requestRender()}async _removeDirectRendererGeometry(e){let t=e.renderGeometryId,r=this._renderGeometries.get(t);if(null==r)return;let n=r.materialId,i=this._directRenderers.get(n);null!=i?i.removeRenderGeometry(e.renderGeometryId):console.error("no renderer assigned to provided material")}async _createLodRenderer(e){let t=new ef({view:this.view,layerUid:this.layerUid}),r=new AbortController;await t.doLoad(e.lodRenderGeometry,e=>this._getMaterial(e),r.signal),this._lodRenderers.set(e.lodRendererId,t)}async _addLodInstances(e){let t=this._lodRenderers.get(e.lodRendererId);if(null==t)throw Error("no lod renderer assigned to provided lod renderer Id");t.addInstances(e.data)}async _removeLodInstances(e){let t=this._lodRenderers.get(e.lodRendererId);if(null==t)throw Error("no lod renderer assigned to provided lod renderer Id");t.removeInstances(e.featureIds)}};function ex(e,t){let r={anchorPosition:et.Zd.center,occlusionTest:!0,hasSlicePlane:!1,color:[1,0,0,1],outlineColor:[0,0,0,1],outlineSize:1,distanceFieldBoundingBox:em.PY};return null!=e&&(r.textureId=e.fromData("circle-icon",()=>(0,em.sZ)("circle")).texture.id,r.textureIsSignedDistanceField=!0,r.sampleSignedDistanceFieldTexelCenter=(0,em.ny)("circle")),[new ep.R(r,t),null]}(0,n._)([(0,o.MZ)({readOnly:!0})],eb.prototype,"totalFeatures",void 0),eb=(0,n._)([(0,u.$)("esri.views.3d.layers.graphics.pipeline.rendering.FeaturePipelineRenderManager")],eb);var eI=r(40998),ew=r(38715);class ev{constructor(e){this._bufferWriter=null,this._bufferWriter=e.createBufferWriter()}createBuffer(e,t){let r=this._bufferWriter,n=null;if(e.transformation&&t)(0,eI.C)(eT,e.transformation),eT[12]-=t[0],eT[13]-=t[1],eT[14]-=t[2],n=eT;else{if(t)throw Error("not implemented");e.transformation&&(n=e.transformation)}let i=null;n&&((0,eI.B8)(eS,eT),(0,eI.mg)(eS,eS),i=eS);let s=e.attributes,a=r.elementCount(s);a>Math.floor(eR/(r.vertexBufferLayout.stride/4))&&console.warn("geometry with very large number of elements encountered");let o=r.vertexBufferLayout.createBuffer(a);return r.write(n,i,s,e.objectAndLayerIdColor,o,0),{data:o.buffer,elementCount:a}}}let eT=(0,ew.vt)(),eS=(0,ew.vt)(),eR=4194304;var eM=r(40389);class eA{constructor(e){this._context=e,this._commands=[],this._transferables=new Set}createMaterial(e){let t=this._context,r=t.generateId("material");switch(e){case"default":{let e=new ev(new e_.$U({},{spherical:this._context.globalViewingMode,doublePrecisionRequiresObfuscation:!0}));t.registerRenderGeometryBufferWriter(r,e)}break;case"hud":{let e=new ev(ex(null,this._context.globalViewingMode)[0]);t.registerRenderGeometryBufferWriter(r,e)}}return this._commands.push({id:"create-material",type:e,materialId:r}),r}createDirectRenderer(e){let t=this._context.generateId("material-renderer");return this._commands.push({id:"create-direct-renderer",materialRendererId:t,materialId:e}),t}addDirectRendererGeometry(e,t,r){let n=t.materialId,i=this._context.getRenderGeometryBufferWriter(n);if(null==i)throw Error(`no bufferwriter found for material ${n}`);let s=i.createBuffer(t,r);this._transferables.add(s.data),this._commands.push({id:"add-direct-renderer-geometry",renderGeometryId:e,materialId:n,renderGeometryBuffer:s,localOrigin:r})}removeDirectRendererGeometry(e){this._commands.push({id:"remove-direct-renderer-geometry",renderGeometryId:e})}createLodRenderer(e){let t=this._context.generateId("lod-renderer"),r={levels:e.levels.map(e=>({components:e.components.map(e=>{let t=e.attributes.get(ed.r.POSITION);if(!t||0===t.indices.length)throw Error("positions attribute expected");let r=(0,Q.tM)(t.indices.length/3),n=new eM.j(r,3,t),i=this._context.getRenderGeometryBufferWriter(e.materialId);if(null==i)throw Error("writer not found");let s=i.createBuffer(e,null);return this._transferables.add(s.data),{materialId:e.materialId,renderGeometryBuffer:s,boundingInfo:{bbMax:n.bbMax,bbMin:n.bbMin}}}),minScreenSpaceRadius:e.minScreenSpaceRadius}))};return this._commands.push({id:"create-lod-renderer",lodRendererId:t,lodRenderGeometry:r}),t}addLodInstances(e,t){this._commands.push({id:"add-lod-instances",lodRendererId:e,data:t}),this._transferables.add(t.featureIds.buffer),this._transferables.add(t.globalTransforms.buffer),this._transferables.add(t.localTransforms.buffer)}removeLodInstances(e,t){this._commands.push({id:"remove-lod-instances",lodRendererId:e,featureIds:t}),this._transferables.add(t.buffer)}append(e){if(e._context!==this._context)throw Error("Cannot append encoders from different contexts");let{_commands:t,_transferables:r}=this;for(let r of e._commands)t.push(r);for(let t of e._transferables)r.add(t)}async dispatch(){let e=this._commands,t=Array.from(this._transferables);this._clearCommandBuffer(),await this._context.dispatchRenderCommands(e,t)}_clearCommandBuffer(){this._commands=[],this._transferables.clear()}}class eE{constructor(e){this._idCounter=0,this._bufferWriters=new Map,this._dispatchRenderCommandsCallback=async()=>{},this.globalViewingMode=!1,this.globalViewingMode=e.viewingMode===H.RT.Global,this._dispatchRenderCommandsCallback=e.dispatchRenderCommandsCallback}generateId(e=""){return`${e}${this._idCounter++}`}createEncoder(){return new eA(this)}async dispatchRenderCommands(e,t){0!==e.length&&await this._dispatchRenderCommandsCallback(e,t)}registerRenderGeometryBufferWriter(e,t){this._bufferWriters.set(e,t)}getRenderGeometryBufferWriter(e){return this._bufferWriters.get(e)}}class eC{constructor(e,t){this._renderCommands=e,this._pipelineStateCommands=t}append(e){this.appendRenderCommands(e._renderCommands),this.appendPipelineStateCommands(e._pipelineStateCommands)}appendRenderCommands(e){this._renderCommands.append(e)}appendPipelineStateCommand(e){this._pipelineStateCommands.push(e)}appendPipelineStateCommands(e){let{_pipelineStateCommands:t}=this;for(let r of e)t.push(r)}execute(){for(let e of this._pipelineStateCommands)e();this._renderCommands.dispatch()}}var eF=r(70983),eN=r(9892);function eO(e,t){let{featureCount:r}=e;if(0===r)return new Uint32Array;let n=new Uint32Array(r);return e.readObjectIds(n),n}function eB(e,t){let{featureCount:r}=e;if(0===r)return new Float64Array;let n=new Float64Array(3*r);return e.readCoordinates(n),n}var eP=r(26270),ek=r(89834),eG=r(91220);function eL(e){let t=new Map;for(let[r,n]of e)t.set(r,{...n,indices:(0,Q.Dg)(n.indices)});return t}var eD=r(10240),eU=r(96319);function eq(e,t){let r=e.get(t);return r&&!r.exclusive&&(r={...r,exclusive:!0,data:(0,eD.S)(r.data)},e.set(t,r)),r}let eV=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}];class ej{constructor(e){this._context=e,this.lodRendererId=null,this._loaded=!1,this._loadingPromise=null,this._primitive="cone"}get loaded(){return this._loaded}load(){return null==this._loadingPromise&&(this._loadingPromise=this._load()),this._loadingPromise}async _load(){let e=this._context.renderCommandContext.createEncoder(),t=e.createMaterial("default"),r=function(e,t){switch(e){case"cone":return((e,r,n=!1)=>({levels:e.map(e=>{let i=eL(r(e.tesselation));return n&&function(e){let t=e.get(ed.r.POSITION).data,r=e.get(ed.r.NORMAL).data;if(r){let t=eq(e,ed.r.NORMAL).data;for(let e=0;e<r.length;e+=3){let n=r[e+1];t[e+1]=-r[e+2],t[e+2]=n}}if(t){let r=eq(e,ed.r.POSITION).data;for(let e=0;e<t.length;e+=3){let n=t[e+1];r[e+1]=-t[e+2],r[e+2]=n}}}(i),{components:[{attributes:i,objectAndLayerIdColor:void 0,transformation:null,materialId:t}],minScreenSpaceRadius:e.minScreenSpaceRadius}})}))(eV,e=>(0,eU.YG)(1,.5,e,!1),!0);case"sphere":case"cube":case"inverted-cone":case"cylinder":case"tetrahedron":case"diamond":throw Error("not implemented");default:return}}(this._primitive,t);this.lodRendererId=e.createLodRenderer(r),await e.dispatch(),this._loaded=!0}async createAddCommand(e){let t=this._context.renderCommandContext.createEncoder();if(null==this.lodRendererId)throw Error("expected lod renderer id to not be null");let{featureCount:r}=e;if(0===r)return t;let n=(0,q.vt)((0,ek.Fq)(this._primitive)),i=(0,U.ci)((0,q.Ej)(n)),s=(0,U.ci)((0,ek.Bb)(i,{isPrimitive:!0,width:100,depth:null,height:null})),a=new Float64Array(16*r),o=new Float64Array(16*r),l=eB(e,this._context);for(let e=0;e<r;++e){let t=e,r=l[3*e+0],n=l[3*e+1],u=l[3*e+2],d=this._computeGlobalTransform(r,n,u,this._context.viewSpatialReference,eZ),c=this._computeLocalTransform(s,i,eY);this._writeMatrixToTypedBuffer(a,t,c),this._writeMatrixToTypedBuffer(o,t,d)}let u={featureIds:new Uint32Array(eO(e,this._context)),localTransforms:a,globalTransforms:o};return t.addLodInstances(this.lodRendererId,u),t}async createRemoveCommand(e){let t=this._context.renderCommandContext.createEncoder();if(null==this.lodRendererId)return t;let r=eO(e,this._context);return t.removeLodInstances(this.lodRendererId,r),t}_writeMatrixToTypedBuffer(e,t,r){let n=16*t;for(let t=0;t<16;t++)e[n++]=r[t]}_computeGlobalTransform(e,t,r,n,i){return ez[0]=e,ez[1]=t,ez[2]=r,(0,eP.l)(n,ez,i,this._context.renderSpatialReference),i}_computeLocalTransform(e,t,r){return(0,eI.D_)(r),this._applyObjectScale(e,t,r),r}_applyObjectScale(e,t,r){let n=(0,eG.pW)(e,e,t,this._context.renderCoordsHelper.unitInMeters);1===n[0]&&1===n[1]&&1===n[2]||(0,eI.hs)(r,r,n)}}let ez=(0,U.vt)(),eY=(0,ew.vt)(),eZ=(0,ew.vt)();var e$=r(4023);class eX{constructor(e){this._context=e,this.materialId=null,this._loaded=!1,this._loadingPromise=null}get loaded(){return this._loaded}load(){return null==this._loadingPromise&&(this._loadingPromise=this._load()),this._loadingPromise}async _load(){let e=this._context.renderCommandContext.createEncoder();this.materialId=e.createMaterial("hud"),e.createDirectRenderer(this.materialId),await e.dispatch(),this._loaded=!0}async createAddCommand(e){let t=this._context.renderCommandContext.createEncoder();if(null==this.materialId)throw Error("expected material not to be null");let{featureCount:r,id:n}=e;if(0===r)return t;let i=function(e,t){let{featureCount:r}=e;if(0===r)return new Float64Array;let n=eB(e),i=t.viewSpatialReference,s=t.renderSpatialReference,a=new Float64Array(3*r);if(!(0,eF.projectBuffer)(n,i,0,a,s,0,r))throw Error("Failed to project coordinates");return a}(e,this._context),s=function(e,t){let r=t.viewSpatialReference,n=t.renderSpatialReference,{extent:i}=e,s=(0,b.gX)(i),a=(0,U.vt)();return(0,eN.F)([s[0],s[1],0],r,a,n),a}(e,this._context),a=new Float64Array([0,0,1]),o=new Float64Array([255,255,255,255]),l=new Float64Array([24,24]),u=new Float64Array([0,0,0,1]),d=new Float64Array([0,0]),c=new Float64Array([0]),h=new Uint32Array(r);for(let e=0;e<r;++e)h[e]=e;let f=new Uint32Array(r);for(let e=0;e<r;++e)f[e]=0;let m=new e$.n(i,h,3,!0),g=new e$.n(a,f,3,!0),_=new e$.n(d,f,2,!0),p=new e$.n(o,f,4,!0),y=new e$.n(c,f,1,!0),x=new e$.n(l,f,2,!0),I=new e$.n(u,f,4,!0),w={attributes:eL([[ed.r.POSITION,m],[ed.r.NORMAL,g],[ed.r.UV0,_],[ed.r.COLOR,p],[ed.r.ROTATION,y],[ed.r.SIZE,x],[ed.r.CENTEROFFSETANDDISTANCE,I]]),objectAndLayerIdColor:void 0,transformation:(0,ew.vt)(),materialId:this.materialId};return t.addDirectRendererGeometry(n,w,s),t}async createRemoveCommand(e){let t=this._context.renderCommandContext.createEncoder();return t.removeDirectRendererGeometry(e.id),t}}class eW{constructor(e){this._symbols=[],this._featureDataPartitioning=new Map,this._context=e}async load(){this._symbols[0]=new eX(this._context),this._symbols[1]=new ej(this._context)}async createAddCommand(e){let t=this._partition(e),r=await Promise.all(t.map(async({index:e,features:t})=>{let r=await this._provisionSymbol(e);return await r?.createAddCommand(t)})),n=this._context.renderCommandContext.createEncoder();for(let e of r)null!=e&&n.append(e);return new eC(n,[()=>{this._featureDataPartitioning.set(e,t)}])}async createRemoveCommand(e){let{_featureDataPartitioning:t}=this,r=t.get(e),n=this._context.renderCommandContext.createEncoder();if(null==r)return new eC(this._context.renderCommandContext.createEncoder(),[]);for(let e of(await Promise.all(r.map(async({index:e,features:t})=>{let r=this._getLoadedSymbol(e);return await r?.createRemoveCommand(t)}))))null!=e&&n.append(e);return new eC(n,[()=>{t.delete(e)}])}async _provisionSymbol(e){if(null==e)return null;let t=this._symbols[e];return t?(t.loaded||await t.load(),t):null}_getLoadedSymbol(e){if(null==e)return null;let t=this._symbols[e];return null!=t&&t.loaded?t:null}_partition(e){let t=eO(e,this._context);if(null==t)throw Error("unable to fetch objectIds");let{featureCount:r}=e,n=[[],[]];for(let e=0;e<r;++e)n[t[e]%2].push(e);return n.map((t,r)=>new eH(r,e.subset(new Uint32Array(t)))).filter(e=>e.features.featureCount>0)}}class eH{constructor(e,t){this.index=e,this.features=t}}var eQ=r(78756);let eJ=class extends i.A.EventedAccessor{constructor(){super(...arguments),this.remoteClient=null,this._featureDataStore=new M,this._featureStore=new O,this._tileManager=null,this._renderer=null,this._fetcher=null,this._queryEngine=null,this._defaultQueryJSON=null}get updating(){return this._tileManager.updating}destroy(){this._featureStore.clear(),this._tileManager?.destroy()}async setup({viewSpatialReference:e,renderSpatialReference:t,viewingMode:r,baseQuery:n,url:i,objectIdField:s,capabilities:o,fieldsIndex:l,timeInfo:u,fullExtent:g}){let _=h.A.fromJSON(e),p=h.A.fromJSON(t);this._fetcher=new W(_,m.A.fromJSON(n),i,s,o),this._queryEngine=new f.do({hasZ:!0,hasM:!1,geometryType:"esriGeometryPoint",objectIdField:s,fieldsIndex:l,availableFields:[s],spatialReference:e,featureStore:this._featureStore,timeInfo:u}),this._renderer=new eW({viewSpatialReference:_,renderSpatialReference:p,renderCoordsHelper:eQ.d.create(r,p),renderCommandContext:new eE({viewingMode:r,dispatchRenderCommandsCallback:(e,t)=>this.remoteClient.invoke("dispatchRenderCommands",e,{transferList:t})})}),this._defaultQueryJSON=new m.A({outSpatialReference:_}).toJSON();let y=null;if(null!=g){let e=d.A.fromJSON(g);await (0,c.initializeProjection)(e.spatialReference,_),y=(0,c.project)(e,_)}return this._tileManager=new x({loadTile:(e,t)=>this._fetcher.fetch(e,t),createAddTileCommand:(e,t)=>this._createAddTileCommand(e,t),createRemoveTileCommand:e=>this._createRemoveTileCommand(e),extent:y}),this.addHandles((0,a.wB)(()=>this.updating,e=>{this.emit("notify-updating",{updating:e})}),a.Vh),await this._renderer.load(),e0}async executeQuery(e,t){return{result:await this._queryEngine.executeQuery(this._ensureQuery(e),t)}}async executeQueryForIds(e,t){return{result:Array.from(await this._queryEngine.executeQueryForIdSet(this._ensureQuery(e),t))}}async executeQueryForCount(e,t){return{result:await this._queryEngine.executeQueryForCount(this._ensureQuery(e),t)}}async executeQueryForExtent(e,t){return{result:await this._queryEngine.executeQueryForExtent(this._ensureQuery(e),t)}}async executeQueryForLatestObservations(e,t){return{result:await this._queryEngine.executeQueryForLatestObservations(this._ensureQuery(e),t)}}async onTileTreeChange(e){return await this._tileManager.onTileTreeChange(e),e0}async _createAddTileCommand(e,t){let r=new R(e),n=await this._renderer.createAddCommand(r);return(0,s.Te)(t),n.appendPipelineStateCommand(()=>{this._featureDataStore.add(r),this._featureStore.addTile(e)}),n}async _createRemoveTileCommand(e){let t=this._featureStore,r=this._featureDataStore,n=this._renderer,i=r.get(e);if(null==i)return null;let s=await n.createRemoveCommand(i);return s.appendPipelineStateCommand(()=>{r.remove(e),t.removeTile(e)}),s}_ensureQuery(e){return e??this._defaultQueryJSON}};(0,n._)([(0,o.MZ)()],eJ.prototype,"updating",null);let eK=eJ=(0,n._)([(0,u.$)("esri.views.3d.layers.graphics.pipeline.Feature3DPipelineWorker")],eJ),e0={result:void 0}},17656:(e,t,r)=>{r.d(t,{I:()=>i});var n=r(86075);class i{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,n.d)(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){let e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*s);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,s));e++)this._items.push(this._allocator())}}let s=1024},19474:(e,t,r)=>{r.d(t,{CK:()=>u,E9:()=>o,Hq:()=>l,MW:()=>d,TE:()=>c,yJ:()=>h});var n=r(63599),i=r(39960),s=r(76277),a=r(61102);function o(e){return null==e.origin}function l(e){return null!=e.origin}function u(e){return l(e.vertexSpace)}function d(e,t){if(!l(e))return null;let[r,n,s]=e.origin;return new i.A({x:r,y:n,z:s,spatialReference:t})}function c(e,t){var r;let{x:n,y:i,z:o,spatialReference:l}=e,u=[n,i,o??0];return"local"===(t?.vertexSpace??((r=l).isGeographic||r.isWebMercator?"local":"georeferenced"))?new a.A({origin:u}):new s.A({origin:u})}function h(e,t){return e.type===t.type&&(e.origin===t.origin||null!=e.origin&&null!=t.origin&&(0,n.p)(e.origin,t.origin))}},21893:(e,t,r)=>{r.d(t,{m:()=>i});var n=r(65642);function i(e,t){let r=(0,n.SH)(e,t),i=r.queryResult.featureResult,s=r.queryResult.queryGeometry,a=r.queryResult.queryGeometryType;if(i&&i.features&&i.features.length&&i.objectIdFieldName){let e=i.objectIdFieldName;for(let t of i.features)t.attributes&&(t.objectId=t.attributes[e])}return i&&(i.queryGeometry=s,i.queryGeometryType=a),i}},23146:(e,t,r)=>{r.d(t,{C:()=>c,Cr:()=>h,LV:()=>d,kb:()=>f,oC:()=>m,vt:()=>l}),r(31461);var n=r(17656);r(6815);var i=r(3391),s=r(63599),a=r(56911),o=r(42378);function l(e){return e?u((0,a.o8)(e.origin),(0,a.o8)(e.direction)):u((0,a.vt)(),(0,a.vt)())}function u(e,t){return{origin:e,direction:t}}function d(e,t){let r=g.get();return r.origin=e,r.direction=t,r}function c(e,t=l()){return function(e,t,r=l()){return(0,s.c)(r.origin,e),(0,s.c)(r.direction,t),r}(e.origin,e.direction,t)}function h(e,t,r=l()){return(0,s.c)(r.origin,e),(0,s.d)(r.direction,t,e),r}function f(e,t){let r=(0,s.e)(o.rq.get(),(0,s.n)(o.rq.get(),e.direction),(0,s.d)(o.rq.get(),t,e.origin));return(0,s.f)(r,r)}function m(e,t,r){let n=(0,s.f)(e.direction,(0,s.d)(r,t,e.origin));return(0,s.g)(r,e.origin,(0,s.h)(r,e.direction,n)),r}let g=new n.I(()=>l());(0,a.vt)(),(0,a.vt)(),(0,a.vt)(),(0,i.vt)()},27151:(e,t,r)=>{r.d(t,{S:()=>u,z:()=>l});var n=r(8922),i=r(71760),s=r(82795),a=r(54805),o=r(56599);let l=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class u{constructor(e){this._options=e,this.geometryTypes=l,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new a.A}prepareFeatures(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}finishFeatureResult(e){if(!e?.features||!e.hasZ||!this._options.sourceSpatialReference||!e.spatialReference||(0,i.aI)(e.spatialReference,this._options.sourceSpatialReference)||e.spatialReference.vcsWkid)return;let t=(0,n.G9)(this._options.sourceSpatialReference)/(0,n.G9)(e.spatialReference);if(1!==t)for(let r of e.features){if(!(0,s.N3)(r))continue;let e=r.geometry.coords;for(let r=2;r<e.length;r+=3)e[r]*=t}}addFeature(e,t){e.features.push(t)}createFeature(){return new s.Om(null,{},null,0)}createSpatialReference(){return{wkid:0}}createGeometry(){return new o.A}addField(e,t){e.fields.push(t)}allocateCoordinates(e){e.coords.length=e.lengths.reduce((e,t)=>e+t,0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(e,t){e.coords[this._coordinatePtr++]=t}addCoordinatePoint(e,t){e.coords.push(t)}addLength(e,t){e.lengths.push(t)}addQueryGeometry(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}createPointGeometry(){return new o.A}}},36365:(e,t,r)=>{r.d(t,{A:()=>u});var n,i=r(57845),s=r(94264),a=r(98570);!function(e){e[e.varint=0]="varint",e[e.fixed64=1]="fixed64",e[e.delimited=2]="delimited",e[e.fixed32=5]="fixed32",e[e.unknown=99]="unknown"}(n||(n={}));let o=new TextDecoder("utf-8"),l=(0,i.A)("safari")||(0,i.A)("ios")?6:(0,i.A)("ff")?12:32;class u{constructor(e,t,r=0,i=e?e.byteLength:0){this._tag=0,this._dataType=n.unknown,this._init(e,t,r,i)}_init(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n}get usedMemory(){return 64+(0,s.Qf)(this._data)}asUnsafe(){return this}clone(){return new u(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;let t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;let e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=0xffffffff;if(e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128||(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128)||(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128)||(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128)||(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128))return e;throw Error("Varint overflow")}getUInt64(){return this._decodeVarint()}getSInt32(){let e=this.getUInt32();return e>>>1^-(1&e)}getSInt64(){return this._decodeSVarint()}getBool(){let e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){let e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+0x100000000*e.getUint32(t+4,!0);return this._skip(8),r}getSFixed64(){let e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+0x100000000*e.getInt32(t+4,!0);return this._skip(8),r}getDouble(){let e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){let e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){let e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){let e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){let e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r}getBytes(){let e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,r,n){let i=this.getMessage(),s=e(i,t,r,n);return i.release(),s}processMessage(e){let t=this.getMessage(),r=e(t);return t.release(),r}getMessage(){let e=this._getLength(),t=u.pool.acquire();return t._init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){u.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case n.varint:this._decodeVarint();break;case n.fixed64:this._skip(8);break;case n.delimited:this._skip(this._getLength());break;case n.fixed32:this._skip(4);break;default:throw Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){let e=this._data,t=this._pos,r=0,n=0;if(this._end-t>=10)do{if(r|=127&(n=e[t++]),!(128&n)||(r|=(127&(n=e[t++]))<<7,!(128&n))||(r|=(127&(n=e[t++]))<<14,!(128&n))||(r|=(127&(n=e[t++]))<<21,!(128&n))||(r+=0x10000000*(127&(n=e[t++])),!(128&n))||(r+=0x800000000*(127&(n=e[t++])),!(128&n))||(r+=0x40000000000*(127&(n=e[t++])),!(128&n))||(r+=0x2000000000000*(127&(n=e[t++])),!(128&n))||(r+=0x100000000000000*(127&(n=e[t++])),!(128&n))||(r+=0x8000000000000000*(127&(n=e[t++])),!(128&n)))break;throw Error("Varint too long!")}while(0);else{let i=1;for(;t!==this._end&&128&(n=e[t]);)++t,r+=(127&n)*i,i*=128;if(t===this._end)throw Error("Varint overrun!");++t,r+=n*i}return this._pos=t,r}_decodeSVarint(){let e=this._data,t,r=0,n=0,i=1&e[this._pos];if(r|=127&(n=e[this._pos++]),!(128&n)||(r|=(127&(n=e[this._pos++]))<<7,!(128&n))||(r|=(127&(n=e[this._pos++]))<<14,!(128&n))||(r|=(127&(n=e[this._pos++]))<<21,!(128&n))||(r+=0x10000000*(127&(n=e[this._pos++])),!(128&n))||(r+=0x800000000*(127&(n=e[this._pos++])),!(128&n))||(r+=0x40000000000*(127&(n=e[this._pos++])),!(128&n)))return i?-(r+1)/2:r/2;if(t=BigInt(r)+562949953421312n*BigInt(127&(n=e[this._pos++])),!(128&n)||(t+=0x100000000000000n*BigInt(127&(n=e[this._pos++])),!(128&n))||(t+=0x8000000000000000n*BigInt(127&(n=e[this._pos++])),!(128&n)))return Number(i?-(t+1n)/2n:t/2n);throw Error("Varint too long!")}_getLength(){if(this._dataType!==n.delimited)throw Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,r){if((r=Math.min(this._end,r))-t>l){let n=e.subarray(t,r);return o.decode(n)}let n="",i="";for(let s=t;s<r;++s){let t=e[s];128&t?i+="%"+t.toString(16):(n+=decodeURIComponent(i)+String.fromCharCode(t),i="")}return i.length&&(n+=decodeURIComponent(i)),n}_toBytes(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)}}u.pool=new a.A(u,void 0,e=>{e._data=null,e._dataView=null})},38715:(e,t,r)=>{function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function s(e,t,r,n,i,s,a,o,l,u,d,c,h,f,m,g){return[e,t,r,n,i,s,a,o,l,u,d,c,h,f,m,g]}r.d(t,{fA:()=>s,o8:()=>i,vt:()=>n,zK:()=>a});let a=n();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:a,clone:i,create:n,createView:function(e,t){return new Float64Array(e,t,16)},fromValues:s},Symbol.toStringTag,{value:"Module"}))},40838:(e,t,r)=>{function n(e,t,r,n){return{x:e,y:t,z:r,hasZ:null!=r,hasM:!1,spatialReference:n,type:"point"}}function i(e,t,r,n,i){e.x=t,e.y=r,e.z=n,e.hasZ=null!=n,e.spatialReference=i}r.d(t,{J:()=>i,T:()=>n})},42378:(e,t,r)=>{r.d(t,{Rc:()=>m,J8:()=>g,oG:()=>c,rq:()=>h,Km:()=>f}),r(57845);var n=r(86075),i=r(3391),s=r(38715),a=r(79019),o=r(35430),l=r(56911),u=r(44120);class d{constructor(e){this._create=e,this._items=[],this._itemsPtr=0}get(){return 0===this._itemsPtr&&(0,n.d)(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){let e=2*this._itemsPtr;this._items.length>e&&(this._items.length=e),this._itemsPtr=0}static createVec2f64(){return new d(o.vt)}static createVec3f64(){return new d(l.vt)}static createVec4f64(){return new d(u.vt)}static createMat3f64(){return new d(i.vt)}static createMat4f64(){return new d(s.vt)}static createQuatf64(){return new d(a.vt)}get test(){}}let c=d.createVec2f64(),h=d.createVec3f64(),f=d.createVec4f64(),m=(d.createMat3f64(),d.createMat4f64()),g=d.createQuatf64()},47325:(e,t,r)=>{r.d(t,{EJ:()=>u,_I:()=>a,g7:()=>l,gr:()=>o});var n=r(20538),i=r(63599),s=r(56911);function a(e,t,r){let n=(0,i.f)(e,t)/(0,i.f)(e,e);return(0,i.h)(r,e,n)}function o(e,t){return(0,i.f)(e,t)/(0,i.l)(e)}function l(e,t){let r=(0,i.f)(e,t)/((0,i.l)(e)*(0,i.l)(t));return-(0,n.XM)(r)}function u(e,t,r){(0,i.n)(d,e),(0,i.n)(c,t);let s=(0,i.f)(d,c),a=(0,n.XM)(s),o=(0,i.e)(d,d,c);return 0>(0,i.f)(o,r)?2*Math.PI-a:a}let d=(0,s.vt)(),c=(0,s.vt)()},54805:(e,t,r)=>{r.d(t,{A:()=>n});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){let e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},56599:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(94264);class i{constructor(e=[],t=[]){this.lengths=e??[],this.coords=t??[]}static fromJSON(e){return new i(e.lengths,e.coords)}static fromRect(e){let[t,r,n,s]=e,a=n-t,o=s-r;return new i([5],[t,r,a,0,0,o,-a,0,0,-o])}get isPoint(){return 0===this.lengths.length&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,t)=>e+t)}get usedMemory(){return 64+(0,n.Qf)(this.lengths,this.coords)}area(){let e=0,t=0;if(!this.lengths.length)return 0;for(let r=0;r<this.lengths.length;r++){let n=this.lengths[r];if(n<3)continue;let i=this.coords[2*t],s=this.coords[2*t+1];for(let r=1;r<n;r+=1){let n=this.coords[2*(r+t)],a=this.coords[2*(r+t)+1];e+=-.5*(n-i)*(a+s),i=n,s=a}t+=n}return e}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){let n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}deltaDecode(){let e=this.clone(),{coords:t,lengths:r}=e,n=0;for(let e of r){for(let r=1;r<e;r++)t[2*(n+r)]+=t[2*(n+r)-2],t[2*(n+r)+1]+=t[2*(n+r)-1];n+=e}return e}clone(e){if(0===this.lengths.length)return new i([],[this.coords[0],this.coords[1]]);let t=(0===this.lengths.length?1:this.lengths.reduce((e,t)=>e+t))*2,r=this.coords.slice(0,t);return e?(e.set(r),new i(this.lengths,e)):new i(Array.from(this.lengths),Array.from(r))}}},60729:(e,t,r)=>{r.d(t,{B2:()=>I,BW:()=>L,Ch:()=>ei,DF:()=>S,Di:()=>Z,E2:()=>Y,IE:()=>x,Nl:()=>et,Q4:()=>es,Rk:()=>ea,Ux:()=>X,Ye:()=>q,ZF:()=>Q,eU:()=>V,eY:()=>K,hK:()=>eo,jH:()=>ee,jQ:()=>en,kz:()=>er,oN:()=>$,q3:()=>J,qK:()=>k,qN:()=>P,z5:()=>U,zv:()=>W});var n=r(32391),i=r(61939),s=r(40941),a=r(42845),o=r(84766),l=r(31789),u=r(82795),d=r(54805),c=r(56599);function h(e,t){return e?t?4:3:t?3:2}let f=()=>i.A.getLogger("esri.layers.graphics.featureConversionUtils"),m={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},g=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s},_=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2]},p=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+3]},y=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2],e[r+3]=t[n+3]};function b(e,t,r,n){if(e){if(r)return t&&n?y:_;if(t&&n)return p}else if(t&&n)return _;return g}function x({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function I({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function w({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function v({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}function T({scale:e,translate:t},r,n){return r*e[n]+t[n]}function S(e,t,r){return e?t?r?N(e):A(e):r?C(e):R(e):null}function R(e){let t=e.coords;return{x:t[0],y:t[1]}}function M(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function A(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function E(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function C(e){let t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function F(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function N(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function O(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function B(e,t){return e&&t?O:e?E:t?F:M}function P(e,t,r=B(null!=t.z,null!=t.m)){return r(e,t)}function k(e,t,r){if(null==e)return null;let n=h(t,r),i=[];for(let t=0;t<e.coords.length;t+=n){let r=[];for(let i=0;i<n;i++)r.push(e.coords[t+i]);i.push(r)}return t?r?{points:i,hasZ:t,hasM:r}:{points:i,hasZ:t}:r?{points:i,hasM:r}:{points:i}}function G(e,t,r=h(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;let n=e.coords,i=0;for(let e of t.points)for(let t=0;t<r;t++)n[i++]=e[t];return e}function L(e,t,r){if(!e)return null;let n=h(t,r),{coords:i,lengths:s}=e,a=[],o=0;for(let e of s){let t=[];for(let r=0;r<e;r++){let e=[];for(let t=0;t<n;t++)e.push(i[o++]);t.push(e)}a.push(t)}return t?r?{paths:a,hasZ:t,hasM:r}:{paths:a,hasZ:t}:r?{paths:a,hasM:r}:{paths:a}}function D(e,t,r=h(t.hasZ,t.hasM)){let{lengths:n,coords:i}=e,s=0;for(let e of t.paths){for(let t of e)for(let e=0;e<r;e++)i[s++]=t[e];n.push(e.length)}return e}function U(e,t,r){if(!e)return null;let n=h(t,r),{coords:i,lengths:s}=e,a=[],o=0;for(let e of s){let t=[];for(let r=0;r<e;r++){let e=[];for(let t=0;t<n;t++)e.push(i[o++]);t.push(e)}a.push(t)}return t?r?{rings:a,hasZ:t,hasM:r}:{rings:a,hasZ:t}:r?{rings:a,hasM:r}:{rings:a}}function q(e,t,r=t.hasZ,n=t.hasM){return V(e,t.rings,r,n)}function V(e,t,r,n){let i=h(r,n),{lengths:s,coords:a}=e,o=0;for(let r of(el(e),t)){for(let e of r)for(let t=0;t<i;t++)a[o++]=e[t];s.push(r.length)}return e}let j=[],z=[];function Y(e,t,r,n,i){j[0]=e;let[s]=Z(z,j,t,r,n,i);return eu(j),eu(z),s}function Z(e,t,r,i,s,a){if(eu(e),!r){for(let r of t){let t=a?r.attributes[a]:void 0;e.push(new u.Om(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":let o=B(i,s);for(let{geometry:r,attributes:n}of t){let t=null!=r?o(new c.A,r):null;e.push(new u.Om(t,n,null,a?n[a]:void 0))}break;case"esriGeometryMultipoint":let l=h(i,s);for(let{geometry:r,attributes:n}of t){let t=null!=r?G(new c.A,r,l):null;e.push(new u.Om(t,n,null,a?n[a]:void 0))}break;case"esriGeometryPolyline":let d=h(i,s);for(let{geometry:r,attributes:n,centroid:i}of t){let t=null!=r?D(new c.A,r,d):null,s=null!=i?P(new c.A,i):null;e.push(new u.Om(t,n,s,a?n[a]:void 0))}break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":for(let{geometry:r,centroid:n,attributes:o}of t){let t=null!=r?q(new c.A,r,i,s):null,l=a?o[a]:void 0;null!=n?e.push(new u.Om(t,o,M(new c.A,n),l)):e.push(new u.Om(t,o,null,l))}break;default:f().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`)),eu(e)}return e}function $(e,t,r,n){z[0]=e,H(j,z,t,r,n);let i=j[0];return eu(j),eu(z),i}function X(e,t,r){if(null==e)return null;let i=new c.A;return("hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),(0,l.fT)(e))?B(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(i,e):(0,l.Bi)(e)?q(i,e,t,r):(0,l.Rg)(e)?D(i,e,h(t,r)):(0,l.U9)(e)?G(i,e,h(t,r)):void f().error("convertFromGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${e}'`))}function W(e,t,r,i){let s=e&&("coords"in e?e:e.geometry);if(null==s)return null;switch(t){case"esriGeometryPoint":{let e=R;return r&&i?e=N:r?e=A:i&&(e=C),e(s)}case"esriGeometryMultipoint":return k(s,r,i);case"esriGeometryPolyline":return L(s,r,i);case"esriGeometryPolygon":return U(s,r,i);default:return f().error("convertToGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${t}'`)),null}}function H(e,t,r,i,s){if(eu(e),null==r){for(let r of t)e.push({attributes:r.attributes});return e}switch(r){case"esriGeometryPoint":let a=R;for(let r of(i&&s?a=N:i?a=A:s&&(a=C),t)){let{geometry:t,attributes:n}=r,i=null!=t?a(t):null;e.push({attributes:n,geometry:i})}break;case"esriGeometryMultipoint":for(let{geometry:r,attributes:n}of t)e.push({attributes:n,geometry:null!=r?k(r,i,s):null});break;case"esriGeometryPolyline":for(let{geometry:r,attributes:n}of t)e.push({attributes:n,geometry:null!=r?L(r,i,s):null});break;case"esriGeometryPolygon":for(let{geometry:r,attributes:n,centroid:a}of t){let t=null!=r?U(r,i,s):null;if(null!=a){let r=R(a);e.push({attributes:n,centroid:r,geometry:t})}else e.push({attributes:n,geometry:t})}break;default:f().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`))}return e}function Q(e){let{objectIdFieldName:t,spatialReference:r,transform:n,fields:i,hasM:s,hasZ:a,features:o,geometryType:l,exceededTransferLimit:u,uniqueIdField:d,queryGeometry:c,queryGeometryType:h}=e,f={features:H([],o,l,a,s),fields:i,geometryType:l,objectIdFieldName:t,spatialReference:r,uniqueIdField:d,queryGeometry:W(c,h,!1,!1)};return n&&(f.transform=n),u&&(f.exceededTransferLimit=u),s&&(f.hasM=s),a&&(f.hasZ=a),f}function J(e,t){let r=new d.A,{hasM:i,hasZ:s,features:a,objectIdFieldName:o,spatialReference:l,geometryType:u,exceededTransferLimit:c,transform:h,fields:m}=e;return m&&(r.fields=m),r.geometryType=u??null,r.objectIdFieldName=o??t??null,r.spatialReference=l??null,r.objectIdFieldName?(a&&Z(r.features,a,u,s,i,r.objectIdFieldName),c&&(r.exceededTransferLimit=c),i&&(r.hasM=i),s&&(r.hasZ=s),h&&(r.transform=h)):f().error(new n.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r}function K(e){let{transform:t,features:r,hasM:n,hasZ:i}=e;if(!t)return e;for(let e of r)null!=e.geometry&&ei(e.geometry,e.geometry,n,i,t),null!=e.centroid&&ei(e.centroid,e.centroid,n,i,t);return e.transform=null,e}function ee(e,t){let{geometryType:r,features:n,hasM:i,hasZ:s}=t;if(!e)return t;for(let t=0;t<n.length;t++){let a=n[t],o=a.weakClone();o.geometry=new c.A,et(o.geometry,a.geometry,i,s,r,e),a.centroid&&(o.centroid=new c.A,et(o.centroid,a.centroid,i,s,"esriGeometryPoint",e)),n[t]=o}return t.transform=e,t}function et(e,t,r,n,i,s,a=r,o=n){if(el(e),!t?.coords.length)return null;let l=m[i],{coords:u,lengths:d}=t,c=h(r,n),f=h(r&&a,n&&o),g=b(r,n,a,o);if(!d.length)return g(e.coords,u,0,0,x(s,u[0]),I(s,u[1])),el(e,c,0),e;let _,p,y,w,v=0,T=0,S=0;for(let t of d){if(t<l)continue;let r=0;T=S,y=_=x(s,u[v]),w=p=I(s,u[v+1]),g(e.coords,u,T,v,y,w),r++,v+=c,T+=f;for(let n=1;n<t;n++,v+=c)y=x(s,u[v]),w=I(s,u[v+1]),y===_&&w===p||(g(e.coords,u,T,v,y-_,w-p),T+=f,r++,_=y,p=w);r>=l&&(e.lengths.push(r),S=T)}return eu(e.coords,S),e.coords.length?e:null}function er(e,t,r,n,i,s,a=r,o=n){if(el(e),!t?.coords.length)return null;let l=m[i],{coords:u,lengths:d}=t,c=h(r,n),f=h(r&&a,n&&o),g=b(r,n,a,o);if(!d.length)return g(e.coords,u,0,0,u[0],u[1]),el(e,c,0),e;let _=0,p=s*s;for(let t of d){if(t<l){_+=t*c;continue}let r=e.coords.length/f,n=_,i=_+(t-1)*c;g(e.coords,u,e.coords.length,n,u[n],u[n+1]),function e(t,r,n,i,s,a,o){let l,u=i,d=0;for(let e=a+n;e<o;e+=n)(l=function(e,t,r,n){let i=e[t],s=e[t+1],a=e[r],o=e[r+1],l=e[n],u=e[n+1],d=a,c=o,h=l-d,f=u-c;if(0!==h||0!==f){let e=((i-d)*h+(s-c)*f)/(h*h+f*f);e>1?(d=l,c=u):e>0&&(d+=h*e,c+=f*e)}return(h=i-d)*h+(f=s-c)*f}(r,e,a,o))>u&&(d=e,u=l);u>i&&(d-a>n&&e(t,r,n,i,s,a,d),s(t,r,t.length,d,r[d],r[d+1]),o-d>n&&e(t,r,n,i,s,d,o))}(e.coords,u,c,p,g,n,i),g(e.coords,u,e.coords.length,i,u[i],u[i+1]);let s=e.coords.length/f-r;s>=l?e.lengths.push(s):eu(e.coords,r*f),_+=t*c}return e.coords.length?e:null}function en(e,t,r,n){if(!t?.coords?.length)return null;let i=h(r,n),s=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY;if(t&&t.coords){let e=t.coords;for(let t=0;t<e.length;t+=i){let r=e[t],n=e[t+1];s=Math.min(s,r),u=Math.max(u,r),l=Math.min(l,n),d=Math.max(d,n)}}return(0,a.is)(e)?(0,a.BI)(e,s,l,u,d):(0,o.fA)(s,l,u,d,e),e}function ei(e,t,r,n,i){let{coords:a,lengths:o}=t,l=h(r,n);if(!a.length)return e!==t&&el(e),e;(0,s.Lw)(i);let{originPosition:u,scale:d,translate:c}=i;ed.originPosition=u;let f=ed.scale;f[0]=d[0]??1,f[1]=-(d[1]??1),f[2]=d[2]??1,f[3]=d[3]??1;let m=ed.translate;if(m[0]=c[0]??0,m[1]=c[1]??0,m[2]=c[2]??0,m[3]=c[3]??0,!o.length){for(let t=0;t<l;++t)e.coords[t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(ed,a[t],t);return e!==t&&el(e,l,0),e}let g=0;for(let t=0;t<o.length;t++){let r=o[t];e.lengths[t]=r;for(let t=0;t<l;++t)e.coords[g+t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(ed,a[g+t],t);let n=e.coords[g],i=e.coords[g+1];g+=l;for(let t=1;t<r;t++,g+=l){n+=a[g]*f[0],i+=a[g+1]*f[1],e.coords[g]=n,e.coords[g+1]=i;for(let t=2;t<l;++t)e.coords[g+t]=function({scale:e,translate:t},r,n){return r*e[n]+t[n]}(ed,a[g+t],t)}}return e!==t&&el(e,a.length,o.length),e}function es(e,t,r,n,i,s){if(el(e),e.lengths.push(...t.lengths),r===i&&n===s)for(let r=0;r<t.coords.length;r++)e.coords.push(t.coords[r]);else{let a=h(r,n),o=b(r,n,i,s),l=t.coords;for(let t=0;t<l.length;t+=a)o(e.coords,l,e.coords.length,t,l[t],l[t+1])}return e}function ea(e,t){let{coords:r,lengths:n}=e,i=0,s=0;for(let e=0;e<n.length;e++){let a=n[e];s+=function(e,t,r,n){let i=0,s=e[n*t],a=e[n*(t+1)];for(let o=1;o<r;o++){let r=s+e[n*(t+o)],l=a+e[n*(t+o)+1],u=(r-s)*(l+a);s=r,a=l,i+=u}return .5*i}(r,i,a,t),i+=a}return Math.abs(s)}function eo(e,t,r,n,i){let s=h(n,i);if(!e.lengths.length){if(e.coords.length<2)return null;let[r,n]=e.coords,i=w(t,r),s=v(t,n);return new c.A([],[i,s])}let a=new c.A([],[0,0]),o=m[r],l="esriGeometryPolygon"===r||"esriGeometryPolyline"===r,u=0,d=0;for(let r=0;r<e.lengths.length;r++){let n=e.lengths[r],i=d,c=w(t,e.coords[s*u]),h=v(t,e.coords[s*u+1]);a.coords[d++]=c,a.coords[d++]=h;let m=0,_=0,p=1;for(let r=1;r<n;r++){let n=w(t,e.coords[s*(r+u)]),i=v(t,e.coords[s*(r+u)+1]);if(n!==c||i!==h){var f,g;let e=n-c,t=i-h;l&&0==(f=m)*t-e*(g=_)&&f*e+g*t>0?(a.coords[d-2]+=e,a.coords[d-1]+=t,c+=e,h+=t):(a.coords[d++]=n,a.coords[d++]=i,c=n,h=i,m=e,_=t,p+=1)}}p<o?d=i:a.lengths.push(p),u+=n}return 0===a.lengths.length?null:a}function el(e,t=0,r=0){eu(e.lengths,r),eu(e.coords,t)}function eu(e,t=0){e.length!==t&&(e.length=t)}let ed={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},61102:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(81856),i=r(71017),s=r(92713),a=r(91838);r(57845),r(61939),r(33638);var o=r(33498),l=r(12709),u=r(56911);let d=class extends i.A.ClonableMixin(s.A){constructor(e){super(e),this.type="local",this.origin=(0,u.vt)()}};(0,n._)([(0,o.e)({local:"local"},{readOnly:!0})],d.prototype,"type",void 0),(0,n._)([(0,a.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],d.prototype,"origin",void 0);let c=d=(0,n._)([(0,l.$)("esri.geometry.support.MeshLocalVertexSpace")],d)},62233:(e,t,r)=>{r.d(t,{g:()=>u});var n=r(31461);r(57845);var i=r(61939),s=r(48678),a=r(53701),o=r(93446);let l=()=>i.A.getLogger("esri.views.webgl.BufferObject");class u{static createIndex(e,t,r){return new u(e,o.NZ.ELEMENT_ARRAY_BUFFER,t,r)}static createVertex(e,t,r){return new u(e,o.NZ.ARRAY_BUFFER,t,r)}static createUniform(e,t,r){return new u(e,o.NZ.UNIFORM_BUFFER,t,r)}static createPixelPack(e,t=o._U.STREAM_READ,r){let n=new u(e,o.NZ.PIXEL_PACK_BUFFER,t);return r&&n.setSize(r),n}static createPixelUnpack(e,t=o._U.STREAM_DRAW,r){return new u(e,o.NZ.PIXEL_UNPACK_BUFFER,t,r)}static createTransformFeedback(e,t=o._U.STATIC_DRAW,r){let n=new u(e,o.NZ.TRANSFORM_FEEDBACK_BUFFER,t);return n.setSize(r),n}constructor(e,t,r,n){this._context=e,this.bufferType=t,this.usage=r,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(o.vt.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,a.Y2)(this._context.gl),n&&this.setData(n)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get usedMemory(){if(this.bufferType===o.NZ.ELEMENT_ARRAY_BUFFER){if(this._indexType===o.pe.UNSIGNED_INT)return 4*this._size;if(this._indexType===o.pe.UNSIGNED_SHORT)return 2*this._size}return this._size}get _isVAOAware(){return this.bufferType===o.NZ.ELEMENT_ARRAY_BUFFER||this.bufferType===o.NZ.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(o.vt.BufferObject,this),this._context=null):this._glName&&l().warn("Leaked WebGL buffer object")}setSize(e,t=null){if(this.bufferType===o.NZ.ELEMENT_ARRAY_BUFFER&&null!=t)switch(this._indexType=t,t){case o.pe.UNSIGNED_SHORT:e*=2;break;case o.pe.UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===o.NZ.ELEMENT_ARRAY_BUFFER&&((0,s.mg)(e)?this._indexType=o.pe.UNSIGNED_BYTE:(0,s.jq)(e)?(t/=2,this._indexType=o.pe.UNSIGNED_SHORT):(0,s.XJ)(e)&&(t/=4,this._indexType=o.pe.UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e,t=null){this._size=e;let r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);let n=this._context.gl;null!=t?n.bufferData(this.bufferType,t,this.usage):n.bufferData(this.bufferType,e,this.usage),(0,a.Y2)(n),this._isVAOAware&&this._context.bindVAO(r)}setSubData(e,t,r,n){if(!e)return;let i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);let{gl:s}=this._context;s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,r,n-r),(0,a.Y2)(s),this._isVAOAware&&this._context.bindVAO(i)}getSubData(e,t=0,r,i){var s;if(r<0||i<0)return;let a=(s=e,(0,n.Xj)(s))?e.BYTES_PER_ELEMENT:1;if(a*((r??0)+(i??0))>e.byteLength)return;t+a*(i??0)>this.usedMemory&&l().warn("Potential problem getting subdata: requested data exceeds buffer size!");let u=this._context.gl;this.bufferType===o.NZ.TRANSFORM_FEEDBACK_BUFFER?(this._context.bindBuffer(this,o.NZ.TRANSFORM_FEEDBACK_BUFFER),u.getBufferSubData(o.NZ.TRANSFORM_FEEDBACK_BUFFER,t,e,r,i),this._context.unbindBuffer(o.NZ.TRANSFORM_FEEDBACK_BUFFER)):(this._context.bindBuffer(this,o.NZ.COPY_READ_BUFFER),u.getBufferSubData(o.NZ.COPY_READ_BUFFER,t,e,r,i),this._context.unbindBuffer(o.NZ.COPY_READ_BUFFER))}async getSubDataAsync(e,t=0,r,n){await this._context.clientWaitAsync(),this.getSubData(e,t,r,n)}}},62377:(e,t,r)=>{r.d(t,{T:()=>s,U:()=>i});var n=r(20538);function i(e,t,r=0){let s=(0,n.qE)(e,0,l);for(let e=0;e<4;e++){var o;t[r+e]=Math.floor(256*((o=s*a[e])-Math.floor(o)))}}function s(e,t=0){let r=0;for(let n=0;n<4;n++)r+=e[t+n]*o[n];return r}let a=[1,256,65536,0x1000000],o=[1/256,1/65536,1/0x1000000,1/0x100000000],l=s(new Uint8ClampedArray([255,255,255,255]))},65642:(e,t,r)=>{r.d(t,{SH:()=>M,ae:()=>w,cn:()=>p});var n=r(32391),i=r(36365),s=r(56599),a=r(27151);let o=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML","esriFieldTypeBigInteger","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],l=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],u=["upperLeft","lowerLeft"];function d(e){return e>=o.length?null:o[e]}function c(e){return e>=u.length?null:u[e]}function h(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function f(e,t,r){let n=e.asUnsafe(),i=t.createPointGeometry(r);for(;n.next();)if(3===n.tag()){let e=n.getUInt32(),r=n.pos()+e,s=0;for(;n.pos()<r;)t.addCoordinatePoint(i,n.getSInt64(),s++)}else n.skip();return i}function m(e,t,r){let n=e.asUnsafe(),i=t.createGeometry(r),s=2+ +!!r.hasZ+ +!!r.hasM;for(;n.next();)switch(n.tag()){case 2:{let e=n.getUInt32(),r=n.pos()+e,s=0;for(;n.pos()<r;)t.addLength(i,n.getUInt32(),s++);break}case 3:{let e=n.getUInt32(),r=n.pos()+e,a=0;for(t.allocateCoordinates(i);n.pos()<r;)t.addCoordinate(i,n.getSInt64(),a),++a===s&&(a=0);break}default:n.skip()}return i}function g(e){let t=e.asUnsafe(),r=new s.A,n="esriGeometryPoint";for(;t.next();)switch(t.tag()){case 2:{let e=t.getUInt32(),n=t.pos()+e;for(;t.pos()<n;)r.lengths.push(t.getUInt32());break}case 3:{let e=t.getUInt32(),n=t.pos()+e;for(;t.pos()<n;)r.coords.push(t.getSInt64());break}case 1:n=a.z[t.getEnum()];break;default:t.skip()}return{queryGeometry:r,queryGeometryType:n}}function _(e){let t=e.asUnsafe();for(;t.next();)switch(t.tag()){case 1:return t.getString();case 2:return t.getFloat();case 3:return t.getDouble();case 4:return t.getSInt32();case 5:return t.getUInt32();case 6:return t.getInt64();case 7:return t.getUInt64();case 8:return t.getSInt64();case 9:return t.getBool();default:return t.skip(),null}return null}function p(e){let t=e.asUnsafe(),r={type:d(0)};for(;t.next();)switch(t.tag()){case 1:r.name=t.getString();break;case 2:r.type=d(t.getEnum());break;case 3:r.alias=t.getString();break;case 4:var n;r.sqlType=(n=t.getEnum())>=l.length?null:l[n];break;case 5:default:t.skip();break;case 6:r.defaultValue=t.getString()}return r}function y(e){let t={},r=e.asUnsafe();for(;r.next();)switch(r.tag()){case 1:t.name=r.getString();break;case 2:t.isSystemMaintained=r.getBool();break;default:r.skip()}return t}function b(e,t,r,n){let i=t.createFeature(r),s=0;for(;e.next();)switch(e.tag()){case 1:{let t=n[s++].name;i.attributes[t]=e.processMessage(_);break}case 2:i.geometry=e.processMessageWithArgs(m,t,r);break;case 4:i.centroid=e.processMessageWithArgs(f,t,r);break;default:e.skip()}return i}function x(e){let t=[1,1,1,1],r=e.asUnsafe();for(;r.next();)switch(r.tag()){case 1:t[0]=r.getDouble();break;case 2:t[1]=r.getDouble();break;case 4:t[2]=r.getDouble();break;case 3:t[3]=r.getDouble();break;default:r.skip()}return t}function I(e){let t=[0,0,0,0],r=e.asUnsafe();for(;r.next();)switch(r.tag()){case 1:t[0]=r.getDouble();break;case 2:t[1]=r.getDouble();break;case 4:t[2]=r.getDouble();break;case 3:t[3]=r.getDouble();break;default:r.skip()}return t}function w(e){let t={originPosition:c(0)},r=e.asUnsafe();for(;r.next();)switch(r.tag()){case 1:t.originPosition=c(r.getEnum());break;case 2:t.scale=r.processMessage(x);break;case 3:t.translate=r.processMessage(I);break;default:r.skip()}return t}function v(e){let t={},r=e.asUnsafe();for(;r.next();)switch(r.tag()){case 1:t.shapeAreaFieldName=r.getString();break;case 2:t.shapeLengthFieldName=r.getString();break;case 3:t.units=r.getString();break;default:r.skip()}return t}function T(e,t){let r=t.createSpatialReference();for(;e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:r.latestWkid=e.getUInt32();break;case 3:r.vcsWkid=e.getUInt32();break;case 4:r.latestVcsWkid=e.getUInt32();break;default:e.skip()}return r}function S(e,t){let r=t.createFeatureResult(),n=e.asUnsafe();r.geometryType=h(t,0);let i=!1;for(;n.next();)switch(n.tag()){case 1:r.objectIdFieldName=n.getString();break;case 3:r.globalIdFieldName=n.getString();break;case 4:r.geohashFieldName=n.getString();break;case 5:r.geometryProperties=n.processMessage(v);break;case 7:r.geometryType=h(t,n.getEnum());break;case 8:r.spatialReference=n.processMessageWithArgs(T,t);break;case 10:r.hasZ=n.getBool();break;case 11:r.hasM=n.getBool();break;case 12:r.transform=n.processMessage(w);break;case 9:r.exceededTransferLimit=n.getBool();break;case 13:t.addField(r,n.processMessage(p));break;case 15:i||(t.prepareFeatures(r),i=!0),t.addFeature(r,n.processMessageWithArgs(b,t,r,r.fields));break;case 2:r.uniqueIdField=n.processMessage(y);break;default:n.skip()}return t.finishFeatureResult(r),r}function R(e,t){let r={},n=null;for(;e.next();)switch(e.tag()){case 4:n=e.processMessageWithArgs(g);break;case 1:r.featureResult=e.processMessageWithArgs(S,t);break;default:e.skip()}return null!=n&&r.featureResult&&t.addQueryGeometry(r,n),r}function M(e,t){try{let r=new i.A(new Uint8Array(e),new DataView(e)),n={};for(;r.next();)2===r.tag()?n.queryResult=r.processMessageWithArgs(R,t):r.skip();return n}catch(e){throw new n.A("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e})}}},72500:(e,t,r)=>{r.d(t,{C:()=>f,Cr:()=>p,Io:()=>G,LV:()=>h,O_:()=>_,Qj:()=>m,T7:()=>F,Tj:()=>O,U5:()=>E,Ui:()=>C,Z1:()=>k,_I:()=>P,b6:()=>B,ci:()=>b,fA:()=>g,gv:()=>N,lU:()=>y,mN:()=>L,mP:()=>R,mR:()=>A,vt:()=>c,ze:()=>M});var n,i,s=r(20538),a=r(63599),o=r(56911);r(13784);var l=r(47325),u=r(42378),d=r(87261);function c(e=q){return[e[0],e[1],e[2],e[3]]}function h(e=q[0],t=q[1],r=q[2],n=q[3]){return g(e,t,r,n,u.Km.get())}function f(e,t){return g(t[0],t[1],t[2],t[3],e)}function m(e){return e}function g(e,t,r,n,i=c()){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function _(e,t,r){let n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function p(e,t,r,n=c()){let i=r[0]-t[0],s=r[1]-t[1],a=r[2]-t[2],o=e[0]-t[0],l=e[1]-t[1],u=e[2]-t[2],d=s*u-a*l,h=a*o-i*u,f=i*l-s*o,m=d*d+h*h+f*f,g=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return n[0]=d*g,n[1]=h*g,n[2]=f*g,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function y(e,t,r,n=0,i=Math.floor(1/3*r),s=Math.floor(2/3*r)){if(r<3)return!1;t(I,n);let o=i,l=!1;for(;o<r-1&&!l;)t(w,o),o++,l=!(0,a.p)(I,w);if(!l)return!1;for(o=Math.max(o,s),l=!1;o<r&&!l;)t(v,o),o++,(0,a.d)(T,I,w),(0,a.n)(T,T),(0,a.d)(S,w,v),(0,a.n)(S,S),l=!(0,a.p)(I,v)&&!(0,a.p)(w,v)&&Math.abs((0,a.f)(T,S))<x;return l?(p(I,w,v,e),!0):(0!==n||1!==i||2!==s)&&y(e,t,r,0,1,2)}function b(e,t,r=!0){let n=t.length/3;return y(e,(e,r)=>(0,a.i)(e,t[3*r+0],t[3*r+1],t[3*r+2]),r?n-1:n)}let x=.99619469809,I=(0,o.vt)(),w=(0,o.vt)(),v=(0,o.vt)(),T=(0,o.vt)(),S=(0,o.vt)();function R(e,t,r){return t!==e&&f(e,t),e[3]=-(0,a.f)(e,r),e}function M(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function A(e,t,r,n){return(0,a.e)(v,t,e),_(r,v,n)}function E(e,t,r,n){return D(U(e,t,(0,a.d)(u.rq.get(),r,t),V,n))}function C(e,t,r){return null!=t&&D(U(e,t.origin,t.direction,j,r))}function F(e,t,r){return D(U(e,t.origin,t.vector,i.NONE,r))}function N(e,t,r){return D(U(e,t.origin,t.vector,i.CLAMP,r))}function O(e,t){return L(e,t)>=0}function B(e,t){let r=(0,a.f)(e,t.ray.direction),n=-L(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return n>0;let i=n/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function P(e,t,r){let n=(0,a.h)(u.rq.get(),e,-e[3]),i=function(e,t,r){let n=(0,a.h)(u.rq.get(),e,(0,a.f)(e,t));return(0,a.d)(r,t,n),r}(e,(0,a.d)(u.rq.get(),t,n),u.rq.get());return(0,a.g)(r,i,n),r}function k(e,t,r,n){let i=u.rq.get(),s=u.rq.get();(0,d.VV)(e,i,s);let o=(0,a.d)(u.rq.get(),r,t),c=(0,l.gr)(i,o),h=(0,l.gr)(s,o),f=(0,l.gr)(e,o);return(0,a.i)(n,c,h,f)}function G(e,t){return Math.abs(L(e,t))}function L(e,t){return(0,a.f)(e,t)+e[3]}function D(e){return e===n.INTERSECTS_INSIDE_OUT||e===n.INTERSECTS_OUTSIDE_IN}function U(e,t,r,o,l){let u=(0,a.f)(e,r),d=L(e,t);if(0===u)return d>=0?n.INSIDE:n.OUTSIDE;let c=-d/u;return o&i.CLAMP&&(c=(0,s.qE)(c,0,1)),!(o&i.INFINITE_MIN)&&c<0||!(o&i.INFINITE_MAX)&&c>1?d>=0?n.INSIDE:n.OUTSIDE:((0,a.g)(l,t,(0,a.h)(l,r,c)),d>=0?n.INTERSECTS_INSIDE_OUT:n.INTERSECTS_OUTSIDE_IN)}!function(e){e[e.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",e[e.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",e[e.INSIDE=2]="INSIDE",e[e.OUTSIDE=3]="OUTSIDE"}(n||(n={}));let q=[0,0,1,0];!function(e){e[e.NONE=0]="NONE",e[e.CLAMP=1]="CLAMP",e[e.INFINITE_MIN=4]="INFINITE_MIN",e[e.INFINITE_MAX=8]="INFINITE_MAX"}(i||(i={}));let V=i.INFINITE_MIN|i.INFINITE_MAX,j=i.INFINITE_MAX},72977:(e,t,r)=>{r.d(t,{Fe:()=>m,Rn:()=>u,dI:()=>d,hr:()=>f,iC:()=>h});var n=r(31461),i=r(94264),s=r(64835),a=r(119),o=r(53041),l=r(4547);class u{constructor(e,t,r,n){this.material=e,this.bufferWriter=e.createBufferWriter(),this.vertexBufferLayout=this.bufferWriter.vertexBufferLayout,this.buffer=t,this.elementCount=r,this.boundingInfo=n}get numTriangles(){return this.elementCount/3}get numVertices(){return this.elementCount}computeUsedMemory(){return this.buffer.byteLength+i.i5}getRenderGeometry(){return this}intersect(e,t,r,n,i,s,a,o){let l=this.bufferWriter,u=this.buffer;l.intersect(u,e,r,n,(r,n,l,u,d)=>c(r,n,l,d,e,t,s,a,i,o))}}class d{constructor(e){this.engineGeometry=e}get material(){return this.engineGeometry.material}get numVertices(){return this.engineGeometry.attributes.get(o.r.POSITION).indices.length}get numTriangles(){return this.engineGeometry.indexCount/3}get boundingInfo(){return this.engineGeometry.boundingInfo}computeUsedMemory(){return Array.from(this.engineGeometry.attributes.values()).reduce((e,t)=>e+(0,i.Qf)(t.data,t.indices),0)}getRenderGeometry(){let e=this.material,t=this.engineGeometry,r=t.attributes,n=t.boundingInfo,i=e.createBufferWriter(),s=i.vertexBufferLayout,a=i.elementCount(r),o=s.createBuffer(a);return i.write(null,null,r,null,o,0),new u(e,o.buffer,a,n)}intersect(e,t,r,n,i,s,a,o){let l=this.engineGeometry;this.material.intersect(l,e.transform.transform,e,r,n,(r,n,l,u,d)=>c(r,n,l,d,e,t,s,a,i,o))}}function c(e,t,r,n,i,o,u,d,c,h){if(e<0||o&&!o(i.rayBegin,i.rayEnd,e))return;let f=new l.h(u.layerUid,u.graphicUid(c),r,d,h);if((null==i.results.min.drapedLayerOrder||n>=i.results.min.drapedLayerOrder)&&(null==i.results.min.dist||e<i.results.min.dist)&&i.results.min.set(a.dz.LOD,f,e,t,i.transform.transform,n),i.options.store!==a.oH.MIN&&(null==i.results.max.drapedLayerOrder||n>=i.results.max.drapedLayerOrder)&&(null==i.results.max.dist||e>i.results.max.dist)&&i.results.max.set(a.dz.LOD,f,e,t,i.transform.transform,n),i.options.store===a.oH.ALL){let r=(0,s.G7)(i.results.min.ray);r.set(a.dz.LOD,f,e,t,i.transform.transform,n),i.results.all.push(r)}}class h{constructor(e,t=null){this.geometry=e,this.textures=t}get material(){return this.geometry.material}get numTriangles(){return this.geometry.numTriangles}}class f{constructor(e,t,r){this.components=e,this.minScreenSpaceRadius=t,this.pivotOffset=r;let i=(0,n.Am)(this.components.map(e=>e.geometry));this.numVertices=i.reduce((e,t)=>e+t.numVertices,0)}}class m{constructor(e){this.levels=e,this.levels.sort((e,t)=>e.minScreenSpaceRadius===t.minScreenSpaceRadius?e.numVertices-t.numVertices:e.minScreenSpaceRadius-t.minScreenSpaceRadius)}getMaterials(){let e=[];return this.levels.forEach(t=>t.components.forEach(t=>e.push(t.geometry.material))),(0,n.Am)(e)}getTextures(){let e=[];return this.levels.forEach(t=>t.components.forEach(t=>{null!=t.textures&&e.push(...t.textures)})),(0,n.Am)(e)}getGeometries(){let e=[];return this.levels.forEach(t=>t.components.forEach(t=>{e.push(t.geometry)})),(0,n.Am)(e)}getEngineGeometries(){return this.getGeometries().map(e=>e.engineGeometry).filter(e=>null!=e)}computeUsedMemory(){let e=this.getGeometries(),t=this.getTextures(),r=e.reduce((e,t)=>e+t.computeUsedMemory(),0);return t.reduce((e,t)=>e+t.memoryEstimate,0)+r}}},76277:(e,t,r)=>{r.d(t,{A:()=>c});var n,i=r(81856),s=r(71017),a=r(92713),o=r(91838);r(57845),r(61939),r(33638);var l=r(33498),u=r(12709);let d=n=class extends s.A.ClonableMixin(a.A){constructor(e){super(e),this.type="georeferenced",this.origin=null}};d.absolute=new n,(0,i._)([(0,l.e)({georeferenced:"georeferenced"},{readOnly:!0})],d.prototype,"type",void 0),(0,i._)([(0,o.MZ)({type:[Number],nonNullable:!1,json:{write:!0}})],d.prototype,"origin",void 0);let c=d=n=(0,i._)([(0,u.$)("esri.geometry.support.MeshGeoreferencedVertexSpace")],d)},78756:(e,t,r)=>{r.d(t,{d:()=>R});var n=r(20538),i=r(8922),s=r(40998),a=r(63599),o=r(69752),l=r(99345),u=r(86835),d=r(93739),c=r(9892),h=r(84766),f=r(97067),m=r(56911);r(91463);var g=r(56429),_=r(7916);function p(e,t,r=function(e){return{operations:e,value:e.create()}}(e)){return r.operations=e,e.copy(t,r.value),r}function y(e,t,r,n){return e.operations.setAltitudeAt(e.value,t,r,n)}function b(e,t,r){return e.operations.elevate(e.value,t,r.value)}let x=(0,m.vt)();(0,m.vt)();var I=r(72500),w=r(47325),v=r(42378),T=r(54919),S=r(10954);class R{constructor(e,t,r,n){this.viewingMode=e,this.spatialReference=t,this.unitInMeters=r,this._coordinateSystem=n,this._tmpCoordinateSystem=function(e){let{value:t,operations:r}=e;return{operations:r,value:r.create(t)}}(n),this.referenceEllipsoid=(0,o.tO)(t),this.sphericalPCPF=(0,l.lO)(t)}set extent(e){var t,r;e&&(t=this._coordinateSystem,r=this._coordinateSystem,t.operations.setExtent(t.value,e,r.value))}get extent(){var e,t;return e=this._coordinateSystem,t=(0,h.vt)(),e.operations.getExtent(e.value,t),t}getAltitude(e){var t;return t=this._coordinateSystem,t.operations.altitudeAt(t.value,e)}setAltitude(e,t,r=e){return y(this._coordinateSystem,r,t,e)}setAltitudeOfTransformation(e,t){var r;r=this._coordinateSystem,t!=t&&(0,s.C)(t,t),(0,a.i)(x,t[12],t[13],t[14]),y(r,x,e,x),t[12]=x[0],t[13]=x[1],t[14]=x[2]}worldUpAtPosition(e,t){var r;return r=this._coordinateSystem,r.operations.axisAt(r.value,e,f._.Z,t)}worldBasisAtPosition(e,t,r){var n;return n=this._coordinateSystem,n.operations.axisAt(n.value,e,t,r)}basisMatrixAtPosition(e,t){let r=this.worldBasisAtPosition(e,f._.X,v.rq.get()),n=this.worldBasisAtPosition(e,f._.Y,v.rq.get()),i=this.worldBasisAtPosition(e,f._.Z,v.rq.get());return(0,s.hZ)(t,r[0],r[1],r[2],0,n[0],n[1],n[2],0,i[0],i[1],i[2],0,0,0,0,1),t}headingAtPosition(e,t){let r=this.worldUpAtPosition(e,v.rq.get()),i=this.worldBasisAtPosition(e,f._.Y,v.rq.get()),s=(0,w.EJ)(t,i,r);return(0,n.KJ)(s)}intersectManifoldClosestSilhouette(e,t,r){var n;return b(this._coordinateSystem,t,this._tmpCoordinateSystem),n=this._tmpCoordinateSystem,n.operations.intersectRayClosestSilhouette(n.value,e,r),r}intersectManifold(e,t,r){var n;b(this._coordinateSystem,t,this._tmpCoordinateSystem);let i=v.rq.get();return(n=this._tmpCoordinateSystem,n.operations.intersectRay(n.value,e,i))?(0,a.c)(r,i):null}intersectInfiniteManifold(e,t,r){if(this.viewingMode===S.RT.Global)return this.intersectManifold(e,t,r);b(this._coordinateSystem,t,this._tmpCoordinateSystem);let n=this._tmpCoordinateSystem.value,i=v.rq.get();return(0,I.Ui)(n.plane,e,i)?(0,a.c)(r,i):null}toRenderCoords(e,t,r){return(0,T.v)(e)?(0,u.g)(e,t,this.spatialReference):(0,c.F)(e,t,r,this.spatialReference)}fromRenderCoords(e,t,r=null){return(0,T.v)(t)?(null!=r&&(t.spatialReference=r),(0,d.E)(e,this.spatialReference,t)?t:null):(0,c.F)(e,this.spatialReference,t,r)?t:null}static create(e,t){switch(e){case S.RT.Local:return new R(S.RT.Local,t,(0,i.GA)(t),p(g.b,(0,g.f)([0,0,0],[0x4000000000000,0,0],[0,0x4000000000000,0])));case S.RT.Global:return new R(S.RT.Global,t,1,p(_.s,(0,_.f)(0,0,0,(0,o.tO)(t).radius)))}}static renderUnitScaleFactor(e,t){return(0,i.KX)(e)/(0,i.KX)(t)}}},79019:(e,t,r)=>{function n(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}r.d(t,{o8:()=>i,vt:()=>n,zK:()=>s});let s=n();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:s,clone:i,create:n,fromValues:function(e,t,r,n){return[e,t,r,n]}},Symbol.toStringTag,{value:"Module"}))},79136:(e,t,r)=>{r.d(t,{IJ:()=>h,Jf:()=>_,Pk:()=>m,eW:()=>c,gW:()=>g,kS:()=>f});var n=r(39166),i=r(90525),s=r(31789),a=r(25606),o=r(71760),l=r(1485),u=r(21893),d=r(9723);async function c(e,t,r,n){let i=null!=t.timeExtent&&t.timeExtent.isEmpty?{data:{features:[]}}:await p(e,t,"json",n);return(0,d.q)(t,r,i.data),i}async function h(e,t,r,n){if(null!=t.timeExtent&&t.timeExtent.isEmpty)return{data:r.createFeatureResult()};let i=await f(e,t,n);return i.data=(0,u.m)(i.data,r),i}function f(e,t,r){return p(e,t,"pbf",r)}function m(e,t,r){return null!=t.timeExtent&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):p(e,t,"json",r,{returnIdsOnly:!0})}function g(e,t,r){return null!=t.timeExtent&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):p(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}async function _(e,t,r){if(null!=t.timeExtent&&t.timeExtent.isEmpty)return{data:{count:0,extent:null}};let n=await p(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}),i=n.data;if(i.hasOwnProperty("extent"))return n;if(i.features||i.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return n}async function p(e,t,r,u={},d={}){var c,h;let f="string"==typeof e?(0,i.An)(e):e,m=t.geometry?[t.geometry]:[],g=await (0,a.el)(m,null,{signal:u.signal}),_=g?.[0];null!=_&&((t=t.clone()).geometry=_);let y=(0,l.z)({...f.query,f:r,...d,...function(e,t){let r,n,i,a=e.geometry,l=e.toJSON();if(delete l.compactGeometryEnabled,delete l.defaultSpatialReferenceEnabled,null!=a&&(n=a.spatialReference,i=(0,o.YX)(n),l.geometryType=(0,s.$B)(a),l.geometry=function(e,t){if(t&&"extent"===e.type)return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&"point"===e.type)return`${e.x},${e.y}`;let r=e.toJSON();return delete r.spatialReference,JSON.stringify(r)}(a,e.compactGeometryEnabled),l.inSR=i),l.groupByFieldsForStatistics&&(l.groupByFieldsForStatistics=l.groupByFieldsForStatistics.join(",")),l.objectIds&&(l.objectIds=l.objectIds.join(",")),l.orderByFields&&(l.orderByFields=l.orderByFields.join(",")),!l.outFields||!l.returnDistinctValues&&(t?.returnCountOnly||t?.returnExtentOnly||t?.returnIdsOnly)?delete l.outFields:l.outFields.includes("*")?l.outFields="*":l.outFields=l.outFields.join(","),l.outSR?(l.outSR=(0,o.YX)(l.outSR),r=e.outSpatialReference):a&&(l.returnGeometry||l.returnCentroid)&&(l.outSR=l.inSR,r=n),l.returnGeometry&&delete l.returnGeometry,l.outStatistics&&(l.outStatistics=JSON.stringify(l.outStatistics)),l.fullText&&(l.fullText=JSON.stringify(l.fullText)),l.pixelSize&&(l.pixelSize=JSON.stringify(l.pixelSize)),l.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&null!=n&&null!=e.quantizationParameters?.extent&&n.equals(e.quantizationParameters.extent.spatialReference)&&delete l.quantizationParameters.extent.spatialReference,l.quantizationParameters=JSON.stringify(l.quantizationParameters)),l.parameterValues&&(l.parameterValues=JSON.stringify(l.parameterValues)),l.rangeValues&&(l.rangeValues=JSON.stringify(l.rangeValues)),l.dynamicDataSource&&(l.layer=JSON.stringify({source:l.dynamicDataSource}),delete l.dynamicDataSource),l.timeExtent){let{start:e,end:t}=l.timeExtent;null==e&&null==t||(l.time=e===t?e:`${e??"null"},${t??"null"}`),delete l.timeExtent}return e.defaultSpatialReferenceEnabled&&null!=n&&null!=r&&n.equals(r)&&(l.defaultSR=l.inSR,delete l.inSR,delete l.outSR),l}(t,d)});return(0,n.A)((0,i.fj)(f.path,(c=t,h=d,null==c.formatOf3DObjects||h.returnCountOnly||h.returnExtentOnly||h.returnIdsOnly)?"query":"query3d"),{...u,responseType:"pbf"===r?"array-buffer":"json",query:{...y,...u.query}})}},82795:(e,t,r)=>{r.d(t,{N3:()=>o,Om:()=>a});var n=r(94264),i=r(11506),s=r(56599);class a{constructor(e=null,t={},r,n,i=0){this.geometry=e,this.attributes=t,this.centroid=r,this.objectId=n,this.displayId=i}static fromJSON(e){let t=e.geometry?s.A.fromJSON(e.geometry):null,r=e.centroid?s.A.fromJSON(e.centroid):null,n=e.objectId;return new a(t,e.attributes,r,n)}weakClone(){let e=new a(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){let e=new a(this.geometry?.clone(),{...this.attributes},this.centroid?.clone(),this.objectId);return e.displayId=this.displayId,e}ensureCentroid(e){return this.centroid??=(0,i.Q)(new s.A,this.geometry,e.hasZ,e.hasM),this.centroid}get usedMemory(){return 128+(0,n.lM)(this.attributes)+(this.geometry?.usedMemory??0)}}function o(e){return!!e.geometry?.coords?.length}},83048:(e,t,r)=>{r.d(t,{EL:()=>_,RS:()=>p,gr:()=>u,wP:()=>c,wZ:()=>h});var n=r(97135);r(57845);var i=r(33715),s=r(48678),a=r(91463),o=r(31789),l=r(40838);function u(e){return"declaredClass"in e}function d(e){return"declaredClass"in e}function c(e,t){return e?"declaredClass"in e?e:new n.A({layer:t,sourceLayer:t,visible:e.visible,symbol:(0,i.o8)(e.symbol),attributes:(0,i.o8)(e.attributes),geometry:h(e.geometry)}):null}function h(e){return null==e?null:u(e)?e:(0,o.rS)(function(e){let{wkid:t,wkt:r,wkt2:n,latestWkid:i}=e.spatialReference,s={wkid:t,wkt:r,wkt2:n,latestWkid:i};switch(e.type){case"point":{let{x:t,y:r,z:n,m:i}=e;return{x:t,y:r,z:n,m:i,spatialReference:s}}case"polygon":{let{rings:t,hasZ:r,hasM:n}=e;return{rings:f(t),hasZ:r,hasM:n,spatialReference:s}}case"polyline":{let{paths:t,hasZ:r,hasM:n}=e;return{paths:f(t),hasZ:r,hasM:n,spatialReference:s}}case"extent":{let{xmin:t,xmax:r,ymin:n,ymax:i,zmin:a,zmax:o,mmin:l,mmax:u,hasZ:d,hasM:c}=e;return{xmin:t,xmax:r,ymin:n,ymax:i,zmin:a,zmax:o,mmin:l,mmax:u,hasZ:d,hasM:c,spatialReference:s}}case"multipoint":{let{points:t,hasZ:r,hasM:n}=e;return{points:g(t)?m(t):t,hasZ:r,hasM:n,spatialReference:s}}default:return}}(e))}function f(e){return!function(e){for(let t of e)if(0!==t.length)return g(t);return!1}(e)?e:e.map(e=>m(e))}function m(e){return e.map(e=>Array.from(e))}function g(e){return e.length>0&&((0,s.vZ)(e[0])||(0,s.aI)(e[0]))}function _(e,t){let r;if(!e)return null;if(d(e)){if(null==t)return e.clone();if(d(t))return t.copy(e)}return null!=t?((r=t).x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=void 0,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=void 0,r.hasM=!1)):(r=(0,l.T)(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r}function p(e){let{wkid:t,wkt:r,wkt2:n,latestWkid:i}=e;return a.A.fromJSON({wkid:t,wkt:r,wkt2:n,latestWkid:i})}},84172:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(61939),i=r(40941),s=r(94264),a=r(93446),o=r(90040);let l=()=>n.A.getLogger("esri.views.webgl.VertexArrayObject"),u=class{constructor(e,t,r,n,i=null){this._context=e,this._locations=t,this._layout=r,this._buffers=n,this._indexBuffer=i,this._glName=null,this._initialized=!1}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Array.from(this._buffers.values()).reduce((e,t)=>e+t.usedMemory,null!=this._indexBuffer?this._indexBuffer.usedMemory:0)}get layout(){return this._layout}get locations(){return this._locations}get usedMemory(){return this.byteSize+(this._buffers.size+ +!!this._indexBuffer)*s.i5}get cachedMemory(){return this.usedMemory}dispose(){this._context?(this._context.getBoundVAO()===this&&this._context.bindVAO(null),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this._indexBuffer=(0,i.WD)(this._indexBuffer),this.disposeVAOOnly()):(this._glName||this._buffers.size>0)&&l().warn("Leaked WebGL VAO")}disposeVAOOnly(){this._glName&&(this._context.gl.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(a.vt.VertexArrayObject,this)),this._context=null}initialize(){if(this._initialized)return;let{gl:e}=this._context,t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t,this._context.instanceCounter.increment(a.vt.VertexArrayObject,this),this._initialized=!0}bind(){this.initialize(),this._context.gl.bindVertexArray(this.glName)}_bindLayout(){let{_buffers:e,_layout:t,_indexBuffer:r}=this;e||l().error("Vertex buffer dictionary is empty!");let n=this._context.gl;this._buffers.forEach((e,r)=>{let n=t.get(r);n?(0,o.yu)(this._context,this._locations,e,n):l().error("Vertex element descriptor is empty!")}),null!=r&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.glName)}unbind(){this.initialize(),this._context.gl.bindVertexArray(null)}}},86835:(e,t,r)=>{r.d(t,{W:()=>o,g:()=>a});var n=r(56911),i=r(65111),s=r(70983);function a(e,t,r,n){if((0,i.canProjectWithoutEngine)(e.spatialReference,r)){l[0]=e.x,l[1]=e.y;let i=e.z;return l[2]=i??n??0,(0,s.projectBuffer)(l,e.spatialReference,0,t,r,0)}let a=(0,i.tryProjectWithZConversion)(e,r);return!!a&&(t[0]=a?.x,t[1]=a?.y,t[2]=a?.z??n??0,!0)}async function o(e,t,r,n,s){return await (0,i.initializeProjection)(e.spatialReference,r,null,s),a(e,t,r,n)}let l=(0,n.vt)()},87261:(e,t,r)=>{r.d(t,{VV:()=>o,hG:()=>s,wp:()=>a}),r(20538);var n=r(63599),i=r(56911);function s(e){let t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8];return Math.sqrt(Math.max(t,e[1]*e[1]+e[5]*e[5]+e[9]*e[9],e[2]*e[2]+e[6]*e[6]+e[10]*e[10]))}function a(e,t){let r=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),i=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),s=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return(0,n.i)(e,r,i,s),e}function o(e,t,r){Math.abs(e[0])>Math.abs(e[1])?(0,n.i)(t,0,1,0):(0,n.i)(t,1,0,0),(0,n.e)(r,e,t),(0,n.e)(t,r,e),(0,n.n)(r,r),(0,n.n)(t,t)}(0,i.vt)(),(0,i.vt)(),(0,i.vt)(),(0,i.vt)(),(0,i.vt)()},89988:(e,t,r)=>{function n(){return new Float32Array(3)}function i(e){let t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(e,t,r){let n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n}function a(){return n()}function o(){return s(1,1,1)}function l(){return s(1,0,0)}function u(){return s(0,1,0)}function d(){return s(0,0,1)}r.d(t,{fA:()=>s,o8:()=>i,vt:()=>n});let c=a(),h=o(),f=l();Object.freeze(Object.defineProperty({__proto__:null,ONES:h,UNIT_X:f,UNIT_Y:u(),UNIT_Z:d(),ZEROS:c,clone:i,create:n,createView:function(e,t){return new Float32Array(e,t,3)},fromValues:s,ones:o,unitX:l,unitY:u,unitZ:d,zeros:a},Symbol.toStringTag,{value:"Module"}))},90564:(e,t,r)=>{r.d(t,{N5:()=>l});var n=r(32391);r(57845);var i=r(61939),s=r(2907);let a=()=>i.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class o{constructor(){this._includedModules=new Map}include(e,t){this._includedModules.has(e)?this._includedModules.get(e):(this._includedModules.set(e,t),e(this.builder,t))}}class l extends o{constructor(){super(...arguments),this.vertex=new h,this.fragment=new h,this.attributes=new f,this.varyings=new m,this.extensions=new g,this.outputs=new _}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(e,t=!1){let r=this.extensions.generateSource(e),n=this.attributes.generateSource(e),i=this.varyings.generateSource(e),s="vertex"===e?this.vertex:this.fragment,a=s.uniforms.generateSource(),o=s.code.generateSource(),l=s.main.generateSource(t),u="vertex"===e?b:y,d=s.constants.generateSource(),c=this.outputs.generateSource(e);return`#version 300 es
${r.join("\n")}
${u}
${d.join("\n")}
${a.join("\n")}
${n.join("\n")}
${i.join("\n")}
${c.join("\n")}
${o.join("\n")}
${l.join("\n")}`}generateBind(e){let t=new Map;this.vertex.uniforms.entries.forEach(e=>{let r=e.bind[s.c.Bind];r&&t.set(e.name,r)}),this.fragment.uniforms.entries.forEach(e=>{let r=e.bind[s.c.Bind];r&&t.set(e.name,r)});let r=Array.from(t.values()),n=r.length;return t=>{for(let i=0;i<n;++i)r[i](e,t)}}generateBindPass(e){let t=new Map;this.vertex.uniforms.entries.forEach(e=>{let r=e.bind[s.c.Pass];r&&t.set(e.name,r)}),this.fragment.uniforms.entries.forEach(e=>{let r=e.bind[s.c.Pass];r&&t.set(e.name,r)});let r=Array.from(t.values()),n=r.length;return(t,i)=>{for(let s=0;s<n;++s)r[s](e,t,i)}}generateBindDraw(e){let t=new Map;this.vertex.uniforms.entries.forEach(e=>{let r=e.bind[s.c.Draw];r&&t.set(e.name,r)}),this.fragment.uniforms.entries.forEach(e=>{let r=e.bind[s.c.Draw];r&&t.set(e.name,r)});let r=Array.from(t.values()),n=r.length;return(t,i,s)=>{for(let a=0;a<n;++a)r[a](e,s,t,i)}}}class u{constructor(e){this._stage=e,this._entries=new Map}add(...e){for(let t of e)this._add(t);return this._stage}get(e){return this._entries.get(e)}_add(e){if(null!=e){if(this._entries.has(e.name)&&!this._entries.get(e.name).equals(e))throw new n.A(`Duplicate uniform name ${e.name} for different uniform type`);this._entries.set(e.name,e)}else a().error(`Trying to add null Uniform from ${Error().stack}.`)}generateSource(){return Array.from(this._entries.values()).map(e=>null!=e.arraySize?`uniform ${e.type} ${e.name}[${e.arraySize}];`:`uniform ${e.type} ${e.name};`)}get entries(){return Array.from(this._entries.values())}}class d{constructor(e){this._stage=e,this._bodies=[]}add(e){return this._bodies.push(e),this._stage}generateSource(e){if(this._bodies.length>0)return[`void main() {
 ${this._bodies.join("\n")||""} 
}`];if(e)throw new n.A("Shader does not contain main function body.");return[]}}class c{constructor(e){this._stage=e,this._entries=[]}add(e){return this._entries.push(e),this._stage}generateSource(){return this._entries}}class h extends o{constructor(){super(...arguments),this.uniforms=new u(this),this.main=new d(this),this.code=new c(this),this.constants=new p(this)}get builder(){return this}}class f{constructor(){this._entries=[]}add(e,t){this._entries.push([e,t])}generateSource(e){return"fragment"===e?[]:this._entries.map(e=>`in ${e[1]} ${e[0]};`)}}class m{constructor(){this._entries=new Map}add(e,t){this._entries.has(e)?a().warn(`Ignoring duplicate varying ${t} ${e}`):this._entries.set(e,t)}generateSource(e){let t=[];return this._entries.forEach((r,n)=>t.push("vertex"===e?`out ${r} ${n};`:`in ${r} ${n};`)),t}}class g{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){let t="vertex"===e?g.ALLOWLIST_VERTEX:g.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(e=>t.includes(e)).map(e=>`#extension ${e} : enable`)}}g.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],g.ALLOWLIST_VERTEX=[];class _{constructor(){this._entries=new Map}add(e,t,r=0){let n=this._entries.get(r);n?.name!==e||n?.type!==t?this._entries.set(r,{name:e,type:t}):a().warn(`Fragment shader output location ${r} occupied`)}generateSource(e){if("vertex"===e)return[];0===this._entries.size&&this._entries.set(0,{name:_.DEFAULT_NAME,type:_.DEFAULT_TYPE});let t=[];return this._entries.forEach((e,r)=>t.push(`layout(location = ${r}) out ${e.type} ${e.name};`)),t}}_.DEFAULT_TYPE="vec4",_.DEFAULT_NAME="fragColor";class p{constructor(e){this._stage=e,this._entries=new Set}add(e,t,r){let n="ERROR_CONSTRUCTOR_STRING";switch(t){case"float":n=p._numberToFloatStr(r);break;case"int":n=p._numberToIntStr(r);break;case"bool":n=r.toString();break;case"vec2":n=`vec2(${p._numberToFloatStr(r[0])},                            ${p._numberToFloatStr(r[1])})`;break;case"vec3":n=`vec3(${p._numberToFloatStr(r[0])},                            ${p._numberToFloatStr(r[1])},                            ${p._numberToFloatStr(r[2])})`;break;case"vec4":n=`vec4(${p._numberToFloatStr(r[0])},                            ${p._numberToFloatStr(r[1])},                            ${p._numberToFloatStr(r[2])},                            ${p._numberToFloatStr(r[3])})`;break;case"ivec2":n=`ivec2(${p._numberToIntStr(r[0])},                             ${p._numberToIntStr(r[1])})`;break;case"ivec3":n=`ivec3(${p._numberToIntStr(r[0])},                             ${p._numberToIntStr(r[1])},                             ${p._numberToIntStr(r[2])})`;break;case"ivec4":n=`ivec4(${p._numberToIntStr(r[0])},                             ${p._numberToIntStr(r[1])},                             ${p._numberToIntStr(r[2])},                             ${p._numberToIntStr(r[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${t}(${Array.prototype.map.call(r,e=>p._numberToFloatStr(e)).join(", ")})`}return this._entries.add(`const ${t} ${e} = ${n};`),this._stage}static _numberToIntStr(e){return e.toFixed(0)}static _numberToFloatStr(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}generateSource(){return Array.from(this._entries)}}let y="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp int;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump int;\n  precision mediump sampler2D;\n#endif",b="precision highp float;\nprecision highp sampler2D;"},94264:(e,t,r)=>{r.d(t,{Qf:()=>l,Qh:()=>a,RS:()=>i,ez:()=>d,i5:()=>c,lM:()=>s,qK:()=>u});var n=r(48678);let i=16;function s(e){if(!e)return 0;let t=u;for(let r in e)e.hasOwnProperty(r)&&(t+=o(e[r],!1));return t}function a(e){if(!e)return 0;if("number"==typeof e[0])return l(e);if(Array.isArray(e)){var t=e;let r=t.length;if(0===r||"number"==typeof t[0])return function(e,t){return d+e.length*t}(t,8);let n=d;for(let e=0;e<r;e++)n+=o(t[e]);return n}let r=u;for(let t in e)e.hasOwnProperty(t)&&(r+=o(e[t]));return r}function o(e,t=!0){switch(typeof e){case"object":return t?a(e):u;case"string":return 32+e.length;case"number":return i;case"boolean":return 4;default:return 8}}function l(...e){return e.reduce((e,t)=>{var r,s;return e+(t?(0,n.iu)(t)?t.byteLength+c:Array.isArray(t)?(r=t,s=i,d+r.length*s):0:0)},0)}let u=32,d=16,c=145},99419:(e,t,r)=>{r.d(t,{_:()=>n});class n{constructor(e,t,r,n,i,s=!1,a=0){this.name=e,this.count=t,this.type=r,this.offset=n,this.stride=i,this.normalized=s,this.divisor=a}}}}]);