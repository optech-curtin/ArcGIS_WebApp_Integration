"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6569],{76569:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(95155),a=r(12115),l=r(15879),c=r(79233),n=r(43778),i=r(48767);let u=e=>{let{parkingLot:t,bayTypes:r}=e,a=r.reduce((e,t)=>{let{count:r}=t;return e+r},0);return(0,s.jsxs)("div",{className:"absolute top-4 right-4 bg-white p-4 rounded-lg shadow-lg z-10",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-1",children:t}),(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("th",{className:"text-left text-base py-2 px-4",children:"Bay Type"}),(0,s.jsx)("th",{className:"text-right text-base py-2 px-4",children:"Count"})]})}),(0,s.jsxs)("tbody",{children:[r.map(e=>{let{type:t,count:r}=e;return(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:t}),(0,s.jsx)("td",{className:"text-right text-sm py-2 px-4",children:r})]},t)}),(0,s.jsxs)("tr",{className:"border-t-2 font-semibold",children:[(0,s.jsx)("td",{className:"py-2 px-4 text-sm",children:"Total"}),(0,s.jsx)("td",{className:"text-right text-sm py-2 px-4",children:a})]})]})]})]})};function o(){let e=(0,a.useRef)(null),[t,r]=(0,a.useState)(""),[o,d]=(0,a.useState)([]);return(0,a.useEffect)(()=>{e.current&&function(){i.A.portalUrl="https://arcgis.curtin.edu.au/portal";let t=new c.A({portalItem:{id:"34e3e14cea754a41a9b7f8455fef8c48"}});new l.A({container:e.current,map:t,center:[115.894,-32.005],zoom:14}).on("click",async e=>{try{let t=new n.default({url:"https://arcgis.curtin.edu.au/arcgis/rest/services/ParKam/ParKam/FeatureServer/4"}),s=t.createQuery();s.geometry=e.mapPoint,s.spatialRelationship="intersects";let a=await t.queryFeatures(s);if(a.features.length>0){let e=a.features[0].attributes.Zone.trim();console.log("Clicked zone:",e),r(e);let t=new n.default({url:"https://arcgis.curtin.edu.au/arcgis/rest/services/Hosted/Park_Aid_Bays_Under/FeatureServer/0"}),s=new n.default({url:"https://arcgis.curtin.edu.au/arcgis/rest/services/Hosted/Park_Aid_Bays/FeatureServer/0"});await Promise.all([t.load(),s.load()]);let l=t.createQuery();l.where="parkinglot = '".concat(e,"'"),l.returnGeometry=!1,l.outFields=["*"];let c=s.createQuery();c.where="parkinglot = '".concat(e,"'"),c.returnGeometry=!1,c.outFields=["*"];let[i,u]=await Promise.all([t.queryFeatures(l),s.queryFeatures(c)]),o=[...i.features,...u.features],h={};o.forEach(e=>{let t=e.attributes.baytype||"Unknown";h[t]=(h[t]||0)+1});let p=Object.entries(h).map(e=>{let[t,r]=e;return{type:t,count:r}}).sort((e,t)=>t.count-e.count);d(p)}}catch(e){console.error("Map click error:",e)}})}()},[]),(0,s.jsxs)("div",{className:"relative w-full h-screen",children:[(0,s.jsx)("div",{ref:e,className:"w-full h-screen"}),t&&(0,s.jsx)(u,{parkingLot:t,bayTypes:o})]})}}}]);